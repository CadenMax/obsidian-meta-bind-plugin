"use strict";
/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod2) => __copyProps(__defProp({}, "__esModule", { value: true }), mod2);
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MetaBindPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian14 = require("obsidian");

// src/settings/Settings.ts
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  devMode: false,
  preferredDateFormat: "YYYY-MM-DD",
  useUsDateInputOrder: false,
  syncInterval: 200,
  minSyncInterval: 50,
  maxSyncInterval: 1e3,
  inputTemplates: ""
};
var MetaBindSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Meta Bind Plugin Settings" });
    new import_obsidian.Setting(containerEl).setName("Sync interval").setDesc(`The interval in milli-seconds between disk writes. Changing this number is not recommended except if your hard drive is exceptionally slow. Standard: ${DEFAULT_SETTINGS.syncInterval}; Minimum: ${DEFAULT_SETTINGS.minSyncInterval}; Maximum: ${DEFAULT_SETTINGS.maxSyncInterval}`).addText((cb) => {
      cb.setValue(this.plugin.settings.syncInterval.toString());
      cb.onChange((data) => {
        this.plugin.settings.syncInterval = Number.parseInt(data);
        if (Number.isNaN(this.plugin.settings.syncInterval)) {
          this.plugin.settings.syncInterval = DEFAULT_SETTINGS.syncInterval;
        }
        if (this.plugin.settings.syncInterval < DEFAULT_SETTINGS.minSyncInterval) {
          this.plugin.settings.syncInterval = DEFAULT_SETTINGS.minSyncInterval;
        }
        if (this.plugin.settings.syncInterval > DEFAULT_SETTINGS.maxSyncInterval) {
          this.plugin.settings.syncInterval = DEFAULT_SETTINGS.maxSyncInterval;
        }
        this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(containerEl).setName("Date format").setDesc(`The date format to be used by this plugin. Changing this setting will break the parsing of existing date inputs. Here is a list of all available date tokes https://momentjs.com/docs/#/displaying/.`).addText((cb) => {
      cb.setValue(this.plugin.settings.preferredDateFormat);
      cb.onChange((data) => {
        this.plugin.settings.preferredDateFormat = data;
        this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(containerEl).setName("Use US date input field order").setDesc(`When enabled the month input is before the day input.`).addToggle((cb) => {
      cb.setValue(this.plugin.settings.useUsDateInputOrder);
      cb.onChange((data) => {
        this.plugin.settings.useUsDateInputOrder = data;
        this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(containerEl).setName("Templates").setDesc(`You can specify templates here, and access them using \`TEMPLATE_INPUT[...]\` in your notes.`);
    const ta = new import_obsidian.TextAreaComponent(containerEl);
    ta.setValue(this.plugin.settings.inputTemplates);
    ta.setPlaceholder("template_name -> INPUT[input_type(argument(value)):bind_target]");
    ta.inputEl.style.width = "100%";
    ta.inputEl.style.height = "200px";
    ta.onChange((data) => {
      this.plugin.settings.inputTemplates = data;
      this.plugin.saveSettings();
    });
    new import_obsidian.Setting(containerEl).setName("Dev Mode").setDesc("Enable dev mode. Not recommended unless you want to debug this plugin.").addToggle((cb) => {
      cb.setValue(this.plugin.settings.devMode);
      cb.onChange((data) => {
        this.plugin.settings.devMode = data;
        this.plugin.saveSettings();
      });
    });
  }
};

// src/InputFieldMarkdownRenderChild.ts
var import_obsidian13 = require("obsidian");

// src/utils/Logger.ts
var _Logger = class {
  static log(...data) {
    console.log(this.prefix, ...data);
  }
  static logDebug(...data) {
    if (this.devMode) {
      _Logger.log(...data);
    }
  }
  static logWarning(...data) {
    console.warn(this.prefix, data);
  }
  static warn(...data) {
    console.warn(data);
  }
  static logError(...data) {
    console.error(this.prefix, data);
  }
};
var Logger = _Logger;
Logger.prefix = "meta-bind |";

// src/inputFields/AbstractInputField.ts
var AbstractInputField = class {
  constructor(inputFieldMarkdownRenderChild, onValueChange) {
    this.inputFieldMarkdownRenderChild = inputFieldMarkdownRenderChild;
    this.onValueChange = onValueChange;
  }
};
AbstractInputField.allowCodeBlock = true;
AbstractInputField.allowInlineCodeBlock = true;

// src/inputFields/ToggleInputField.ts
var import_obsidian2 = require("obsidian");

// src/utils/Utils.ts
var MetaBindInternalError = class extends Error {
  constructor(message) {
    super(`[MB_INTERNAL_ERROR - please report this error here https://github.com/mProjectsCode/obsidian-meta-bind-plugin/issues] ${message}`);
  }
};
var MetaBindParsingError = class extends Error {
  constructor(message) {
    super(`[MB_PARSING_ERROR] ${message}`);
  }
};
var MetaBindBindTargetError = class extends Error {
  constructor(message) {
    super(`[MB_BIND_TARGET_ERROR] ${message}`);
  }
};
function getFileName(path) {
  var _a;
  return (_a = path.split("/").at(-1)) != null ? _a : path;
}
function isPath(path) {
  return path.split("/").length > 1;
}
function removeFileEnding(fileName) {
  const fileNameParts = fileName.split(".");
  if (fileNameParts.length === 1) {
    return fileName;
  } else {
    let newFileName = fileNameParts[0];
    for (let i = 1; i < fileNameParts.length - 1; i++) {
      newFileName += "." + fileNameParts[i];
    }
    return newFileName;
  }
}
function mod(n, m) {
  return (n % m + m) % m;
}
function arrayEquals(arr1, arr2) {
  if (arr1.length !== arr2.length) {
    return false;
  }
  for (const arr1Element of arr1) {
    if (!arr2.contains(arr1Element)) {
      return false;
    }
  }
  return true;
}
function isTruthy(value) {
  return !!value;
}
function isFalsy(value) {
  return !value;
}
function equalOrIncludes(str1, str2) {
  return str1 === str2 || str1.includes(str2) || str2.includes(str1);
}

// src/inputFields/ToggleInputField.ts
var ToggleInputField = class extends AbstractInputField {
  getValue() {
    if (!this.toggleComponent) {
      throw new MetaBindInternalError("toggle input component is undefined");
    }
    return this.toggleComponent.getValue();
  }
  setValue(value) {
    if (!this.toggleComponent) {
      throw new MetaBindInternalError("toggle input component is undefined");
    }
    if (value != null && typeof value == "boolean") {
      this.toggleComponent.setValue(value);
    } else {
      Logger.logWarning(`can not set value of toggle to '${value}'`);
      this.toggleComponent.setValue(false);
    }
  }
  isEqualValue(value) {
    return this.getValue() == value;
  }
  getDefaultValue() {
    return false;
  }
  getHtmlElement() {
    if (!this.toggleComponent) {
      throw new MetaBindInternalError("toggle input component is undefined");
    }
    return this.toggleComponent.toggleEl;
  }
  render(container) {
    const component = new import_obsidian2.ToggleComponent(container);
    component.setValue(this.inputFieldMarkdownRenderChild.getInitialValue());
    component.onChange(this.onValueChange);
    this.toggleComponent = component;
  }
};

// src/inputFields/TextInputField.ts
var import_obsidian3 = require("obsidian");
var TextInputField = class extends AbstractInputField {
  getValue() {
    if (!this.textComponent) {
      throw new MetaBindInternalError("text input component is undefined");
    }
    return this.textComponent.getValue();
  }
  setValue(value) {
    if (!this.textComponent) {
      throw new MetaBindInternalError("text input component is undefined");
    }
    if (value != null && typeof value == "string") {
      this.textComponent.setValue(value);
    } else {
      Logger.logWarning(`can not set value of text input to '${value}'`);
      this.textComponent.setValue("");
    }
  }
  isEqualValue(value) {
    return this.getValue() == value;
  }
  getDefaultValue() {
    return "";
  }
  getHtmlElement() {
    if (!this.textComponent) {
      throw new MetaBindInternalError("text input component is undefined");
    }
    return this.textComponent.inputEl;
  }
  render(container) {
    const component = new import_obsidian3.TextComponent(container);
    component.setValue(this.inputFieldMarkdownRenderChild.getInitialValue());
    component.onChange(this.onValueChange);
    this.textComponent = component;
  }
};

// src/inputFields/SliderInputField.ts
var import_obsidian4 = require("obsidian");

// src/utils/ParserUtils.ts
var EnclosingPair = class {
  constructor(openingString, closingString) {
    if (isFalsy(openingString)) {
      throw new MetaBindInternalError("opening string must not be empty");
    }
    this.openingEqualsClosing = isFalsy(closingString) || openingString === closingString;
    if (this.openingEqualsClosing) {
      this._openingString = openingString;
      this._closingString = openingString;
    } else {
      this._openingString = openingString;
      this._closingString = closingString;
    }
  }
  get openingString() {
    return this._openingString;
  }
  get closingString() {
    return this.openingEqualsClosing ? this._openingString : this._closingString;
  }
  overlaps(other) {
    return equalOrIncludes(this.openingString, other.openingString) || equalOrIncludes(this.openingString, other.closingString) || equalOrIncludes(this.closingString, other.openingString) || equalOrIncludes(this.closingString, other.closingString);
  }
  equals(other) {
    if (isFalsy(other)) {
      return false;
    }
    return this.openingString === other.openingString && this.closingString === other.closingString;
  }
  toString() {
    return JSON.stringify(this);
  }
};
var ParserUtils = class {
  static split(str, separator, ignore) {
    if (!str) {
      throw new MetaBindInternalError("string must not be empty");
    }
    if (!separator) {
      throw new MetaBindInternalError("separator must not be empty");
    }
    let subStr = "";
    const subStrings = [];
    if (ignore) {
      let remainingOpeningStringCount = ParserUtils.numberOfOccurrences(str, ignore.openingString);
      let remainingClosingStringCount = ParserUtils.numberOfOccurrences(str, ignore.closingString);
      let enclosingLevel = 0;
      strLoop:
        for (let i = 0; i < str.length; i++) {
          if (enclosingLevel === 0 && ParserUtils.isStringAt(str, separator, i)) {
            subStrings.push(subStr);
            subStr = "";
            i += separator.length - 1;
          } else {
            subStr += str[i];
          }
          if (ignore.openingEqualsClosing) {
            if (ParserUtils.isStringAt(str, ignore.openingString, i)) {
              if (enclosingLevel % 2 === 0 && remainingOpeningStringCount === 1) {
              } else if (enclosingLevel % 2 === 0) {
                enclosingLevel += 1;
                for (let j = 1; j < ignore.openingString.length; j++) {
                  i += 1;
                  subStr += str[i];
                  if (i >= str.length) {
                    break strLoop;
                  }
                }
              } else {
                enclosingLevel -= 1;
                for (let j = 1; j < ignore.closingString.length; j++) {
                  i += 1;
                  subStr += str[i];
                  if (i >= str.length) {
                    break strLoop;
                  }
                }
              }
              remainingOpeningStringCount -= 1;
            }
          } else {
            if (ParserUtils.isStringAt(str, ignore.openingString, i)) {
              if (remainingOpeningStringCount <= remainingClosingStringCount) {
                enclosingLevel += 1;
                for (let j = 1; j < ignore.openingString.length; j++) {
                  i += 1;
                  subStr += str[i];
                  if (i >= str.length) {
                    break strLoop;
                  }
                }
              }
              remainingOpeningStringCount -= 1;
            } else if (ParserUtils.isStringAt(str, ignore.closingString, i)) {
              if (enclosingLevel > 0) {
                enclosingLevel -= 1;
                for (let j = 1; j < ignore.closingString.length; j++) {
                  i += 1;
                  subStr += str[i];
                  if (i >= str.length) {
                    break strLoop;
                  }
                }
              }
              remainingClosingStringCount -= 1;
            }
          }
        }
    } else {
      for (let i = 0; i < str.length; i++) {
        if (ParserUtils.isStringAt(str, separator, i)) {
          subStrings.push(subStr);
          subStr = "";
          i += separator.length - 1;
        } else {
          subStr += str[i];
        }
      }
    }
    subStrings.push(subStr);
    return subStrings;
  }
  static removeInBetween(str, enclosingPair) {
    if (!str) {
      throw new MetaBindInternalError("string must not be empty");
    }
    let remainingOpeningStringCount = ParserUtils.numberOfOccurrences(str, enclosingPair.openingString);
    let remainingClosingStringCount = ParserUtils.numberOfOccurrences(str, enclosingPair.closingString);
    let enclosingLevel = 0;
    let subStr = "";
    for (let i = 0; i < str.length; i++) {
      if (enclosingPair.openingEqualsClosing) {
        if (ParserUtils.isStringAt(str, enclosingPair.openingString, i)) {
          if (enclosingLevel % 2 === 0 && remainingOpeningStringCount === 1) {
          } else if (enclosingLevel % 2 === 0) {
            enclosingLevel += 1;
            i += enclosingPair.openingString.length;
            if (i >= str.length) {
              break;
            }
          } else {
            enclosingLevel -= 1;
            i += enclosingPair.closingString.length;
            if (i >= str.length) {
              break;
            }
          }
          remainingOpeningStringCount -= 1;
        }
      } else {
        if (ParserUtils.isStringAt(str, enclosingPair.openingString, i)) {
          if (remainingOpeningStringCount <= remainingClosingStringCount) {
            enclosingLevel += 1;
            i += enclosingPair.openingString.length;
            if (i >= str.length) {
              break;
            }
          }
          remainingOpeningStringCount -= 1;
        } else if (ParserUtils.isStringAt(str, enclosingPair.closingString, i)) {
          if (enclosingLevel > 0) {
            enclosingLevel -= 1;
            i += enclosingPair.closingString.length;
            if (i >= str.length) {
              break;
            }
          }
          remainingClosingStringCount -= 1;
        }
      }
      if (enclosingLevel === 0) {
        subStr += str[i];
      }
    }
    return subStr;
  }
  static getInBetween(str, enclosingPair) {
    if (!str) {
      throw new MetaBindInternalError("string must not be empty");
    }
    let remainingOpeningStringCount = ParserUtils.numberOfOccurrences(str, enclosingPair.openingString);
    let remainingClosingStringCount = ParserUtils.numberOfOccurrences(str, enclosingPair.closingString);
    let enclosingLevel = 0;
    let subStr = "";
    const subStrings = [];
    strLoop:
      for (let i = 0; i < str.length; i++) {
        if (enclosingPair.openingEqualsClosing) {
          if (ParserUtils.isStringAt(str, enclosingPair.openingString, i)) {
            if (enclosingLevel % 2 === 0 && remainingOpeningStringCount === 1) {
            } else if (enclosingLevel % 2 === 0) {
              enclosingLevel += 1;
              subStr += str[i];
              for (let j = 1; j < enclosingPair.openingString.length; j++) {
                i += 1;
                subStr += str[i];
                if (i >= str.length) {
                  break strLoop;
                }
              }
            } else {
              enclosingLevel -= 1;
              subStr += str[i];
              for (let j = 1; j < enclosingPair.closingString.length; j++) {
                i += 1;
                subStr += str[i];
                if (i > str.length) {
                  break strLoop;
                }
              }
              subStrings.push(subStr);
              subStr = "";
            }
            remainingOpeningStringCount -= 1;
          } else {
            if (enclosingLevel >= 1) {
              subStr += str[i];
            }
          }
        } else {
          if (ParserUtils.isStringAt(str, enclosingPair.openingString, i)) {
            if (remainingOpeningStringCount <= remainingClosingStringCount) {
              enclosingLevel += 1;
              subStr += str[i];
              for (let j = 1; j < enclosingPair.openingString.length; j++) {
                i += 1;
                subStr += str[i];
                if (i >= str.length) {
                  break strLoop;
                }
              }
            }
            remainingOpeningStringCount -= 1;
          } else if (ParserUtils.isStringAt(str, enclosingPair.closingString, i)) {
            if (enclosingLevel > 0) {
              enclosingLevel -= 1;
              subStr += str[i];
              for (let j = 1; j < enclosingPair.closingString.length; j++) {
                i += 1;
                subStr += str[i];
                if (i > str.length) {
                  break strLoop;
                }
              }
              if (enclosingLevel === 0) {
                subStrings.push(subStr);
                subStr = "";
              }
            }
            remainingClosingStringCount -= 1;
          } else {
            if (enclosingLevel >= 1) {
              subStr += str[i];
            }
          }
        }
      }
    if (subStrings.length === 0) {
      return "";
    } else if (subStrings.length === 1) {
      return subStrings[0].substring(enclosingPair.openingString.length, subStrings[0].length - enclosingPair.closingString.length);
    } else {
      return subStrings.map((x) => x.substring(enclosingPair.openingString.length, x.length - enclosingPair.closingString.length));
    }
  }
  static isStringAt(str, subStr, index) {
    if (index < 0) {
      throw new MetaBindInternalError("index must be greater than 0");
    }
    if (index >= str.length) {
      throw new MetaBindInternalError("index out of bounds of string");
    }
    if (!str) {
      throw new MetaBindInternalError("string must not be empty");
    }
    if (!subStr) {
      throw new MetaBindInternalError("sub string must not be empty");
    }
    for (let i = 0; i < subStr.length; i++) {
      if (str[i + index] !== subStr[i]) {
        return false;
      }
    }
    return true;
  }
  static contains(str, subStr) {
    return ParserUtils.numberOfOccurrences(str, subStr) > 0;
  }
  static numberOfOccurrences(str, subStr) {
    if (!str) {
      throw new MetaBindInternalError("string must not be empty");
    }
    if (!subStr) {
      throw new MetaBindInternalError("sub string must not be empty");
    }
    let occurrences = 0;
    for (let i = 0; i < str.length; i++) {
      if (ParserUtils.isStringAt(str, subStr, i)) {
        occurrences += 1;
      }
    }
    return occurrences;
  }
};

// src/inputFieldArguments/AbstractInputFieldArgument.ts
var AbstractInputFieldArgument = class {
  constructor() {
    this.identifier = "invalid" /* INVALID */;
    this.allowedInputFields = [];
    this.requiresValue = false;
    this.allowMultiple = false;
  }
  isAllowed(inputFieldType) {
    if (this.allowedInputFields.length === 0) {
      return true;
    }
    return this.allowedInputFields.contains(inputFieldType);
  }
  getAllowedInputFieldsAsString() {
    return this.allowedInputFields.length === 0 ? "all" : this.allowedInputFields.join(", ");
  }
};

// src/inputFieldArguments/ClassInputFieldArgument.ts
var ClassInputFieldArgument = class extends AbstractInputFieldArgument {
  constructor() {
    super(...arguments);
    this.identifier = "class" /* CLASS */;
    this.allowedInputFields = [];
    this.value = [];
    this.requiresValue = true;
    this.allowMultiple = true;
  }
  parseValue(valueStr) {
    this.value = valueStr.split(" ");
  }
};

// src/inputFieldArguments/AddLabelsInputFieldArgument.ts
var AddLabelsInputFieldArgument = class extends AbstractInputFieldArgument {
  constructor() {
    super(...arguments);
    this.identifier = "addLabels" /* ADD_LABELS */;
    this.allowedInputFields = [
      "slider" /* SLIDER */
    ];
    this.value = true;
    this.requiresValue = false;
    this.allowMultiple = false;
  }
  parseValue(valueStr) {
    this.value = valueStr.toLowerCase() === "true";
  }
};

// src/inputFieldArguments/MinValueInputFieldArgument.ts
var MinValueInputFieldArgument = class extends AbstractInputFieldArgument {
  constructor() {
    super(...arguments);
    this.identifier = "minValue" /* MIN_VALUE */;
    this.allowedInputFields = [
      "slider" /* SLIDER */
    ];
    this.value = 0;
    this.requiresValue = true;
    this.allowMultiple = false;
  }
  parseValue(valueStr) {
    this.value = Number.parseInt(valueStr);
    if (Number.isNaN(this.value)) {
      throw new MetaBindParsingError("value of argument 'minValue' must be of type number");
    }
  }
};

// src/inputFieldArguments/MaxValueInputFieldArgument.ts
var MaxValueInputFieldArgument = class extends AbstractInputFieldArgument {
  constructor() {
    super(...arguments);
    this.identifier = "maxValue" /* MAX_VALUE */;
    this.allowedInputFields = [
      "slider" /* SLIDER */
    ];
    this.value = 100;
    this.requiresValue = true;
    this.allowMultiple = false;
  }
  parseValue(valueStr) {
    this.value = Number.parseInt(valueStr);
    if (Number.isNaN(this.value)) {
      throw new MetaBindParsingError("value of argument 'maxValue' must be of type number");
    }
  }
};

// src/inputFieldArguments/OptionInputFieldArgument.ts
var OptionInputFieldArgument = class extends AbstractInputFieldArgument {
  constructor() {
    super(...arguments);
    this.identifier = "option" /* OPTION */;
    this.allowedInputFields = [
      "select" /* SELECT */,
      "multi_select" /* MULTI_SELECT */
    ];
    this.value = "";
    this.requiresValue = true;
    this.allowMultiple = true;
  }
  parseValue(valueStr) {
    this.value = valueStr;
  }
};

// src/inputFieldArguments/TitleInputFieldArgument.ts
var TitleInputFieldArgument = class extends AbstractInputFieldArgument {
  constructor() {
    super(...arguments);
    this.identifier = "title" /* TITLE */;
    this.allowedInputFields = [
      "select" /* SELECT */,
      "multi_select" /* MULTI_SELECT */
    ];
    this.value = "";
    this.requiresValue = true;
    this.allowMultiple = false;
  }
  parseValue(valueStr) {
    this.value = valueStr;
  }
};

// src/inputFieldArguments/AlignRightInputFieldArgument.ts
var AlignRightInputFieldArgument = class extends AbstractInputFieldArgument {
  constructor() {
    super(...arguments);
    this.identifier = "alignRight" /* ALIGN_RIGHT */;
    this.allowedInputFields = [
      "date_picker" /* DATE_PICKER */
    ];
    this.value = true;
    this.requiresValue = false;
    this.allowMultiple = false;
  }
  parseValue(valueStr) {
    this.value = valueStr.toLowerCase() === "true";
  }
};

// src/inputFieldArguments/InputFieldArgumentFactory.ts
var InputFieldArgumentFactory = class {
  static createInputFieldArgument(argumentIdentifier) {
    if (argumentIdentifier === "class" /* CLASS */) {
      return new ClassInputFieldArgument();
    } else if (argumentIdentifier === "addLabels" /* ADD_LABELS */) {
      return new AddLabelsInputFieldArgument();
    } else if (argumentIdentifier === "minValue" /* MIN_VALUE */) {
      return new MinValueInputFieldArgument();
    } else if (argumentIdentifier === "maxValue" /* MAX_VALUE */) {
      return new MaxValueInputFieldArgument();
    } else if (argumentIdentifier === "option" /* OPTION */) {
      return new OptionInputFieldArgument();
    } else if (argumentIdentifier === "title" /* TITLE */) {
      return new TitleInputFieldArgument();
    } else if (argumentIdentifier === "alignRight" /* ALIGN_RIGHT */) {
      return new AlignRightInputFieldArgument();
    } else {
      throw new MetaBindParsingError(`unknown argument '${argumentIdentifier}'`);
    }
  }
};

// src/inputFieldArguments/InputFieldArgumentContainer.ts
var InputFieldArgumentContainer = class {
  constructor() {
    this.arguments = [];
  }
  add(argument) {
    this.arguments.push(argument);
  }
  validate() {
    let map = {};
    for (const inputFieldArgumentType of Object.values(InputFieldArgumentType)) {
      map[inputFieldArgumentType] = 0;
    }
    for (const argument of this.arguments) {
      map[argument.identifier] += 1;
      if (map[argument.identifier] > 1 && !argument.allowMultiple) {
        throw new MetaBindParsingError(`argument '${argument.identifier}' does not allow duplicates`);
      }
    }
  }
  mergeByOverride(other) {
    for (const argument of other.arguments) {
      if (!argument.allowMultiple) {
        this.arguments = this.arguments.filter((x) => x.identifier !== argument.identifier);
      }
      this.arguments.push(argument);
    }
    this.validate();
    return this;
  }
  mergeByThrow(other) {
    for (const argument of other.arguments) {
      if (!argument.allowMultiple) {
        if (this.arguments.filter((x) => x.identifier === argument.identifier).length > 0) {
          throw new MetaBindParsingError("can not merge InputFieldArgumentContainers, since arguments overlap");
        }
      }
      this.arguments.push(argument);
    }
    this.validate();
    return this;
  }
};

// src/parsers/InputFieldDeclarationParser.ts
var InputFieldType3 = /* @__PURE__ */ ((InputFieldType4) => {
  InputFieldType4["TOGGLE"] = "toggle";
  InputFieldType4["SLIDER"] = "slider";
  InputFieldType4["TEXT"] = "text";
  InputFieldType4["TEXT_AREA"] = "text_area";
  InputFieldType4["SELECT"] = "select";
  InputFieldType4["MULTI_SELECT"] = "multi_select";
  InputFieldType4["DATE"] = "date";
  InputFieldType4["TIME"] = "time";
  InputFieldType4["DATE_PICKER"] = "date_picker";
  InputFieldType4["INVALID"] = "invalid";
  return InputFieldType4;
})(InputFieldType3 || {});
var InputFieldArgumentType = /* @__PURE__ */ ((InputFieldArgumentType2) => {
  InputFieldArgumentType2["CLASS"] = "class";
  InputFieldArgumentType2["ADD_LABELS"] = "addLabels";
  InputFieldArgumentType2["MIN_VALUE"] = "minValue";
  InputFieldArgumentType2["MAX_VALUE"] = "maxValue";
  InputFieldArgumentType2["OPTION"] = "option";
  InputFieldArgumentType2["TITLE"] = "title";
  InputFieldArgumentType2["ALIGN_RIGHT"] = "alignRight";
  InputFieldArgumentType2["INVALID"] = "invalid";
  return InputFieldArgumentType2;
})(InputFieldArgumentType || {});
var _InputFieldDeclarationParser = class {
  static parse(fullDeclaration) {
    var _a, _b;
    let inputFieldDeclaration = {};
    let useTemplate = false;
    let templateName = "";
    inputFieldDeclaration.fullDeclaration = fullDeclaration;
    const temp = ParserUtils.getInBetween(fullDeclaration, _InputFieldDeclarationParser.squareBracesPair);
    if (Array.isArray(temp)) {
      if (temp.length === 2) {
        useTemplate = true;
        templateName = temp[0];
        inputFieldDeclaration.declaration = temp[1];
      } else {
        throw new MetaBindParsingError("invalid input field declaration");
      }
    } else {
      inputFieldDeclaration.declaration = temp;
    }
    const declarationParts = ParserUtils.split(inputFieldDeclaration.declaration, ":", _InputFieldDeclarationParser.squareBracesPair);
    inputFieldDeclaration.bindTarget = (_a = declarationParts[1]) != null ? _a : "";
    inputFieldDeclaration.isBound = isTruthy(inputFieldDeclaration.bindTarget);
    const inputFieldTypeWithArguments = declarationParts[0];
    if (inputFieldTypeWithArguments) {
      const inputFieldTypeString = ParserUtils.removeInBetween(inputFieldTypeWithArguments, _InputFieldDeclarationParser.roundBracesPair);
      inputFieldDeclaration.inputFieldType = _InputFieldDeclarationParser.getInputFieldType(inputFieldTypeString);
      const inputFieldArgumentsString = ParserUtils.getInBetween(inputFieldTypeWithArguments, _InputFieldDeclarationParser.roundBracesPair);
      if (inputFieldArgumentsString) {
        inputFieldDeclaration.argumentContainer = _InputFieldDeclarationParser.parseArguments(inputFieldArgumentsString, inputFieldDeclaration.inputFieldType);
      } else {
        inputFieldDeclaration.argumentContainer = new InputFieldArgumentContainer();
      }
    } else {
      inputFieldDeclaration.inputFieldType = "invalid" /* INVALID */;
      inputFieldDeclaration.argumentContainer = new InputFieldArgumentContainer();
    }
    if (useTemplate) {
      const template = (_b = _InputFieldDeclarationParser.templates.filter((x) => x.identifier === templateName).first()) == null ? void 0 : _b.template;
      if (template) {
        inputFieldDeclaration.bindTarget = inputFieldDeclaration.bindTarget || template.bindTarget;
        inputFieldDeclaration.isBound = inputFieldDeclaration.isBound || template.isBound;
        inputFieldDeclaration.inputFieldType = inputFieldDeclaration.inputFieldType === "invalid" /* INVALID */ ? template.inputFieldType : inputFieldDeclaration.inputFieldType || template.inputFieldType;
        inputFieldDeclaration.argumentContainer = template.argumentContainer.mergeByOverride(inputFieldDeclaration.argumentContainer);
      } else {
        throw new MetaBindParsingError(`unknown template name '${templateName}'`);
      }
    }
    if (inputFieldDeclaration.inputFieldType === "invalid" /* INVALID */) {
      throw new MetaBindParsingError(`unknown input field type`);
    }
    return inputFieldDeclaration;
  }
  static parseTemplates(templates) {
    let templateDeclarations = templates ? ParserUtils.split(templates, "\n", _InputFieldDeclarationParser.squareBracesPair) : [];
    templateDeclarations = templateDeclarations.map((x) => x.trim()).filter((x) => x.length > 0);
    for (const templateDeclaration of templateDeclarations) {
      let templateDeclarationParts = ParserUtils.split(templateDeclaration, "->", _InputFieldDeclarationParser.squareBracesPair);
      templateDeclarationParts = templateDeclarationParts.map((x) => x.trim());
      if (templateDeclarationParts.length === 1) {
        throw new MetaBindParsingError("Invalid template syntax");
      } else if (templateDeclarationParts.length === 2) {
        _InputFieldDeclarationParser.templates.push({
          identifier: templateDeclarationParts[0],
          template: _InputFieldDeclarationParser.parse(templateDeclarationParts[1])
        });
      }
    }
    console.log(_InputFieldDeclarationParser.templates);
  }
  static parseArguments(inputFieldArgumentsString, inputFieldType) {
    let inputFieldArgumentStrings = ParserUtils.split(inputFieldArgumentsString, ",", _InputFieldDeclarationParser.roundBracesPair);
    inputFieldArgumentStrings = inputFieldArgumentStrings.map((x) => x.trim());
    const inputFieldArgumentContainer = new InputFieldArgumentContainer();
    for (const inputFieldArgumentString of inputFieldArgumentStrings) {
      const inputFieldArgumentIdentifier = _InputFieldDeclarationParser.extractInputFieldArgumentIdentifier(inputFieldArgumentString);
      const inputFieldArgument = InputFieldArgumentFactory.createInputFieldArgument(inputFieldArgumentIdentifier);
      if (!inputFieldArgument.isAllowed(inputFieldType)) {
        throw new MetaBindParsingError(`argument '${inputFieldArgumentIdentifier}' is only applicable to ${inputFieldArgument.getAllowedInputFieldsAsString()} input fields`);
      }
      if (inputFieldArgument.requiresValue) {
        inputFieldArgument.parseValue(_InputFieldDeclarationParser.extractInputFieldArgumentValue(inputFieldArgumentString));
      }
      inputFieldArgumentContainer.add(inputFieldArgument);
    }
    inputFieldArgumentContainer.validate();
    return inputFieldArgumentContainer;
  }
  static extractInputFieldArgumentIdentifier(argumentString) {
    return ParserUtils.removeInBetween(argumentString, _InputFieldDeclarationParser.roundBracesPair);
  }
  static extractInputFieldArgumentValue(argumentString) {
    const argumentName = this.extractInputFieldArgumentIdentifier(argumentString);
    const argumentValue = ParserUtils.getInBetween(argumentString, _InputFieldDeclarationParser.roundBracesPair);
    if (!argumentValue) {
      throw new MetaBindParsingError(`argument '${argumentName}' requires a non empty value`);
    }
    return argumentValue;
  }
  static getInputFieldType(str) {
    for (const entry of Object.entries(InputFieldType3)) {
      if (entry[1] === str) {
        return entry[1];
      }
    }
    return "invalid" /* INVALID */;
  }
};
var InputFieldDeclarationParser = _InputFieldDeclarationParser;
InputFieldDeclarationParser.roundBracesPair = new EnclosingPair("(", ")");
InputFieldDeclarationParser.squareBracesPair = new EnclosingPair("[", "]");
InputFieldDeclarationParser.curlyBracesPair = new EnclosingPair("{", "}");
InputFieldDeclarationParser.allBracesPairs = [
  _InputFieldDeclarationParser.roundBracesPair,
  _InputFieldDeclarationParser.squareBracesPair,
  _InputFieldDeclarationParser.curlyBracesPair
];
InputFieldDeclarationParser.templates = [];

// src/inputFields/SliderInputField.ts
var SliderInputField = class extends AbstractInputField {
  constructor(inputFieldMarkdownRenderChild, onValueChange) {
    var _a, _b, _c, _d;
    super(inputFieldMarkdownRenderChild, onValueChange);
    this.minValue = (_b = (_a = inputFieldMarkdownRenderChild.getArgument("minValue" /* MIN_VALUE */)) == null ? void 0 : _a.value) != null ? _b : 0;
    this.maxValue = (_d = (_c = inputFieldMarkdownRenderChild.getArgument("maxValue" /* MAX_VALUE */)) == null ? void 0 : _c.value) != null ? _d : 100;
  }
  getValue() {
    if (!this.sliderComponent) {
      throw new MetaBindInternalError("slider input component is undefined");
    }
    return this.sliderComponent.getValue();
  }
  setValue(value) {
    if (!this.sliderComponent) {
      throw new MetaBindInternalError("slider input component is undefined");
    }
    if (value != null && typeof value == "number") {
      if (value >= this.minValue && value <= this.maxValue) {
        this.sliderComponent.setValue(value);
      }
    } else {
      Logger.logWarning(`can not set value of slider to '${value}'`);
      this.sliderComponent.setValue(this.getDefaultValue());
    }
  }
  isEqualValue(value) {
    return this.getValue() == value;
  }
  getDefaultValue() {
    return this.minValue;
  }
  getHtmlElement() {
    if (!this.sliderComponent) {
      throw new MetaBindInternalError("slider input component is undefined");
    }
    return this.sliderComponent.sliderEl;
  }
  render(container) {
    container.removeClass("meta-bind-plugin-input-wrapper");
    container.addClass("meta-bind-plugin-flex-input-wrapper");
    const labelArgument = this.inputFieldMarkdownRenderChild.getArgument("addLabels" /* ADD_LABELS */);
    if (labelArgument && labelArgument.value === true) {
      container.createSpan({ text: this.minValue.toString(), cls: "meta-bind-plugin-slider-input-label" });
    }
    const component = new import_obsidian4.SliderComponent(container);
    component.setValue(this.inputFieldMarkdownRenderChild.getInitialValue());
    component.onChange(this.onValueChange);
    component.setDynamicTooltip();
    component.setLimits(this.minValue, this.maxValue, 1);
    component.sliderEl.addClass("meta-bind-plugin-slider-input");
    if (labelArgument && labelArgument.value === true) {
      container.createSpan({ text: this.maxValue.toString(), cls: "meta-bind-plugin-slider-input-label" });
    }
    this.sliderComponent = component;
  }
};

// src/inputFields/TextAreaInputField.ts
var import_obsidian5 = require("obsidian");
var TextAreaInputField = class extends AbstractInputField {
  getValue() {
    if (!this.textAreaComponent) {
      throw new MetaBindInternalError("text area input component is undefined");
    }
    return this.textAreaComponent.getValue();
  }
  setValue(value) {
    if (!this.textAreaComponent) {
      throw new MetaBindInternalError("text area input component is undefined");
    }
    if (value != null && typeof value == "string") {
      this.textAreaComponent.setValue(value);
    } else {
      Logger.logWarning(`can not set value of text area input to '${value}'`);
      this.textAreaComponent.setValue("");
    }
  }
  isEqualValue(value) {
    return this.getValue() == value;
  }
  getDefaultValue() {
    return "";
  }
  getHtmlElement() {
    if (!this.textAreaComponent) {
      throw new MetaBindInternalError("text area input component is undefined");
    }
    return this.textAreaComponent.inputEl;
  }
  render(container) {
    const component = new import_obsidian5.TextAreaComponent(container);
    component.setValue(this.inputFieldMarkdownRenderChild.getInitialValue());
    component.onChange(this.onValueChange);
    this.textAreaComponent = component;
  }
};

// src/inputFields/SelectInputFieldElement.ts
var SelectInputFieldElement = class {
  constructor(value, parentElement, id, multiSelectInputField, active = false) {
    this.value = value;
    this.id = id;
    this.active = active;
    this.highlighted = false;
    this.selectInputField = multiSelectInputField;
    this.cssClass = "meta-bind-plugin-select-input-element";
    this.activeClass = "meta-bind-plugin-select-input-element-selected";
    this.hoverClass = "meta-bind-plugin-select-input-element-hover";
    this.element = parentElement.createDiv({ cls: this.cssClass });
    this.element.id = this.getHTMLId();
    this.element.on("click", "#" + this.getHTMLId(), () => {
      this.setActive(!this.active);
      if (!this.selectInputField.allowMultiSelect) {
        this.selectInputField.disableAllOtherElements(this.id);
      }
    });
    this.element.on("mouseenter", "#" + this.getHTMLId(), () => {
      this.setHighlighted(true);
    });
    this.element.on("mouseleave", "#" + this.getHTMLId(), () => {
      this.setHighlighted(false);
    });
  }
  getHTMLId() {
    return `meta-bind-select-input-element-${this.selectInputField.inputFieldMarkdownRenderChild.uid}-${this.id}`;
  }
  isHighlighted() {
    return this.highlighted;
  }
  setHighlighted(value) {
    this.highlighted = value;
    if (this.highlighted) {
      this.addClass(this.hoverClass);
      this.selectInputField.deHighlightAllOtherElements(this.id);
    } else {
      this.removeClass(this.hoverClass);
    }
  }
  isActive() {
    return this.active;
  }
  setActive(active, updateParent = true) {
    this.active = active;
    this.update(updateParent);
  }
  update(updateParent) {
    if (this.active) {
      this.addClass(this.activeClass);
    } else {
      this.removeClass(this.activeClass);
    }
    if (updateParent) {
      this.selectInputField.onChange();
    }
  }
  addClass(cssClass) {
    if (!this.element.hasClass(cssClass)) {
      this.element.addClass(cssClass);
    }
  }
  removeClass(cssClass) {
    if (this.element.hasClass(cssClass)) {
      this.element.removeClass(cssClass);
    }
  }
  render() {
    this.element.createEl("div", { text: this.value });
  }
};

// src/inputFields/SelectInputField.ts
var SelectInputField = class extends AbstractInputField {
  constructor(inputFieldMarkdownRenderChild, onValueChange) {
    super(inputFieldMarkdownRenderChild, onValueChange);
    this.elements = [];
    this.allowMultiSelect = false;
  }
  getHtmlElement() {
    if (!this.container) {
      throw new MetaBindInternalError("select input container is undefined");
    }
    return this.container;
  }
  getValue() {
    var _a, _b;
    return (_b = (_a = this.elements.filter((x) => x.isActive()).first()) == null ? void 0 : _a.value) != null ? _b : "";
  }
  setValue(value) {
    for (const element2 of this.elements) {
      if (value === element2.value) {
        element2.setActive(true, false);
      } else {
        element2.setActive(false, false);
      }
    }
  }
  isEqualValue(value) {
    return this.getValue() == value;
  }
  getDefaultValue() {
    return "";
  }
  onChange() {
    this.onValueChange(this.getValue());
  }
  render(container) {
    container.addClass("meta-bind-plugin-select-input-bg");
    this.container = container;
    const elementWrapper = container.createDiv({ cls: "meta-bind-plugin-select-input-wrapper" });
    const titleArgument = this.inputFieldMarkdownRenderChild.getArgument("title" /* TITLE */);
    if (titleArgument) {
      elementWrapper.createEl("div", { text: titleArgument.value, cls: "meta-bind-plugin-select-input-header" });
    }
    const elementArguments = this.inputFieldMarkdownRenderChild.getArguments("option" /* OPTION */);
    let i = 0;
    for (const elementArgument of elementArguments) {
      const selectInputFieldElement = new SelectInputFieldElement(elementArgument.value, elementWrapper, i, this, false);
      this.elements.push(selectInputFieldElement);
      selectInputFieldElement.render();
      i += 1;
    }
    this.setValue(this.inputFieldMarkdownRenderChild.getInitialValue());
  }
  disableAllOtherElements(elementId) {
    for (const selectModalElement of this.elements) {
      if (selectModalElement.id !== elementId) {
        selectModalElement.setActive(false);
      }
    }
  }
  deHighlightAllOtherElements(elementId) {
    for (const selectModalElement of this.elements) {
      if (selectModalElement.id !== elementId) {
        selectModalElement.setHighlighted(false);
      }
    }
  }
  activateHighlighted() {
    for (const selectModalElement of this.elements) {
      if (selectModalElement.isHighlighted()) {
        selectModalElement.setActive(!selectModalElement.isActive());
        if (!this.allowMultiSelect) {
          this.disableAllOtherElements(selectModalElement.id);
        }
      }
    }
  }
  highlightUp() {
    var _a, _b;
    for (const selectModalElement of this.elements) {
      if (selectModalElement.isHighlighted()) {
        (_a = this.getPreviousSelectModalElement(selectModalElement)) == null ? void 0 : _a.setHighlighted(true);
        return;
      }
    }
    (_b = this.elements.at(-1)) == null ? void 0 : _b.setHighlighted(true);
  }
  highlightDown() {
    var _a, _b;
    for (const selectModalElement of this.elements) {
      if (selectModalElement.isHighlighted()) {
        (_a = this.getNextSelectModalElement(selectModalElement)) == null ? void 0 : _a.setHighlighted(true);
        return;
      }
    }
    (_b = this.elements.at(0)) == null ? void 0 : _b.setHighlighted(true);
  }
  getNextSelectModalElement(element2) {
    let nextId = element2.id + 1;
    nextId = mod(nextId, this.elements.length);
    return this.elements.filter((x) => x.id === nextId).at(0);
  }
  getPreviousSelectModalElement(element2) {
    let nextId = element2.id - 1;
    nextId = mod(nextId, this.elements.length);
    return this.elements.filter((x) => x.id === nextId).at(0);
  }
};
SelectInputField.allowInlineCodeBlock = false;

// src/inputFields/MultiSelectInputField.ts
var MultiSelectInputField = class extends SelectInputField {
  constructor(inputFieldMarkdownRenderChild, onValueChange) {
    super(inputFieldMarkdownRenderChild, onValueChange);
    this.allowMultiSelect = true;
  }
  getValue() {
    return this.elements.filter((x) => x.isActive()).map((x) => x.value);
  }
  setValue(value) {
    if (value.length === 0) {
      for (const element2 of this.elements) {
        element2.setActive(false, false);
      }
      return;
    }
    elementLoop:
      for (const element2 of this.elements) {
        for (const valueElement of value) {
          if (valueElement === element2.value) {
            element2.setActive(true, false);
            continue elementLoop;
          }
        }
        element2.setActive(false, false);
      }
  }
  isEqualValue(value) {
    if (!Array.isArray(value)) {
      return false;
    }
    return arrayEquals(this.getValue(), value);
  }
  getDefaultValue() {
    return [];
  }
};

// src/inputFields/DateInputField.ts
var import_obsidian7 = require("obsidian");

// src/parsers/DateParser.ts
var import_obsidian6 = require("obsidian");
var DateParser = class {
  static stringify(date) {
    return date.format(this.dateFormat);
  }
  static parse(dateString) {
    return (0, import_obsidian6.moment)(dateString, DateParser.dateFormat);
  }
  static getDefaultDate() {
    return (0, import_obsidian6.moment)(new Date(DateParser.getDefaultYear(), DateParser.getDefaultMonth(), DateParser.getDefaultDay()));
  }
  static getDefaultDay() {
    return 1;
  }
  static getDefaultMonth() {
    return 1;
  }
  static getDefaultYear() {
    return 2022;
  }
};

// src/inputFields/DateInputField.ts
var DateInputField = class extends AbstractInputField {
  constructor(inputFieldMarkdownRenderChild, onValueChange) {
    super(inputFieldMarkdownRenderChild, onValueChange);
    this.months = {
      "0": "January",
      "1": "February",
      "2": "March",
      "3": "April",
      "4": "May",
      "5": "June",
      "6": "July",
      "7": "August",
      "8": "September",
      "9": "October",
      "10": "November",
      "11": "December"
    };
    this.date = DateParser.getDefaultDate();
    this.days = {};
    for (let i = 1; i <= 31; i++) {
      this.days[i.toString()] = i.toString();
    }
  }
  getHtmlElement() {
    if (!this.container) {
      throw new MetaBindInternalError("toggle input container is undefined");
    }
    return this.container;
  }
  getValue() {
    return DateParser.stringify(this.date);
  }
  setValue(value) {
    var _a;
    if (!this.monthComponent) {
      throw new MetaBindInternalError("date input month component is undefined");
    }
    if (!this.dayComponent) {
      throw new MetaBindInternalError("date input day component is undefined");
    }
    if (!this.yearComponent) {
      throw new MetaBindInternalError("date input hour component is undefined");
    }
    this.date = (_a = DateParser.parse(value)) != null ? _a : DateParser.getDefaultDate();
    if (!this.date.isValid()) {
      this.date = DateParser.getDefaultDate();
      this.onValueChange(this.getValue());
    }
    this.monthComponent.setValue(this.date.month().toString());
    this.dayComponent.setValue(this.date.date().toString());
    this.yearComponent.setValue(this.date.year().toString());
  }
  isEqualValue(value) {
    return value == this.getValue();
  }
  getDefaultValue() {
    return DateParser.stringify(DateParser.getDefaultDate());
  }
  render(container) {
    var _a;
    this.date = (_a = DateParser.parse(this.inputFieldMarkdownRenderChild.getInitialValue())) != null ? _a : DateParser.getDefaultDate();
    if (!this.date.isValid()) {
      this.date = DateParser.getDefaultDate();
      this.onValueChange(this.getValue());
    }
    let useUsInputOrder = this.inputFieldMarkdownRenderChild.plugin.settings.useUsDateInputOrder;
    container.removeClass("meta-bind-plugin-input-wrapper");
    container.addClass("meta-bind-plugin-flex-input-wrapper", "meta-bind-plugin-input-element-group");
    if (!useUsInputOrder) {
      this.dayComponent = new import_obsidian7.DropdownComponent(container);
      this.dayComponent.addOptions(this.days);
      this.dayComponent.setValue(this.date.date().toString());
      this.dayComponent.onChange(this.onDayChange.bind(this));
      this.monthComponent = new import_obsidian7.DropdownComponent(container);
      this.monthComponent.addOptions(this.months);
      this.monthComponent.setValue(this.date.month().toString());
      this.monthComponent.onChange(this.onMonthChange.bind(this));
      this.dayComponent.selectEl.addClass("meta-bind-plugin-input-element-group-element");
      this.monthComponent.selectEl.addClass("meta-bind-plugin-input-element-group-element");
    } else {
      this.monthComponent = new import_obsidian7.DropdownComponent(container);
      this.monthComponent.addOptions(this.months);
      this.monthComponent.setValue(this.date.month().toString());
      this.monthComponent.onChange(this.onMonthChange.bind(this));
      this.dayComponent = new import_obsidian7.DropdownComponent(container);
      this.dayComponent.addOptions(this.days);
      this.dayComponent.setValue(this.date.date().toString());
      this.dayComponent.onChange(this.onDayChange.bind(this));
      this.dayComponent.selectEl.addClass("meta-bind-plugin-input-element-group-element");
      this.monthComponent.selectEl.addClass("meta-bind-plugin-input-element-group-element");
    }
    this.yearComponent = new import_obsidian7.TextComponent(container);
    this.yearComponent.setValue(this.date.year().toString());
    this.yearComponent.onChange(this.onYearChange.bind(this));
    this.yearComponent.inputEl.addClass("meta-bind-plugin-date-input-year-input");
    this.yearComponent.inputEl.addClass("meta-bind-plugin-input-element-group-element");
    this.yearComponent.inputEl.type = "number";
    this.yearComponent.inputEl.max = "9999";
    this.container = container;
  }
  onMonthChange(value) {
    var _a;
    this.date.month(value);
    const clampedDay = this.clampDay(this.date.date());
    (_a = this.dayComponent) == null ? void 0 : _a.setValue(clampedDay.toString());
    this.date.date(clampedDay);
    this.onValueChange(this.getValue());
  }
  onDayChange(value) {
    var _a;
    const day = Number.parseInt(value);
    const clampedDay = this.clampDay(day);
    if (clampedDay !== day) {
      (_a = this.dayComponent) == null ? void 0 : _a.setValue(clampedDay.toString());
    }
    this.date.date(clampedDay);
    this.onValueChange(this.getValue());
  }
  onYearChange(value) {
    const year = Number.parseInt(value);
    this.date.year(Number.isNaN(year) ? DateParser.getDefaultYear() : year);
    this.onValueChange(this.getValue());
  }
  clampDay(day) {
    if (Number.isNaN(day)) {
      return DateParser.getDefaultDay();
    } else if (day < 1) {
      return 1;
    } else if (day > this.date.daysInMonth()) {
      return this.date.daysInMonth();
    }
    return day;
  }
};

// src/inputFields/TimeInputField.ts
var import_obsidian8 = require("obsidian");

// src/parsers/TimeParser.ts
var Time = class {
  constructor() {
    this._hour = TimeParser.getDefaultHour();
    this._minute = TimeParser.getDefaultHour();
  }
  getHour() {
    return this._hour;
  }
  setHour(value) {
    if (value < 0 || value > 24) {
      this._hour = TimeParser.getDefaultHour();
      return;
    }
    this._hour = value;
  }
  getMinute() {
    return this._minute;
  }
  setMinute(value) {
    if (value < 0 || value > 59) {
      this._minute = TimeParser.getDefaultMinute();
      return;
    }
    this._minute = value;
  }
  getUniformHour() {
    return ("00" + this.getHour().toString()).slice(-2);
  }
  getUniformMinute() {
    return ("00" + this.getMinute().toString()).slice(-2);
  }
  setHourFromString(str) {
    const v = Number.parseInt(str);
    this.setHour(Number.isNaN(v) ? TimeParser.getDefaultHour() : v);
  }
  setMinuteFromString(str) {
    const v = Number.parseInt(str);
    this.setMinute(Number.isNaN(v) ? TimeParser.getDefaultMinute() : v);
  }
};
var TimeParser = class {
  static parse(timeString) {
    const time = TimeParser.getDefaultTime();
    const timeParts = timeString.split(":");
    if (timeParts.length !== 2) {
      return void 0;
    }
    time.setHourFromString(timeParts[0]);
    time.setMinuteFromString(timeParts[1]);
    return time;
  }
  static stringify(time) {
    return `${time.getUniformHour()}:${time.getUniformMinute()}`;
  }
  static getDefaultTime() {
    return new Time();
  }
  static getDefaultHour() {
    return 0;
  }
  static getDefaultMinute() {
    return 0;
  }
};

// src/inputFields/TimeInputField.ts
var TimeInputField = class extends AbstractInputField {
  constructor(inputFieldMarkdownRenderChild, onValueChange) {
    super(inputFieldMarkdownRenderChild, onValueChange);
    this.time = TimeParser.getDefaultTime();
    this.hours = {};
    for (let i = 0; i <= 24; i++) {
      this.hours[i.toString()] = i.toString();
    }
    this.minutes = {};
    for (let i = 0; i <= 59; i++) {
      this.minutes[i.toString()] = i.toString();
    }
  }
  getHtmlElement() {
    if (!this.container) {
      throw new MetaBindInternalError("time input container is undefined");
    }
    return this.container;
  }
  getValue() {
    return TimeParser.stringify(this.time);
  }
  setValue(value) {
    var _a;
    if (!this.hourComponent) {
      throw new MetaBindInternalError("time input hour component is undefined");
    }
    if (!this.minuteComponent) {
      throw new MetaBindInternalError("time input minute component is undefined");
    }
    this.time = (_a = TimeParser.parse(value)) != null ? _a : TimeParser.getDefaultTime();
    this.hourComponent.setValue(this.time.getHour().toString());
    this.minuteComponent.setValue(this.time.getMinute().toString());
  }
  isEqualValue(value) {
    return value == this.getValue();
  }
  getDefaultValue() {
    return TimeParser.stringify(TimeParser.getDefaultTime());
  }
  render(container) {
    var _a;
    this.time = (_a = TimeParser.parse(this.inputFieldMarkdownRenderChild.getInitialValue())) != null ? _a : TimeParser.getDefaultTime();
    container.removeClass("meta-bind-plugin-input-wrapper");
    container.addClass("meta-bind-plugin-flex-input-wrapper", "meta-bind-plugin-input-element-group");
    this.hourComponent = new import_obsidian8.DropdownComponent(container);
    this.hourComponent.addOptions(this.hours);
    this.hourComponent.setValue(this.time.getHour().toString());
    this.hourComponent.onChange(this.onHourChange.bind(this));
    this.minuteComponent = new import_obsidian8.DropdownComponent(container);
    this.minuteComponent.addOptions(this.minutes);
    this.minuteComponent.setValue(this.time.getMinute().toString());
    this.minuteComponent.onChange(this.onMinuteChange.bind(this));
    this.hourComponent.selectEl.addClass("meta-bind-plugin-input-element-group-element");
    this.minuteComponent.selectEl.addClass("meta-bind-plugin-input-element-group-element");
    this.container = container;
  }
  onHourChange(value) {
    this.time.setHourFromString(value);
    this.onValueChange(this.getValue());
  }
  onMinuteChange(value) {
    this.time.setMinuteFromString(value);
    this.onValueChange(this.getValue());
  }
};

// node_modules/svelte/internal/index.mjs
function noop() {
}
function run(fn) {
  return fn();
}
function blank_object() {
  return /* @__PURE__ */ Object.create(null);
}
function run_all(fns) {
  fns.forEach(run);
}
function is_function(thing) {
  return typeof thing === "function";
}
function safe_not_equal(a, b) {
  return a != a ? b == b : a !== b || (a && typeof a === "object" || typeof a === "function");
}
function is_empty(obj) {
  return Object.keys(obj).length === 0;
}
var is_hydrating = false;
function start_hydrating() {
  is_hydrating = true;
}
function end_hydrating() {
  is_hydrating = false;
}
function append(target, node) {
  target.appendChild(node);
}
function append_styles(target, style_sheet_id, styles) {
  const append_styles_to = get_root_for_style(target);
  if (!append_styles_to.getElementById(style_sheet_id)) {
    const style = element("style");
    style.id = style_sheet_id;
    style.textContent = styles;
    append_stylesheet(append_styles_to, style);
  }
}
function get_root_for_style(node) {
  if (!node)
    return document;
  const root = node.getRootNode ? node.getRootNode() : node.ownerDocument;
  if (root && root.host) {
    return root;
  }
  return node.ownerDocument;
}
function append_stylesheet(node, style) {
  append(node.head || node, style);
}
function insert(target, node, anchor) {
  target.insertBefore(node, anchor || null);
}
function detach(node) {
  node.parentNode.removeChild(node);
}
function destroy_each(iterations, detaching) {
  for (let i = 0; i < iterations.length; i += 1) {
    if (iterations[i])
      iterations[i].d(detaching);
  }
}
function element(name) {
  return document.createElement(name);
}
function text(data) {
  return document.createTextNode(data);
}
function space() {
  return text(" ");
}
function empty() {
  return text("");
}
function listen(node, event, handler, options) {
  node.addEventListener(event, handler, options);
  return () => node.removeEventListener(event, handler, options);
}
function attr(node, attribute, value) {
  if (value == null)
    node.removeAttribute(attribute);
  else if (node.getAttribute(attribute) !== value)
    node.setAttribute(attribute, value);
}
function children(element2) {
  return Array.from(element2.childNodes);
}
function set_data(text2, data) {
  data = "" + data;
  if (text2.wholeText !== data)
    text2.data = data;
}
function toggle_class(element2, name, toggle) {
  element2.classList[toggle ? "add" : "remove"](name);
}
function custom_event(type, detail, { bubbles = false, cancelable = false } = {}) {
  const e = document.createEvent("CustomEvent");
  e.initCustomEvent(type, bubbles, cancelable, detail);
  return e;
}
var current_component;
function set_current_component(component) {
  current_component = component;
}
function get_current_component() {
  if (!current_component)
    throw new Error("Function called outside component initialization");
  return current_component;
}
function onMount(fn) {
  get_current_component().$$.on_mount.push(fn);
}
function createEventDispatcher() {
  const component = get_current_component();
  return (type, detail, { cancelable = false } = {}) => {
    const callbacks = component.$$.callbacks[type];
    if (callbacks) {
      const event = custom_event(type, detail, { cancelable });
      callbacks.slice().forEach((fn) => {
        fn.call(component, event);
      });
      return !event.defaultPrevented;
    }
    return true;
  };
}
var dirty_components = [];
var binding_callbacks = [];
var render_callbacks = [];
var flush_callbacks = [];
var resolved_promise = Promise.resolve();
var update_scheduled = false;
function schedule_update() {
  if (!update_scheduled) {
    update_scheduled = true;
    resolved_promise.then(flush);
  }
}
function add_render_callback(fn) {
  render_callbacks.push(fn);
}
var seen_callbacks = /* @__PURE__ */ new Set();
var flushidx = 0;
function flush() {
  const saved_component = current_component;
  do {
    while (flushidx < dirty_components.length) {
      const component = dirty_components[flushidx];
      flushidx++;
      set_current_component(component);
      update(component.$$);
    }
    set_current_component(null);
    dirty_components.length = 0;
    flushidx = 0;
    while (binding_callbacks.length)
      binding_callbacks.pop()();
    for (let i = 0; i < render_callbacks.length; i += 1) {
      const callback = render_callbacks[i];
      if (!seen_callbacks.has(callback)) {
        seen_callbacks.add(callback);
        callback();
      }
    }
    render_callbacks.length = 0;
  } while (dirty_components.length);
  while (flush_callbacks.length) {
    flush_callbacks.pop()();
  }
  update_scheduled = false;
  seen_callbacks.clear();
  set_current_component(saved_component);
}
function update($$) {
  if ($$.fragment !== null) {
    $$.update();
    run_all($$.before_update);
    const dirty = $$.dirty;
    $$.dirty = [-1];
    $$.fragment && $$.fragment.p($$.ctx, dirty);
    $$.after_update.forEach(add_render_callback);
  }
}
var outroing = /* @__PURE__ */ new Set();
var outros;
function group_outros() {
  outros = {
    r: 0,
    c: [],
    p: outros
  };
}
function check_outros() {
  if (!outros.r) {
    run_all(outros.c);
  }
  outros = outros.p;
}
function transition_in(block, local) {
  if (block && block.i) {
    outroing.delete(block);
    block.i(local);
  }
}
function transition_out(block, local, detach2, callback) {
  if (block && block.o) {
    if (outroing.has(block))
      return;
    outroing.add(block);
    outros.c.push(() => {
      outroing.delete(block);
      if (callback) {
        if (detach2)
          block.d(1);
        callback();
      }
    });
    block.o(local);
  }
}
var globals = typeof window !== "undefined" ? window : typeof globalThis !== "undefined" ? globalThis : global;
function destroy_block(block, lookup) {
  block.d(1);
  lookup.delete(block.key);
}
function update_keyed_each(old_blocks, dirty, get_key, dynamic, ctx, list, lookup, node, destroy, create_each_block2, next, get_context) {
  let o = old_blocks.length;
  let n = list.length;
  let i = o;
  const old_indexes = {};
  while (i--)
    old_indexes[old_blocks[i].key] = i;
  const new_blocks = [];
  const new_lookup = /* @__PURE__ */ new Map();
  const deltas = /* @__PURE__ */ new Map();
  i = n;
  while (i--) {
    const child_ctx = get_context(ctx, list, i);
    const key = get_key(child_ctx);
    let block = lookup.get(key);
    if (!block) {
      block = create_each_block2(key, child_ctx);
      block.c();
    } else if (dynamic) {
      block.p(child_ctx, dirty);
    }
    new_lookup.set(key, new_blocks[i] = block);
    if (key in old_indexes)
      deltas.set(key, Math.abs(i - old_indexes[key]));
  }
  const will_move = /* @__PURE__ */ new Set();
  const did_move = /* @__PURE__ */ new Set();
  function insert2(block) {
    transition_in(block, 1);
    block.m(node, next);
    lookup.set(block.key, block);
    next = block.first;
    n--;
  }
  while (o && n) {
    const new_block = new_blocks[n - 1];
    const old_block = old_blocks[o - 1];
    const new_key = new_block.key;
    const old_key = old_block.key;
    if (new_block === old_block) {
      next = new_block.first;
      o--;
      n--;
    } else if (!new_lookup.has(old_key)) {
      destroy(old_block, lookup);
      o--;
    } else if (!lookup.has(new_key) || will_move.has(new_key)) {
      insert2(new_block);
    } else if (did_move.has(old_key)) {
      o--;
    } else if (deltas.get(new_key) > deltas.get(old_key)) {
      did_move.add(new_key);
      insert2(new_block);
    } else {
      will_move.add(old_key);
      o--;
    }
  }
  while (o--) {
    const old_block = old_blocks[o];
    if (!new_lookup.has(old_block.key))
      destroy(old_block, lookup);
  }
  while (n)
    insert2(new_blocks[n - 1]);
  return new_blocks;
}
function create_component(block) {
  block && block.c();
}
function mount_component(component, target, anchor, customElement) {
  const { fragment, on_mount, on_destroy, after_update } = component.$$;
  fragment && fragment.m(target, anchor);
  if (!customElement) {
    add_render_callback(() => {
      const new_on_destroy = on_mount.map(run).filter(is_function);
      if (on_destroy) {
        on_destroy.push(...new_on_destroy);
      } else {
        run_all(new_on_destroy);
      }
      component.$$.on_mount = [];
    });
  }
  after_update.forEach(add_render_callback);
}
function destroy_component(component, detaching) {
  const $$ = component.$$;
  if ($$.fragment !== null) {
    run_all($$.on_destroy);
    $$.fragment && $$.fragment.d(detaching);
    $$.on_destroy = $$.fragment = null;
    $$.ctx = [];
  }
}
function make_dirty(component, i) {
  if (component.$$.dirty[0] === -1) {
    dirty_components.push(component);
    schedule_update();
    component.$$.dirty.fill(0);
  }
  component.$$.dirty[i / 31 | 0] |= 1 << i % 31;
}
function init(component, options, instance4, create_fragment4, not_equal, props, append_styles2, dirty = [-1]) {
  const parent_component = current_component;
  set_current_component(component);
  const $$ = component.$$ = {
    fragment: null,
    ctx: null,
    props,
    update: noop,
    not_equal,
    bound: blank_object(),
    on_mount: [],
    on_destroy: [],
    on_disconnect: [],
    before_update: [],
    after_update: [],
    context: new Map(options.context || (parent_component ? parent_component.$$.context : [])),
    callbacks: blank_object(),
    dirty,
    skip_bound: false,
    root: options.target || parent_component.$$.root
  };
  append_styles2 && append_styles2($$.root);
  let ready = false;
  $$.ctx = instance4 ? instance4(component, options.props || {}, (i, ret, ...rest) => {
    const value = rest.length ? rest[0] : ret;
    if ($$.ctx && not_equal($$.ctx[i], $$.ctx[i] = value)) {
      if (!$$.skip_bound && $$.bound[i])
        $$.bound[i](value);
      if (ready)
        make_dirty(component, i);
    }
    return ret;
  }) : [];
  $$.update();
  ready = true;
  run_all($$.before_update);
  $$.fragment = create_fragment4 ? create_fragment4($$.ctx) : false;
  if (options.target) {
    if (options.hydrate) {
      start_hydrating();
      const nodes = children(options.target);
      $$.fragment && $$.fragment.l(nodes);
      nodes.forEach(detach);
    } else {
      $$.fragment && $$.fragment.c();
    }
    if (options.intro)
      transition_in(component.$$.fragment);
    mount_component(component, options.target, options.anchor, options.customElement);
    end_hydrating();
    flush();
  }
  set_current_component(parent_component);
}
var SvelteElement;
if (typeof HTMLElement === "function") {
  SvelteElement = class extends HTMLElement {
    constructor() {
      super();
      this.attachShadow({ mode: "open" });
    }
    connectedCallback() {
      const { on_mount } = this.$$;
      this.$$.on_disconnect = on_mount.map(run).filter(is_function);
      for (const key in this.$$.slotted) {
        this.appendChild(this.$$.slotted[key]);
      }
    }
    attributeChangedCallback(attr2, _oldValue, newValue) {
      this[attr2] = newValue;
    }
    disconnectedCallback() {
      run_all(this.$$.on_disconnect);
    }
    $destroy() {
      destroy_component(this, 1);
      this.$destroy = noop;
    }
    $on(type, callback) {
      const callbacks = this.$$.callbacks[type] || (this.$$.callbacks[type] = []);
      callbacks.push(callback);
      return () => {
        const index = callbacks.indexOf(callback);
        if (index !== -1)
          callbacks.splice(index, 1);
      };
    }
    $set($$props) {
      if (this.$$set && !is_empty($$props)) {
        this.$$.skip_bound = true;
        this.$$set($$props);
        this.$$.skip_bound = false;
      }
    }
  };
}
var SvelteComponent = class {
  $destroy() {
    destroy_component(this, 1);
    this.$destroy = noop;
  }
  $on(type, callback) {
    const callbacks = this.$$.callbacks[type] || (this.$$.callbacks[type] = []);
    callbacks.push(callback);
    return () => {
      const index = callbacks.indexOf(callback);
      if (index !== -1)
        callbacks.splice(index, 1);
    };
  }
  $set($$props) {
    if (this.$$set && !is_empty($$props)) {
      this.$$.skip_bound = true;
      this.$$set($$props);
      this.$$.skip_bound = false;
    }
  }
};

// src/inputFields/DatePicker/DatePickerInputSvelteHelpers.ts
var import_obsidian9 = require("obsidian");
var monthNames = [
  "January",
  "February",
  "March",
  "April",
  "May",
  "June",
  "July",
  "August",
  "September",
  "October",
  "November",
  "December"
];
function getMonthName(index) {
  return monthNames[index];
}
function getDateRows(monthIndex, year) {
  const days = (0, import_obsidian9.moment)(new Date(year, monthIndex)).daysInMonth();
  let rows = new Array(42).fill(void 0);
  const startIndex = getWeekDay(new Date(year, monthIndex, 1));
  for (let i = 0; i < days; i++) {
    rows[i + startIndex] = i + 1;
  }
  rows = rows[rows.length - 7] ? rows : rows.slice(0, -7);
  rows = rows[rows.length - 7] ? rows : rows.slice(0, -7);
  return rows;
}
function getWeekDay(date) {
  return date.getDay() === 0 ? 6 : date.getDay() - 1;
}
function getWeekDays() {
  return ["Mo", "Tu", "We", "Th", "Fr", "Sa", "Su"];
}
function uuid() {
  let id = 0;
  return () => {
    return ++id;
  };
}

// src/inputFields/DatePicker/Calender.svelte
var import_obsidian10 = require("obsidian");
function add_css(target) {
  append_styles(target, "svelte-sdiiqi", ".calendar.svelte-sdiiqi{margin-top:10px}.calendar-header.svelte-sdiiqi{display:flex;justify-content:space-around;flex-wrap:wrap;gap:2px;background:var(--background-primary);border-radius:var(--meta-bind-plugin-border-radius);margin-bottom:2px}.calendar-content.svelte-sdiiqi{display:grid;flex-wrap:wrap;grid-template-columns:repeat(7, 1fr);gap:2px}.cell.svelte-sdiiqi{min-width:40px;height:30px;padding:5px;display:flex;justify-content:center;align-items:center;border-radius:var(--meta-bind-plugin-border-radius)}.content-cell.svelte-sdiiqi{cursor:pointer}.cell-text.svelte-sdiiqi{margin:auto;text-align:center}.selected.svelte-sdiiqi{background:var(--background-modifier-success)}.highlight.svelte-sdiiqi:hover{background:var(--interactive-hover)}.selected.highlight.svelte-sdiiqi:hover{background:green}");
}
function get_each_context(ctx, list, i) {
  const child_ctx = ctx.slice();
  child_ctx[7] = list[i];
  return child_ctx;
}
function get_each_context_1(ctx, list, i) {
  const child_ctx = ctx.slice();
  child_ctx[10] = list[i];
  return child_ctx;
}
function create_each_block_1(ctx) {
  let div;
  let span;
  let t0_value = ctx[10] + "";
  let t0;
  let t1;
  return {
    c() {
      div = element("div");
      span = element("span");
      t0 = text(t0_value);
      t1 = space();
      attr(span, "class", "cell-text svelte-sdiiqi");
      attr(div, "class", "cell header-cell svelte-sdiiqi");
    },
    m(target, anchor) {
      insert(target, div, anchor);
      append(div, span);
      append(span, t0);
      append(div, t1);
    },
    p: noop,
    d(detaching) {
      if (detaching)
        detach(div);
    }
  };
}
function create_each_block(key_1, ctx) {
  let div;
  let span;
  let t0_value = (ctx[7] || "") + "";
  let t0;
  let t1;
  let mounted;
  let dispose;
  function click_handler() {
    return ctx[5](ctx[7]);
  }
  return {
    key: key_1,
    first: null,
    c() {
      div = element("div");
      span = element("span");
      t0 = text(t0_value);
      t1 = space();
      attr(span, "class", "cell-text svelte-sdiiqi");
      attr(div, "class", "cell svelte-sdiiqi");
      toggle_class(div, "highlight", ctx[7]);
      toggle_class(div, "content-cell", ctx[7]);
      toggle_class(div, "selected", ctx[0].year() === ctx[2] && ctx[0].month() === ctx[1] && ctx[0].date() === ctx[7]);
      this.first = div;
    },
    m(target, anchor) {
      insert(target, div, anchor);
      append(div, span);
      append(span, t0);
      append(div, t1);
      if (!mounted) {
        dispose = listen(div, "click", function() {
          if (is_function(ctx[7] ? click_handler : click_handler_1))
            (ctx[7] ? click_handler : click_handler_1).apply(this, arguments);
        });
        mounted = true;
      }
    },
    p(new_ctx, dirty) {
      ctx = new_ctx;
      if (dirty & 8 && t0_value !== (t0_value = (ctx[7] || "") + ""))
        set_data(t0, t0_value);
      if (dirty & 8) {
        toggle_class(div, "highlight", ctx[7]);
      }
      if (dirty & 8) {
        toggle_class(div, "content-cell", ctx[7]);
      }
      if (dirty & 15) {
        toggle_class(div, "selected", ctx[0].year() === ctx[2] && ctx[0].month() === ctx[1] && ctx[0].date() === ctx[7]);
      }
    },
    d(detaching) {
      if (detaching)
        detach(div);
      mounted = false;
      dispose();
    }
  };
}
function create_fragment(ctx) {
  let div2;
  let div0;
  let t;
  let div1;
  let each_blocks = [];
  let each1_lookup = /* @__PURE__ */ new Map();
  let each_value_1 = getWeekDays();
  let each_blocks_1 = [];
  for (let i = 0; i < each_value_1.length; i += 1) {
    each_blocks_1[i] = create_each_block_1(get_each_context_1(ctx, each_value_1, i));
  }
  let each_value = ctx[3];
  const get_key = (ctx2) => uuid();
  for (let i = 0; i < each_value.length; i += 1) {
    let child_ctx = get_each_context(ctx, each_value, i);
    let key = get_key(child_ctx);
    each1_lookup.set(key, each_blocks[i] = create_each_block(key, child_ctx));
  }
  return {
    c() {
      div2 = element("div");
      div0 = element("div");
      for (let i = 0; i < each_blocks_1.length; i += 1) {
        each_blocks_1[i].c();
      }
      t = space();
      div1 = element("div");
      for (let i = 0; i < each_blocks.length; i += 1) {
        each_blocks[i].c();
      }
      attr(div0, "class", "calendar-header svelte-sdiiqi");
      attr(div1, "class", "calendar-content svelte-sdiiqi");
      attr(div2, "class", "calendar svelte-sdiiqi");
    },
    m(target, anchor) {
      insert(target, div2, anchor);
      append(div2, div0);
      for (let i = 0; i < each_blocks_1.length; i += 1) {
        each_blocks_1[i].m(div0, null);
      }
      append(div2, t);
      append(div2, div1);
      for (let i = 0; i < each_blocks.length; i += 1) {
        each_blocks[i].m(div1, null);
      }
    },
    p(ctx2, [dirty]) {
      if (dirty & 0) {
        each_value_1 = getWeekDays();
        let i;
        for (i = 0; i < each_value_1.length; i += 1) {
          const child_ctx = get_each_context_1(ctx2, each_value_1, i);
          if (each_blocks_1[i]) {
            each_blocks_1[i].p(child_ctx, dirty);
          } else {
            each_blocks_1[i] = create_each_block_1(child_ctx);
            each_blocks_1[i].c();
            each_blocks_1[i].m(div0, null);
          }
        }
        for (; i < each_blocks_1.length; i += 1) {
          each_blocks_1[i].d(1);
        }
        each_blocks_1.length = each_value_1.length;
      }
      if (dirty & 31) {
        each_value = ctx2[3];
        each_blocks = update_keyed_each(each_blocks, dirty, get_key, 1, ctx2, each_value, each1_lookup, div1, destroy_block, create_each_block, null, get_each_context);
      }
    },
    i: noop,
    o: noop,
    d(detaching) {
      if (detaching)
        detach(div2);
      destroy_each(each_blocks_1, detaching);
      for (let i = 0; i < each_blocks.length; i += 1) {
        each_blocks[i].d();
      }
    }
  };
}
var click_handler_1 = () => {
};
function instance($$self, $$props, $$invalidate) {
  const dispatch = createEventDispatcher();
  let { selectedDate } = $$props;
  let { month } = $$props;
  let { year } = $$props;
  let cells;
  function onChange(date) {
    dispatch("dateChange", (0, import_obsidian10.moment)(new Date(year, month, date)));
  }
  const click_handler = (value) => onChange(value);
  $$self.$$set = ($$props2) => {
    if ("selectedDate" in $$props2)
      $$invalidate(0, selectedDate = $$props2.selectedDate);
    if ("month" in $$props2)
      $$invalidate(1, month = $$props2.month);
    if ("year" in $$props2)
      $$invalidate(2, year = $$props2.year);
  };
  $$self.$$.update = () => {
    if ($$self.$$.dirty & 6) {
      $:
        $$invalidate(3, cells = getDateRows(month, year));
    }
  };
  return [selectedDate, month, year, cells, onChange, click_handler];
}
var Calender = class extends SvelteComponent {
  constructor(options) {
    super();
    init(this, options, instance, create_fragment, safe_not_equal, { selectedDate: 0, month: 1, year: 2 }, add_css);
  }
};
var Calender_default = Calender;

// src/inputFields/DatePicker/DatePicker.svelte
var import_obsidian12 = require("obsidian");

// src/inputFields/DatePicker/Icon.svelte
var import_obsidian11 = require("obsidian");
function add_css2(target) {
  append_styles(target, "svelte-9cikvm", ".icon-wrapper.svelte-9cikvm{display:inline-block;position:relative;width:20px}.icon.svelte-9cikvm{position:absolute;height:20px;width:20px;bottom:-5px}");
}
function create_if_block(ctx) {
  let div1;
  let div0;
  return {
    c() {
      div1 = element("div");
      div0 = element("div");
      attr(div0, "class", "icon svelte-9cikvm");
      attr(div1, "class", "icon-wrapper svelte-9cikvm");
    },
    m(target, anchor) {
      insert(target, div1, anchor);
      append(div1, div0);
      ctx[3](div0);
    },
    p: noop,
    d(detaching) {
      if (detaching)
        detach(div1);
      ctx[3](null);
    }
  };
}
function create_fragment2(ctx) {
  let if_block_anchor;
  let if_block = ctx[0].length > 0 && create_if_block(ctx);
  return {
    c() {
      if (if_block)
        if_block.c();
      if_block_anchor = empty();
    },
    m(target, anchor) {
      if (if_block)
        if_block.m(target, anchor);
      insert(target, if_block_anchor, anchor);
    },
    p(ctx2, [dirty]) {
      if (ctx2[0].length > 0) {
        if (if_block) {
          if_block.p(ctx2, dirty);
        } else {
          if_block = create_if_block(ctx2);
          if_block.c();
          if_block.m(if_block_anchor.parentNode, if_block_anchor);
        }
      } else if (if_block) {
        if_block.d(1);
        if_block = null;
      }
    },
    i: noop,
    o: noop,
    d(detaching) {
      if (if_block)
        if_block.d(detaching);
      if (detaching)
        detach(if_block_anchor);
    }
  };
}
function instance2($$self, $$props, $$invalidate) {
  let { iconName = "" } = $$props;
  let { iconSize = 20 } = $$props;
  let iconEl;
  onMount(() => {
    (0, import_obsidian11.setIcon)(iconEl, iconName, iconSize);
  });
  function div0_binding($$value) {
    binding_callbacks[$$value ? "unshift" : "push"](() => {
      iconEl = $$value;
      $$invalidate(1, iconEl);
    });
  }
  $$self.$$set = ($$props2) => {
    if ("iconName" in $$props2)
      $$invalidate(0, iconName = $$props2.iconName);
    if ("iconSize" in $$props2)
      $$invalidate(2, iconSize = $$props2.iconSize);
  };
  return [iconName, iconEl, iconSize, div0_binding];
}
var Icon = class extends SvelteComponent {
  constructor(options) {
    super();
    init(this, options, instance2, create_fragment2, safe_not_equal, { iconName: 0, iconSize: 2 }, add_css2);
  }
};
var Icon_default = Icon;

// src/inputFields/DatePicker/DatePicker.svelte
function add_css3(target) {
  append_styles(target, "svelte-vzlvwz", ".date-picker-input.svelte-vzlvwz{position:relative;color:var(--text-normal);display:inline-block}.date-picker.svelte-vzlvwz{position:absolute;top:35px;display:inline-block;background:var(--background-secondary);border-radius:var(--meta-bind-plugin-border-radius);border:var(--meta-bind-plugin-border-width) solid var(--background-modifier-border);padding:10px;z-index:1000000}.date-picker-text.svelte-vzlvwz{background:var(--background-secondary);border-radius:var(--meta-bind-plugin-border-radius);border:var(--meta-bind-plugin-border-width) solid var(--background-modifier-border);padding:5px 5px 5px 7px;cursor:pointer;width:fit-content;display:inline-block}.date-picker-close-layer.svelte-vzlvwz{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:900000}.date-picker-header.svelte-vzlvwz{display:flex;gap:5px;align-items:center;justify-content:space-around}.date-picker-header-text.svelte-vzlvwz{flex:1;text-align:center;display:flex;gap:5px;align-items:center;justify-content:center;width:min-content}.date-picker-header-text-year.svelte-vzlvwz{width:60px;padding:5px}.date-picker-header-text-month.svelte-vzlvwz{height:min-content}.month-switch-button.svelte-vzlvwz{margin:0}");
}
function create_if_block2(ctx) {
  let div0;
  let t0;
  let div3;
  let div2;
  let button0;
  let t2;
  let div1;
  let span;
  let t3_value = getMonthName(ctx[3]) + "";
  let t3;
  let t4;
  let input;
  let input_value_value;
  let t5;
  let button1;
  let t7;
  let calender;
  let div3_style_value;
  let current;
  let mounted;
  let dispose;
  calender = new Calender_default({
    props: {
      month: ctx[3],
      year: ctx[4],
      selectedDate: ctx[0]
    }
  });
  calender.$on("dateChange", ctx[9]);
  return {
    c() {
      div0 = element("div");
      t0 = space();
      div3 = element("div");
      div2 = element("div");
      button0 = element("button");
      button0.textContent = "Prev";
      t2 = space();
      div1 = element("div");
      span = element("span");
      t3 = text(t3_value);
      t4 = space();
      input = element("input");
      t5 = space();
      button1 = element("button");
      button1.textContent = "Next";
      t7 = space();
      create_component(calender.$$.fragment);
      attr(div0, "class", "date-picker-close-layer svelte-vzlvwz");
      attr(button0, "class", "month-switch-button svelte-vzlvwz");
      attr(span, "class", "date-picker-header-text-month svelte-vzlvwz");
      attr(input, "class", "date-picker-header-text-year svelte-vzlvwz");
      attr(input, "type", "number");
      input.value = input_value_value = ctx[4].toString();
      attr(div1, "class", "date-picker-header-text svelte-vzlvwz");
      attr(button1, "class", "month-switch-button svelte-vzlvwz");
      attr(div2, "class", "date-picker-header svelte-vzlvwz");
      attr(div3, "class", "date-picker svelte-vzlvwz");
      attr(div3, "style", div3_style_value = ctx[2] ? "left: auto; right: 0;" : "right: auto; left: 0;");
    },
    m(target, anchor) {
      insert(target, div0, anchor);
      insert(target, t0, anchor);
      insert(target, div3, anchor);
      append(div3, div2);
      append(div2, button0);
      append(div2, t2);
      append(div2, div1);
      append(div1, span);
      append(span, t3);
      append(div1, t4);
      append(div1, input);
      append(div2, t5);
      append(div2, button1);
      append(div3, t7);
      mount_component(calender, div3, null);
      current = true;
      if (!mounted) {
        dispose = [
          listen(div0, "click", ctx[12]),
          listen(button0, "click", ctx[7]),
          listen(input, "input", ctx[8]),
          listen(button1, "click", ctx[6])
        ];
        mounted = true;
      }
    },
    p(ctx2, dirty) {
      if ((!current || dirty & 8) && t3_value !== (t3_value = getMonthName(ctx2[3]) + ""))
        set_data(t3, t3_value);
      if (!current || dirty & 16 && input_value_value !== (input_value_value = ctx2[4].toString()) && input.value !== input_value_value) {
        input.value = input_value_value;
      }
      const calender_changes = {};
      if (dirty & 8)
        calender_changes.month = ctx2[3];
      if (dirty & 16)
        calender_changes.year = ctx2[4];
      if (dirty & 1)
        calender_changes.selectedDate = ctx2[0];
      calender.$set(calender_changes);
      if (!current || dirty & 4 && div3_style_value !== (div3_style_value = ctx2[2] ? "left: auto; right: 0;" : "right: auto; left: 0;")) {
        attr(div3, "style", div3_style_value);
      }
    },
    i(local) {
      if (current)
        return;
      transition_in(calender.$$.fragment, local);
      current = true;
    },
    o(local) {
      transition_out(calender.$$.fragment, local);
      current = false;
    },
    d(detaching) {
      if (detaching)
        detach(div0);
      if (detaching)
        detach(t0);
      if (detaching)
        detach(div3);
      destroy_component(calender);
      mounted = false;
      run_all(dispose);
    }
  };
}
function create_fragment3(ctx) {
  let div1;
  let div0;
  let t0_value = ctx[0].format(ctx[1]) + "";
  let t0;
  let t1;
  let icon;
  let t2;
  let current;
  let mounted;
  let dispose;
  icon = new Icon_default({ props: { iconName: "calendar" } });
  let if_block = ctx[5] && create_if_block2(ctx);
  return {
    c() {
      div1 = element("div");
      div0 = element("div");
      t0 = text(t0_value);
      t1 = space();
      create_component(icon.$$.fragment);
      t2 = space();
      if (if_block)
        if_block.c();
      attr(div0, "class", "date-picker-text svelte-vzlvwz");
      attr(div1, "class", "date-picker-input svelte-vzlvwz");
    },
    m(target, anchor) {
      insert(target, div1, anchor);
      append(div1, div0);
      append(div0, t0);
      append(div0, t1);
      mount_component(icon, div0, null);
      append(div1, t2);
      if (if_block)
        if_block.m(div1, null);
      current = true;
      if (!mounted) {
        dispose = listen(div0, "click", ctx[11]);
        mounted = true;
      }
    },
    p(ctx2, [dirty]) {
      if ((!current || dirty & 3) && t0_value !== (t0_value = ctx2[0].format(ctx2[1]) + ""))
        set_data(t0, t0_value);
      if (ctx2[5]) {
        if (if_block) {
          if_block.p(ctx2, dirty);
          if (dirty & 32) {
            transition_in(if_block, 1);
          }
        } else {
          if_block = create_if_block2(ctx2);
          if_block.c();
          transition_in(if_block, 1);
          if_block.m(div1, null);
        }
      } else if (if_block) {
        group_outros();
        transition_out(if_block, 1, 1, () => {
          if_block = null;
        });
        check_outros();
      }
    },
    i(local) {
      if (current)
        return;
      transition_in(icon.$$.fragment, local);
      transition_in(if_block);
      current = true;
    },
    o(local) {
      transition_out(icon.$$.fragment, local);
      transition_out(if_block);
      current = false;
    },
    d(detaching) {
      if (detaching)
        detach(div1);
      destroy_component(icon);
      if (if_block)
        if_block.d();
      mounted = false;
      dispose();
    }
  };
}
function instance3($$self, $$props, $$invalidate) {
  const dispatch = createEventDispatcher();
  let { selectedDate = (0, import_obsidian12.moment)() } = $$props;
  let { dateFormat = "dddd, MMMM Do YYYY" } = $$props;
  let { dateChangeCallback } = $$props;
  let { alignRight } = $$props;
  let date;
  let month;
  let year;
  let showDatePicker;
  function nextMonth() {
    if (month === 11) {
      $$invalidate(3, month = 0);
      $$invalidate(4, year += 1);
      return;
    }
    $$invalidate(3, month = month + 1);
  }
  function prevMonth() {
    if (month === 0) {
      $$invalidate(3, month = 11);
      $$invalidate(4, year -= 1);
      return;
    }
    $$invalidate(3, month -= 1);
  }
  function changeYear(value) {
    const v = value.target.value;
    const vNum = Number.parseInt(v);
    if (!Number.isNaN(vNum)) {
      $$invalidate(4, year = vNum);
    }
  }
  function onDateChange(d) {
    $$invalidate(5, showDatePicker = false);
    $$invalidate(0, selectedDate = d.detail);
    dateChangeCallback(d.detail);
  }
  const click_handler = () => $$invalidate(5, showDatePicker = true);
  const click_handler_12 = () => $$invalidate(5, showDatePicker = false);
  $$self.$$set = ($$props2) => {
    if ("selectedDate" in $$props2)
      $$invalidate(0, selectedDate = $$props2.selectedDate);
    if ("dateFormat" in $$props2)
      $$invalidate(1, dateFormat = $$props2.dateFormat);
    if ("dateChangeCallback" in $$props2)
      $$invalidate(10, dateChangeCallback = $$props2.dateChangeCallback);
    if ("alignRight" in $$props2)
      $$invalidate(2, alignRight = $$props2.alignRight);
  };
  $$self.$$.update = () => {
    if ($$self.$$.dirty & 1) {
      $: {
        console.log("update date picker", selectedDate);
        date = selectedDate.date();
        $$invalidate(3, month = selectedDate.month());
        $$invalidate(4, year = selectedDate.year());
      }
    }
  };
  return [
    selectedDate,
    dateFormat,
    alignRight,
    month,
    year,
    showDatePicker,
    nextMonth,
    prevMonth,
    changeYear,
    onDateChange,
    dateChangeCallback,
    click_handler,
    click_handler_12
  ];
}
var DatePicker = class extends SvelteComponent {
  constructor(options) {
    super();
    init(this, options, instance3, create_fragment3, safe_not_equal, {
      selectedDate: 0,
      dateFormat: 1,
      dateChangeCallback: 10,
      alignRight: 2
    }, add_css3);
  }
};
var DatePicker_default = DatePicker;

// src/inputFields/DatePicker/DatePickerInputField.ts
var DatePickerInputField = class extends AbstractInputField {
  constructor(inputFieldMarkdownRenderChild, onValueChange) {
    super(inputFieldMarkdownRenderChild, onValueChange);
    this.date = DateParser.getDefaultDate();
  }
  getValue() {
    return DateParser.stringify(this.date);
  }
  setValue(value) {
    var _a, _b;
    this.date = (_a = DateParser.parse(value)) != null ? _a : DateParser.getDefaultDate();
    if (!this.date.isValid()) {
      this.date = DateParser.getDefaultDate();
      this.onValueChange(this.getValue());
    }
    (_b = this.component) == null ? void 0 : _b.$set({ "selectedDate": this.date });
  }
  isEqualValue(value) {
    return this.getValue() == value;
  }
  getDefaultValue() {
    return DateParser.stringify(DateParser.getDefaultDate());
  }
  getHtmlElement() {
    if (!this.container) {
      throw new MetaBindInternalError("");
    }
    return this.container;
  }
  datePickerValueChanged(date) {
    this.date = date;
    if (this.date.isValid()) {
      this.onValueChange(this.getValue());
    }
  }
  render(container) {
    var _a, _b;
    this.container = container;
    this.date = (_a = DateParser.parse(this.inputFieldMarkdownRenderChild.getInitialValue())) != null ? _a : DateParser.getDefaultDate();
    if (!this.date.isValid()) {
      this.date = DateParser.getDefaultDate();
      this.onValueChange(this.getValue());
    }
    this.component = new DatePicker_default({
      target: container,
      props: {
        alignRight: (_b = this.inputFieldMarkdownRenderChild.getArgument("alignRight" /* ALIGN_RIGHT */)) == null ? void 0 : _b.value,
        selectedDate: this.date,
        dateFormat: this.inputFieldMarkdownRenderChild.plugin.settings.preferredDateFormat,
        dateChangeCallback: (date) => this.datePickerValueChanged(date)
      }
    });
  }
};

// src/inputFields/InputFieldFactory.ts
var _InputFieldFactory = class {
  static createInputField(inputFieldType, args) {
    if (inputFieldType === "toggle" /* TOGGLE */) {
      _InputFieldFactory.checkInputFieldMarkdownRenderChildTypeAllowed(inputFieldType, args.type);
      return new ToggleInputField(args.inputFieldMarkdownRenderChild, args.onValueChanged);
    } else if (inputFieldType === "slider" /* SLIDER */) {
      _InputFieldFactory.checkInputFieldMarkdownRenderChildTypeAllowed(inputFieldType, args.type);
      return new SliderInputField(args.inputFieldMarkdownRenderChild, args.onValueChanged);
    } else if (inputFieldType === "text" /* TEXT */) {
      _InputFieldFactory.checkInputFieldMarkdownRenderChildTypeAllowed(inputFieldType, args.type);
      return new TextInputField(args.inputFieldMarkdownRenderChild, args.onValueChanged);
    } else if (inputFieldType === "text_area" /* TEXT_AREA */) {
      _InputFieldFactory.checkInputFieldMarkdownRenderChildTypeAllowed(inputFieldType, args.type);
      return new TextAreaInputField(args.inputFieldMarkdownRenderChild, args.onValueChanged);
    } else if (inputFieldType === "select" /* SELECT */) {
      _InputFieldFactory.checkInputFieldMarkdownRenderChildTypeAllowed(inputFieldType, args.type);
      return new SelectInputField(args.inputFieldMarkdownRenderChild, args.onValueChanged);
    } else if (inputFieldType === "multi_select" /* MULTI_SELECT */) {
      _InputFieldFactory.checkInputFieldMarkdownRenderChildTypeAllowed(inputFieldType, args.type);
      return new MultiSelectInputField(args.inputFieldMarkdownRenderChild, args.onValueChanged);
    } else if (inputFieldType === "date" /* DATE */) {
      _InputFieldFactory.checkInputFieldMarkdownRenderChildTypeAllowed(inputFieldType, args.type);
      return new DateInputField(args.inputFieldMarkdownRenderChild, args.onValueChanged);
    } else if (inputFieldType === "time" /* TIME */) {
      _InputFieldFactory.checkInputFieldMarkdownRenderChildTypeAllowed(inputFieldType, args.type);
      return new TimeInputField(args.inputFieldMarkdownRenderChild, args.onValueChanged);
    } else if (inputFieldType === "date_picker" /* DATE_PICKER */) {
      _InputFieldFactory.checkInputFieldMarkdownRenderChildTypeAllowed(inputFieldType, args.type);
      return new DatePickerInputField(args.inputFieldMarkdownRenderChild, args.onValueChanged);
    }
    return void 0;
  }
  static checkInputFieldMarkdownRenderChildTypeAllowed(inputFieldType, type) {
    const allowCodeBlock = _InputFieldFactory.allowCodeBlockMap[inputFieldType];
    if (type === 1 /* CODE_BLOCK */ && !allowCodeBlock.codeBlock) {
      throw new MetaBindParsingError(`'${inputFieldType}' is not allowed as code block`);
    }
    if (type === 0 /* INLINE_CODE_BLOCK */ && !allowCodeBlock.inlineCodeBlock) {
      throw new MetaBindParsingError(`'${inputFieldType}' is not allowed as inline code block`);
    }
  }
};
var InputFieldFactory = _InputFieldFactory;
InputFieldFactory.allowCodeBlockMap = {
  ["toggle" /* TOGGLE */]: {
    codeBlock: ToggleInputField.allowCodeBlock,
    inlineCodeBlock: ToggleInputField.allowInlineCodeBlock
  },
  ["slider" /* SLIDER */]: {
    codeBlock: SliderInputField.allowCodeBlock,
    inlineCodeBlock: SliderInputField.allowInlineCodeBlock
  },
  ["text" /* TEXT */]: {
    codeBlock: TextInputField.allowCodeBlock,
    inlineCodeBlock: TextInputField.allowInlineCodeBlock
  },
  ["text_area" /* TEXT_AREA */]: {
    codeBlock: TextAreaInputField.allowCodeBlock,
    inlineCodeBlock: TextAreaInputField.allowInlineCodeBlock
  },
  ["select" /* SELECT */]: {
    codeBlock: SelectInputField.allowCodeBlock,
    inlineCodeBlock: SelectInputField.allowInlineCodeBlock
  },
  ["multi_select" /* MULTI_SELECT */]: {
    codeBlock: MultiSelectInputField.allowCodeBlock,
    inlineCodeBlock: MultiSelectInputField.allowInlineCodeBlock
  },
  ["date" /* DATE */]: {
    codeBlock: DateInputField.allowCodeBlock,
    inlineCodeBlock: DateInputField.allowInlineCodeBlock
  },
  ["time" /* TIME */]: {
    codeBlock: TimeInputField.allowCodeBlock,
    inlineCodeBlock: TimeInputField.allowInlineCodeBlock
  },
  ["date_picker" /* DATE_PICKER */]: {
    codeBlock: DatePickerInputField.allowCodeBlock,
    inlineCodeBlock: DatePickerInputField.allowInlineCodeBlock
  }
};

// src/InputFieldMarkdownRenderChild.ts
var InputFieldMarkdownRenderChild2 = class extends import_obsidian13.MarkdownRenderChild {
  constructor(containerEl, type, fullDeclaration, plugin, filePath, uid) {
    super(containerEl);
    this.error = "";
    this.filePath = filePath;
    this.uid = uid;
    this.plugin = plugin;
    this.type = type;
    this.fullDeclaration = fullDeclaration;
    this.metadataValueUpdateQueue = [];
    this.inputFieldValueUpdateQueue = [];
    this.intervalCounter = 0;
    try {
      this.inputFieldDeclaration = InputFieldDeclarationParser.parse(fullDeclaration);
      if (this.inputFieldDeclaration.isBound) {
        this.parseBindTarget();
        this.metaData = this.plugin.getMetaDataForFile(this.bindTargetFile);
      }
      this.inputField = InputFieldFactory.createInputField(this.inputFieldDeclaration.inputFieldType, {
        type,
        inputFieldMarkdownRenderChild: this,
        onValueChanged: this.pushToMetadataValueUpdateQueue.bind(this)
      });
      this.limitInterval = window.setInterval(() => this.applyValueUpdateQueues(), this.plugin.settings.syncInterval);
    } catch (e) {
      this.error = e.message;
      console.warn(e);
    }
  }
  parseBindTarget() {
    if (!this.inputFieldDeclaration) {
      throw new MetaBindInternalError("inputFieldDeclaration is undefined, can not parse bind target");
    }
    const bindTargetParts = this.inputFieldDeclaration.bindTarget.split("#");
    if (bindTargetParts.length === 1) {
      this.bindTargetMetadataField = this.inputFieldDeclaration.bindTarget;
      const files = this.plugin.getFilesByName(this.filePath);
      if (files.length === 0) {
        throw new MetaBindBindTargetError("bind target file not found");
      } else if (files.length === 1) {
        this.bindTargetFile = files[0];
      } else {
        throw new MetaBindBindTargetError("bind target resolves to multiple files, please also specify the file path");
      }
    } else if (bindTargetParts.length === 2) {
      this.bindTargetMetadataField = bindTargetParts[1];
      const files = this.plugin.getFilesByName(bindTargetParts[0]);
      if (files.length === 0) {
        throw new MetaBindBindTargetError("bind target file not found");
      } else if (files.length === 1) {
        this.bindTargetFile = files[0];
      } else {
        throw new MetaBindBindTargetError("bind target resolves to multiple files, please also specify the file path");
      }
    } else {
      throw new MetaBindBindTargetError("bind target may only contain one '#' to specify the metadata field");
    }
  }
  applyValueUpdateQueues() {
    return __async(this, null, function* () {
      if (this.metadataValueUpdateQueue.length !== 0) {
        yield this.applyMetadataValueUpdateQueue();
        this.cleanUpUpdateQueues();
        return;
      }
      if (this.inputFieldValueUpdateQueue.length !== 0) {
        yield this.applyInputFieldValueUpdateQueue();
        this.cleanUpUpdateQueues();
        return;
      }
    });
  }
  applyMetadataValueUpdateQueue() {
    return __async(this, null, function* () {
      if (!this.inputFieldDeclaration) {
        throw new MetaBindInternalError("inputFieldDeclaration is undefined, can not update metadata");
      }
      if (!this.inputFieldDeclaration.isBound) {
        return;
      }
      if (!this.bindTargetMetadataField || !this.bindTargetFile) {
        throw new MetaBindInternalError("bindTargetMetadataField or bindTargetFile is undefined, can not update metadata");
      }
      if (this.metadataValueUpdateQueue.length > 0) {
        yield this.plugin.updateMetaData(this.bindTargetMetadataField, this.metadataValueUpdateQueue.at(-1), this.bindTargetFile);
      } else {
        throw new MetaBindInternalError(`cannot apply metadataValueUpdateQueue to inputField ${this.uid}, metadataValueUpdateQueue is empty`);
      }
    });
  }
  applyInputFieldValueUpdateQueue() {
    return __async(this, null, function* () {
      if (!this.inputFieldDeclaration) {
        throw new MetaBindInternalError("inputFieldDeclaration is undefined, can not update inputField");
      }
      if (!this.inputField) {
        throw new MetaBindInternalError("inputField is undefined, can not update inputField");
      }
      if (this.inputFieldValueUpdateQueue.length > 0) {
        let value = this.inputFieldValueUpdateQueue.at(-1);
        if (value == null) {
          value = this.inputField.getDefaultValue();
        }
        Logger.logDebug(`updating input field ${this.uid} to`, value);
        this.inputField.setValue(value);
      } else {
        throw new MetaBindInternalError(`cannot apply inputFieldValueUpdateQueue to inputField ${this.uid}, inputFieldValueUpdateQueue is empty`);
      }
    });
  }
  cleanUpUpdateQueues() {
    this.metadataValueUpdateQueue = [];
    this.inputFieldValueUpdateQueue = [];
  }
  pushToMetadataValueUpdateQueue(value) {
    var _a;
    if ((_a = this.inputFieldDeclaration) == null ? void 0 : _a.isBound) {
      this.metadataValueUpdateQueue.push(value);
    }
  }
  pushToInputFieldValueUpdateQueue(value) {
    var _a;
    if (!((_a = this.inputField) == null ? void 0 : _a.isEqualValue(value))) {
      this.inputFieldValueUpdateQueue.push(value);
    }
  }
  getInitialValue() {
    var _a, _b, _c, _d;
    if ((_a = this.inputFieldDeclaration) == null ? void 0 : _a.isBound) {
      return (_d = this.metaData[(_b = this.bindTargetMetadataField) != null ? _b : ""]) != null ? _d : (_c = this.inputField) == null ? void 0 : _c.getDefaultValue();
    }
  }
  getArguments(name) {
    if (!this.inputFieldDeclaration) {
      throw new MetaBindInternalError("inputFieldDeclaration is undefined, can not retrieve arguments");
    }
    return this.inputFieldDeclaration.argumentContainer.arguments.filter((x) => x.identifier === name);
  }
  getArgument(name) {
    return this.getArguments(name).at(0);
  }
  onload() {
    return __async(this, null, function* () {
      Logger.logDebug("load", this);
      this.metaData = yield this.metaData;
      const container = this.containerEl.createDiv();
      container.addClass("meta-bind-plugin-input-wrapper");
      this.containerEl.addClass("meta-bind-plugin-input");
      if (this.error) {
        this.containerEl.empty();
        const originalText = this.containerEl.createEl("span", { text: this.fullDeclaration, cls: "meta-bind-code" });
        container.innerText = ` -> ERROR: ${this.error}`;
        container.addClass("meta-bind-plugin-error");
        this.containerEl.appendChild(container);
        return;
      }
      if (!this.inputField) {
        this.containerEl.empty();
        const originalText = this.containerEl.createEl("span", { text: this.fullDeclaration, cls: "meta-bind-code" });
        container.innerText = ` -> ERROR: ${new MetaBindInternalError("input field is undefined and error is empty").message}`;
        container.addClass("meta-bind-plugin-error");
        this.containerEl.appendChild(container);
        return;
      }
      this.plugin.registerInputFieldMarkdownRenderChild(this);
      this.inputField.render(container);
      const classArguments = this.getArguments("class" /* CLASS */);
      if (classArguments) {
        this.inputField.getHtmlElement().addClasses(classArguments.map((x) => x.value).flat());
      }
      this.containerEl.empty();
      this.containerEl.appendChild(container);
    });
  }
  onunload() {
    Logger.logDebug("unload", this);
    this.plugin.unregisterInputFieldMarkdownRenderChild(this);
    super.onunload();
    window.clearInterval(this.limitInterval);
  }
};

// src/main.ts
var MetaBindPlugin = class extends import_obsidian14.Plugin {
  constructor() {
    super(...arguments);
    this.frontMatterRexExpPattern = "^(---)\\n[\\s\\S]*?\\n---";
  }
  onload() {
    return __async(this, null, function* () {
      yield this.loadSettings();
      Logger.devMode = this.settings.devMode;
      DateParser.dateFormat = this.settings.preferredDateFormat;
      InputFieldDeclarationParser.parseTemplates(this.settings.inputTemplates);
      this.activeMarkdownInputFields = [];
      this.markDownInputFieldIndex = 0;
      this.registerMarkdownPostProcessor((element2, context) => {
        const codeBlocks = element2.querySelectorAll("code");
        for (let index = 0; index < codeBlocks.length; index++) {
          const codeBlock = codeBlocks.item(index);
          const text2 = codeBlock.innerText;
          const isInputField = text2.startsWith("INPUT[") && text2.endsWith("]");
          if (isInputField) {
            context.addChild(new InputFieldMarkdownRenderChild2(codeBlock, 0 /* INLINE_CODE_BLOCK */, text2, this, context.sourcePath, this.markDownInputFieldIndex));
            this.markDownInputFieldIndex += 1;
          }
        }
      });
      this.registerMarkdownCodeBlockProcessor("meta-bind", (source, el, ctx) => {
        const codeBlock = el;
        const text2 = source.replace(/\n/g, "");
        const isInputField = text2.startsWith("INPUT[") && text2.endsWith("]");
        if (isInputField) {
          ctx.addChild(new InputFieldMarkdownRenderChild2(codeBlock, 1 /* CODE_BLOCK */, text2, this, ctx.sourcePath, this.markDownInputFieldIndex));
          this.markDownInputFieldIndex += 1;
        }
      });
      this.registerEvent(this.app.metadataCache.on("changed", (file, data, cache) => __async(this, null, function* () {
        yield this.updateMarkdownInputFieldsOnMetadataCacheChange(file, cache);
      })));
      this.addSettingTab(new MetaBindSettingTab(this.app, this));
    });
  }
  onunload() {
    for (const activeMarkdownInputField of this.activeMarkdownInputFields) {
      activeMarkdownInputField.unload();
    }
  }
  registerInputFieldMarkdownRenderChild(inputFieldMarkdownRenderChild) {
    this.activeMarkdownInputFields.push(inputFieldMarkdownRenderChild);
  }
  unregisterInputFieldMarkdownRenderChild(inputFieldMarkdownRenderChild) {
    this.activeMarkdownInputFields = this.activeMarkdownInputFields.filter((x) => x.uid !== inputFieldMarkdownRenderChild.uid);
  }
  updateMarkdownInputFieldsOnMetadataCacheChange(file, cache) {
    return __async(this, null, function* () {
      var _a;
      let metadata = void 0;
      for (const activeMarkdownInputField of this.activeMarkdownInputFields) {
        if (!((_a = activeMarkdownInputField.inputFieldDeclaration) == null ? void 0 : _a.isBound) || !activeMarkdownInputField.bindTargetFile || !activeMarkdownInputField.bindTargetMetadataField) {
          continue;
        }
        if (activeMarkdownInputField.bindTargetFile.path === file.path) {
          if (metadata === void 0) {
            metadata = yield this.getMetadataFromFileCache(cache.frontmatter);
          }
          activeMarkdownInputField.pushToInputFieldValueUpdateQueue(metadata[activeMarkdownInputField.bindTargetMetadataField]);
        }
      }
    });
  }
  updateMetaData(key, value, file) {
    return __async(this, null, function* () {
      Logger.logDebug(`updating `, key, `: `, value, ` in '${file.path}'`);
      if (!file) {
        console.log("no file");
        return;
      }
      let fileContent = yield this.app.vault.read(file);
      const metadata = yield this.getMetaDataForFileContent(fileContent);
      if (!metadata) {
        return;
      }
      const regExp = new RegExp(this.frontMatterRexExpPattern);
      fileContent = fileContent.replace(regExp, "");
      metadata[key] = value;
      fileContent = `---
${(0, import_obsidian14.stringifyYaml)(metadata)}---` + fileContent;
      yield this.app.vault.modify(file, fileContent);
    });
  }
  getFilesByName(name) {
    const fileNameIsPath = isPath(name);
    const processedFileName = fileNameIsPath ? removeFileEnding(name) : getFileName(removeFileEnding(name));
    const allFiles = this.app.vault.getMarkdownFiles();
    const files = [];
    for (const file of allFiles) {
      if (fileNameIsPath) {
        if (removeFileEnding(file.path) === processedFileName) {
          files.push(file);
        }
      } else {
        if (getFileName(removeFileEnding(file.name)) === processedFileName) {
          files.push(file);
        }
      }
    }
    return files;
  }
  getMetaDataForFile(file) {
    return __async(this, null, function* () {
      if (!file) {
        return void 0;
      }
      const fileContent = yield this.app.vault.read(file);
      return yield this.getMetaDataForFileContent(fileContent);
    });
  }
  getMetaDataForFileContent(fileContent) {
    return __async(this, null, function* () {
      let metadata;
      const regExp = new RegExp(this.frontMatterRexExpPattern);
      const frontMatterRegExpResult = regExp.exec(fileContent);
      if (!frontMatterRegExpResult) {
        return {};
      }
      let frontMatter = frontMatterRegExpResult[0];
      if (!frontMatter) {
        return {};
      }
      frontMatter = frontMatter.substring(4);
      frontMatter = frontMatter.substring(0, frontMatter.length - 3);
      metadata = (0, import_obsidian14.parseYaml)(frontMatter);
      if (!metadata) {
        metadata = {};
      }
      return metadata;
    });
  }
  getMetadataFromFileCache(cache) {
    let metadata = cache;
    if (metadata) {
      metadata = Object.assign({}, metadata);
      delete metadata.position;
    } else {
      metadata = {};
    }
    return metadata;
  }
  loadSettings() {
    return __async(this, null, function* () {
      this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
    });
  }
  saveSettings() {
    return __async(this, null, function* () {
      DateParser.dateFormat = this.settings.preferredDateFormat;
      Logger.devMode = this.settings.devMode;
      InputFieldDeclarationParser.parseTemplates(this.settings.inputTemplates);
      yield this.saveData(this.settings);
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vLi4vc3JjL21haW4udHMiLCAiLi4vLi4vLi4vLi4vc3JjL3NldHRpbmdzL1NldHRpbmdzLnRzIiwgIi4uLy4uLy4uLy4uL3NyYy9JbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZC50cyIsICIuLi8uLi8uLi8uLi9zcmMvdXRpbHMvTG9nZ2VyLnRzIiwgIi4uLy4uLy4uLy4uL3NyYy9pbnB1dEZpZWxkcy9BYnN0cmFjdElucHV0RmllbGQudHMiLCAiLi4vLi4vLi4vLi4vc3JjL2lucHV0RmllbGRzL1RvZ2dsZUlucHV0RmllbGQudHMiLCAiLi4vLi4vLi4vLi4vc3JjL3V0aWxzL1V0aWxzLnRzIiwgIi4uLy4uLy4uLy4uL3NyYy9pbnB1dEZpZWxkcy9UZXh0SW5wdXRGaWVsZC50cyIsICIuLi8uLi8uLi8uLi9zcmMvaW5wdXRGaWVsZHMvU2xpZGVySW5wdXRGaWVsZC50cyIsICIuLi8uLi8uLi8uLi9zcmMvdXRpbHMvUGFyc2VyVXRpbHMudHMiLCAiLi4vLi4vLi4vLi4vc3JjL2lucHV0RmllbGRBcmd1bWVudHMvQWJzdHJhY3RJbnB1dEZpZWxkQXJndW1lbnQudHMiLCAiLi4vLi4vLi4vLi4vc3JjL2lucHV0RmllbGRBcmd1bWVudHMvQ2xhc3NJbnB1dEZpZWxkQXJndW1lbnQudHMiLCAiLi4vLi4vLi4vLi4vc3JjL2lucHV0RmllbGRBcmd1bWVudHMvQWRkTGFiZWxzSW5wdXRGaWVsZEFyZ3VtZW50LnRzIiwgIi4uLy4uLy4uLy4uL3NyYy9pbnB1dEZpZWxkQXJndW1lbnRzL01pblZhbHVlSW5wdXRGaWVsZEFyZ3VtZW50LnRzIiwgIi4uLy4uLy4uLy4uL3NyYy9pbnB1dEZpZWxkQXJndW1lbnRzL01heFZhbHVlSW5wdXRGaWVsZEFyZ3VtZW50LnRzIiwgIi4uLy4uLy4uLy4uL3NyYy9pbnB1dEZpZWxkQXJndW1lbnRzL09wdGlvbklucHV0RmllbGRBcmd1bWVudC50cyIsICIuLi8uLi8uLi8uLi9zcmMvaW5wdXRGaWVsZEFyZ3VtZW50cy9UaXRsZUlucHV0RmllbGRBcmd1bWVudC50cyIsICIuLi8uLi8uLi8uLi9zcmMvaW5wdXRGaWVsZEFyZ3VtZW50cy9BbGlnblJpZ2h0SW5wdXRGaWVsZEFyZ3VtZW50LnRzIiwgIi4uLy4uLy4uLy4uL3NyYy9pbnB1dEZpZWxkQXJndW1lbnRzL0lucHV0RmllbGRBcmd1bWVudEZhY3RvcnkudHMiLCAiLi4vLi4vLi4vLi4vc3JjL2lucHV0RmllbGRBcmd1bWVudHMvSW5wdXRGaWVsZEFyZ3VtZW50Q29udGFpbmVyLnRzIiwgIi4uLy4uLy4uLy4uL3NyYy9wYXJzZXJzL0lucHV0RmllbGREZWNsYXJhdGlvblBhcnNlci50cyIsICIuLi8uLi8uLi8uLi9zcmMvaW5wdXRGaWVsZHMvVGV4dEFyZWFJbnB1dEZpZWxkLnRzIiwgIi4uLy4uLy4uLy4uL3NyYy9pbnB1dEZpZWxkcy9TZWxlY3RJbnB1dEZpZWxkRWxlbWVudC50cyIsICIuLi8uLi8uLi8uLi9zcmMvaW5wdXRGaWVsZHMvU2VsZWN0SW5wdXRGaWVsZC50cyIsICIuLi8uLi8uLi8uLi9zcmMvaW5wdXRGaWVsZHMvTXVsdGlTZWxlY3RJbnB1dEZpZWxkLnRzIiwgIi4uLy4uLy4uLy4uL3NyYy9pbnB1dEZpZWxkcy9EYXRlSW5wdXRGaWVsZC50cyIsICIuLi8uLi8uLi8uLi9zcmMvcGFyc2Vycy9EYXRlUGFyc2VyLnRzIiwgIi4uLy4uLy4uLy4uL3NyYy9pbnB1dEZpZWxkcy9UaW1lSW5wdXRGaWVsZC50cyIsICIuLi8uLi8uLi8uLi9zcmMvcGFyc2Vycy9UaW1lUGFyc2VyLnRzIiwgIi4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9zdmVsdGUvaW50ZXJuYWwvaW5kZXgubWpzIiwgIi4uLy4uLy4uLy4uL3NyYy9pbnB1dEZpZWxkcy9EYXRlUGlja2VyL0RhdGVQaWNrZXJJbnB1dFN2ZWx0ZUhlbHBlcnMudHMiLCAiLi4vLi4vLi4vLi4vc3JjL2lucHV0RmllbGRzL0RhdGVQaWNrZXIvQ2FsZW5kZXIuc3ZlbHRlIiwgIi4uLy4uLy4uLy4uL3NyYy9pbnB1dEZpZWxkcy9EYXRlUGlja2VyL0ljb24uc3ZlbHRlIiwgIi4uLy4uLy4uLy4uL3NyYy9pbnB1dEZpZWxkcy9EYXRlUGlja2VyL0RhdGVQaWNrZXIuc3ZlbHRlIiwgIi4uLy4uLy4uLy4uL3NyYy9pbnB1dEZpZWxkcy9EYXRlUGlja2VyL0RhdGVQaWNrZXJJbnB1dEZpZWxkLnRzIiwgIi4uLy4uLy4uLy4uL3NyYy9pbnB1dEZpZWxkcy9JbnB1dEZpZWxkRmFjdG9yeS50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHtDYWNoZWRNZXRhZGF0YSwgRnJvbnRNYXR0ZXJDYWNoZSwgcGFyc2VZYW1sLCBQbHVnaW4sIHN0cmluZ2lmeVlhbWwsIFRGaWxlfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQge0RFRkFVTFRfU0VUVElOR1MsIE1ldGFCaW5kUGx1Z2luU2V0dGluZ3MsIE1ldGFCaW5kU2V0dGluZ1RhYn0gZnJvbSAnLi9zZXR0aW5ncy9TZXR0aW5ncyc7XG5pbXBvcnQge0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLCBJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZFR5cGV9IGZyb20gJy4vSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQnO1xuaW1wb3J0IHtnZXRGaWxlTmFtZSwgaXNQYXRoLCByZW1vdmVGaWxlRW5kaW5nfSBmcm9tICcuL3V0aWxzL1V0aWxzJztcbmltcG9ydCB7TG9nZ2VyfSBmcm9tICcuL3V0aWxzL0xvZ2dlcic7XG5pbXBvcnQge0RhdGVQYXJzZXJ9IGZyb20gJy4vcGFyc2Vycy9EYXRlUGFyc2VyJztcbmltcG9ydCB7SW5wdXRGaWVsZERlY2xhcmF0aW9uUGFyc2VyfSBmcm9tIFwiLi9wYXJzZXJzL0lucHV0RmllbGREZWNsYXJhdGlvblBhcnNlclwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNZXRhQmluZFBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG5cdC8vIEB0cy1pZ25vcmUgZGVmaW5lZCBpbiBgb25sb2FkYFxuXHRzZXR0aW5nczogTWV0YUJpbmRQbHVnaW5TZXR0aW5ncztcblxuXHQvLyBAdHMtaWdub3JlIGRlZmluZWQgaW4gYG9ubG9hZGBcblx0YWN0aXZlTWFya2Rvd25JbnB1dEZpZWxkczogSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGRbXTtcblx0Ly8gQHRzLWlnbm9yZSBkZWZpbmVkIGluIGBvbmxvYWRgXG5cdG1hcmtEb3duSW5wdXRGaWVsZEluZGV4OiBudW1iZXI7XG5cblx0ZnJvbnRNYXR0ZXJSZXhFeHBQYXR0ZXJuID0gJ14oLS0tKVxcXFxuW1xcXFxzXFxcXFNdKj9cXFxcbi0tLSc7XG5cblx0YXN5bmMgb25sb2FkKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cblx0XHRMb2dnZXIuZGV2TW9kZSA9IHRoaXMuc2V0dGluZ3MuZGV2TW9kZTtcblx0XHREYXRlUGFyc2VyLmRhdGVGb3JtYXQgPSB0aGlzLnNldHRpbmdzLnByZWZlcnJlZERhdGVGb3JtYXQ7XG5cdFx0SW5wdXRGaWVsZERlY2xhcmF0aW9uUGFyc2VyLnBhcnNlVGVtcGxhdGVzKHRoaXMuc2V0dGluZ3MuaW5wdXRUZW1wbGF0ZXMpO1xuXG5cdFx0dGhpcy5hY3RpdmVNYXJrZG93bklucHV0RmllbGRzID0gW107XG5cdFx0dGhpcy5tYXJrRG93bklucHV0RmllbGRJbmRleCA9IDA7XG5cblx0XHR0aGlzLnJlZ2lzdGVyTWFya2Rvd25Qb3N0UHJvY2Vzc29yKChlbGVtZW50LCBjb250ZXh0KSA9PiB7XG5cdFx0XHRjb25zdCBjb2RlQmxvY2tzID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCdjb2RlJyk7XG5cdFx0XHRmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgY29kZUJsb2Nrcy5sZW5ndGg7IGluZGV4KyspIHtcblx0XHRcdFx0Y29uc3QgY29kZUJsb2NrID0gY29kZUJsb2Nrcy5pdGVtKGluZGV4KTtcblx0XHRcdFx0Y29uc3QgdGV4dCA9IGNvZGVCbG9jay5pbm5lclRleHQ7XG5cdFx0XHRcdGNvbnN0IGlzSW5wdXRGaWVsZCA9IHRleHQuc3RhcnRzV2l0aCgnSU5QVVRbJykgJiYgdGV4dC5lbmRzV2l0aCgnXScpO1xuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhjb250ZXh0LnNvdXJjZVBhdGgpO1xuXHRcdFx0XHRpZiAoaXNJbnB1dEZpZWxkKSB7XG5cdFx0XHRcdFx0Y29udGV4dC5hZGRDaGlsZChuZXcgSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQoXG5cdFx0XHRcdFx0XHRjb2RlQmxvY2ssXG5cdFx0XHRcdFx0XHRJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZFR5cGUuSU5MSU5FX0NPREVfQkxPQ0ssXG5cdFx0XHRcdFx0XHR0ZXh0LFxuXHRcdFx0XHRcdFx0dGhpcyxcblx0XHRcdFx0XHRcdGNvbnRleHQuc291cmNlUGF0aCxcblx0XHRcdFx0XHRcdHRoaXMubWFya0Rvd25JbnB1dEZpZWxkSW5kZXgsXG5cdFx0XHRcdFx0KSk7XG5cdFx0XHRcdFx0dGhpcy5tYXJrRG93bklucHV0RmllbGRJbmRleCArPSAxO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHR0aGlzLnJlZ2lzdGVyTWFya2Rvd25Db2RlQmxvY2tQcm9jZXNzb3IoJ21ldGEtYmluZCcsIChzb3VyY2UsIGVsLCBjdHgpID0+IHtcblx0XHRcdGNvbnN0IGNvZGVCbG9jayA9IGVsO1xuXHRcdFx0Y29uc3QgdGV4dCA9IHNvdXJjZS5yZXBsYWNlKC9cXG4vZywgJycpO1xuXHRcdFx0Y29uc3QgaXNJbnB1dEZpZWxkID0gdGV4dC5zdGFydHNXaXRoKCdJTlBVVFsnKSAmJiB0ZXh0LmVuZHNXaXRoKCddJyk7XG5cdFx0XHQvLyBjb25zb2xlLmxvZyhjb250ZXh0LnNvdXJjZVBhdGgpO1xuXHRcdFx0aWYgKGlzSW5wdXRGaWVsZCkge1xuXHRcdFx0XHRjdHguYWRkQ2hpbGQobmV3IElucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkKFxuXHRcdFx0XHRcdGNvZGVCbG9jayxcblx0XHRcdFx0XHRJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZFR5cGUuQ09ERV9CTE9DSyxcblx0XHRcdFx0XHR0ZXh0LFxuXHRcdFx0XHRcdHRoaXMsXG5cdFx0XHRcdFx0Y3R4LnNvdXJjZVBhdGgsXG5cdFx0XHRcdFx0dGhpcy5tYXJrRG93bklucHV0RmllbGRJbmRleCkpO1xuXHRcdFx0XHR0aGlzLm1hcmtEb3duSW5wdXRGaWVsZEluZGV4ICs9IDE7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAubWV0YWRhdGFDYWNoZS5vbignY2hhbmdlZCcsIGFzeW5jIChmaWxlOiBURmlsZSwgZGF0YTogc3RyaW5nLCBjYWNoZTogQ2FjaGVkTWV0YWRhdGEpID0+IHtcblx0XHRcdGF3YWl0IHRoaXMudXBkYXRlTWFya2Rvd25JbnB1dEZpZWxkc09uTWV0YWRhdGFDYWNoZUNoYW5nZShmaWxlLCBjYWNoZSk7XG5cdFx0fSkpO1xuXG5cblx0XHR0aGlzLmFkZFNldHRpbmdUYWIobmV3IE1ldGFCaW5kU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXHR9XG5cblx0b251bmxvYWQoKTogdm9pZCB7XG5cdFx0Zm9yIChjb25zdCBhY3RpdmVNYXJrZG93bklucHV0RmllbGQgb2YgdGhpcy5hY3RpdmVNYXJrZG93bklucHV0RmllbGRzKSB7XG5cdFx0XHRhY3RpdmVNYXJrZG93bklucHV0RmllbGQudW5sb2FkKCk7XG5cdFx0fVxuXHR9XG5cblx0cmVnaXN0ZXJJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZChpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZDogSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQpOiB2b2lkIHtcblx0XHR0aGlzLmFjdGl2ZU1hcmtkb3duSW5wdXRGaWVsZHMucHVzaChpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCk7XG5cdH1cblxuXHR1bnJlZ2lzdGVySW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQoaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQ6IElucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkKTogdm9pZCB7XG5cdFx0dGhpcy5hY3RpdmVNYXJrZG93bklucHV0RmllbGRzID0gdGhpcy5hY3RpdmVNYXJrZG93bklucHV0RmllbGRzLmZpbHRlcih4ID0+IHgudWlkICE9PSBpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZC51aWQpO1xuXHR9XG5cblx0YXN5bmMgdXBkYXRlTWFya2Rvd25JbnB1dEZpZWxkc09uTWV0YWRhdGFDYWNoZUNoYW5nZShmaWxlOiBURmlsZSwgY2FjaGU6IENhY2hlZE1ldGFkYXRhKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0bGV0IG1ldGFkYXRhOiBhbnkgPSB1bmRlZmluZWQ7XG5cblx0XHRmb3IgKGNvbnN0IGFjdGl2ZU1hcmtkb3duSW5wdXRGaWVsZCBvZiB0aGlzLmFjdGl2ZU1hcmtkb3duSW5wdXRGaWVsZHMpIHtcblx0XHRcdGlmICghYWN0aXZlTWFya2Rvd25JbnB1dEZpZWxkLmlucHV0RmllbGREZWNsYXJhdGlvbj8uaXNCb3VuZCB8fCAhYWN0aXZlTWFya2Rvd25JbnB1dEZpZWxkLmJpbmRUYXJnZXRGaWxlIHx8ICFhY3RpdmVNYXJrZG93bklucHV0RmllbGQuYmluZFRhcmdldE1ldGFkYXRhRmllbGQpIHtcblx0XHRcdFx0Y29udGludWU7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChhY3RpdmVNYXJrZG93bklucHV0RmllbGQuYmluZFRhcmdldEZpbGUucGF0aCA9PT0gZmlsZS5wYXRoKSB7XG5cdFx0XHRcdGlmIChtZXRhZGF0YSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0bWV0YWRhdGEgPSBhd2FpdCB0aGlzLmdldE1ldGFkYXRhRnJvbUZpbGVDYWNoZShjYWNoZS5mcm9udG1hdHRlcik7XG5cdFx0XHRcdH1cblx0XHRcdFx0YWN0aXZlTWFya2Rvd25JbnB1dEZpZWxkLnB1c2hUb0lucHV0RmllbGRWYWx1ZVVwZGF0ZVF1ZXVlKG1ldGFkYXRhW2FjdGl2ZU1hcmtkb3duSW5wdXRGaWVsZC5iaW5kVGFyZ2V0TWV0YWRhdGFGaWVsZF0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGFzeW5jIHVwZGF0ZU1ldGFEYXRhKGtleTogc3RyaW5nLCB2YWx1ZTogYW55LCBmaWxlOiBURmlsZSk6IFByb21pc2U8dm9pZD4ge1xuXHRcdExvZ2dlci5sb2dEZWJ1ZyhgdXBkYXRpbmcgYCwga2V5LCBgOiBgLCB2YWx1ZSwgYCBpbiAnJHtmaWxlLnBhdGh9J2ApO1xuXG5cdFx0aWYgKCFmaWxlKSB7XG5cdFx0XHRjb25zb2xlLmxvZygnbm8gZmlsZScpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGxldCBmaWxlQ29udGVudDogc3RyaW5nID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcblxuXHRcdGNvbnN0IG1ldGFkYXRhOiBhbnkgPSBhd2FpdCB0aGlzLmdldE1ldGFEYXRhRm9yRmlsZUNvbnRlbnQoZmlsZUNvbnRlbnQpO1xuXHRcdC8vIGNvbnNvbGUubG9nKG1ldGFkYXRhKTtcblx0XHRpZiAoIW1ldGFkYXRhKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVnRXhwID0gbmV3IFJlZ0V4cCh0aGlzLmZyb250TWF0dGVyUmV4RXhwUGF0dGVybik7XG5cdFx0ZmlsZUNvbnRlbnQgPSBmaWxlQ29udGVudC5yZXBsYWNlKHJlZ0V4cCwgJycpO1xuXG5cdFx0bWV0YWRhdGFba2V5XSA9IHZhbHVlO1xuXHRcdC8vIGNvbnNvbGUubG9nKG1ldGFkYXRhKTtcblxuXHRcdGZpbGVDb250ZW50ID0gYC0tLVxcbiR7c3RyaW5naWZ5WWFtbChtZXRhZGF0YSl9LS0tYCArIGZpbGVDb250ZW50O1xuXHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBmaWxlQ29udGVudCk7XG5cdH1cblxuXHRnZXRGaWxlc0J5TmFtZShuYW1lOiBzdHJpbmcpOiBURmlsZVtdIHtcblx0XHQvLyBjb25zb2xlLmxvZyhnZXRGaWxlTmFtZShyZW1vdmVGaWxlRW5kaW5nKG5hbWUpKSlcblx0XHRjb25zdCBmaWxlTmFtZUlzUGF0aCA9IGlzUGF0aChuYW1lKTtcblx0XHRjb25zdCBwcm9jZXNzZWRGaWxlTmFtZSA9IGZpbGVOYW1lSXNQYXRoID8gcmVtb3ZlRmlsZUVuZGluZyhuYW1lKSA6IGdldEZpbGVOYW1lKHJlbW92ZUZpbGVFbmRpbmcobmFtZSkpO1xuXG5cdFx0Y29uc3QgYWxsRmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cdFx0Y29uc3QgZmlsZXM6IFRGaWxlW10gPSBbXTtcblx0XHRmb3IgKGNvbnN0IGZpbGUgb2YgYWxsRmlsZXMpIHtcblx0XHRcdC8vIGNvbnNvbGUubG9nKHJlbW92ZUZpbGVFbmRpbmcoZmlsZS5wYXRoKSk7XG5cdFx0XHRpZiAoZmlsZU5hbWVJc1BhdGgpIHtcblx0XHRcdFx0aWYgKHJlbW92ZUZpbGVFbmRpbmcoZmlsZS5wYXRoKSA9PT0gcHJvY2Vzc2VkRmlsZU5hbWUpIHtcblx0XHRcdFx0XHRmaWxlcy5wdXNoKGZpbGUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAoZ2V0RmlsZU5hbWUocmVtb3ZlRmlsZUVuZGluZyhmaWxlLm5hbWUpKSA9PT0gcHJvY2Vzc2VkRmlsZU5hbWUpIHtcblx0XHRcdFx0XHRmaWxlcy5wdXNoKGZpbGUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZpbGVzO1xuXHR9XG5cblx0YXN5bmMgZ2V0TWV0YURhdGFGb3JGaWxlKGZpbGU6IFRGaWxlKTogUHJvbWlzZTxhbnk+IHtcblx0XHRpZiAoIWZpbGUpIHtcblx0XHRcdHJldHVybiB1bmRlZmluZWQ7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZmlsZUNvbnRlbnQ6IHN0cmluZyA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG5cdFx0cmV0dXJuIGF3YWl0IHRoaXMuZ2V0TWV0YURhdGFGb3JGaWxlQ29udGVudChmaWxlQ29udGVudCk7XG5cdH1cblxuXHRhc3luYyBnZXRNZXRhRGF0YUZvckZpbGVDb250ZW50KGZpbGVDb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuXHRcdC8vIExvZ2dlci5sb2dEZWJ1ZyhgcmVhZGluZyBtZXRhZGF0YWApO1xuXHRcdGxldCBtZXRhZGF0YTogYW55O1xuXG5cdFx0Y29uc3QgcmVnRXhwID0gbmV3IFJlZ0V4cCh0aGlzLmZyb250TWF0dGVyUmV4RXhwUGF0dGVybik7XG5cdFx0Y29uc3QgZnJvbnRNYXR0ZXJSZWdFeHBSZXN1bHQgPSByZWdFeHAuZXhlYyhmaWxlQ29udGVudCk7XG5cdFx0Ly8gY29uc29sZS5sb2coJ3JlZ2V4cmVzOiAnLCBmcm9udE1hdHRlclJlZ0V4cFJlc3VsdCk7XG5cdFx0aWYgKCFmcm9udE1hdHRlclJlZ0V4cFJlc3VsdCkge1xuXHRcdFx0cmV0dXJuIHt9O1xuXHRcdH1cblx0XHRsZXQgZnJvbnRNYXR0ZXIgPSBmcm9udE1hdHRlclJlZ0V4cFJlc3VsdFswXTtcblx0XHRpZiAoIWZyb250TWF0dGVyKSB7XG5cdFx0XHRyZXR1cm4ge307XG5cdFx0fVxuXHRcdC8vIGNvbnNvbGUubG9nKGZyb250TWF0dGVyKTtcblx0XHRmcm9udE1hdHRlciA9IGZyb250TWF0dGVyLnN1YnN0cmluZyg0KTtcblx0XHRmcm9udE1hdHRlciA9IGZyb250TWF0dGVyLnN1YnN0cmluZygwLCBmcm9udE1hdHRlci5sZW5ndGggLSAzKTtcblx0XHQvLyBjb25zb2xlLmxvZyhmcm9udE1hdHRlcik7XG5cblx0XHRtZXRhZGF0YSA9IHBhcnNlWWFtbChmcm9udE1hdHRlcik7XG5cblx0XHRpZiAoIW1ldGFkYXRhKSB7XG5cdFx0XHRtZXRhZGF0YSA9IHt9O1xuXHRcdH1cblxuXHRcdC8vIGNvbnNvbGUubG9nKCdtZXRhZGF0YTogJywgbWV0YWRhdGEpO1xuXG5cdFx0cmV0dXJuIG1ldGFkYXRhO1xuXHR9XG5cblx0Z2V0TWV0YWRhdGFGcm9tRmlsZUNhY2hlKGNhY2hlOiBGcm9udE1hdHRlckNhY2hlIHwgdW5kZWZpbmVkKSB7XG5cdFx0bGV0IG1ldGFkYXRhID0gY2FjaGUgYXMgb2JqZWN0O1xuXG5cdFx0aWYgKG1ldGFkYXRhKSB7XG5cdFx0XHRtZXRhZGF0YSA9IE9iamVjdC5hc3NpZ24oe30sIG1ldGFkYXRhKTsgLy8gY29weVxuXHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0ZGVsZXRlIG1ldGFkYXRhLnBvc2l0aW9uO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRtZXRhZGF0YSA9IHt9O1xuXHRcdH1cblx0XHRyZXR1cm4gbWV0YWRhdGE7XG5cdH1cblxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG5cdH1cblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0RGF0ZVBhcnNlci5kYXRlRm9ybWF0ID0gdGhpcy5zZXR0aW5ncy5wcmVmZXJyZWREYXRlRm9ybWF0O1xuXHRcdExvZ2dlci5kZXZNb2RlID0gdGhpcy5zZXR0aW5ncy5kZXZNb2RlO1xuXHRcdElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlci5wYXJzZVRlbXBsYXRlcyh0aGlzLnNldHRpbmdzLmlucHV0VGVtcGxhdGVzKTtcblx0XHRhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuXHR9XG59XG4iLCAiaW1wb3J0IHtBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIFRleHRBcmVhQ29tcG9uZW50fSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCBNZXRhQmluZFBsdWdpbiBmcm9tICcuLi9tYWluJztcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgTWV0YUJpbmRQbHVnaW5TZXR0aW5ncyB7XHJcblx0ZGV2TW9kZTogYm9vbGVhbjtcclxuXHRwcmVmZXJyZWREYXRlRm9ybWF0OiBzdHJpbmc7XHJcblx0dXNlVXNEYXRlSW5wdXRPcmRlcjogYm9vbGVhbjtcclxuXHRzeW5jSW50ZXJ2YWw6IG51bWJlcjtcclxuXHRtYXhTeW5jSW50ZXJ2YWw6IG51bWJlcjtcclxuXHRtaW5TeW5jSW50ZXJ2YWw6IG51bWJlcjtcclxuXHJcblx0aW5wdXRUZW1wbGF0ZXM6IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IE1ldGFCaW5kUGx1Z2luU2V0dGluZ3MgPSB7XHJcblx0ZGV2TW9kZTogZmFsc2UsXHJcblx0cHJlZmVycmVkRGF0ZUZvcm1hdDogJ1lZWVktTU0tREQnLFxyXG5cdHVzZVVzRGF0ZUlucHV0T3JkZXI6IGZhbHNlLFxyXG5cdHN5bmNJbnRlcnZhbDogMjAwLFxyXG5cdG1pblN5bmNJbnRlcnZhbDogNTAsXHJcblx0bWF4U3luY0ludGVydmFsOiAxMDAwLFxyXG5cclxuXHRpbnB1dFRlbXBsYXRlczogJycsXHJcbn07XHJcblxyXG5leHBvcnQgY2xhc3MgTWV0YUJpbmRTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcblx0cGx1Z2luOiBNZXRhQmluZFBsdWdpbjtcclxuXHJcblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogTWV0YUJpbmRQbHVnaW4pIHtcclxuXHRcdHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG5cdH1cclxuXHJcblx0ZGlzcGxheSgpOiB2b2lkIHtcclxuXHRcdGNvbnN0IHtjb250YWluZXJFbH0gPSB0aGlzO1xyXG5cclxuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcblxyXG5cdFx0Y29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywge3RleHQ6ICdNZXRhIEJpbmQgUGx1Z2luIFNldHRpbmdzJ30pO1xyXG5cclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0XHQuc2V0TmFtZSgnU3luYyBpbnRlcnZhbCcpXHJcblx0XHRcdC5zZXREZXNjKGBUaGUgaW50ZXJ2YWwgaW4gbWlsbGktc2Vjb25kcyBiZXR3ZWVuIGRpc2sgd3JpdGVzLiBDaGFuZ2luZyB0aGlzIG51bWJlciBpcyBub3QgcmVjb21tZW5kZWQgZXhjZXB0IGlmIHlvdXIgaGFyZCBkcml2ZSBpcyBleGNlcHRpb25hbGx5IHNsb3cuIFN0YW5kYXJkOiAke0RFRkFVTFRfU0VUVElOR1Muc3luY0ludGVydmFsfTsgTWluaW11bTogJHtERUZBVUxUX1NFVFRJTkdTLm1pblN5bmNJbnRlcnZhbH07IE1heGltdW06ICR7REVGQVVMVF9TRVRUSU5HUy5tYXhTeW5jSW50ZXJ2YWx9YClcclxuXHRcdFx0LmFkZFRleHQoY2IgPT4ge1xyXG5cdFx0XHRcdGNiLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnN5bmNJbnRlcnZhbC50b1N0cmluZygpKTtcclxuXHRcdFx0XHRjYi5vbkNoYW5nZShkYXRhID0+IHtcclxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnN5bmNJbnRlcnZhbCA9IE51bWJlci5wYXJzZUludChkYXRhKTtcclxuXHRcdFx0XHRcdGlmIChOdW1iZXIuaXNOYU4odGhpcy5wbHVnaW4uc2V0dGluZ3Muc3luY0ludGVydmFsKSkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5zeW5jSW50ZXJ2YWwgPSBERUZBVUxUX1NFVFRJTkdTLnN5bmNJbnRlcnZhbDtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zeW5jSW50ZXJ2YWwgPCBERUZBVUxUX1NFVFRJTkdTLm1pblN5bmNJbnRlcnZhbCkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5zeW5jSW50ZXJ2YWwgPSBERUZBVUxUX1NFVFRJTkdTLm1pblN5bmNJbnRlcnZhbDtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zeW5jSW50ZXJ2YWwgPiBERUZBVUxUX1NFVFRJTkdTLm1heFN5bmNJbnRlcnZhbCkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5zeW5jSW50ZXJ2YWwgPSBERUZBVUxUX1NFVFRJTkdTLm1heFN5bmNJbnRlcnZhbDtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuXHRcdFx0LnNldE5hbWUoJ0RhdGUgZm9ybWF0JylcclxuXHRcdFx0LnNldERlc2MoYFRoZSBkYXRlIGZvcm1hdCB0byBiZSB1c2VkIGJ5IHRoaXMgcGx1Z2luLiBDaGFuZ2luZyB0aGlzIHNldHRpbmcgd2lsbCBicmVhayB0aGUgcGFyc2luZyBvZiBleGlzdGluZyBkYXRlIGlucHV0cy4gSGVyZSBpcyBhIGxpc3Qgb2YgYWxsIGF2YWlsYWJsZSBkYXRlIHRva2VzIGh0dHBzOi8vbW9tZW50anMuY29tL2RvY3MvIy9kaXNwbGF5aW5nLy5gKVxyXG5cdFx0XHQuYWRkVGV4dChjYiA9PiB7XHJcblx0XHRcdFx0Y2Iuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucHJlZmVycmVkRGF0ZUZvcm1hdCk7XHJcblx0XHRcdFx0Y2Iub25DaGFuZ2UoZGF0YSA9PiB7XHJcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcmVmZXJyZWREYXRlRm9ybWF0ID0gZGF0YTtcclxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuXHRcdFx0LnNldE5hbWUoJ1VzZSBVUyBkYXRlIGlucHV0IGZpZWxkIG9yZGVyJylcclxuXHRcdFx0LnNldERlc2MoYFdoZW4gZW5hYmxlZCB0aGUgbW9udGggaW5wdXQgaXMgYmVmb3JlIHRoZSBkYXkgaW5wdXQuYClcclxuXHRcdFx0LmFkZFRvZ2dsZShjYiA9PiB7XHJcblx0XHRcdFx0Y2Iuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlVXNEYXRlSW5wdXRPcmRlcik7XHJcblx0XHRcdFx0Y2Iub25DaGFuZ2UoZGF0YSA9PiB7XHJcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy51c2VVc0RhdGVJbnB1dE9yZGVyID0gZGF0YTtcclxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuXHRcdFx0LnNldE5hbWUoJ1RlbXBsYXRlcycpXHJcblx0XHRcdC5zZXREZXNjKGBZb3UgY2FuIHNwZWNpZnkgdGVtcGxhdGVzIGhlcmUsIGFuZCBhY2Nlc3MgdGhlbSB1c2luZyBcXGBURU1QTEFURV9JTlBVVFsuLi5dXFxgIGluIHlvdXIgbm90ZXMuYCk7XHJcblxyXG5cdFx0Y29uc3QgdGEgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQoY29udGFpbmVyRWwpO1xyXG5cdFx0dGEuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5wdXRUZW1wbGF0ZXMpO1xyXG5cdFx0dGEuc2V0UGxhY2Vob2xkZXIoJ3RlbXBsYXRlX25hbWUgLT4gSU5QVVRbaW5wdXRfdHlwZShhcmd1bWVudCh2YWx1ZSkpOmJpbmRfdGFyZ2V0XScpO1xyXG5cdFx0dGEuaW5wdXRFbC5zdHlsZS53aWR0aCA9ICcxMDAlJztcclxuXHRcdHRhLmlucHV0RWwuc3R5bGUuaGVpZ2h0ID0gJzIwMHB4JztcclxuXHRcdHRhLm9uQ2hhbmdlKGRhdGEgPT4ge1xyXG5cdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbnB1dFRlbXBsYXRlcyA9IGRhdGE7XHJcblx0XHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0fSk7XHJcblxyXG5cclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0XHQuc2V0TmFtZSgnRGV2IE1vZGUnKVxyXG5cdFx0XHQuc2V0RGVzYygnRW5hYmxlIGRldiBtb2RlLiBOb3QgcmVjb21tZW5kZWQgdW5sZXNzIHlvdSB3YW50IHRvIGRlYnVnIHRoaXMgcGx1Z2luLicpXHJcblx0XHRcdC5hZGRUb2dnbGUoY2IgPT4ge1xyXG5cdFx0XHRcdGNiLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRldk1vZGUpO1xyXG5cdFx0XHRcdGNiLm9uQ2hhbmdlKGRhdGEgPT4ge1xyXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZGV2TW9kZSA9IGRhdGE7XHJcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSk7XHJcblx0fVxyXG59XHJcbiIsICJpbXBvcnQge01hcmtkb3duUmVuZGVyQ2hpbGQsIFRGaWxlfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTWV0YUJpbmRQbHVnaW4gZnJvbSAnLi9tYWluJztcbmltcG9ydCB7TG9nZ2VyfSBmcm9tICcuL3V0aWxzL0xvZ2dlcic7XG5pbXBvcnQge0Fic3RyYWN0SW5wdXRGaWVsZH0gZnJvbSAnLi9pbnB1dEZpZWxkcy9BYnN0cmFjdElucHV0RmllbGQnO1xuaW1wb3J0IHtJbnB1dEZpZWxkRmFjdG9yeX0gZnJvbSAnLi9pbnB1dEZpZWxkcy9JbnB1dEZpZWxkRmFjdG9yeSc7XG5pbXBvcnQge1xuXHRJbnB1dEZpZWxkQXJndW1lbnRUeXBlLFxuXHRJbnB1dEZpZWxkRGVjbGFyYXRpb24sXG5cdElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlclxufSBmcm9tICcuL3BhcnNlcnMvSW5wdXRGaWVsZERlY2xhcmF0aW9uUGFyc2VyJztcbmltcG9ydCB7TWV0YUJpbmRCaW5kVGFyZ2V0RXJyb3IsIE1ldGFCaW5kSW50ZXJuYWxFcnJvcn0gZnJvbSAnLi91dGlscy9VdGlscyc7XG5pbXBvcnQge0Fic3RyYWN0SW5wdXRGaWVsZEFyZ3VtZW50fSBmcm9tIFwiLi9pbnB1dEZpZWxkQXJndW1lbnRzL0Fic3RyYWN0SW5wdXRGaWVsZEFyZ3VtZW50XCI7XG5pbXBvcnQge0NsYXNzSW5wdXRGaWVsZEFyZ3VtZW50fSBmcm9tIFwiLi9pbnB1dEZpZWxkQXJndW1lbnRzL0NsYXNzSW5wdXRGaWVsZEFyZ3VtZW50XCI7XG5cbmV4cG9ydCBlbnVtIElucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkVHlwZSB7XG5cdElOTElORV9DT0RFX0JMT0NLLFxuXHRDT0RFX0JMT0NLLFxufVxuXG5leHBvcnQgY2xhc3MgSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQgZXh0ZW5kcyBNYXJrZG93blJlbmRlckNoaWxkIHtcblx0cGx1Z2luOiBNZXRhQmluZFBsdWdpbjtcblx0bWV0YURhdGE6IGFueTtcblx0ZmlsZVBhdGg6IHN0cmluZztcblx0dWlkOiBudW1iZXI7XG5cdGlucHV0RmllbGQ6IEFic3RyYWN0SW5wdXRGaWVsZCB8IHVuZGVmaW5lZDtcblx0ZXJyb3I6IHN0cmluZztcblx0dHlwZTogSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGRUeXBlO1xuXG5cdGZ1bGxEZWNsYXJhdGlvbjogc3RyaW5nO1xuXHRpbnB1dEZpZWxkRGVjbGFyYXRpb246IElucHV0RmllbGREZWNsYXJhdGlvbiB8IHVuZGVmaW5lZDtcblx0YmluZFRhcmdldEZpbGU6IFRGaWxlIHwgdW5kZWZpbmVkO1xuXHRiaW5kVGFyZ2V0TWV0YWRhdGFGaWVsZDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG5cdGxpbWl0SW50ZXJ2YWw6IG51bWJlciB8IHVuZGVmaW5lZDtcblx0aW50ZXJ2YWxDb3VudGVyOiBudW1iZXI7XG5cdG1ldGFkYXRhVmFsdWVVcGRhdGVRdWV1ZTogYW55W107XG5cdGlucHV0RmllbGRWYWx1ZVVwZGF0ZVF1ZXVlOiBhbnlbXTtcblxuXHRjb25zdHJ1Y3Rvcihjb250YWluZXJFbDogSFRNTEVsZW1lbnQsIHR5cGU6IElucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkVHlwZSwgZnVsbERlY2xhcmF0aW9uOiBzdHJpbmcsIHBsdWdpbjogTWV0YUJpbmRQbHVnaW4sIGZpbGVQYXRoOiBzdHJpbmcsIHVpZDogbnVtYmVyKSB7XG5cdFx0c3VwZXIoY29udGFpbmVyRWwpO1xuXG5cdFx0dGhpcy5lcnJvciA9ICcnO1xuXHRcdHRoaXMuZmlsZVBhdGggPSBmaWxlUGF0aDtcblx0XHR0aGlzLnVpZCA9IHVpZDtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0XHR0aGlzLnR5cGUgPSB0eXBlO1xuXHRcdHRoaXMuZnVsbERlY2xhcmF0aW9uID0gZnVsbERlY2xhcmF0aW9uO1xuXG5cdFx0dGhpcy5tZXRhZGF0YVZhbHVlVXBkYXRlUXVldWUgPSBbXTtcblx0XHR0aGlzLmlucHV0RmllbGRWYWx1ZVVwZGF0ZVF1ZXVlID0gW107XG5cdFx0dGhpcy5pbnRlcnZhbENvdW50ZXIgPSAwO1xuXG5cdFx0dHJ5IHtcblx0XHRcdHRoaXMuaW5wdXRGaWVsZERlY2xhcmF0aW9uID0gSW5wdXRGaWVsZERlY2xhcmF0aW9uUGFyc2VyLnBhcnNlKGZ1bGxEZWNsYXJhdGlvbik7XG5cblx0XHRcdGlmICh0aGlzLmlucHV0RmllbGREZWNsYXJhdGlvbi5pc0JvdW5kKSB7XG5cdFx0XHRcdHRoaXMucGFyc2VCaW5kVGFyZ2V0KCk7XG5cdFx0XHRcdC8vIEB0cy1pZ25vcmUgYHBhcnNlQmluZFRhcmdldGAgc2V0cyBgYmluZFRhcmdldEZpbGVgIGFuZCBgYmluZFRhcmdldE1ldGFkYXRhRmllbGRgIG9yIHRocm93cyBhbiBlcnJvci5cblx0XHRcdFx0dGhpcy5tZXRhRGF0YSA9IHRoaXMucGx1Z2luLmdldE1ldGFEYXRhRm9yRmlsZSh0aGlzLmJpbmRUYXJnZXRGaWxlKTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5pbnB1dEZpZWxkID0gSW5wdXRGaWVsZEZhY3RvcnkuY3JlYXRlSW5wdXRGaWVsZCh0aGlzLmlucHV0RmllbGREZWNsYXJhdGlvbi5pbnB1dEZpZWxkVHlwZSwge1xuXHRcdFx0XHR0eXBlOiB0eXBlLFxuXHRcdFx0XHRpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZDogdGhpcyxcblx0XHRcdFx0b25WYWx1ZUNoYW5nZWQ6IHRoaXMucHVzaFRvTWV0YWRhdGFWYWx1ZVVwZGF0ZVF1ZXVlLmJpbmQodGhpcyksXG5cdFx0XHR9KTtcblxuXHRcdFx0dGhpcy5saW1pdEludGVydmFsID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHRoaXMuYXBwbHlWYWx1ZVVwZGF0ZVF1ZXVlcygpLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zeW5jSW50ZXJ2YWwpO1xuXHRcdH0gY2F0Y2ggKGU6IGFueSkge1xuXHRcdFx0dGhpcy5lcnJvciA9IGUubWVzc2FnZTtcblx0XHRcdGNvbnNvbGUud2FybihlKTtcblx0XHR9XG5cdH1cblxuXHRwYXJzZUJpbmRUYXJnZXQoKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLmlucHV0RmllbGREZWNsYXJhdGlvbikge1xuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcignaW5wdXRGaWVsZERlY2xhcmF0aW9uIGlzIHVuZGVmaW5lZCwgY2FuIG5vdCBwYXJzZSBiaW5kIHRhcmdldCcpO1xuXHRcdH1cblxuXHRcdGNvbnN0IGJpbmRUYXJnZXRQYXJ0cyA9IHRoaXMuaW5wdXRGaWVsZERlY2xhcmF0aW9uLmJpbmRUYXJnZXQuc3BsaXQoJyMnKTtcblxuXHRcdGlmIChiaW5kVGFyZ2V0UGFydHMubGVuZ3RoID09PSAxKSB7XG5cdFx0XHQvLyB0aGUgYmluZCB0YXJnZXQgaXMgaW4gdGhlIHNhbWUgZmlsZVxuXHRcdFx0dGhpcy5iaW5kVGFyZ2V0TWV0YWRhdGFGaWVsZCA9IHRoaXMuaW5wdXRGaWVsZERlY2xhcmF0aW9uLmJpbmRUYXJnZXQ7XG5cblx0XHRcdGNvbnN0IGZpbGVzOiBURmlsZVtdID0gdGhpcy5wbHVnaW4uZ2V0RmlsZXNCeU5hbWUodGhpcy5maWxlUGF0aCk7XG5cdFx0XHRpZiAoZmlsZXMubGVuZ3RoID09PSAwKSB7XG5cdFx0XHRcdHRocm93IG5ldyBNZXRhQmluZEJpbmRUYXJnZXRFcnJvcignYmluZCB0YXJnZXQgZmlsZSBub3QgZm91bmQnKTtcblx0XHRcdH0gZWxzZSBpZiAoZmlsZXMubGVuZ3RoID09PSAxKSB7XG5cdFx0XHRcdHRoaXMuYmluZFRhcmdldEZpbGUgPSBmaWxlc1swXTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRocm93IG5ldyBNZXRhQmluZEJpbmRUYXJnZXRFcnJvcignYmluZCB0YXJnZXQgcmVzb2x2ZXMgdG8gbXVsdGlwbGUgZmlsZXMsIHBsZWFzZSBhbHNvIHNwZWNpZnkgdGhlIGZpbGUgcGF0aCcpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAoYmluZFRhcmdldFBhcnRzLmxlbmd0aCA9PT0gMikge1xuXHRcdFx0Ly8gdGhlIGJpbmQgdGFyZ2V0IGlzIGluIGFub3RoZXIgZmlsZVxuXHRcdFx0dGhpcy5iaW5kVGFyZ2V0TWV0YWRhdGFGaWVsZCA9IGJpbmRUYXJnZXRQYXJ0c1sxXTtcblxuXHRcdFx0Y29uc3QgZmlsZXM6IFRGaWxlW10gPSB0aGlzLnBsdWdpbi5nZXRGaWxlc0J5TmFtZShiaW5kVGFyZ2V0UGFydHNbMF0pO1xuXHRcdFx0aWYgKGZpbGVzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRCaW5kVGFyZ2V0RXJyb3IoJ2JpbmQgdGFyZ2V0IGZpbGUgbm90IGZvdW5kJyk7XG5cdFx0XHR9IGVsc2UgaWYgKGZpbGVzLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0XHR0aGlzLmJpbmRUYXJnZXRGaWxlID0gZmlsZXNbMF07XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRCaW5kVGFyZ2V0RXJyb3IoJ2JpbmQgdGFyZ2V0IHJlc29sdmVzIHRvIG11bHRpcGxlIGZpbGVzLCBwbGVhc2UgYWxzbyBzcGVjaWZ5IHRoZSBmaWxlIHBhdGgnKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kQmluZFRhcmdldEVycm9yKCdiaW5kIHRhcmdldCBtYXkgb25seSBjb250YWluIG9uZSBcXCcjXFwnIHRvIHNwZWNpZnkgdGhlIG1ldGFkYXRhIGZpZWxkJyk7XG5cdFx0fVxuXHR9XG5cblx0Ly8gdXNlIHRoaXMgaW50ZXJ2YWwgdG8gcmVkdWNlIHdyaXRpbmcgb3BlcmF0aW9uc1xuXHRhc3luYyBhcHBseVZhbHVlVXBkYXRlUXVldWVzKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGlmICh0aGlzLm1ldGFkYXRhVmFsdWVVcGRhdGVRdWV1ZS5sZW5ndGggIT09IDApIHtcblx0XHRcdGF3YWl0IHRoaXMuYXBwbHlNZXRhZGF0YVZhbHVlVXBkYXRlUXVldWUoKTtcblx0XHRcdHRoaXMuY2xlYW5VcFVwZGF0ZVF1ZXVlcygpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGlmICh0aGlzLmlucHV0RmllbGRWYWx1ZVVwZGF0ZVF1ZXVlLmxlbmd0aCAhPT0gMCkge1xuXHRcdFx0YXdhaXQgdGhpcy5hcHBseUlucHV0RmllbGRWYWx1ZVVwZGF0ZVF1ZXVlKCk7XG5cdFx0XHR0aGlzLmNsZWFuVXBVcGRhdGVRdWV1ZXMoKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdH1cblxuXHRhc3luYyBhcHBseU1ldGFkYXRhVmFsdWVVcGRhdGVRdWV1ZSgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAoIXRoaXMuaW5wdXRGaWVsZERlY2xhcmF0aW9uKSB7XG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCdpbnB1dEZpZWxkRGVjbGFyYXRpb24gaXMgdW5kZWZpbmVkLCBjYW4gbm90IHVwZGF0ZSBtZXRhZGF0YScpO1xuXHRcdH1cblx0XHRpZiAoIXRoaXMuaW5wdXRGaWVsZERlY2xhcmF0aW9uLmlzQm91bmQpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0aWYgKCF0aGlzLmJpbmRUYXJnZXRNZXRhZGF0YUZpZWxkIHx8ICF0aGlzLmJpbmRUYXJnZXRGaWxlKSB7XG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCdiaW5kVGFyZ2V0TWV0YWRhdGFGaWVsZCBvciBiaW5kVGFyZ2V0RmlsZSBpcyB1bmRlZmluZWQsIGNhbiBub3QgdXBkYXRlIG1ldGFkYXRhJyk7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMubWV0YWRhdGFWYWx1ZVVwZGF0ZVF1ZXVlLmxlbmd0aCA+IDApIHtcblx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnVwZGF0ZU1ldGFEYXRhKHRoaXMuYmluZFRhcmdldE1ldGFkYXRhRmllbGQsIHRoaXMubWV0YWRhdGFWYWx1ZVVwZGF0ZVF1ZXVlLmF0KC0xKSwgdGhpcy5iaW5kVGFyZ2V0RmlsZSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoYGNhbm5vdCBhcHBseSBtZXRhZGF0YVZhbHVlVXBkYXRlUXVldWUgdG8gaW5wdXRGaWVsZCAke3RoaXMudWlkfSwgbWV0YWRhdGFWYWx1ZVVwZGF0ZVF1ZXVlIGlzIGVtcHR5YCk7XG5cdFx0fVxuXHR9XG5cblx0YXN5bmMgYXBwbHlJbnB1dEZpZWxkVmFsdWVVcGRhdGVRdWV1ZSgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAoIXRoaXMuaW5wdXRGaWVsZERlY2xhcmF0aW9uKSB7XG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCdpbnB1dEZpZWxkRGVjbGFyYXRpb24gaXMgdW5kZWZpbmVkLCBjYW4gbm90IHVwZGF0ZSBpbnB1dEZpZWxkJyk7XG5cdFx0fVxuXHRcdGlmICghdGhpcy5pbnB1dEZpZWxkKSB7XG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCdpbnB1dEZpZWxkIGlzIHVuZGVmaW5lZCwgY2FuIG5vdCB1cGRhdGUgaW5wdXRGaWVsZCcpO1xuXHRcdH1cblxuXHRcdGlmICh0aGlzLmlucHV0RmllbGRWYWx1ZVVwZGF0ZVF1ZXVlLmxlbmd0aCA+IDApIHtcblx0XHRcdGxldCB2YWx1ZSA9IHRoaXMuaW5wdXRGaWVsZFZhbHVlVXBkYXRlUXVldWUuYXQoLTEpO1xuXG5cdFx0XHRpZiAodmFsdWUgPT0gbnVsbCkge1xuXHRcdFx0XHR2YWx1ZSA9IHRoaXMuaW5wdXRGaWVsZC5nZXREZWZhdWx0VmFsdWUoKTtcblx0XHRcdH1cblxuXHRcdFx0TG9nZ2VyLmxvZ0RlYnVnKGB1cGRhdGluZyBpbnB1dCBmaWVsZCAke3RoaXMudWlkfSB0b2AsIHZhbHVlKTtcblx0XHRcdHRoaXMuaW5wdXRGaWVsZC5zZXRWYWx1ZSh2YWx1ZSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoYGNhbm5vdCBhcHBseSBpbnB1dEZpZWxkVmFsdWVVcGRhdGVRdWV1ZSB0byBpbnB1dEZpZWxkICR7dGhpcy51aWR9LCBpbnB1dEZpZWxkVmFsdWVVcGRhdGVRdWV1ZSBpcyBlbXB0eWApO1xuXHRcdH1cblx0fVxuXG5cdGNsZWFuVXBVcGRhdGVRdWV1ZXMoKTogdm9pZCB7XG5cdFx0dGhpcy5tZXRhZGF0YVZhbHVlVXBkYXRlUXVldWUgPSBbXTtcblx0XHR0aGlzLmlucHV0RmllbGRWYWx1ZVVwZGF0ZVF1ZXVlID0gW107XG5cdH1cblxuXHRwdXNoVG9NZXRhZGF0YVZhbHVlVXBkYXRlUXVldWUodmFsdWU6IGFueSk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmlucHV0RmllbGREZWNsYXJhdGlvbj8uaXNCb3VuZCkge1xuXHRcdFx0dGhpcy5tZXRhZGF0YVZhbHVlVXBkYXRlUXVldWUucHVzaCh2YWx1ZSk7XG5cdFx0fVxuXHR9XG5cblx0cHVzaFRvSW5wdXRGaWVsZFZhbHVlVXBkYXRlUXVldWUodmFsdWU6IGFueSk6IHZvaWQge1xuXHRcdGlmICghdGhpcy5pbnB1dEZpZWxkPy5pc0VxdWFsVmFsdWUodmFsdWUpKSB7XG5cdFx0XHR0aGlzLmlucHV0RmllbGRWYWx1ZVVwZGF0ZVF1ZXVlLnB1c2godmFsdWUpO1xuXHRcdH1cblx0fVxuXG5cdGdldEluaXRpYWxWYWx1ZSgpOiBhbnkgfCB1bmRlZmluZWQge1xuXHRcdGlmICh0aGlzLmlucHV0RmllbGREZWNsYXJhdGlvbj8uaXNCb3VuZCkge1xuXHRcdFx0cmV0dXJuIHRoaXMubWV0YURhdGFbdGhpcy5iaW5kVGFyZ2V0TWV0YWRhdGFGaWVsZCA/PyAnJ10gPz8gdGhpcy5pbnB1dEZpZWxkPy5nZXREZWZhdWx0VmFsdWUoKTtcblx0XHR9XG5cdH1cblxuXHRnZXRBcmd1bWVudHMobmFtZTogSW5wdXRGaWVsZEFyZ3VtZW50VHlwZSk6IEFic3RyYWN0SW5wdXRGaWVsZEFyZ3VtZW50W10ge1xuXHRcdGlmICghdGhpcy5pbnB1dEZpZWxkRGVjbGFyYXRpb24pIHtcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ2lucHV0RmllbGREZWNsYXJhdGlvbiBpcyB1bmRlZmluZWQsIGNhbiBub3QgcmV0cmlldmUgYXJndW1lbnRzJyk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXMuaW5wdXRGaWVsZERlY2xhcmF0aW9uLmFyZ3VtZW50Q29udGFpbmVyLmFyZ3VtZW50cy5maWx0ZXIoeCA9PiB4LmlkZW50aWZpZXIgPT09IG5hbWUpO1xuXHR9XG5cblx0Z2V0QXJndW1lbnQobmFtZTogSW5wdXRGaWVsZEFyZ3VtZW50VHlwZSk6IEFic3RyYWN0SW5wdXRGaWVsZEFyZ3VtZW50IHwgdW5kZWZpbmVkIHtcblx0XHRyZXR1cm4gdGhpcy5nZXRBcmd1bWVudHMobmFtZSkuYXQoMCk7XG5cdH1cblxuXHRhc3luYyBvbmxvYWQoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0TG9nZ2VyLmxvZ0RlYnVnKCdsb2FkJywgdGhpcyk7XG5cblx0XHR0aGlzLm1ldGFEYXRhID0gYXdhaXQgdGhpcy5tZXRhRGF0YTtcblxuXHRcdGNvbnN0IGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZURpdigpO1xuXHRcdGNvbnRhaW5lci5hZGRDbGFzcygnbWV0YS1iaW5kLXBsdWdpbi1pbnB1dC13cmFwcGVyJyk7XG5cdFx0dGhpcy5jb250YWluZXJFbC5hZGRDbGFzcygnbWV0YS1iaW5kLXBsdWdpbi1pbnB1dCcpO1xuXG5cdFx0aWYgKHRoaXMuZXJyb3IpIHtcblx0XHRcdHRoaXMuY29udGFpbmVyRWwuZW1wdHkoKTtcblx0XHRcdGNvbnN0IG9yaWdpbmFsVGV4dCA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRWwoJ3NwYW4nLCB7dGV4dDogdGhpcy5mdWxsRGVjbGFyYXRpb24sIGNsczogJ21ldGEtYmluZC1jb2RlJ30pO1xuXHRcdFx0Y29udGFpbmVyLmlubmVyVGV4dCA9IGAgLT4gRVJST1I6ICR7dGhpcy5lcnJvcn1gO1xuXHRcdFx0Y29udGFpbmVyLmFkZENsYXNzKCdtZXRhLWJpbmQtcGx1Z2luLWVycm9yJyk7XG5cdFx0XHR0aGlzLmNvbnRhaW5lckVsLmFwcGVuZENoaWxkKGNvbnRhaW5lcik7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKCF0aGlzLmlucHV0RmllbGQpIHtcblx0XHRcdHRoaXMuY29udGFpbmVyRWwuZW1wdHkoKTtcblx0XHRcdGNvbnN0IG9yaWdpbmFsVGV4dCA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRWwoJ3NwYW4nLCB7dGV4dDogdGhpcy5mdWxsRGVjbGFyYXRpb24sIGNsczogJ21ldGEtYmluZC1jb2RlJ30pO1xuXHRcdFx0Y29udGFpbmVyLmlubmVyVGV4dCA9IGAgLT4gRVJST1I6ICR7KG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ2lucHV0IGZpZWxkIGlzIHVuZGVmaW5lZCBhbmQgZXJyb3IgaXMgZW1wdHknKS5tZXNzYWdlKX1gO1xuXHRcdFx0Y29udGFpbmVyLmFkZENsYXNzKCdtZXRhLWJpbmQtcGx1Z2luLWVycm9yJyk7XG5cdFx0XHR0aGlzLmNvbnRhaW5lckVsLmFwcGVuZENoaWxkKGNvbnRhaW5lcik7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCh0aGlzKTtcblxuXHRcdHRoaXMuaW5wdXRGaWVsZC5yZW5kZXIoY29udGFpbmVyKTtcblxuXHRcdGNvbnN0IGNsYXNzQXJndW1lbnRzOiBDbGFzc0lucHV0RmllbGRBcmd1bWVudFtdID0gdGhpcy5nZXRBcmd1bWVudHMoSW5wdXRGaWVsZEFyZ3VtZW50VHlwZS5DTEFTUyk7XG5cdFx0aWYgKGNsYXNzQXJndW1lbnRzKSB7XG5cdFx0XHR0aGlzLmlucHV0RmllbGQuZ2V0SHRtbEVsZW1lbnQoKS5hZGRDbGFzc2VzKGNsYXNzQXJndW1lbnRzLm1hcCh4ID0+IHgudmFsdWUpLmZsYXQoKSk7XG5cdFx0fVxuXG5cblx0XHR0aGlzLmNvbnRhaW5lckVsLmVtcHR5KCk7XG5cdFx0dGhpcy5jb250YWluZXJFbC5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuXHR9XG5cblx0b251bmxvYWQoKTogdm9pZCB7XG5cdFx0TG9nZ2VyLmxvZ0RlYnVnKCd1bmxvYWQnLCB0aGlzKTtcblxuXHRcdHRoaXMucGx1Z2luLnVucmVnaXN0ZXJJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCh0aGlzKTtcblxuXHRcdHN1cGVyLm9udW5sb2FkKCk7XG5cblx0XHQvL2NvbnNvbGUubG9nKCd1bmxvYWQnLCB0aGlzKTtcblx0XHR3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLmxpbWl0SW50ZXJ2YWwpO1xuXHR9XG59XG4iLCAiZXhwb3J0IGNsYXNzIExvZ2dlciB7XHJcblx0c3RhdGljIGRldk1vZGU6IGJvb2xlYW47XHJcblx0c3RhdGljIHByZWZpeDogc3RyaW5nID0gJ21ldGEtYmluZCB8JztcclxuXHJcblx0LyoqXHJcblx0ICogTG9ncyB0byB0aGUgY29uc29sZSB3aXRoIHRoZSBwbHVnaW4gcHJlZml4XHJcblx0ICpcclxuXHQgKiBAcGFyYW0gZGF0YVxyXG5cdCAqL1xyXG5cdHN0YXRpYyBsb2coLi4uZGF0YTogYW55KTogdm9pZCB7XHJcblx0XHRjb25zb2xlLmxvZyh0aGlzLnByZWZpeCwgLi4uZGF0YSk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBMb2dzIHRvIHRoZSBjb25zb2xlIHdpdGggdGhlIHBsdWdpbiBwcmVmaXgsIGlmIGRldiBtb2RlIGlzIHR1cm5lZCBvbiBpbiB0aGUgcGx1Z2luIHNldHRpbmdzXHJcblx0ICpcclxuXHQgKiBAcGFyYW0gZGF0YVxyXG5cdCAqL1xyXG5cdHN0YXRpYyBsb2dEZWJ1ZyguLi5kYXRhOiBhbnkpOiB2b2lkIHtcclxuXHRcdGlmICh0aGlzLmRldk1vZGUpIHtcclxuXHRcdFx0TG9nZ2VyLmxvZyguLi5kYXRhKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIExvZ3MgYSB3YXJuaW5nIHRvIHRoZSBjb25zb2xlIHdpdGggdGhlIHBsdWdpbiBwcmVmaXhcclxuXHQgKlxyXG5cdCAqIEBwYXJhbSBkYXRhXHJcblx0ICovXHJcblx0c3RhdGljIGxvZ1dhcm5pbmcoLi4uZGF0YTogYW55KTogdm9pZCB7XHJcblx0XHRjb25zb2xlLndhcm4odGhpcy5wcmVmaXgsIGRhdGEpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogTG9ncyBhIHdhcm5pbmcgdG8gdGhlIGNvbnNvbGUgd2l0aG91dCB0aGUgcGx1Z2luIHByZWZpeFxyXG5cdCAqXHJcblx0ICogQHBhcmFtIGRhdGFcclxuXHQgKi9cclxuXHRzdGF0aWMgd2FybiguLi5kYXRhOiBhbnkpOiB2b2lkIHtcclxuXHRcdGNvbnNvbGUud2FybihkYXRhKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIExvZ3MgYW4gZXJyb3IgdG8gdGhlIGNvbnNvbGUgd2l0aCB0aGUgcGx1Z2luIHByZWZpeFxyXG5cdCAqXHJcblx0ICogQHBhcmFtIGRhdGFcclxuXHQgKi9cclxuXHRzdGF0aWMgbG9nRXJyb3IoLi4uZGF0YTogYW55KTogdm9pZCB7XHJcblx0XHRjb25zb2xlLmVycm9yKHRoaXMucHJlZml4LCBkYXRhKTtcclxuXHR9XHJcbn1cclxuIiwgImltcG9ydCB7SW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGR9IGZyb20gJy4uL0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkJztcclxuXHJcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdElucHV0RmllbGQge1xyXG5cdHN0YXRpYyBhbGxvd0NvZGVCbG9jazogYm9vbGVhbiA9IHRydWU7XHJcblx0c3RhdGljIGFsbG93SW5saW5lQ29kZUJsb2NrOiBib29sZWFuID0gdHJ1ZTtcclxuXHRpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZDogSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQ7XHJcblx0b25WYWx1ZUNoYW5nZTogKHZhbHVlOiBhbnkpID0+IHZvaWQgfCBQcm9taXNlPHZvaWQ+O1xyXG5cclxuXHRjb25zdHJ1Y3RvcihpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZDogSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQsIG9uVmFsdWVDaGFuZ2U6ICh2YWx1ZTogYW55KSA9PiB2b2lkIHwgUHJvbWlzZTx2b2lkPikge1xyXG5cdFx0dGhpcy5pbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCA9IGlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkO1xyXG5cdFx0dGhpcy5vblZhbHVlQ2hhbmdlID0gb25WYWx1ZUNoYW5nZTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFJldHVybnMgdGhlIGN1cnJlbnQgY29udGVudCBvZiB0aGUgaW5wdXQgZmllbGRcclxuXHQgKi9cclxuXHRhYnN0cmFjdCBnZXRWYWx1ZSgpOiBhbnk7XHJcblxyXG5cdC8qKlxyXG5cdCAqIFNldHMgdGhlIHZhbHVlIG9uIHRoaXMgaW5wdXQgZmllbGQsIG92ZXJyaWRpbmcgdGhlIGN1cnJlbnQgY29udGVudFxyXG5cdCAqXHJcblx0ICogQHBhcmFtIHZhbHVlXHJcblx0ICovXHJcblx0YWJzdHJhY3Qgc2V0VmFsdWUodmFsdWU6IGFueSk6IHZvaWQ7XHJcblxyXG5cdC8qKlxyXG5cdCAqIENoZWNrcyBpZiB0aGUgdmFsdWUgaXMgdGhlIHNhbWUgYXMgdGhlIHZhbHVlIG9mIHRoaXMgaW5wdXQgZmllbGRcclxuXHQgKlxyXG5cdCAqIEBwYXJhbSB2YWx1ZVxyXG5cdCAqL1xyXG5cdGFic3RyYWN0IGlzRXF1YWxWYWx1ZSh2YWx1ZTogYW55KTogYm9vbGVhbjtcclxuXHJcblx0LyoqXHJcblx0ICogUmV0dXJucyB0aGUgZGVmYXVsdCB2YWx1ZSBvZiB0aGlzIGlucHV0IGZpZWxkXHJcblx0ICovXHJcblx0YWJzdHJhY3QgZ2V0RGVmYXVsdFZhbHVlKCk6IGFueTtcclxuXHJcblx0LyoqXHJcblx0ICogUmV0dXJucyB0aGUgSFRNTCBlbGVtZW50IHRoaXMgaW5wdXQgZmllbGQgaXMgd3JhcHBlZCBpblxyXG5cdCAqL1xyXG5cdGFic3RyYWN0IGdldEh0bWxFbGVtZW50KCk6IEhUTUxFbGVtZW50O1xyXG5cclxuXHQvKipcclxuXHQgKiBSZW5kZXJzIHRoZSBpbnB1dCBmaWVsZCBhcyBhIGNoaWxkIG9mIHRoZSBjb250YWluZXJcclxuXHQgKlxyXG5cdCAqIEBwYXJhbSBjb250YWluZXJcclxuXHQgKi9cclxuXHRhYnN0cmFjdCByZW5kZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQ7XHJcbn1cclxuIiwgImltcG9ydCB7QWJzdHJhY3RJbnB1dEZpZWxkfSBmcm9tICcuL0Fic3RyYWN0SW5wdXRGaWVsZCc7XHJcbmltcG9ydCB7VG9nZ2xlQ29tcG9uZW50fSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7TG9nZ2VyfSBmcm9tICcuLi91dGlscy9Mb2dnZXInO1xyXG5pbXBvcnQge01ldGFCaW5kSW50ZXJuYWxFcnJvcn0gZnJvbSAnLi4vdXRpbHMvVXRpbHMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFRvZ2dsZUlucHV0RmllbGQgZXh0ZW5kcyBBYnN0cmFjdElucHV0RmllbGQge1xyXG5cdHRvZ2dsZUNvbXBvbmVudDogVG9nZ2xlQ29tcG9uZW50IHwgdW5kZWZpbmVkO1xyXG5cclxuXHRnZXRWYWx1ZSgpOiBhbnkge1xyXG5cdFx0aWYgKCF0aGlzLnRvZ2dsZUNvbXBvbmVudCkge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCd0b2dnbGUgaW5wdXQgY29tcG9uZW50IGlzIHVuZGVmaW5lZCcpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRoaXMudG9nZ2xlQ29tcG9uZW50LmdldFZhbHVlKCk7XHJcblx0fVxyXG5cclxuXHRzZXRWYWx1ZSh2YWx1ZTogYW55KTogdm9pZCB7XHJcblx0XHRpZiAoIXRoaXMudG9nZ2xlQ29tcG9uZW50KSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ3RvZ2dsZSBpbnB1dCBjb21wb25lbnQgaXMgdW5kZWZpbmVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHZhbHVlICE9IG51bGwgJiYgdHlwZW9mIHZhbHVlID09ICdib29sZWFuJykge1xyXG5cdFx0XHR0aGlzLnRvZ2dsZUNvbXBvbmVudC5zZXRWYWx1ZSh2YWx1ZSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRMb2dnZXIubG9nV2FybmluZyhgY2FuIG5vdCBzZXQgdmFsdWUgb2YgdG9nZ2xlIHRvIFxcJyR7dmFsdWV9XFwnYCk7XHJcblx0XHRcdHRoaXMudG9nZ2xlQ29tcG9uZW50LnNldFZhbHVlKGZhbHNlKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGlzRXF1YWxWYWx1ZSh2YWx1ZTogYW55KTogYm9vbGVhbiB7XHJcblx0XHRyZXR1cm4gdGhpcy5nZXRWYWx1ZSgpID09IHZhbHVlO1xyXG5cdH1cclxuXHJcblx0Z2V0RGVmYXVsdFZhbHVlKCk6IGJvb2xlYW4ge1xyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH1cclxuXHJcblx0Z2V0SHRtbEVsZW1lbnQoKTogSFRNTEVsZW1lbnQge1xyXG5cdFx0aWYgKCF0aGlzLnRvZ2dsZUNvbXBvbmVudCkge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCd0b2dnbGUgaW5wdXQgY29tcG9uZW50IGlzIHVuZGVmaW5lZCcpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzLnRvZ2dsZUNvbXBvbmVudC50b2dnbGVFbDtcclxuXHR9XHJcblxyXG5cdHJlbmRlcihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XHJcblx0XHRjb25zdCBjb21wb25lbnQgPSBuZXcgVG9nZ2xlQ29tcG9uZW50KGNvbnRhaW5lcik7XHJcblx0XHRjb21wb25lbnQuc2V0VmFsdWUodGhpcy5pbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZC5nZXRJbml0aWFsVmFsdWUoKSk7XHJcblx0XHRjb21wb25lbnQub25DaGFuZ2UodGhpcy5vblZhbHVlQ2hhbmdlKTtcclxuXHRcdHRoaXMudG9nZ2xlQ29tcG9uZW50ID0gY29tcG9uZW50O1xyXG5cdH1cclxuXHJcbn1cclxuIiwgImV4cG9ydCBjbGFzcyBNZXRhQmluZEludGVybmFsRXJyb3IgZXh0ZW5kcyBFcnJvciB7XHJcblx0Y29uc3RydWN0b3IobWVzc2FnZTogc3RyaW5nKSB7XHJcblx0XHRzdXBlcihgW01CX0lOVEVSTkFMX0VSUk9SIC0gcGxlYXNlIHJlcG9ydCB0aGlzIGVycm9yIGhlcmUgaHR0cHM6Ly9naXRodWIuY29tL21Qcm9qZWN0c0NvZGUvb2JzaWRpYW4tbWV0YS1iaW5kLXBsdWdpbi9pc3N1ZXNdICR7bWVzc2FnZX1gKTtcclxuXHR9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBNZXRhQmluZFBhcnNpbmdFcnJvciBleHRlbmRzIEVycm9yIHtcclxuXHRjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcpIHtcclxuXHRcdHN1cGVyKGBbTUJfUEFSU0lOR19FUlJPUl0gJHttZXNzYWdlfWApO1xyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIE1ldGFCaW5kQmluZFRhcmdldEVycm9yIGV4dGVuZHMgRXJyb3Ige1xyXG5cdGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZykge1xyXG5cdFx0c3VwZXIoYFtNQl9CSU5EX1RBUkdFVF9FUlJPUl0gJHttZXNzYWdlfWApO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEdldHMgdGhlIGZpbGUgbmFtZSBmcm9tIGEgcGF0aFxyXG4gKlxyXG4gKiBAcGFyYW0gcGF0aFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEZpbGVOYW1lKHBhdGg6IHN0cmluZyk6IHN0cmluZyB7XHJcblx0cmV0dXJuIHBhdGguc3BsaXQoJy8nKS5hdCgtMSkgPz8gcGF0aDtcclxufVxyXG5cclxuLyoqXHJcbiAqIENoZWNrcyBpZiBhIHBhdGggaXMgYSBwYXRoIG9yIGEgZmlsZSBuYW1lXHJcbiAqXHJcbiAqIEBwYXJhbSBwYXRoXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNQYXRoKHBhdGg6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG5cdHJldHVybiBwYXRoLnNwbGl0KCcvJykubGVuZ3RoID4gMTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFJlbW92ZXMgdGhlIGZpbGUgZW5kaW5nIG9mIGEgZmlsZSBuYW1lXHJcbiAqXHJcbiAqIEBwYXJhbSBmaWxlTmFtZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUZpbGVFbmRpbmcoZmlsZU5hbWU6IHN0cmluZyk6IHN0cmluZyB7XHJcblx0Y29uc3QgZmlsZU5hbWVQYXJ0cyA9IGZpbGVOYW1lLnNwbGl0KCcuJyk7XHJcblx0aWYgKGZpbGVOYW1lUGFydHMubGVuZ3RoID09PSAxKSB7XHJcblx0XHRyZXR1cm4gZmlsZU5hbWU7XHJcblx0fSBlbHNlIHtcclxuXHRcdGxldCBuZXdGaWxlTmFtZSA9IGZpbGVOYW1lUGFydHNbMF07XHJcblx0XHRmb3IgKGxldCBpID0gMTsgaSA8IGZpbGVOYW1lUGFydHMubGVuZ3RoIC0gMTsgaSsrKSB7XHJcblx0XHRcdG5ld0ZpbGVOYW1lICs9ICcuJyArIGZpbGVOYW1lUGFydHNbaV07XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gbmV3RmlsZU5hbWU7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogQ2xhbXAsIHVudXNlZFxyXG4gKlxyXG4gKiBAcGFyYW0gbnVtXHJcbiAqIEBwYXJhbSBtaW5cclxuICogQHBhcmFtIG1heFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNsYW1wKG51bTogbnVtYmVyLCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIpOiBudW1iZXIge1xyXG5cdHJldHVybiBNYXRoLm1pbihNYXRoLm1heChudW0sIG1pbiksIG1heCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBqcyBjYW4ndCBldmVuIGltcGxlbWVudCBtb2R1bG8gY29ycmVjdGx5Li4uXHJcbiAqXHJcbiAqIEBwYXJhbSBuXHJcbiAqIEBwYXJhbSBtXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gbW9kKG46IG51bWJlciwgbTogbnVtYmVyKTogbnVtYmVyIHtcclxuXHRyZXR1cm4gKChuICUgbSkgKyBtKSAlIG07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDaGVja3MgaWYgMiBhcnJheXMgYXJlIGVxdWFsLCB0aGUgYXJyYXlzIHNob3VsZCBoYXZlIHRoZSBzYW1lIGRhdGF0eXBlXHJcbiAqXHJcbiAqIEBwYXJhbSBhcnIxXHJcbiAqIEBwYXJhbSBhcnIyXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gYXJyYXlFcXVhbHMoYXJyMTogYW55W10sIGFycjI6IGFueVtdKTogYm9vbGVhbiB7XHJcblx0aWYgKGFycjEubGVuZ3RoICE9PSBhcnIyLmxlbmd0aCkge1xyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH1cclxuXHJcblx0Zm9yIChjb25zdCBhcnIxRWxlbWVudCBvZiBhcnIxKSB7XHJcblx0XHRpZiAoIWFycjIuY29udGFpbnMoYXJyMUVsZW1lbnQpKSB7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHJldHVybiB0cnVlO1xyXG59XHJcblxyXG4vKipcclxuICogVGVtcGxhdGUgXCJlbmdpbmVcIiBmcm9tIG15IG1lZGlhIGRiIHBsdWdpblxyXG4gKlxyXG4gKiBAcGFyYW0gdGVtcGxhdGVcclxuICogQHBhcmFtIGRhdGFNb2RlbFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHJlcGxhY2VUYWdzKHRlbXBsYXRlOiBzdHJpbmcsIGRhdGFNb2RlbDogYW55KTogc3RyaW5nIHtcclxuXHRjb25zdCByZXNvbHZlZFRlbXBsYXRlID0gdGVtcGxhdGUucmVwbGFjZShuZXcgUmVnRXhwKCd7ey4qP319JywgJ2cnKSwgKG1hdGNoOiBzdHJpbmcpID0+IHJlcGxhY2VUYWcobWF0Y2gsIGRhdGFNb2RlbCkpO1xyXG5cclxuXHRyZXR1cm4gcmVzb2x2ZWRUZW1wbGF0ZTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRha2VzIGluIGEgdGVtcGxhdGUgbWF0Y2ggYW5kIHJldHVybnMgdGhlIHJlcGxhY2VtZW50IGRhdGFcclxuICpcclxuICogQHBhcmFtIG1hdGNoXHJcbiAqIEBwYXJhbSBkYXRhTW9kZWxcclxuICovXHJcbmZ1bmN0aW9uIHJlcGxhY2VUYWcobWF0Y2g6IHN0cmluZywgZGF0YU1vZGVsOiBhbnkpOiBzdHJpbmcge1xyXG5cdGxldCB0YWcgPSBtYXRjaDtcclxuXHR0YWcgPSB0YWcuc3Vic3RyaW5nKDIpO1xyXG5cdHRhZyA9IHRhZy5zdWJzdHJpbmcoMCwgdGFnLmxlbmd0aCAtIDIpO1xyXG5cdHRhZyA9IHRhZy50cmltKCk7XHJcblxyXG5cdGNvbnN0IHBhcnRzID0gdGFnLnNwbGl0KCc6Jyk7XHJcblx0aWYgKHBhcnRzLmxlbmd0aCA9PT0gMSkge1xyXG5cdFx0Y29uc3QgcGF0aCA9IHBhcnRzWzBdLnNwbGl0KCcuJyk7XHJcblxyXG5cdFx0Y29uc3Qgb2JqID0gdHJhdmVyc2VPYmplY3QocGF0aCwgZGF0YU1vZGVsKTtcclxuXHJcblx0XHRpZiAob2JqID09PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0cmV0dXJuICd7eyBJTlZBTElEIFRFTVBMQVRFIFRBRyAtIG9iamVjdCB1bmRlZmluZWQgfX0nO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBvYmo7XHJcblx0fSBlbHNlIGlmIChwYXJ0cy5sZW5ndGggPT09IDIpIHtcclxuXHRcdGNvbnN0IG9wZXJhdG9yID0gcGFydHNbMF07XHJcblxyXG5cdFx0Y29uc3QgcGF0aCA9IHBhcnRzWzFdLnNwbGl0KCcuJyk7XHJcblxyXG5cdFx0Y29uc3Qgb2JqID0gdHJhdmVyc2VPYmplY3QocGF0aCwgZGF0YU1vZGVsKTtcclxuXHJcblx0XHRpZiAob2JqID09PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0cmV0dXJuICd7eyBJTlZBTElEIFRFTVBMQVRFIFRBRyAtIG9iamVjdCB1bmRlZmluZWQgfX0nO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChvcGVyYXRvciA9PT0gJ0xJU1QnKSB7XHJcblx0XHRcdGlmICghQXJyYXkuaXNBcnJheShvYmopKSB7XHJcblx0XHRcdFx0cmV0dXJuICd7eyBJTlZBTElEIFRFTVBMQVRFIFRBRyAtIG9wZXJhdG9yIExJU1QgaXMgb25seSBhcHBsaWNhYmxlIG9uIGFuIGFycmF5IH19JztcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gb2JqLm1hcCgoZTogYW55KSA9PiBgLSAke2V9YCkuam9pbignXFxuJyk7XHJcblx0XHR9IGVsc2UgaWYgKG9wZXJhdG9yID09PSAnRU5VTScpIHtcclxuXHRcdFx0aWYgKCFBcnJheS5pc0FycmF5KG9iaikpIHtcclxuXHRcdFx0XHRyZXR1cm4gJ3t7IElOVkFMSUQgVEVNUExBVEUgVEFHIC0gb3BlcmF0b3IgRU5VTSBpcyBvbmx5IGFwcGxpY2FibGUgb24gYW4gYXJyYXkgfX0nO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiBvYmouam9pbignLCAnKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gYHt7IElOVkFMSUQgVEVNUExBVEUgVEFHIC0gdW5rbm93biBvcGVyYXRvciAke29wZXJhdG9yfSB9fWA7XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gJ3t7IElOVkFMSUQgVEVNUExBVEUgVEFHIH19JztcclxufVxyXG5cclxuLyoqXHJcbiAqIFRyYXZlcnNlcyB0aGUgb2JqZWN0IGFsb25nIGEgcHJvcGVydHkgcGF0aFxyXG4gKlxyXG4gKiBAcGFyYW0gcGF0aFxyXG4gKiBAcGFyYW0gb2JqXHJcbiAqL1xyXG5mdW5jdGlvbiB0cmF2ZXJzZU9iamVjdChwYXRoOiBBcnJheTxzdHJpbmc+LCBvYmo6IGFueSk6IGFueSB7XHJcblx0Zm9yIChjb25zdCBwYXJ0IG9mIHBhdGgpIHtcclxuXHRcdGlmIChvYmogIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRvYmogPSBvYmpbcGFydF07XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gb2JqO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNUcnV0aHkodmFsdWU6IGFueSk6IGJvb2xlYW4ge1xyXG5cdHJldHVybiAhIXZhbHVlO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNGYWxzeSh2YWx1ZTogYW55KTogYm9vbGVhbiB7XHJcblx0cmV0dXJuICF2YWx1ZTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGVxdWFsT3JJbmNsdWRlcyhzdHIxOiBzdHJpbmcsIHN0cjI6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG5cdHJldHVybiBzdHIxID09PSBzdHIyIHx8IHN0cjEuaW5jbHVkZXMoc3RyMikgfHwgc3RyMi5pbmNsdWRlcyhzdHIxKTtcclxufVxyXG4iLCAiaW1wb3J0IHtBYnN0cmFjdElucHV0RmllbGR9IGZyb20gJy4vQWJzdHJhY3RJbnB1dEZpZWxkJztcclxuaW1wb3J0IHtUZXh0Q29tcG9uZW50fSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7TG9nZ2VyfSBmcm9tICcuLi91dGlscy9Mb2dnZXInO1xyXG5pbXBvcnQge01ldGFCaW5kSW50ZXJuYWxFcnJvcn0gZnJvbSAnLi4vdXRpbHMvVXRpbHMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFRleHRJbnB1dEZpZWxkIGV4dGVuZHMgQWJzdHJhY3RJbnB1dEZpZWxkIHtcclxuXHR0ZXh0Q29tcG9uZW50OiBUZXh0Q29tcG9uZW50IHwgdW5kZWZpbmVkO1xyXG5cclxuXHRnZXRWYWx1ZSgpOiBhbnkge1xyXG5cdFx0aWYgKCF0aGlzLnRleHRDb21wb25lbnQpIHtcclxuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcigndGV4dCBpbnB1dCBjb21wb25lbnQgaXMgdW5kZWZpbmVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMudGV4dENvbXBvbmVudC5nZXRWYWx1ZSgpO1xyXG5cdH1cclxuXHJcblx0c2V0VmFsdWUodmFsdWU6IGFueSk6IHZvaWQge1xyXG5cdFx0aWYgKCF0aGlzLnRleHRDb21wb25lbnQpIHtcclxuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcigndGV4dCBpbnB1dCBjb21wb25lbnQgaXMgdW5kZWZpbmVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHZhbHVlICE9IG51bGwgJiYgdHlwZW9mIHZhbHVlID09ICdzdHJpbmcnKSB7XHJcblx0XHRcdHRoaXMudGV4dENvbXBvbmVudC5zZXRWYWx1ZSh2YWx1ZSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRMb2dnZXIubG9nV2FybmluZyhgY2FuIG5vdCBzZXQgdmFsdWUgb2YgdGV4dCBpbnB1dCB0byBcXCcke3ZhbHVlfVxcJ2ApO1xyXG5cdFx0XHR0aGlzLnRleHRDb21wb25lbnQuc2V0VmFsdWUoJycpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0aXNFcXVhbFZhbHVlKHZhbHVlOiBhbnkpOiBib29sZWFuIHtcclxuXHRcdHJldHVybiB0aGlzLmdldFZhbHVlKCkgPT0gdmFsdWU7XHJcblx0fVxyXG5cclxuXHRnZXREZWZhdWx0VmFsdWUoKTogYW55IHtcclxuXHRcdHJldHVybiAnJztcclxuXHR9XHJcblxyXG5cdGdldEh0bWxFbGVtZW50KCk6IEhUTUxFbGVtZW50IHtcclxuXHRcdGlmICghdGhpcy50ZXh0Q29tcG9uZW50KSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ3RleHQgaW5wdXQgY29tcG9uZW50IGlzIHVuZGVmaW5lZCcpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzLnRleHRDb21wb25lbnQuaW5wdXRFbDtcclxuXHR9XHJcblxyXG5cdHJlbmRlcihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XHJcblx0XHRjb25zdCBjb21wb25lbnQgPSBuZXcgVGV4dENvbXBvbmVudChjb250YWluZXIpO1xyXG5cdFx0Y29tcG9uZW50LnNldFZhbHVlKHRoaXMuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQuZ2V0SW5pdGlhbFZhbHVlKCkpO1xyXG5cdFx0Y29tcG9uZW50Lm9uQ2hhbmdlKHRoaXMub25WYWx1ZUNoYW5nZSk7XHJcblx0XHR0aGlzLnRleHRDb21wb25lbnQgPSBjb21wb25lbnQ7XHJcblx0fVxyXG5cclxufVxyXG4iLCAiaW1wb3J0IHtBYnN0cmFjdElucHV0RmllbGR9IGZyb20gJy4vQWJzdHJhY3RJbnB1dEZpZWxkJztcclxuaW1wb3J0IHtTbGlkZXJDb21wb25lbnR9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHtMb2dnZXJ9IGZyb20gJy4uL3V0aWxzL0xvZ2dlcic7XHJcbmltcG9ydCB7SW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGR9IGZyb20gJy4uL0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkJztcclxuaW1wb3J0IHtNZXRhQmluZEludGVybmFsRXJyb3J9IGZyb20gJy4uL3V0aWxzL1V0aWxzJztcclxuaW1wb3J0IHtJbnB1dEZpZWxkQXJndW1lbnRUeXBlfSBmcm9tICcuLi9wYXJzZXJzL0lucHV0RmllbGREZWNsYXJhdGlvblBhcnNlcic7XHJcblxyXG5leHBvcnQgY2xhc3MgU2xpZGVySW5wdXRGaWVsZCBleHRlbmRzIEFic3RyYWN0SW5wdXRGaWVsZCB7XHJcblx0c2xpZGVyQ29tcG9uZW50OiBTbGlkZXJDb21wb25lbnQgfCB1bmRlZmluZWQ7XHJcblx0bWluVmFsdWU6IG51bWJlcjtcclxuXHRtYXhWYWx1ZTogbnVtYmVyO1xyXG5cclxuXHJcblx0Y29uc3RydWN0b3IoaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQ6IElucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLCBvblZhbHVlQ2hhbmdlOiAodmFsdWU6IGFueSkgPT4gKHZvaWQgfCBQcm9taXNlPHZvaWQ+KSkge1xyXG5cdFx0c3VwZXIoaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQsIG9uVmFsdWVDaGFuZ2UpO1xyXG5cdFx0dGhpcy5taW5WYWx1ZSA9IGlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLmdldEFyZ3VtZW50KElucHV0RmllbGRBcmd1bWVudFR5cGUuTUlOX1ZBTFVFKT8udmFsdWUgPz8gMDtcclxuXHRcdHRoaXMubWF4VmFsdWUgPSBpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZC5nZXRBcmd1bWVudChJbnB1dEZpZWxkQXJndW1lbnRUeXBlLk1BWF9WQUxVRSk/LnZhbHVlID8/IDEwMDtcclxuXHR9XHJcblxyXG5cdGdldFZhbHVlKCk6IGFueSB7XHJcblx0XHRpZiAoIXRoaXMuc2xpZGVyQ29tcG9uZW50KSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ3NsaWRlciBpbnB1dCBjb21wb25lbnQgaXMgdW5kZWZpbmVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMuc2xpZGVyQ29tcG9uZW50LmdldFZhbHVlKCk7XHJcblx0fVxyXG5cclxuXHRzZXRWYWx1ZSh2YWx1ZTogYW55KTogdm9pZCB7XHJcblx0XHRpZiAoIXRoaXMuc2xpZGVyQ29tcG9uZW50KSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ3NsaWRlciBpbnB1dCBjb21wb25lbnQgaXMgdW5kZWZpbmVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHZhbHVlICE9IG51bGwgJiYgdHlwZW9mIHZhbHVlID09ICdudW1iZXInKSB7XHJcblx0XHRcdGlmICh2YWx1ZSA+PSB0aGlzLm1pblZhbHVlICYmIHZhbHVlIDw9IHRoaXMubWF4VmFsdWUpIHtcclxuXHRcdFx0XHR0aGlzLnNsaWRlckNvbXBvbmVudC5zZXRWYWx1ZSh2YWx1ZSk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdExvZ2dlci5sb2dXYXJuaW5nKGBjYW4gbm90IHNldCB2YWx1ZSBvZiBzbGlkZXIgdG8gXFwnJHt2YWx1ZX1cXCdgKTtcclxuXHRcdFx0dGhpcy5zbGlkZXJDb21wb25lbnQuc2V0VmFsdWUodGhpcy5nZXREZWZhdWx0VmFsdWUoKSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRpc0VxdWFsVmFsdWUodmFsdWU6IGFueSk6IGJvb2xlYW4ge1xyXG5cdFx0cmV0dXJuIHRoaXMuZ2V0VmFsdWUoKSA9PSB2YWx1ZTtcclxuXHR9XHJcblxyXG5cdGdldERlZmF1bHRWYWx1ZSgpOiBhbnkge1xyXG5cdFx0cmV0dXJuIHRoaXMubWluVmFsdWU7XHJcblx0fVxyXG5cclxuXHRnZXRIdG1sRWxlbWVudCgpOiBIVE1MRWxlbWVudCB7XHJcblx0XHRpZiAoIXRoaXMuc2xpZGVyQ29tcG9uZW50KSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ3NsaWRlciBpbnB1dCBjb21wb25lbnQgaXMgdW5kZWZpbmVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMuc2xpZGVyQ29tcG9uZW50LnNsaWRlckVsO1xyXG5cdH1cclxuXHJcblx0cmVuZGVyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcclxuXHRcdGNvbnRhaW5lci5yZW1vdmVDbGFzcygnbWV0YS1iaW5kLXBsdWdpbi1pbnB1dC13cmFwcGVyJyk7XHJcblx0XHRjb250YWluZXIuYWRkQ2xhc3MoJ21ldGEtYmluZC1wbHVnaW4tZmxleC1pbnB1dC13cmFwcGVyJyk7XHJcblxyXG5cdFx0Y29uc3QgbGFiZWxBcmd1bWVudCA9IHRoaXMuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQuZ2V0QXJndW1lbnQoSW5wdXRGaWVsZEFyZ3VtZW50VHlwZS5BRERfTEFCRUxTKTtcclxuXHRcdGlmIChsYWJlbEFyZ3VtZW50ICYmIGxhYmVsQXJndW1lbnQudmFsdWUgPT09IHRydWUpIHtcclxuXHRcdFx0Y29udGFpbmVyLmNyZWF0ZVNwYW4oe3RleHQ6IHRoaXMubWluVmFsdWUudG9TdHJpbmcoKSwgY2xzOiAnbWV0YS1iaW5kLXBsdWdpbi1zbGlkZXItaW5wdXQtbGFiZWwnfSk7XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3QgY29tcG9uZW50ID0gbmV3IFNsaWRlckNvbXBvbmVudChjb250YWluZXIpO1xyXG5cdFx0Y29tcG9uZW50LnNldFZhbHVlKHRoaXMuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQuZ2V0SW5pdGlhbFZhbHVlKCkpO1xyXG5cdFx0Y29tcG9uZW50Lm9uQ2hhbmdlKHRoaXMub25WYWx1ZUNoYW5nZSk7XHJcblx0XHRjb21wb25lbnQuc2V0RHluYW1pY1Rvb2x0aXAoKTtcclxuXHRcdGNvbXBvbmVudC5zZXRMaW1pdHModGhpcy5taW5WYWx1ZSwgdGhpcy5tYXhWYWx1ZSwgMSk7XHJcblx0XHRjb21wb25lbnQuc2xpZGVyRWwuYWRkQ2xhc3MoJ21ldGEtYmluZC1wbHVnaW4tc2xpZGVyLWlucHV0Jyk7XHJcblxyXG5cdFx0aWYgKGxhYmVsQXJndW1lbnQgJiYgbGFiZWxBcmd1bWVudC52YWx1ZSA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRjb250YWluZXIuY3JlYXRlU3Bhbih7dGV4dDogdGhpcy5tYXhWYWx1ZS50b1N0cmluZygpLCBjbHM6ICdtZXRhLWJpbmQtcGx1Z2luLXNsaWRlci1pbnB1dC1sYWJlbCd9KTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLnNsaWRlckNvbXBvbmVudCA9IGNvbXBvbmVudDtcclxuXHR9XHJcblxyXG59XHJcbiIsICJpbXBvcnQge2VxdWFsT3JJbmNsdWRlcywgaXNGYWxzeSwgTWV0YUJpbmRJbnRlcm5hbEVycm9yfSBmcm9tICcuL1V0aWxzJztcclxuXHJcblxyXG5leHBvcnQgY2xhc3MgRW5jbG9zaW5nUGFpciB7XHJcblx0cmVhZG9ubHkgb3BlbmluZ0VxdWFsc0Nsb3Npbmc6IGJvb2xlYW47XHJcblx0cHJpdmF0ZSByZWFkb25seSBfb3BlbmluZ1N0cmluZzogc3RyaW5nO1xyXG5cdHByaXZhdGUgcmVhZG9ubHkgX2Nsb3NpbmdTdHJpbmc6IHN0cmluZztcclxuXHJcblx0Y29uc3RydWN0b3Iob3BlbmluZ1N0cmluZzogc3RyaW5nLCBjbG9zaW5nU3RyaW5nPzogc3RyaW5nKSB7XHJcblx0XHRpZiAoaXNGYWxzeShvcGVuaW5nU3RyaW5nKSkge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCdvcGVuaW5nIHN0cmluZyBtdXN0IG5vdCBiZSBlbXB0eScpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMub3BlbmluZ0VxdWFsc0Nsb3NpbmcgPSBpc0ZhbHN5KGNsb3NpbmdTdHJpbmcpIHx8IG9wZW5pbmdTdHJpbmcgPT09IGNsb3NpbmdTdHJpbmc7XHJcblxyXG5cdFx0aWYgKHRoaXMub3BlbmluZ0VxdWFsc0Nsb3NpbmcpIHtcclxuXHRcdFx0dGhpcy5fb3BlbmluZ1N0cmluZyA9IG9wZW5pbmdTdHJpbmc7XHJcblx0XHRcdHRoaXMuX2Nsb3NpbmdTdHJpbmcgPSBvcGVuaW5nU3RyaW5nO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhpcy5fb3BlbmluZ1N0cmluZyA9IG9wZW5pbmdTdHJpbmc7XHJcblx0XHRcdC8vIEB0cy1pZ25vcmUgdGhpcyBjYW4gbm90IGJlIHVuZGVmaW5lZCBoZXJlXHJcblx0XHRcdHRoaXMuX2Nsb3NpbmdTdHJpbmcgPSBjbG9zaW5nU3RyaW5nO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cHVibGljIGdldCBvcGVuaW5nU3RyaW5nKCk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gdGhpcy5fb3BlbmluZ1N0cmluZztcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXQgY2xvc2luZ1N0cmluZygpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIHRoaXMub3BlbmluZ0VxdWFsc0Nsb3NpbmcgPyB0aGlzLl9vcGVuaW5nU3RyaW5nIDogdGhpcy5fY2xvc2luZ1N0cmluZztcclxuXHR9XHJcblxyXG5cdG92ZXJsYXBzKG90aGVyOiBFbmNsb3NpbmdQYWlyKTogYm9vbGVhbiB7XHJcblx0XHRyZXR1cm4gZXF1YWxPckluY2x1ZGVzKHRoaXMub3BlbmluZ1N0cmluZywgb3RoZXIub3BlbmluZ1N0cmluZykgfHxcclxuXHRcdFx0ZXF1YWxPckluY2x1ZGVzKHRoaXMub3BlbmluZ1N0cmluZywgb3RoZXIuY2xvc2luZ1N0cmluZykgfHxcclxuXHRcdFx0ZXF1YWxPckluY2x1ZGVzKHRoaXMuY2xvc2luZ1N0cmluZywgb3RoZXIub3BlbmluZ1N0cmluZykgfHxcclxuXHRcdFx0ZXF1YWxPckluY2x1ZGVzKHRoaXMuY2xvc2luZ1N0cmluZywgb3RoZXIuY2xvc2luZ1N0cmluZyk7XHJcblx0fVxyXG5cclxuXHRlcXVhbHMob3RoZXI6IEVuY2xvc2luZ1BhaXIpOiBib29sZWFuIHtcclxuXHRcdGlmIChpc0ZhbHN5KG90aGVyKSkge1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gKHRoaXMub3BlbmluZ1N0cmluZyA9PT0gb3RoZXIub3BlbmluZ1N0cmluZykgJiYgKHRoaXMuY2xvc2luZ1N0cmluZyA9PT0gb3RoZXIuY2xvc2luZ1N0cmluZyk7XHJcblx0fVxyXG5cclxuXHR0b1N0cmluZygpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIEpTT04uc3RyaW5naWZ5KHRoaXMpO1xyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFBhcnNlclV0aWxzIHtcclxuXHJcblx0Ly8gVE9ETzogcmVuYW1lIHN0dWZmXHJcblx0c3RhdGljIHNwbGl0KHN0cjogc3RyaW5nLCBzZXBhcmF0b3I6IHN0cmluZywgaWdub3JlPzogRW5jbG9zaW5nUGFpcik6IHN0cmluZ1tdIHtcclxuXHRcdGlmICghc3RyKSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ3N0cmluZyBtdXN0IG5vdCBiZSBlbXB0eScpO1xyXG5cdFx0fVxyXG5cdFx0aWYgKCFzZXBhcmF0b3IpIHtcclxuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcignc2VwYXJhdG9yIG11c3Qgbm90IGJlIGVtcHR5Jyk7XHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IHN1YlN0cjogc3RyaW5nID0gJyc7XHJcblx0XHRjb25zdCBzdWJTdHJpbmdzOiBzdHJpbmdbXSA9IFtdO1xyXG5cclxuXHRcdGlmIChpZ25vcmUpIHtcclxuXHRcdFx0bGV0IHJlbWFpbmluZ09wZW5pbmdTdHJpbmdDb3VudCA9IFBhcnNlclV0aWxzLm51bWJlck9mT2NjdXJyZW5jZXMoc3RyLCBpZ25vcmUub3BlbmluZ1N0cmluZyk7XHJcblx0XHRcdGxldCByZW1haW5pbmdDbG9zaW5nU3RyaW5nQ291bnQgPSBQYXJzZXJVdGlscy5udW1iZXJPZk9jY3VycmVuY2VzKHN0ciwgaWdub3JlLmNsb3NpbmdTdHJpbmcpO1xyXG5cclxuXHRcdFx0bGV0IGVuY2xvc2luZ0xldmVsOiBudW1iZXIgPSAwO1xyXG5cclxuXHRcdFx0c3RyTG9vcCA6IGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0Ly8gaWdub3JlIHNwZWNpZmllZFxyXG5cdFx0XHRcdGlmIChlbmNsb3NpbmdMZXZlbCA9PT0gMCAmJiBQYXJzZXJVdGlscy5pc1N0cmluZ0F0KHN0ciwgc2VwYXJhdG9yLCBpKSkge1xyXG5cdFx0XHRcdFx0c3ViU3RyaW5ncy5wdXNoKHN1YlN0cik7XHJcblx0XHRcdFx0XHRzdWJTdHIgPSAnJztcclxuXHRcdFx0XHRcdGkgKz0gc2VwYXJhdG9yLmxlbmd0aCAtIDE7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHN1YlN0ciArPSBzdHJbaV07XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRpZiAoaWdub3JlLm9wZW5pbmdFcXVhbHNDbG9zaW5nKSB7XHJcblx0XHRcdFx0XHRpZiAoUGFyc2VyVXRpbHMuaXNTdHJpbmdBdChzdHIsIGlnbm9yZS5vcGVuaW5nU3RyaW5nLCBpKSkge1xyXG5cdFx0XHRcdFx0XHRpZiAoZW5jbG9zaW5nTGV2ZWwgJSAyID09PSAwICYmIHJlbWFpbmluZ09wZW5pbmdTdHJpbmdDb3VudCA9PT0gMSkge1xyXG5cdFx0XHRcdFx0XHRcdC8vIG5vdCBpbiBhIHBhcnQgdGhhdCBzaG91bGQgYmUgcmVtb3ZlZCBhbmQgdGhlcmUgaXMgc3RpbGwgYW4gb3BlbmluZyBzdHJpbmcgbGVmdCwgc28gd2UgaWdub3JlIGl0XHJcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoZW5jbG9zaW5nTGV2ZWwgJSAyID09PSAwKSB7XHJcblx0XHRcdFx0XHRcdFx0Ly8gb3BlbmluZyBzdHJpbmdcclxuXHRcdFx0XHRcdFx0XHRlbmNsb3NpbmdMZXZlbCArPSAxO1xyXG5cclxuXHRcdFx0XHRcdFx0XHQvLyBjb3B5IHRoZSBvcGVuaW5nIHN0cmluZ1xyXG5cdFx0XHRcdFx0XHRcdGZvciAobGV0IGogPSAxOyBqIDwgaWdub3JlLm9wZW5pbmdTdHJpbmcubGVuZ3RoOyBqKyspIHtcclxuXHRcdFx0XHRcdFx0XHRcdGkgKz0gMTtcclxuXHRcdFx0XHRcdFx0XHRcdHN1YlN0ciArPSBzdHJbaV07XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKGkgPj0gc3RyLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRicmVhayBzdHJMb29wO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHQvLyBjbG9zaW5nIHN0cmluZ1xyXG5cdFx0XHRcdFx0XHRcdGVuY2xvc2luZ0xldmVsIC09IDE7XHJcblxyXG5cdFx0XHRcdFx0XHRcdC8vIGNvcHkgdGhlIGNsb3Npbmcgc3RyaW5nXHJcblx0XHRcdFx0XHRcdFx0Zm9yIChsZXQgaiA9IDE7IGogPCBpZ25vcmUuY2xvc2luZ1N0cmluZy5sZW5ndGg7IGorKykgeyAvLyAob3BlbmluZyBhbmQgY2xvc2luZyBzdHJpbmcgYXJlIHRoZSBzYW1lKVxyXG5cdFx0XHRcdFx0XHRcdFx0aSArPSAxO1xyXG5cdFx0XHRcdFx0XHRcdFx0c3ViU3RyICs9IHN0cltpXTtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRpZiAoaSA+PSBzdHIubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrIHN0ckxvb3A7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdHJlbWFpbmluZ09wZW5pbmdTdHJpbmdDb3VudCAtPSAxO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRpZiAoUGFyc2VyVXRpbHMuaXNTdHJpbmdBdChzdHIsIGlnbm9yZS5vcGVuaW5nU3RyaW5nLCBpKSkge1xyXG5cdFx0XHRcdFx0XHQvLyBvcGVuaW5nIHN0cmluZ1xyXG5cdFx0XHRcdFx0XHRpZiAocmVtYWluaW5nT3BlbmluZ1N0cmluZ0NvdW50IDw9IHJlbWFpbmluZ0Nsb3NpbmdTdHJpbmdDb3VudCkge1xyXG5cdFx0XHRcdFx0XHRcdC8vIHN0ciBzdGlsbCBoYXMgc3VmZmljaWVudCBjbG9zaW5nIHN0cmluZyB0byBmaW5kIHRoaXMgYSBwYXJ0bmVyXHJcblx0XHRcdFx0XHRcdFx0ZW5jbG9zaW5nTGV2ZWwgKz0gMTtcclxuXHJcblx0XHRcdFx0XHRcdFx0Ly8gY29weSB0aGUgb3BlbmluZyBzdHJpbmdcclxuXHRcdFx0XHRcdFx0XHRmb3IgKGxldCBqID0gMTsgaiA8IGlnbm9yZS5vcGVuaW5nU3RyaW5nLmxlbmd0aDsgaisrKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRpICs9IDE7XHJcblx0XHRcdFx0XHRcdFx0XHRzdWJTdHIgKz0gc3RyW2ldO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdGlmIChpID49IHN0ci5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0YnJlYWsgc3RyTG9vcDtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0cmVtYWluaW5nT3BlbmluZ1N0cmluZ0NvdW50IC09IDE7XHJcblx0XHRcdFx0XHR9IGVsc2UgaWYgKFBhcnNlclV0aWxzLmlzU3RyaW5nQXQoc3RyLCBpZ25vcmUuY2xvc2luZ1N0cmluZywgaSkpIHtcclxuXHRcdFx0XHRcdFx0Ly8gY2xvc2luZyBzdHJpbmdcclxuXHRcdFx0XHRcdFx0aWYgKGVuY2xvc2luZ0xldmVsID4gMCkge1xyXG5cdFx0XHRcdFx0XHRcdC8vIHRoZXJlIHdhcyBhbiBvcGVuaW5nIHN0cmluZyBiZWZvcmUgdGhpc1xyXG5cdFx0XHRcdFx0XHRcdGVuY2xvc2luZ0xldmVsIC09IDE7XHJcblxyXG5cdFx0XHRcdFx0XHRcdC8vIGNvcHkgdGhlIGNsb3Npbmcgc3RyaW5nXHJcblx0XHRcdFx0XHRcdFx0Zm9yIChsZXQgaiA9IDE7IGogPCBpZ25vcmUuY2xvc2luZ1N0cmluZy5sZW5ndGg7IGorKykge1xyXG5cdFx0XHRcdFx0XHRcdFx0aSArPSAxO1xyXG5cdFx0XHRcdFx0XHRcdFx0c3ViU3RyICs9IHN0cltpXTtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRpZiAoaSA+PSBzdHIubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrIHN0ckxvb3A7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdHJlbWFpbmluZ0Nsb3NpbmdTdHJpbmdDb3VudCAtPSAxO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Ly8gbm8gaWdub3JlIHNwZWNpZmllZFxyXG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xyXG5cclxuXHRcdFx0XHRpZiAoUGFyc2VyVXRpbHMuaXNTdHJpbmdBdChzdHIsIHNlcGFyYXRvciwgaSkpIHtcclxuXHRcdFx0XHRcdHN1YlN0cmluZ3MucHVzaChzdWJTdHIpO1xyXG5cdFx0XHRcdFx0c3ViU3RyID0gJyc7XHJcblx0XHRcdFx0XHRpICs9IHNlcGFyYXRvci5sZW5ndGggLSAxO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRzdWJTdHIgKz0gc3RyW2ldO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHN1YlN0cmluZ3MucHVzaChzdWJTdHIpO1xyXG5cclxuXHRcdHJldHVybiBzdWJTdHJpbmdzO1xyXG5cdH1cclxuXHJcblx0c3RhdGljIHJlbW92ZUluQmV0d2VlbihzdHI6IHN0cmluZywgZW5jbG9zaW5nUGFpcjogRW5jbG9zaW5nUGFpcik6IHN0cmluZyB7XHJcblx0XHRpZiAoIXN0cikge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCdzdHJpbmcgbXVzdCBub3QgYmUgZW1wdHknKTtcclxuXHRcdH1cclxuXHJcblx0XHRsZXQgcmVtYWluaW5nT3BlbmluZ1N0cmluZ0NvdW50ID0gUGFyc2VyVXRpbHMubnVtYmVyT2ZPY2N1cnJlbmNlcyhzdHIsIGVuY2xvc2luZ1BhaXIub3BlbmluZ1N0cmluZyk7XHJcblx0XHRsZXQgcmVtYWluaW5nQ2xvc2luZ1N0cmluZ0NvdW50ID0gUGFyc2VyVXRpbHMubnVtYmVyT2ZPY2N1cnJlbmNlcyhzdHIsIGVuY2xvc2luZ1BhaXIuY2xvc2luZ1N0cmluZyk7XHJcblxyXG5cdFx0bGV0IGVuY2xvc2luZ0xldmVsOiBudW1iZXIgPSAwO1xyXG5cclxuXHRcdGxldCBzdWJTdHI6IHN0cmluZyA9ICcnO1xyXG5cclxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdGlmIChlbmNsb3NpbmdQYWlyLm9wZW5pbmdFcXVhbHNDbG9zaW5nKSB7XHJcblx0XHRcdFx0aWYgKFBhcnNlclV0aWxzLmlzU3RyaW5nQXQoc3RyLCBlbmNsb3NpbmdQYWlyLm9wZW5pbmdTdHJpbmcsIGkpKSB7XHJcblx0XHRcdFx0XHRpZiAoZW5jbG9zaW5nTGV2ZWwgJSAyID09PSAwICYmIHJlbWFpbmluZ09wZW5pbmdTdHJpbmdDb3VudCA9PT0gMSkge1xyXG5cdFx0XHRcdFx0XHQvLyBub3QgaW4gYSBwYXJ0IHRoYXQgc2hvdWxkIGJlIHJlbW92ZWQgYW5kIHRoZXJlIGlzIHN0aWxsIGFuIG9wZW5pbmcgc3RyaW5nIGxlZnQsIHNvIHdlIGlnbm9yZSBpdFxyXG5cdFx0XHRcdFx0fSBlbHNlIGlmIChlbmNsb3NpbmdMZXZlbCAlIDIgPT09IDApIHtcclxuXHRcdFx0XHRcdFx0Ly8gb3BlbmluZyBzdHJpbmdcclxuXHRcdFx0XHRcdFx0ZW5jbG9zaW5nTGV2ZWwgKz0gMTtcclxuXHJcblx0XHRcdFx0XHRcdC8vIHNraXAgdGhlIG9wZW5pbmcgc3RyaW5nXHJcblx0XHRcdFx0XHRcdGkgKz0gZW5jbG9zaW5nUGFpci5vcGVuaW5nU3RyaW5nLmxlbmd0aDtcclxuXHRcdFx0XHRcdFx0aWYgKGkgPj0gc3RyLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHQvLyBjbG9zaW5nIHN0cmluZ1xyXG5cdFx0XHRcdFx0XHRlbmNsb3NpbmdMZXZlbCAtPSAxO1xyXG5cclxuXHRcdFx0XHRcdFx0Ly8gc2tpcCB0aGUgY2xvc2luZyBzdHJpbmdcclxuXHRcdFx0XHRcdFx0aSArPSBlbmNsb3NpbmdQYWlyLmNsb3NpbmdTdHJpbmcubGVuZ3RoOyAvLyAob3BlbmluZyBhbmQgY2xvc2luZyBzdHJpbmcgYXJlIHRoZSBzYW1lKVxyXG5cdFx0XHRcdFx0XHRpZiAoaSA+PSBzdHIubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHJlbWFpbmluZ09wZW5pbmdTdHJpbmdDb3VudCAtPSAxO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRpZiAoUGFyc2VyVXRpbHMuaXNTdHJpbmdBdChzdHIsIGVuY2xvc2luZ1BhaXIub3BlbmluZ1N0cmluZywgaSkpIHtcclxuXHRcdFx0XHRcdC8vIG9wZW5pbmcgc3RyaW5nXHJcblx0XHRcdFx0XHRpZiAocmVtYWluaW5nT3BlbmluZ1N0cmluZ0NvdW50IDw9IHJlbWFpbmluZ0Nsb3NpbmdTdHJpbmdDb3VudCkge1xyXG5cdFx0XHRcdFx0XHQvLyBzdHIgc3RpbGwgaGFzIHN1ZmZpY2llbnQgY2xvc2luZyBzdHJpbmcgdG8gZmluZCB0aGlzIGEgcGFydG5lclxyXG5cdFx0XHRcdFx0XHRlbmNsb3NpbmdMZXZlbCArPSAxO1xyXG5cclxuXHRcdFx0XHRcdFx0Ly8gc2tpcCB0aGUgb3BlbmluZyBzdHJpbmdcclxuXHRcdFx0XHRcdFx0aSArPSBlbmNsb3NpbmdQYWlyLm9wZW5pbmdTdHJpbmcubGVuZ3RoO1xyXG5cdFx0XHRcdFx0XHRpZiAoaSA+PSBzdHIubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHJlbWFpbmluZ09wZW5pbmdTdHJpbmdDb3VudCAtPSAxO1xyXG5cdFx0XHRcdH0gZWxzZSBpZiAoUGFyc2VyVXRpbHMuaXNTdHJpbmdBdChzdHIsIGVuY2xvc2luZ1BhaXIuY2xvc2luZ1N0cmluZywgaSkpIHtcclxuXHRcdFx0XHRcdC8vIGNsb3Npbmcgc3RyaW5nXHJcblx0XHRcdFx0XHRpZiAoZW5jbG9zaW5nTGV2ZWwgPiAwKSB7XHJcblx0XHRcdFx0XHRcdC8vIHRoZXJlIHdhcyBhbiBvcGVuaW5nIHN0cmluZyBiZWZvcmUgdGhpc1xyXG5cdFx0XHRcdFx0XHRlbmNsb3NpbmdMZXZlbCAtPSAxO1xyXG5cclxuXHRcdFx0XHRcdFx0Ly8gc2tpcCB0aGUgY2xvc2luZyBzdHJpbmdcclxuXHRcdFx0XHRcdFx0aSArPSBlbmNsb3NpbmdQYWlyLmNsb3NpbmdTdHJpbmcubGVuZ3RoO1xyXG5cdFx0XHRcdFx0XHRpZiAoaSA+PSBzdHIubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHJlbWFpbmluZ0Nsb3NpbmdTdHJpbmdDb3VudCAtPSAxO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKGVuY2xvc2luZ0xldmVsID09PSAwKSB7XHJcblx0XHRcdFx0c3ViU3RyICs9IHN0cltpXTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBzdWJTdHI7XHJcblx0fVxyXG5cclxuXHRzdGF0aWMgZ2V0SW5CZXR3ZWVuKHN0cjogc3RyaW5nLCBlbmNsb3NpbmdQYWlyOiBFbmNsb3NpbmdQYWlyKTogc3RyaW5nIHwgc3RyaW5nW10ge1xyXG5cdFx0aWYgKCFzdHIpIHtcclxuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcignc3RyaW5nIG11c3Qgbm90IGJlIGVtcHR5Jyk7XHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IHJlbWFpbmluZ09wZW5pbmdTdHJpbmdDb3VudCA9IFBhcnNlclV0aWxzLm51bWJlck9mT2NjdXJyZW5jZXMoc3RyLCBlbmNsb3NpbmdQYWlyLm9wZW5pbmdTdHJpbmcpO1xyXG5cdFx0bGV0IHJlbWFpbmluZ0Nsb3NpbmdTdHJpbmdDb3VudCA9IFBhcnNlclV0aWxzLm51bWJlck9mT2NjdXJyZW5jZXMoc3RyLCBlbmNsb3NpbmdQYWlyLmNsb3NpbmdTdHJpbmcpO1xyXG5cclxuXHRcdGxldCBlbmNsb3NpbmdMZXZlbDogbnVtYmVyID0gMDtcclxuXHJcblx0XHRsZXQgc3ViU3RyOiBzdHJpbmcgPSAnJztcclxuXHRcdGNvbnN0IHN1YlN0cmluZ3M6IHN0cmluZ1tdID0gW107XHJcblxyXG5cdFx0c3RyTG9vcCA6IGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdGlmIChlbmNsb3NpbmdQYWlyLm9wZW5pbmdFcXVhbHNDbG9zaW5nKSB7XHJcblx0XHRcdFx0aWYgKFBhcnNlclV0aWxzLmlzU3RyaW5nQXQoc3RyLCBlbmNsb3NpbmdQYWlyLm9wZW5pbmdTdHJpbmcsIGkpKSB7XHJcblx0XHRcdFx0XHRpZiAoZW5jbG9zaW5nTGV2ZWwgJSAyID09PSAwICYmIHJlbWFpbmluZ09wZW5pbmdTdHJpbmdDb3VudCA9PT0gMSkge1xyXG5cdFx0XHRcdFx0XHQvLyBub3QgaW4gYSBwYXJ0IHRoYXQgc2hvdWxkIGJlIHJlbW92ZWQgYW5kIHRoZXJlIGlzIHN0aWxsIGFuIG9wZW5pbmcgc3RyaW5nIGxlZnQsIHNvIHdlIGlnbm9yZSBpdFxyXG5cdFx0XHRcdFx0fSBlbHNlIGlmIChlbmNsb3NpbmdMZXZlbCAlIDIgPT09IDApIHtcclxuXHRcdFx0XHRcdFx0Ly8gb3BlbmluZyBzdHJpbmdcclxuXHRcdFx0XHRcdFx0ZW5jbG9zaW5nTGV2ZWwgKz0gMTtcclxuXHJcblx0XHRcdFx0XHRcdC8vIHNraXAgdGhlIG9wZW5pbmcgc3RyaW5nXHJcblx0XHRcdFx0XHRcdHN1YlN0ciArPSBzdHJbaV07XHJcblx0XHRcdFx0XHRcdGZvciAobGV0IGogPSAxOyBqIDwgZW5jbG9zaW5nUGFpci5vcGVuaW5nU3RyaW5nLmxlbmd0aDsgaisrKSB7XHJcblx0XHRcdFx0XHRcdFx0aSArPSAxO1xyXG5cdFx0XHRcdFx0XHRcdHN1YlN0ciArPSBzdHJbaV07XHJcblxyXG5cdFx0XHRcdFx0XHRcdGlmIChpID49IHN0ci5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGJyZWFrIHN0ckxvb3A7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHQvLyBjbG9zaW5nIHN0cmluZ1xyXG5cdFx0XHRcdFx0XHRlbmNsb3NpbmdMZXZlbCAtPSAxO1xyXG5cclxuXHRcdFx0XHRcdFx0Ly8gc2tpcCB0aGUgY2xvc2luZyBzdHJpbmdcclxuXHRcdFx0XHRcdFx0c3ViU3RyICs9IHN0cltpXTtcclxuXHRcdFx0XHRcdFx0Zm9yIChsZXQgaiA9IDE7IGogPCBlbmNsb3NpbmdQYWlyLmNsb3NpbmdTdHJpbmcubGVuZ3RoOyBqKyspIHsgLy8gKG9wZW5pbmcgYW5kIGNsb3Npbmcgc3RyaW5nIGFyZSB0aGUgc2FtZSlcclxuXHRcdFx0XHRcdFx0XHRpICs9IDE7XHJcblx0XHRcdFx0XHRcdFx0c3ViU3RyICs9IHN0cltpXTtcclxuXHJcblx0XHRcdFx0XHRcdFx0aWYgKGkgPiBzdHIubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRicmVhayBzdHJMb29wO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRzdWJTdHJpbmdzLnB1c2goc3ViU3RyKTtcclxuXHRcdFx0XHRcdFx0c3ViU3RyID0gJyc7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRyZW1haW5pbmdPcGVuaW5nU3RyaW5nQ291bnQgLT0gMTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0aWYgKGVuY2xvc2luZ0xldmVsID49IDEpIHtcclxuXHRcdFx0XHRcdFx0c3ViU3RyICs9IHN0cltpXTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0aWYgKFBhcnNlclV0aWxzLmlzU3RyaW5nQXQoc3RyLCBlbmNsb3NpbmdQYWlyLm9wZW5pbmdTdHJpbmcsIGkpKSB7XHJcblx0XHRcdFx0XHQvLyBvcGVuaW5nIHN0cmluZ1xyXG5cdFx0XHRcdFx0aWYgKHJlbWFpbmluZ09wZW5pbmdTdHJpbmdDb3VudCA8PSByZW1haW5pbmdDbG9zaW5nU3RyaW5nQ291bnQpIHtcclxuXHRcdFx0XHRcdFx0Ly8gc3RyIHN0aWxsIGhhcyBzdWZmaWNpZW50IGNsb3Npbmcgc3RyaW5nIHRvIGZpbmQgdGhpcyBhIHBhcnRuZXJcclxuXHRcdFx0XHRcdFx0ZW5jbG9zaW5nTGV2ZWwgKz0gMTtcclxuXHJcblx0XHRcdFx0XHRcdC8vIGNvcHkgdGhlIG9wZW5pbmcgc3RyaW5nXHJcblx0XHRcdFx0XHRcdHN1YlN0ciArPSBzdHJbaV07XHJcblx0XHRcdFx0XHRcdGZvciAobGV0IGogPSAxOyBqIDwgZW5jbG9zaW5nUGFpci5vcGVuaW5nU3RyaW5nLmxlbmd0aDsgaisrKSB7XHJcblx0XHRcdFx0XHRcdFx0aSArPSAxO1xyXG5cdFx0XHRcdFx0XHRcdHN1YlN0ciArPSBzdHJbaV07XHJcblxyXG5cdFx0XHRcdFx0XHRcdGlmIChpID49IHN0ci5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGJyZWFrIHN0ckxvb3A7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRyZW1haW5pbmdPcGVuaW5nU3RyaW5nQ291bnQgLT0gMTtcclxuXHRcdFx0XHR9IGVsc2UgaWYgKFBhcnNlclV0aWxzLmlzU3RyaW5nQXQoc3RyLCBlbmNsb3NpbmdQYWlyLmNsb3NpbmdTdHJpbmcsIGkpKSB7XHJcblx0XHRcdFx0XHQvLyBjbG9zaW5nIHN0cmluZ1xyXG5cdFx0XHRcdFx0aWYgKGVuY2xvc2luZ0xldmVsID4gMCkge1xyXG5cdFx0XHRcdFx0XHQvLyB0aGVyZSB3YXMgYW4gb3BlbmluZyBzdHJpbmcgYmVmb3JlIHRoaXNcclxuXHRcdFx0XHRcdFx0ZW5jbG9zaW5nTGV2ZWwgLT0gMTtcclxuXHJcblx0XHRcdFx0XHRcdC8vIGNvcHkgdGhlIGNsb3Npbmcgc3RyaW5nXHJcblx0XHRcdFx0XHRcdHN1YlN0ciArPSBzdHJbaV07XHJcblx0XHRcdFx0XHRcdGZvciAobGV0IGogPSAxOyBqIDwgZW5jbG9zaW5nUGFpci5jbG9zaW5nU3RyaW5nLmxlbmd0aDsgaisrKSB7XHJcblx0XHRcdFx0XHRcdFx0aSArPSAxO1xyXG5cdFx0XHRcdFx0XHRcdHN1YlN0ciArPSBzdHJbaV07XHJcblxyXG5cdFx0XHRcdFx0XHRcdGlmIChpID4gc3RyLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0YnJlYWsgc3RyTG9vcDtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdGlmIChlbmNsb3NpbmdMZXZlbCA9PT0gMCkge1xyXG5cdFx0XHRcdFx0XHRcdHN1YlN0cmluZ3MucHVzaChzdWJTdHIpO1xyXG5cdFx0XHRcdFx0XHRcdHN1YlN0ciA9ICcnO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRyZW1haW5pbmdDbG9zaW5nU3RyaW5nQ291bnQgLT0gMTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0aWYgKGVuY2xvc2luZ0xldmVsID49IDEpIHtcclxuXHRcdFx0XHRcdFx0c3ViU3RyICs9IHN0cltpXTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRpZiAoc3ViU3RyaW5ncy5sZW5ndGggPT09IDApIHtcclxuXHRcdFx0cmV0dXJuICcnO1xyXG5cdFx0fSBlbHNlIGlmIChzdWJTdHJpbmdzLmxlbmd0aCA9PT0gMSkge1xyXG5cdFx0XHRyZXR1cm4gc3ViU3RyaW5nc1swXS5zdWJzdHJpbmcoZW5jbG9zaW5nUGFpci5vcGVuaW5nU3RyaW5nLmxlbmd0aCwgc3ViU3RyaW5nc1swXS5sZW5ndGggLSBlbmNsb3NpbmdQYWlyLmNsb3NpbmdTdHJpbmcubGVuZ3RoKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHJldHVybiBzdWJTdHJpbmdzLm1hcCh4ID0+IHguc3Vic3RyaW5nKGVuY2xvc2luZ1BhaXIub3BlbmluZ1N0cmluZy5sZW5ndGgsIHgubGVuZ3RoIC0gZW5jbG9zaW5nUGFpci5jbG9zaW5nU3RyaW5nLmxlbmd0aCkpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0c3RhdGljIGlzU3RyaW5nQXQoc3RyOiBzdHJpbmcsIHN1YlN0cjogc3RyaW5nLCBpbmRleDogbnVtYmVyKTogYm9vbGVhbiB7XHJcblx0XHRpZiAoaW5kZXggPCAwKSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ2luZGV4IG11c3QgYmUgZ3JlYXRlciB0aGFuIDAnKTtcclxuXHRcdH1cclxuXHRcdGlmIChpbmRleCA+PSBzdHIubGVuZ3RoKSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ2luZGV4IG91dCBvZiBib3VuZHMgb2Ygc3RyaW5nJyk7XHJcblx0XHR9XHJcblx0XHRpZiAoIXN0cikge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCdzdHJpbmcgbXVzdCBub3QgYmUgZW1wdHknKTtcclxuXHRcdH1cclxuXHRcdGlmICghc3ViU3RyKSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ3N1YiBzdHJpbmcgbXVzdCBub3QgYmUgZW1wdHknKTtcclxuXHRcdH1cclxuXHJcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHN1YlN0ci5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRpZiAoc3RyW2kgKyBpbmRleF0gIT09IHN1YlN0cltpXSkge1xyXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0cnVlO1xyXG5cdH1cclxuXHJcblx0c3RhdGljIGNvbnRhaW5zKHN0cjogc3RyaW5nLCBzdWJTdHI6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG5cdFx0cmV0dXJuIFBhcnNlclV0aWxzLm51bWJlck9mT2NjdXJyZW5jZXMoc3RyLCBzdWJTdHIpID4gMDtcclxuXHR9XHJcblxyXG5cdHN0YXRpYyBudW1iZXJPZk9jY3VycmVuY2VzKHN0cjogc3RyaW5nLCBzdWJTdHI6IHN0cmluZyk6IG51bWJlciB7XHJcblx0XHRpZiAoIXN0cikge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCdzdHJpbmcgbXVzdCBub3QgYmUgZW1wdHknKTtcclxuXHRcdH1cclxuXHRcdGlmICghc3ViU3RyKSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ3N1YiBzdHJpbmcgbXVzdCBub3QgYmUgZW1wdHknKTtcclxuXHRcdH1cclxuXHJcblx0XHRsZXQgb2NjdXJyZW5jZXMgPSAwO1xyXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0aWYgKFBhcnNlclV0aWxzLmlzU3RyaW5nQXQoc3RyLCBzdWJTdHIsIGkpKSB7XHJcblx0XHRcdFx0b2NjdXJyZW5jZXMgKz0gMTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBvY2N1cnJlbmNlcztcclxuXHR9XHJcbn1cclxuIiwgImltcG9ydCB7SW5wdXRGaWVsZEFyZ3VtZW50VHlwZSwgSW5wdXRGaWVsZFR5cGV9IGZyb20gXCIuLi9wYXJzZXJzL0lucHV0RmllbGREZWNsYXJhdGlvblBhcnNlclwiO1xyXG5cclxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEFic3RyYWN0SW5wdXRGaWVsZEFyZ3VtZW50IHtcclxuXHRpZGVudGlmaWVyOiBJbnB1dEZpZWxkQXJndW1lbnRUeXBlID0gSW5wdXRGaWVsZEFyZ3VtZW50VHlwZS5JTlZBTElEO1xyXG5cdGFsbG93ZWRJbnB1dEZpZWxkczogSW5wdXRGaWVsZFR5cGVbXSA9IFtdO1xyXG5cdHZhbHVlOiBhbnk7XHJcblx0cmVxdWlyZXNWYWx1ZTogYm9vbGVhbiA9IGZhbHNlO1xyXG5cdGFsbG93TXVsdGlwbGU6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcblx0YWJzdHJhY3QgcGFyc2VWYWx1ZSh2YWx1ZVN0cjogc3RyaW5nKTogdm9pZDtcclxuXHJcblx0aXNBbGxvd2VkKGlucHV0RmllbGRUeXBlOiBJbnB1dEZpZWxkVHlwZSk6IGJvb2xlYW4ge1xyXG5cdFx0aWYgKHRoaXMuYWxsb3dlZElucHV0RmllbGRzLmxlbmd0aCA9PT0gMCkge1xyXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcy5hbGxvd2VkSW5wdXRGaWVsZHMuY29udGFpbnMoaW5wdXRGaWVsZFR5cGUpO1xyXG5cdH1cclxuXHJcblx0Z2V0QWxsb3dlZElucHV0RmllbGRzQXNTdHJpbmcoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5hbGxvd2VkSW5wdXRGaWVsZHMubGVuZ3RoID09PSAwID8gJ2FsbCcgOiB0aGlzLmFsbG93ZWRJbnB1dEZpZWxkcy5qb2luKCcsICcpO1xyXG5cdH1cclxuXHJcbn1cclxuIiwgImltcG9ydCB7QWJzdHJhY3RJbnB1dEZpZWxkQXJndW1lbnR9IGZyb20gXCIuL0Fic3RyYWN0SW5wdXRGaWVsZEFyZ3VtZW50XCI7XHJcbmltcG9ydCB7SW5wdXRGaWVsZEFyZ3VtZW50VHlwZSwgSW5wdXRGaWVsZFR5cGV9IGZyb20gXCIuLi9wYXJzZXJzL0lucHV0RmllbGREZWNsYXJhdGlvblBhcnNlclwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIENsYXNzSW5wdXRGaWVsZEFyZ3VtZW50IGV4dGVuZHMgQWJzdHJhY3RJbnB1dEZpZWxkQXJndW1lbnQge1xyXG5cdGlkZW50aWZpZXI6IElucHV0RmllbGRBcmd1bWVudFR5cGUgPSBJbnB1dEZpZWxkQXJndW1lbnRUeXBlLkNMQVNTO1xyXG5cdGFsbG93ZWRJbnB1dEZpZWxkczogSW5wdXRGaWVsZFR5cGVbXSA9IFtdO1xyXG5cdHZhbHVlOiBzdHJpbmdbXSA9IFtdO1xyXG5cdHJlcXVpcmVzVmFsdWU6IGJvb2xlYW4gPSB0cnVlO1xyXG5cdGFsbG93TXVsdGlwbGU6IGJvb2xlYW4gPSB0cnVlO1xyXG5cclxuXHRwYXJzZVZhbHVlKHZhbHVlU3RyOiBzdHJpbmcpOiB2b2lkIHtcclxuXHRcdHRoaXMudmFsdWUgPSB2YWx1ZVN0ci5zcGxpdCgnICcpO1xyXG5cdH1cclxufVxyXG4iLCAiaW1wb3J0IHtBYnN0cmFjdElucHV0RmllbGRBcmd1bWVudH0gZnJvbSBcIi4vQWJzdHJhY3RJbnB1dEZpZWxkQXJndW1lbnRcIjtcclxuaW1wb3J0IHtJbnB1dEZpZWxkQXJndW1lbnRUeXBlLCBJbnB1dEZpZWxkVHlwZX0gZnJvbSBcIi4uL3BhcnNlcnMvSW5wdXRGaWVsZERlY2xhcmF0aW9uUGFyc2VyXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgQWRkTGFiZWxzSW5wdXRGaWVsZEFyZ3VtZW50IGV4dGVuZHMgQWJzdHJhY3RJbnB1dEZpZWxkQXJndW1lbnQge1xyXG5cdGlkZW50aWZpZXI6IElucHV0RmllbGRBcmd1bWVudFR5cGUgPSBJbnB1dEZpZWxkQXJndW1lbnRUeXBlLkFERF9MQUJFTFM7XHJcblx0YWxsb3dlZElucHV0RmllbGRzOiBJbnB1dEZpZWxkVHlwZVtdID0gW1xyXG5cdFx0SW5wdXRGaWVsZFR5cGUuU0xJREVSLFxyXG5cdF07XHJcblx0dmFsdWU6IGJvb2xlYW4gPSB0cnVlO1xyXG5cdHJlcXVpcmVzVmFsdWU6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHRhbGxvd011bHRpcGxlOiBib29sZWFuID0gZmFsc2U7XHJcblxyXG5cdHBhcnNlVmFsdWUodmFsdWVTdHI6IHN0cmluZyk6IHZvaWQge1xyXG5cdFx0dGhpcy52YWx1ZSA9ICh2YWx1ZVN0ci50b0xvd2VyQ2FzZSgpID09PSAndHJ1ZScpO1xyXG5cdH1cclxuXHJcbn1cclxuIiwgImltcG9ydCB7QWJzdHJhY3RJbnB1dEZpZWxkQXJndW1lbnR9IGZyb20gXCIuL0Fic3RyYWN0SW5wdXRGaWVsZEFyZ3VtZW50XCI7XHJcbmltcG9ydCB7SW5wdXRGaWVsZEFyZ3VtZW50VHlwZSwgSW5wdXRGaWVsZFR5cGV9IGZyb20gXCIuLi9wYXJzZXJzL0lucHV0RmllbGREZWNsYXJhdGlvblBhcnNlclwiO1xyXG5pbXBvcnQge01ldGFCaW5kUGFyc2luZ0Vycm9yfSBmcm9tIFwiLi4vdXRpbHMvVXRpbHNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBNaW5WYWx1ZUlucHV0RmllbGRBcmd1bWVudCBleHRlbmRzIEFic3RyYWN0SW5wdXRGaWVsZEFyZ3VtZW50IHtcclxuXHRpZGVudGlmaWVyOiBJbnB1dEZpZWxkQXJndW1lbnRUeXBlID0gSW5wdXRGaWVsZEFyZ3VtZW50VHlwZS5NSU5fVkFMVUU7XHJcblx0YWxsb3dlZElucHV0RmllbGRzOiBJbnB1dEZpZWxkVHlwZVtdID0gW1xyXG5cdFx0SW5wdXRGaWVsZFR5cGUuU0xJREVSLFxyXG5cdF07XHJcblx0dmFsdWU6IG51bWJlciA9IDA7XHJcblx0cmVxdWlyZXNWYWx1ZTogYm9vbGVhbiA9IHRydWU7XHJcblx0YWxsb3dNdWx0aXBsZTogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuXHRwYXJzZVZhbHVlKHZhbHVlU3RyOiBzdHJpbmcpOiB2b2lkIHtcclxuXHRcdHRoaXMudmFsdWUgPSBOdW1iZXIucGFyc2VJbnQodmFsdWVTdHIpO1xyXG5cdFx0aWYgKE51bWJlci5pc05hTih0aGlzLnZhbHVlKSkge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRQYXJzaW5nRXJyb3IoJ3ZhbHVlIG9mIGFyZ3VtZW50IFxcJ21pblZhbHVlXFwnIG11c3QgYmUgb2YgdHlwZSBudW1iZXInKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG59XHJcbiIsICJpbXBvcnQge0Fic3RyYWN0SW5wdXRGaWVsZEFyZ3VtZW50fSBmcm9tIFwiLi9BYnN0cmFjdElucHV0RmllbGRBcmd1bWVudFwiO1xyXG5pbXBvcnQge0lucHV0RmllbGRBcmd1bWVudFR5cGUsIElucHV0RmllbGRUeXBlfSBmcm9tIFwiLi4vcGFyc2Vycy9JbnB1dEZpZWxkRGVjbGFyYXRpb25QYXJzZXJcIjtcclxuaW1wb3J0IHtNZXRhQmluZFBhcnNpbmdFcnJvcn0gZnJvbSBcIi4uL3V0aWxzL1V0aWxzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgTWF4VmFsdWVJbnB1dEZpZWxkQXJndW1lbnQgZXh0ZW5kcyBBYnN0cmFjdElucHV0RmllbGRBcmd1bWVudCB7XHJcblx0aWRlbnRpZmllcjogSW5wdXRGaWVsZEFyZ3VtZW50VHlwZSA9IElucHV0RmllbGRBcmd1bWVudFR5cGUuTUFYX1ZBTFVFO1xyXG5cdGFsbG93ZWRJbnB1dEZpZWxkczogSW5wdXRGaWVsZFR5cGVbXSA9IFtcclxuXHRcdElucHV0RmllbGRUeXBlLlNMSURFUixcclxuXHRdO1xyXG5cdHZhbHVlOiBudW1iZXIgPSAxMDA7XHJcblx0cmVxdWlyZXNWYWx1ZTogYm9vbGVhbiA9IHRydWU7XHJcblx0YWxsb3dNdWx0aXBsZTogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuXHRwYXJzZVZhbHVlKHZhbHVlU3RyOiBzdHJpbmcpOiB2b2lkIHtcclxuXHRcdHRoaXMudmFsdWUgPSBOdW1iZXIucGFyc2VJbnQodmFsdWVTdHIpO1xyXG5cdFx0aWYgKE51bWJlci5pc05hTih0aGlzLnZhbHVlKSkge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRQYXJzaW5nRXJyb3IoJ3ZhbHVlIG9mIGFyZ3VtZW50IFxcJ21heFZhbHVlXFwnIG11c3QgYmUgb2YgdHlwZSBudW1iZXInKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG59XHJcbiIsICJpbXBvcnQge0Fic3RyYWN0SW5wdXRGaWVsZEFyZ3VtZW50fSBmcm9tIFwiLi9BYnN0cmFjdElucHV0RmllbGRBcmd1bWVudFwiO1xyXG5pbXBvcnQge0lucHV0RmllbGRBcmd1bWVudFR5cGUsIElucHV0RmllbGRUeXBlfSBmcm9tIFwiLi4vcGFyc2Vycy9JbnB1dEZpZWxkRGVjbGFyYXRpb25QYXJzZXJcIjtcclxuaW1wb3J0IHtNZXRhQmluZFBhcnNpbmdFcnJvcn0gZnJvbSBcIi4uL3V0aWxzL1V0aWxzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgT3B0aW9uSW5wdXRGaWVsZEFyZ3VtZW50IGV4dGVuZHMgQWJzdHJhY3RJbnB1dEZpZWxkQXJndW1lbnQge1xyXG5cdGlkZW50aWZpZXI6IElucHV0RmllbGRBcmd1bWVudFR5cGUgPSBJbnB1dEZpZWxkQXJndW1lbnRUeXBlLk9QVElPTjtcclxuXHRhbGxvd2VkSW5wdXRGaWVsZHM6IElucHV0RmllbGRUeXBlW10gPSBbXHJcblx0XHRJbnB1dEZpZWxkVHlwZS5TRUxFQ1QsXHJcblx0XHRJbnB1dEZpZWxkVHlwZS5NVUxUSV9TRUxFQ1QsXHJcblx0XTtcclxuXHR2YWx1ZTogc3RyaW5nID0gJyc7XHJcblx0cmVxdWlyZXNWYWx1ZTogYm9vbGVhbiA9IHRydWU7XHJcblx0YWxsb3dNdWx0aXBsZTogYm9vbGVhbiA9IHRydWU7XHJcblxyXG5cdHBhcnNlVmFsdWUodmFsdWVTdHI6IHN0cmluZyk6IHZvaWQge1xyXG5cdFx0dGhpcy52YWx1ZSA9IHZhbHVlU3RyO1xyXG5cdH1cclxuXHJcbn1cclxuIiwgImltcG9ydCB7QWJzdHJhY3RJbnB1dEZpZWxkQXJndW1lbnR9IGZyb20gXCIuL0Fic3RyYWN0SW5wdXRGaWVsZEFyZ3VtZW50XCI7XHJcbmltcG9ydCB7SW5wdXRGaWVsZEFyZ3VtZW50VHlwZSwgSW5wdXRGaWVsZFR5cGV9IGZyb20gXCIuLi9wYXJzZXJzL0lucHV0RmllbGREZWNsYXJhdGlvblBhcnNlclwiO1xyXG5pbXBvcnQge01ldGFCaW5kUGFyc2luZ0Vycm9yfSBmcm9tIFwiLi4vdXRpbHMvVXRpbHNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBUaXRsZUlucHV0RmllbGRBcmd1bWVudCBleHRlbmRzIEFic3RyYWN0SW5wdXRGaWVsZEFyZ3VtZW50IHtcclxuXHRpZGVudGlmaWVyOiBJbnB1dEZpZWxkQXJndW1lbnRUeXBlID0gSW5wdXRGaWVsZEFyZ3VtZW50VHlwZS5USVRMRTtcclxuXHRhbGxvd2VkSW5wdXRGaWVsZHM6IElucHV0RmllbGRUeXBlW10gPSBbXHJcblx0XHRJbnB1dEZpZWxkVHlwZS5TRUxFQ1QsXHJcblx0XHRJbnB1dEZpZWxkVHlwZS5NVUxUSV9TRUxFQ1QsXHJcblx0XTtcclxuXHR2YWx1ZTogc3RyaW5nID0gJyc7XHJcblx0cmVxdWlyZXNWYWx1ZTogYm9vbGVhbiA9IHRydWU7XHJcblx0YWxsb3dNdWx0aXBsZTogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuXHRwYXJzZVZhbHVlKHZhbHVlU3RyOiBzdHJpbmcpOiB2b2lkIHtcclxuXHRcdHRoaXMudmFsdWUgPSB2YWx1ZVN0cjtcclxuXHR9XHJcblxyXG59XHJcbiIsICJpbXBvcnQge0Fic3RyYWN0SW5wdXRGaWVsZEFyZ3VtZW50fSBmcm9tICcuL0Fic3RyYWN0SW5wdXRGaWVsZEFyZ3VtZW50JztcclxuaW1wb3J0IHtJbnB1dEZpZWxkQXJndW1lbnRUeXBlLCBJbnB1dEZpZWxkVHlwZX0gZnJvbSAnLi4vcGFyc2Vycy9JbnB1dEZpZWxkRGVjbGFyYXRpb25QYXJzZXInO1xyXG5cclxuZXhwb3J0IGNsYXNzIEFsaWduUmlnaHRJbnB1dEZpZWxkQXJndW1lbnQgZXh0ZW5kcyBBYnN0cmFjdElucHV0RmllbGRBcmd1bWVudCB7XHJcblx0aWRlbnRpZmllcjogSW5wdXRGaWVsZEFyZ3VtZW50VHlwZSA9IElucHV0RmllbGRBcmd1bWVudFR5cGUuQUxJR05fUklHSFQ7XHJcblx0YWxsb3dlZElucHV0RmllbGRzOiBJbnB1dEZpZWxkVHlwZVtdID0gW1xyXG5cdFx0SW5wdXRGaWVsZFR5cGUuREFURV9QSUNLRVIsXHJcblx0XTtcclxuXHR2YWx1ZTogYm9vbGVhbiA9IHRydWU7XHJcblx0cmVxdWlyZXNWYWx1ZTogYm9vbGVhbiA9IGZhbHNlO1xyXG5cdGFsbG93TXVsdGlwbGU6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcblx0cGFyc2VWYWx1ZSh2YWx1ZVN0cjogc3RyaW5nKTogdm9pZCB7XHJcblx0XHR0aGlzLnZhbHVlID0gKHZhbHVlU3RyLnRvTG93ZXJDYXNlKCkgPT09ICd0cnVlJyk7XHJcblx0fVxyXG59XHJcbiIsICJpbXBvcnQge0NsYXNzSW5wdXRGaWVsZEFyZ3VtZW50fSBmcm9tIFwiLi9DbGFzc0lucHV0RmllbGRBcmd1bWVudFwiO1xyXG5pbXBvcnQge01ldGFCaW5kUGFyc2luZ0Vycm9yfSBmcm9tIFwiLi4vdXRpbHMvVXRpbHNcIjtcclxuaW1wb3J0IHtJbnB1dEZpZWxkQXJndW1lbnRUeXBlfSBmcm9tIFwiLi4vcGFyc2Vycy9JbnB1dEZpZWxkRGVjbGFyYXRpb25QYXJzZXJcIjtcclxuaW1wb3J0IHtBZGRMYWJlbHNJbnB1dEZpZWxkQXJndW1lbnR9IGZyb20gXCIuL0FkZExhYmVsc0lucHV0RmllbGRBcmd1bWVudFwiO1xyXG5pbXBvcnQge01pblZhbHVlSW5wdXRGaWVsZEFyZ3VtZW50fSBmcm9tIFwiLi9NaW5WYWx1ZUlucHV0RmllbGRBcmd1bWVudFwiO1xyXG5pbXBvcnQge01heFZhbHVlSW5wdXRGaWVsZEFyZ3VtZW50fSBmcm9tIFwiLi9NYXhWYWx1ZUlucHV0RmllbGRBcmd1bWVudFwiO1xyXG5pbXBvcnQge09wdGlvbklucHV0RmllbGRBcmd1bWVudH0gZnJvbSBcIi4vT3B0aW9uSW5wdXRGaWVsZEFyZ3VtZW50XCI7XHJcbmltcG9ydCB7VGl0bGVJbnB1dEZpZWxkQXJndW1lbnR9IGZyb20gXCIuL1RpdGxlSW5wdXRGaWVsZEFyZ3VtZW50XCI7XHJcbmltcG9ydCB7QWxpZ25SaWdodElucHV0RmllbGRBcmd1bWVudH0gZnJvbSAnLi9BbGlnblJpZ2h0SW5wdXRGaWVsZEFyZ3VtZW50JztcclxuXHJcblxyXG5leHBvcnQgY2xhc3MgSW5wdXRGaWVsZEFyZ3VtZW50RmFjdG9yeSB7XHJcblx0c3RhdGljIGNyZWF0ZUlucHV0RmllbGRBcmd1bWVudChhcmd1bWVudElkZW50aWZpZXI6IHN0cmluZykge1xyXG5cdFx0aWYgKGFyZ3VtZW50SWRlbnRpZmllciA9PT0gSW5wdXRGaWVsZEFyZ3VtZW50VHlwZS5DTEFTUykge1xyXG5cdFx0XHRyZXR1cm4gbmV3IENsYXNzSW5wdXRGaWVsZEFyZ3VtZW50KCk7XHJcblx0XHR9IGVsc2UgaWYgKGFyZ3VtZW50SWRlbnRpZmllciA9PT0gSW5wdXRGaWVsZEFyZ3VtZW50VHlwZS5BRERfTEFCRUxTKSB7XHJcblx0XHRcdHJldHVybiBuZXcgQWRkTGFiZWxzSW5wdXRGaWVsZEFyZ3VtZW50KCk7XHJcblx0XHR9IGVsc2UgaWYgKGFyZ3VtZW50SWRlbnRpZmllciA9PT0gSW5wdXRGaWVsZEFyZ3VtZW50VHlwZS5NSU5fVkFMVUUpIHtcclxuXHRcdFx0cmV0dXJuIG5ldyBNaW5WYWx1ZUlucHV0RmllbGRBcmd1bWVudCgpO1xyXG5cdFx0fSBlbHNlIGlmIChhcmd1bWVudElkZW50aWZpZXIgPT09IElucHV0RmllbGRBcmd1bWVudFR5cGUuTUFYX1ZBTFVFKSB7XHJcblx0XHRcdHJldHVybiBuZXcgTWF4VmFsdWVJbnB1dEZpZWxkQXJndW1lbnQoKTtcclxuXHRcdH0gZWxzZSBpZiAoYXJndW1lbnRJZGVudGlmaWVyID09PSBJbnB1dEZpZWxkQXJndW1lbnRUeXBlLk9QVElPTikge1xyXG5cdFx0XHRyZXR1cm4gbmV3IE9wdGlvbklucHV0RmllbGRBcmd1bWVudCgpO1xyXG5cdFx0fSBlbHNlIGlmIChhcmd1bWVudElkZW50aWZpZXIgPT09IElucHV0RmllbGRBcmd1bWVudFR5cGUuVElUTEUpIHtcclxuXHRcdFx0cmV0dXJuIG5ldyBUaXRsZUlucHV0RmllbGRBcmd1bWVudCgpO1xyXG5cdFx0fSBlbHNlIGlmIChhcmd1bWVudElkZW50aWZpZXIgPT09IElucHV0RmllbGRBcmd1bWVudFR5cGUuQUxJR05fUklHSFQpIHtcclxuXHRcdFx0cmV0dXJuIG5ldyBBbGlnblJpZ2h0SW5wdXRGaWVsZEFyZ3VtZW50KCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRQYXJzaW5nRXJyb3IoYHVua25vd24gYXJndW1lbnQgXFwnJHthcmd1bWVudElkZW50aWZpZXJ9XFwnYCk7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcbiIsICJpbXBvcnQge0Fic3RyYWN0SW5wdXRGaWVsZEFyZ3VtZW50fSBmcm9tIFwiLi9BYnN0cmFjdElucHV0RmllbGRBcmd1bWVudFwiO1xyXG5pbXBvcnQge0lucHV0RmllbGRBcmd1bWVudFR5cGV9IGZyb20gXCIuLi9wYXJzZXJzL0lucHV0RmllbGREZWNsYXJhdGlvblBhcnNlclwiO1xyXG5pbXBvcnQge01ldGFCaW5kUGFyc2luZ0Vycm9yfSBmcm9tIFwiLi4vdXRpbHMvVXRpbHNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBJbnB1dEZpZWxkQXJndW1lbnRDb250YWluZXIge1xyXG5cdGFyZ3VtZW50czogQWJzdHJhY3RJbnB1dEZpZWxkQXJndW1lbnRbXSA9IFtdO1xyXG5cclxuXHRhZGQoYXJndW1lbnQ6IEFic3RyYWN0SW5wdXRGaWVsZEFyZ3VtZW50KTogdm9pZCB7XHJcblx0XHR0aGlzLmFyZ3VtZW50cy5wdXNoKGFyZ3VtZW50KTtcclxuXHR9XHJcblxyXG5cdHZhbGlkYXRlKCk6IHZvaWQge1xyXG5cdFx0bGV0IG1hcDogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xyXG5cdFx0Zm9yIChjb25zdCBpbnB1dEZpZWxkQXJndW1lbnRUeXBlIG9mIE9iamVjdC52YWx1ZXMoSW5wdXRGaWVsZEFyZ3VtZW50VHlwZSkpIHtcclxuXHRcdFx0bWFwW2lucHV0RmllbGRBcmd1bWVudFR5cGVdID0gMDtcclxuXHRcdH1cclxuXHJcblx0XHRmb3IgKGNvbnN0IGFyZ3VtZW50IG9mIHRoaXMuYXJndW1lbnRzKSB7XHJcblx0XHRcdG1hcFthcmd1bWVudC5pZGVudGlmaWVyXSArPSAxO1xyXG5cdFx0XHRpZiAobWFwW2FyZ3VtZW50LmlkZW50aWZpZXJdID4gMSAmJiAhYXJndW1lbnQuYWxsb3dNdWx0aXBsZSkge1xyXG5cdFx0XHRcdHRocm93IG5ldyBNZXRhQmluZFBhcnNpbmdFcnJvcihgYXJndW1lbnQgXFwnJHthcmd1bWVudC5pZGVudGlmaWVyfVxcJyBkb2VzIG5vdCBhbGxvdyBkdXBsaWNhdGVzYClcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogTWVyZ2VzIHR3byBJbnB1dEZpZWxkQXJndW1lbnRDb250YWluZXJzIGJ5IG92ZXJyaWRpbmcuXHJcblx0ICogVGhlIGFyZ3VtZW50cyBmb3JtIHRoZSBvdGhlciBjb250YWluZXIgdGFrZSBwcmlvcml0eS5cclxuXHQgKlxyXG5cdCAqIEBwYXJhbSBvdGhlclxyXG5cdCAqL1xyXG5cdG1lcmdlQnlPdmVycmlkZShvdGhlcjogSW5wdXRGaWVsZEFyZ3VtZW50Q29udGFpbmVyKTogSW5wdXRGaWVsZEFyZ3VtZW50Q29udGFpbmVyIHtcclxuXHRcdGZvciAoY29uc3QgYXJndW1lbnQgb2Ygb3RoZXIuYXJndW1lbnRzKSB7XHJcblx0XHRcdGlmICghYXJndW1lbnQuYWxsb3dNdWx0aXBsZSkge1xyXG5cdFx0XHRcdHRoaXMuYXJndW1lbnRzID0gdGhpcy5hcmd1bWVudHMuZmlsdGVyKHggPT4geC5pZGVudGlmaWVyICE9PSBhcmd1bWVudC5pZGVudGlmaWVyKTtcclxuXHRcdFx0fVxyXG5cdFx0XHR0aGlzLmFyZ3VtZW50cy5wdXNoKGFyZ3VtZW50KTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBzaG91bGQgbm90IGJlIG5lY2Vzc2FyeSBidXQgaXQgaXMgYmV0dGVyIHRvIGNoZWNrXHJcblx0XHR0aGlzLnZhbGlkYXRlKCk7XHJcblxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBNZXJnZXMgdHdvIElucHV0RmllbGRBcmd1bWVudENvbnRhaW5lcnMuXHJcblx0ICogSWYgdGhlcmUgaXMgYW4gYXJndW1lbnQgdGhhdCBkb2VzIG5vdCBhbGxvdyBkdXBsaWNhdGVzIGluIGJvdGggY29udGFpbmVycyB0aGlzIHdpbGwgdGhyb3cgYW4gZXJyb3IuXHJcblx0ICpcclxuXHQgKiBAcGFyYW0gb3RoZXJcclxuXHQgKi9cclxuXHRtZXJnZUJ5VGhyb3cob3RoZXI6IElucHV0RmllbGRBcmd1bWVudENvbnRhaW5lcik6IElucHV0RmllbGRBcmd1bWVudENvbnRhaW5lciB7XHJcblx0XHRmb3IgKGNvbnN0IGFyZ3VtZW50IG9mIG90aGVyLmFyZ3VtZW50cykge1xyXG5cdFx0XHRpZiAoIWFyZ3VtZW50LmFsbG93TXVsdGlwbGUpIHtcclxuXHRcdFx0XHRpZiAodGhpcy5hcmd1bWVudHMuZmlsdGVyKHggPT4geC5pZGVudGlmaWVyID09PSBhcmd1bWVudC5pZGVudGlmaWVyKS5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRQYXJzaW5nRXJyb3IoJ2NhbiBub3QgbWVyZ2UgSW5wdXRGaWVsZEFyZ3VtZW50Q29udGFpbmVycywgc2luY2UgYXJndW1lbnRzIG92ZXJsYXAnKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0dGhpcy5hcmd1bWVudHMucHVzaChhcmd1bWVudCk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gc2hvdWxkIG5vdCBiZSBuZWNlc3NhcnkgYnV0IGl0IGlzIGJldHRlciB0byBjaGVja1xyXG5cdFx0dGhpcy52YWxpZGF0ZSgpO1xyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH1cclxufVxyXG4iLCAiaW1wb3J0IHtFbmNsb3NpbmdQYWlyLCBQYXJzZXJVdGlsc30gZnJvbSAnLi4vdXRpbHMvUGFyc2VyVXRpbHMnO1xyXG5pbXBvcnQge2lzVHJ1dGh5LCBNZXRhQmluZFBhcnNpbmdFcnJvcn0gZnJvbSAnLi4vdXRpbHMvVXRpbHMnO1xyXG5pbXBvcnQge0Fic3RyYWN0SW5wdXRGaWVsZEFyZ3VtZW50fSBmcm9tIFwiLi4vaW5wdXRGaWVsZEFyZ3VtZW50cy9BYnN0cmFjdElucHV0RmllbGRBcmd1bWVudFwiO1xyXG5pbXBvcnQge0lucHV0RmllbGRBcmd1bWVudEZhY3Rvcnl9IGZyb20gXCIuLi9pbnB1dEZpZWxkQXJndW1lbnRzL0lucHV0RmllbGRBcmd1bWVudEZhY3RvcnlcIjtcclxuaW1wb3J0IHtJbnB1dEZpZWxkQXJndW1lbnRDb250YWluZXJ9IGZyb20gXCIuLi9pbnB1dEZpZWxkQXJndW1lbnRzL0lucHV0RmllbGRBcmd1bWVudENvbnRhaW5lclwiO1xyXG5cclxuZXhwb3J0IGVudW0gSW5wdXRGaWVsZFR5cGUge1xyXG5cdFRPR0dMRSA9ICd0b2dnbGUnLFxyXG5cdFNMSURFUiA9ICdzbGlkZXInLFxyXG5cdFRFWFQgPSAndGV4dCcsXHJcblx0VEVYVF9BUkVBID0gJ3RleHRfYXJlYScsXHJcblx0U0VMRUNUID0gJ3NlbGVjdCcsXHJcblx0TVVMVElfU0VMRUNUID0gJ211bHRpX3NlbGVjdCcsXHJcblx0REFURSA9ICdkYXRlJyxcclxuXHRUSU1FID0gJ3RpbWUnLFxyXG5cdERBVEVfUElDS0VSID0gJ2RhdGVfcGlja2VyJyxcclxuXHRJTlZBTElEID0gJ2ludmFsaWQnLFxyXG59XHJcblxyXG5leHBvcnQgZW51bSBJbnB1dEZpZWxkQXJndW1lbnRUeXBlIHtcclxuXHRDTEFTUyA9ICdjbGFzcycsXHJcblx0QUREX0xBQkVMUyA9ICdhZGRMYWJlbHMnLFxyXG5cdE1JTl9WQUxVRSA9ICdtaW5WYWx1ZScsXHJcblx0TUFYX1ZBTFVFID0gJ21heFZhbHVlJyxcclxuXHRPUFRJT04gPSAnb3B0aW9uJyxcclxuXHRUSVRMRSA9ICd0aXRsZScsXHJcblx0QUxJR05fUklHSFQgPSAnYWxpZ25SaWdodCcsXHJcblxyXG5cdElOVkFMSUQgPSAnaW52YWxpZCcsXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSW5wdXRGaWVsZERlY2xhcmF0aW9uIHtcclxuXHRmdWxsRGVjbGFyYXRpb246IHN0cmluZztcclxuXHRkZWNsYXJhdGlvbjogc3RyaW5nO1xyXG5cdGlucHV0RmllbGRUeXBlOiBJbnB1dEZpZWxkVHlwZTtcclxuXHRpc0JvdW5kOiBib29sZWFuO1xyXG5cdGJpbmRUYXJnZXQ6IHN0cmluZztcclxuXHJcblx0YXJndW1lbnRDb250YWluZXI6IElucHV0RmllbGRBcmd1bWVudENvbnRhaW5lcjtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBUZW1wbGF0ZSB7XHJcblx0aWRlbnRpZmllcjogc3RyaW5nO1xyXG5cdHRlbXBsYXRlOiBJbnB1dEZpZWxkRGVjbGFyYXRpb247XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBJbnB1dEZpZWxkRGVjbGFyYXRpb25QYXJzZXIge1xyXG5cdHN0YXRpYyByb3VuZEJyYWNlc1BhaXI6IEVuY2xvc2luZ1BhaXIgPSBuZXcgRW5jbG9zaW5nUGFpcignKCcsICcpJyk7XHJcblx0c3RhdGljIHNxdWFyZUJyYWNlc1BhaXI6IEVuY2xvc2luZ1BhaXIgPSBuZXcgRW5jbG9zaW5nUGFpcignWycsICddJyk7XHJcblx0c3RhdGljIGN1cmx5QnJhY2VzUGFpcjogRW5jbG9zaW5nUGFpciA9IG5ldyBFbmNsb3NpbmdQYWlyKCd7JywgJ30nKTtcclxuXHRzdGF0aWMgYWxsQnJhY2VzUGFpcnM6IEVuY2xvc2luZ1BhaXJbXSA9IFtcclxuXHRcdElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlci5yb3VuZEJyYWNlc1BhaXIsXHJcblx0XHRJbnB1dEZpZWxkRGVjbGFyYXRpb25QYXJzZXIuc3F1YXJlQnJhY2VzUGFpcixcclxuXHRcdElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlci5jdXJseUJyYWNlc1BhaXIsXHJcblx0XTtcclxuXHJcblx0c3RhdGljIHRlbXBsYXRlczogVGVtcGxhdGVbXSA9IFtdO1xyXG5cclxuXHJcblx0c3RhdGljIHBhcnNlKGZ1bGxEZWNsYXJhdGlvbjogc3RyaW5nKTogSW5wdXRGaWVsZERlY2xhcmF0aW9uIHtcclxuXHRcdGxldCBpbnB1dEZpZWxkRGVjbGFyYXRpb246IElucHV0RmllbGREZWNsYXJhdGlvbiA9IHt9IGFzIElucHV0RmllbGREZWNsYXJhdGlvbjtcclxuXHJcblx0XHRsZXQgdXNlVGVtcGxhdGUgPSBmYWxzZTtcclxuXHRcdGxldCB0ZW1wbGF0ZU5hbWUgPSAnJztcclxuXHJcblx0XHQvLyBkZWNsYXJhdGlvblxyXG5cdFx0aW5wdXRGaWVsZERlY2xhcmF0aW9uLmZ1bGxEZWNsYXJhdGlvbiA9IGZ1bGxEZWNsYXJhdGlvbjtcclxuXHRcdGNvbnN0IHRlbXAgPSBQYXJzZXJVdGlscy5nZXRJbkJldHdlZW4oZnVsbERlY2xhcmF0aW9uLCBJbnB1dEZpZWxkRGVjbGFyYXRpb25QYXJzZXIuc3F1YXJlQnJhY2VzUGFpcik7XHJcblx0XHRpZiAoQXJyYXkuaXNBcnJheSh0ZW1wKSkge1xyXG5cdFx0XHRpZiAodGVtcC5sZW5ndGggPT09IDIpIHtcclxuXHRcdFx0XHR1c2VUZW1wbGF0ZSA9IHRydWU7XHJcblx0XHRcdFx0dGVtcGxhdGVOYW1lID0gdGVtcFswXTtcclxuXHRcdFx0XHRpbnB1dEZpZWxkRGVjbGFyYXRpb24uZGVjbGFyYXRpb24gPSB0ZW1wWzFdO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHRocm93IG5ldyBNZXRhQmluZFBhcnNpbmdFcnJvcignaW52YWxpZCBpbnB1dCBmaWVsZCBkZWNsYXJhdGlvbicpO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRpbnB1dEZpZWxkRGVjbGFyYXRpb24uZGVjbGFyYXRpb24gPSB0ZW1wO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIGRlY2xhcmF0aW9uIHBhcnRzXHJcblx0XHRjb25zdCBkZWNsYXJhdGlvblBhcnRzOiBzdHJpbmdbXSA9IFBhcnNlclV0aWxzLnNwbGl0KGlucHV0RmllbGREZWNsYXJhdGlvbi5kZWNsYXJhdGlvbiwgJzonLCBJbnB1dEZpZWxkRGVjbGFyYXRpb25QYXJzZXIuc3F1YXJlQnJhY2VzUGFpcik7XHJcblxyXG5cdFx0Ly8gYmluZCB0YXJnZXRcclxuXHRcdGlucHV0RmllbGREZWNsYXJhdGlvbi5iaW5kVGFyZ2V0ID0gZGVjbGFyYXRpb25QYXJ0c1sxXSA/PyAnJztcclxuXHRcdGlucHV0RmllbGREZWNsYXJhdGlvbi5pc0JvdW5kID0gaXNUcnV0aHkoaW5wdXRGaWVsZERlY2xhcmF0aW9uLmJpbmRUYXJnZXQpO1xyXG5cclxuXHRcdC8vIGlucHV0IGZpZWxkIHR5cGUgYW5kIGFyZ3VtZW50c1xyXG5cdFx0Y29uc3QgaW5wdXRGaWVsZFR5cGVXaXRoQXJndW1lbnRzOiBzdHJpbmcgPSBkZWNsYXJhdGlvblBhcnRzWzBdO1xyXG5cdFx0aWYgKGlucHV0RmllbGRUeXBlV2l0aEFyZ3VtZW50cykge1xyXG5cdFx0XHQvLyBpbnB1dCBmaWVsZCB0eXBlXHJcblx0XHRcdGNvbnN0IGlucHV0RmllbGRUeXBlU3RyaW5nID0gUGFyc2VyVXRpbHMucmVtb3ZlSW5CZXR3ZWVuKGlucHV0RmllbGRUeXBlV2l0aEFyZ3VtZW50cywgSW5wdXRGaWVsZERlY2xhcmF0aW9uUGFyc2VyLnJvdW5kQnJhY2VzUGFpcik7XHJcblx0XHRcdGlucHV0RmllbGREZWNsYXJhdGlvbi5pbnB1dEZpZWxkVHlwZSA9IElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlci5nZXRJbnB1dEZpZWxkVHlwZShpbnB1dEZpZWxkVHlwZVN0cmluZyk7XHJcblxyXG5cdFx0XHQvLyBhcmd1bWVudHNcclxuXHRcdFx0Y29uc3QgaW5wdXRGaWVsZEFyZ3VtZW50c1N0cmluZzogc3RyaW5nID0gUGFyc2VyVXRpbHMuZ2V0SW5CZXR3ZWVuKGlucHV0RmllbGRUeXBlV2l0aEFyZ3VtZW50cywgSW5wdXRGaWVsZERlY2xhcmF0aW9uUGFyc2VyLnJvdW5kQnJhY2VzUGFpcikgYXMgc3RyaW5nO1xyXG5cdFx0XHQvLyBjb25zb2xlLmxvZyhpbnB1dEZpZWxkQXJndW1lbnRzU3RyaW5nKTtcclxuXHRcdFx0aWYgKGlucHV0RmllbGRBcmd1bWVudHNTdHJpbmcpIHtcclxuXHRcdFx0XHRpbnB1dEZpZWxkRGVjbGFyYXRpb24uYXJndW1lbnRDb250YWluZXIgPSBJbnB1dEZpZWxkRGVjbGFyYXRpb25QYXJzZXIucGFyc2VBcmd1bWVudHMoaW5wdXRGaWVsZEFyZ3VtZW50c1N0cmluZywgaW5wdXRGaWVsZERlY2xhcmF0aW9uLmlucHV0RmllbGRUeXBlKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRpbnB1dEZpZWxkRGVjbGFyYXRpb24uYXJndW1lbnRDb250YWluZXIgPSBuZXcgSW5wdXRGaWVsZEFyZ3VtZW50Q29udGFpbmVyKCk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGlucHV0RmllbGREZWNsYXJhdGlvbi5pbnB1dEZpZWxkVHlwZSA9IElucHV0RmllbGRUeXBlLklOVkFMSUQ7XHJcblx0XHRcdGlucHV0RmllbGREZWNsYXJhdGlvbi5hcmd1bWVudENvbnRhaW5lciA9IG5ldyBJbnB1dEZpZWxkQXJndW1lbnRDb250YWluZXIoKTtcclxuXHRcdH1cclxuXHJcblxyXG5cdFx0aWYgKHVzZVRlbXBsYXRlKSB7XHJcblx0XHRcdC8vIGNvbnNvbGUubG9nKHRlbXBsYXRlTmFtZSk7XHJcblx0XHRcdGNvbnN0IHRlbXBsYXRlID0gSW5wdXRGaWVsZERlY2xhcmF0aW9uUGFyc2VyLnRlbXBsYXRlcy5maWx0ZXIoeCA9PiB4LmlkZW50aWZpZXIgPT09IHRlbXBsYXRlTmFtZSkuZmlyc3QoKT8udGVtcGxhdGU7XHJcblx0XHRcdC8vIGNvbnNvbGUubG9nKHRlbXBsYXRlKTtcclxuXHRcdFx0aWYgKHRlbXBsYXRlKSB7XHJcblx0XHRcdFx0aW5wdXRGaWVsZERlY2xhcmF0aW9uLmJpbmRUYXJnZXQgPSBpbnB1dEZpZWxkRGVjbGFyYXRpb24uYmluZFRhcmdldCB8fCB0ZW1wbGF0ZS5iaW5kVGFyZ2V0O1xyXG5cdFx0XHRcdGlucHV0RmllbGREZWNsYXJhdGlvbi5pc0JvdW5kID0gaW5wdXRGaWVsZERlY2xhcmF0aW9uLmlzQm91bmQgfHwgdGVtcGxhdGUuaXNCb3VuZDtcclxuXHRcdFx0XHRpbnB1dEZpZWxkRGVjbGFyYXRpb24uaW5wdXRGaWVsZFR5cGUgPSBpbnB1dEZpZWxkRGVjbGFyYXRpb24uaW5wdXRGaWVsZFR5cGUgPT09IElucHV0RmllbGRUeXBlLklOVkFMSUQgPyB0ZW1wbGF0ZS5pbnB1dEZpZWxkVHlwZSA6IChpbnB1dEZpZWxkRGVjbGFyYXRpb24uaW5wdXRGaWVsZFR5cGUgfHwgdGVtcGxhdGUuaW5wdXRGaWVsZFR5cGUpO1xyXG5cdFx0XHRcdGlucHV0RmllbGREZWNsYXJhdGlvbi5hcmd1bWVudENvbnRhaW5lciA9IHRlbXBsYXRlLmFyZ3VtZW50Q29udGFpbmVyLm1lcmdlQnlPdmVycmlkZShpbnB1dEZpZWxkRGVjbGFyYXRpb24uYXJndW1lbnRDb250YWluZXIpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHRocm93IG5ldyBNZXRhQmluZFBhcnNpbmdFcnJvcihgdW5rbm93biB0ZW1wbGF0ZSBuYW1lIFxcJyR7dGVtcGxhdGVOYW1lfVxcJ2ApO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKGlucHV0RmllbGREZWNsYXJhdGlvbi5pbnB1dEZpZWxkVHlwZSA9PT0gSW5wdXRGaWVsZFR5cGUuSU5WQUxJRCkge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRQYXJzaW5nRXJyb3IoYHVua25vd24gaW5wdXQgZmllbGQgdHlwZWApO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBpbnB1dEZpZWxkRGVjbGFyYXRpb247XHJcblx0fVxyXG5cclxuXHRzdGF0aWMgcGFyc2VUZW1wbGF0ZXModGVtcGxhdGVzOiBzdHJpbmcpOiB2b2lkIHtcclxuXHRcdGxldCB0ZW1wbGF0ZURlY2xhcmF0aW9ucyA9IHRlbXBsYXRlcyA/IFBhcnNlclV0aWxzLnNwbGl0KHRlbXBsYXRlcywgJ1xcbicsIElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlci5zcXVhcmVCcmFjZXNQYWlyKSA6IFtdO1xyXG5cdFx0dGVtcGxhdGVEZWNsYXJhdGlvbnMgPSB0ZW1wbGF0ZURlY2xhcmF0aW9ucy5tYXAoeCA9PiB4LnRyaW0oKSkuZmlsdGVyKHggPT4geC5sZW5ndGggPiAwKTtcclxuXHJcblx0XHRmb3IgKGNvbnN0IHRlbXBsYXRlRGVjbGFyYXRpb24gb2YgdGVtcGxhdGVEZWNsYXJhdGlvbnMpIHtcclxuXHRcdFx0bGV0IHRlbXBsYXRlRGVjbGFyYXRpb25QYXJ0czogc3RyaW5nW10gPSBQYXJzZXJVdGlscy5zcGxpdCh0ZW1wbGF0ZURlY2xhcmF0aW9uLCAnLT4nLCBJbnB1dEZpZWxkRGVjbGFyYXRpb25QYXJzZXIuc3F1YXJlQnJhY2VzUGFpcik7XHJcblx0XHRcdHRlbXBsYXRlRGVjbGFyYXRpb25QYXJ0cyA9IHRlbXBsYXRlRGVjbGFyYXRpb25QYXJ0cy5tYXAoeCA9PiB4LnRyaW0oKSk7XHJcblxyXG5cdFx0XHRpZiAodGVtcGxhdGVEZWNsYXJhdGlvblBhcnRzLmxlbmd0aCA9PT0gMSkge1xyXG5cdFx0XHRcdHRocm93IG5ldyBNZXRhQmluZFBhcnNpbmdFcnJvcignSW52YWxpZCB0ZW1wbGF0ZSBzeW50YXgnKTtcclxuXHRcdFx0fSBlbHNlIGlmICh0ZW1wbGF0ZURlY2xhcmF0aW9uUGFydHMubGVuZ3RoID09PSAyKSB7XHJcblx0XHRcdFx0SW5wdXRGaWVsZERlY2xhcmF0aW9uUGFyc2VyLnRlbXBsYXRlcy5wdXNoKHtcclxuXHRcdFx0XHRcdGlkZW50aWZpZXI6IHRlbXBsYXRlRGVjbGFyYXRpb25QYXJ0c1swXSxcclxuXHRcdFx0XHRcdHRlbXBsYXRlOiBJbnB1dEZpZWxkRGVjbGFyYXRpb25QYXJzZXIucGFyc2UodGVtcGxhdGVEZWNsYXJhdGlvblBhcnRzWzFdKSxcclxuXHRcdFx0XHR9KVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc29sZS5sb2coSW5wdXRGaWVsZERlY2xhcmF0aW9uUGFyc2VyLnRlbXBsYXRlcyk7XHJcblx0fVxyXG5cclxuXHRzdGF0aWMgcGFyc2VBcmd1bWVudHMoaW5wdXRGaWVsZEFyZ3VtZW50c1N0cmluZzogc3RyaW5nLCBpbnB1dEZpZWxkVHlwZTogSW5wdXRGaWVsZFR5cGUpOiBJbnB1dEZpZWxkQXJndW1lbnRDb250YWluZXIge1xyXG5cdFx0Ly8gY29uc29sZS5sb2coJ2lucHV0RmllbGRBcmd1bWVudHNTdHJpbmcnLCBpbnB1dEZpZWxkQXJndW1lbnRzU3RyaW5nKTtcclxuXHRcdGxldCBpbnB1dEZpZWxkQXJndW1lbnRTdHJpbmdzOiBzdHJpbmdbXSA9IFBhcnNlclV0aWxzLnNwbGl0KGlucHV0RmllbGRBcmd1bWVudHNTdHJpbmcsICcsJywgSW5wdXRGaWVsZERlY2xhcmF0aW9uUGFyc2VyLnJvdW5kQnJhY2VzUGFpcik7XHJcblx0XHRpbnB1dEZpZWxkQXJndW1lbnRTdHJpbmdzID0gaW5wdXRGaWVsZEFyZ3VtZW50U3RyaW5ncy5tYXAoeCA9PiB4LnRyaW0oKSk7XHJcblxyXG5cdFx0Y29uc3QgaW5wdXRGaWVsZEFyZ3VtZW50Q29udGFpbmVyOiBJbnB1dEZpZWxkQXJndW1lbnRDb250YWluZXIgPSBuZXcgSW5wdXRGaWVsZEFyZ3VtZW50Q29udGFpbmVyKCk7XHJcblxyXG5cdFx0Zm9yIChjb25zdCBpbnB1dEZpZWxkQXJndW1lbnRTdHJpbmcgb2YgaW5wdXRGaWVsZEFyZ3VtZW50U3RyaW5ncykge1xyXG5cdFx0XHRjb25zdCBpbnB1dEZpZWxkQXJndW1lbnRJZGVudGlmaWVyOiBzdHJpbmcgPSBJbnB1dEZpZWxkRGVjbGFyYXRpb25QYXJzZXIuZXh0cmFjdElucHV0RmllbGRBcmd1bWVudElkZW50aWZpZXIoaW5wdXRGaWVsZEFyZ3VtZW50U3RyaW5nKTtcclxuXHRcdFx0Ly8gY29uc29sZS5sb2coaW5wdXRGaWVsZEFyZ3VtZW50SWRlbnRpZmllcik7XHJcblxyXG5cdFx0XHRjb25zdCBpbnB1dEZpZWxkQXJndW1lbnQgPSBJbnB1dEZpZWxkQXJndW1lbnRGYWN0b3J5LmNyZWF0ZUlucHV0RmllbGRBcmd1bWVudChpbnB1dEZpZWxkQXJndW1lbnRJZGVudGlmaWVyKTtcclxuXHJcblx0XHRcdGlmICghaW5wdXRGaWVsZEFyZ3VtZW50LmlzQWxsb3dlZChpbnB1dEZpZWxkVHlwZSkpIHtcclxuXHRcdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRQYXJzaW5nRXJyb3IoYGFyZ3VtZW50IFxcJyR7aW5wdXRGaWVsZEFyZ3VtZW50SWRlbnRpZmllcn1cXCcgaXMgb25seSBhcHBsaWNhYmxlIHRvICR7aW5wdXRGaWVsZEFyZ3VtZW50LmdldEFsbG93ZWRJbnB1dEZpZWxkc0FzU3RyaW5nKCl9IGlucHV0IGZpZWxkc2ApO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZiAoaW5wdXRGaWVsZEFyZ3VtZW50LnJlcXVpcmVzVmFsdWUpIHtcclxuXHRcdFx0XHRpbnB1dEZpZWxkQXJndW1lbnQucGFyc2VWYWx1ZShJbnB1dEZpZWxkRGVjbGFyYXRpb25QYXJzZXIuZXh0cmFjdElucHV0RmllbGRBcmd1bWVudFZhbHVlKGlucHV0RmllbGRBcmd1bWVudFN0cmluZykpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpbnB1dEZpZWxkQXJndW1lbnRDb250YWluZXIuYWRkKGlucHV0RmllbGRBcmd1bWVudCk7XHJcblx0XHR9XHJcblxyXG5cdFx0aW5wdXRGaWVsZEFyZ3VtZW50Q29udGFpbmVyLnZhbGlkYXRlKCk7XHJcblxyXG5cdFx0cmV0dXJuIGlucHV0RmllbGRBcmd1bWVudENvbnRhaW5lcjtcclxuXHR9XHJcblxyXG5cdHN0YXRpYyBleHRyYWN0SW5wdXRGaWVsZEFyZ3VtZW50SWRlbnRpZmllcihhcmd1bWVudFN0cmluZzogc3RyaW5nKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiBQYXJzZXJVdGlscy5yZW1vdmVJbkJldHdlZW4oYXJndW1lbnRTdHJpbmcsIElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlci5yb3VuZEJyYWNlc1BhaXIpO1xyXG5cdH1cclxuXHJcblx0c3RhdGljIGV4dHJhY3RJbnB1dEZpZWxkQXJndW1lbnRWYWx1ZShhcmd1bWVudFN0cmluZzogc3RyaW5nKTogc3RyaW5nIHtcclxuXHRcdGNvbnN0IGFyZ3VtZW50TmFtZSA9IHRoaXMuZXh0cmFjdElucHV0RmllbGRBcmd1bWVudElkZW50aWZpZXIoYXJndW1lbnRTdHJpbmcpO1xyXG5cclxuXHRcdGNvbnN0IGFyZ3VtZW50VmFsdWUgPSBQYXJzZXJVdGlscy5nZXRJbkJldHdlZW4oYXJndW1lbnRTdHJpbmcsIElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlci5yb3VuZEJyYWNlc1BhaXIpIGFzIHN0cmluZztcclxuXHRcdGlmICghYXJndW1lbnRWYWx1ZSkge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRQYXJzaW5nRXJyb3IoYGFyZ3VtZW50IFxcJyR7YXJndW1lbnROYW1lfVxcJyByZXF1aXJlcyBhIG5vbiBlbXB0eSB2YWx1ZWApO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBhcmd1bWVudFZhbHVlO1xyXG5cdH1cclxuXHJcblx0c3RhdGljIGdldElucHV0RmllbGRUeXBlKHN0cjogc3RyaW5nKTogSW5wdXRGaWVsZFR5cGUge1xyXG5cdFx0Zm9yIChjb25zdCBlbnRyeSBvZiBPYmplY3QuZW50cmllcyhJbnB1dEZpZWxkVHlwZSkpIHtcclxuXHRcdFx0aWYgKGVudHJ5WzFdID09PSBzdHIpIHtcclxuXHRcdFx0XHRyZXR1cm4gZW50cnlbMV07XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gSW5wdXRGaWVsZFR5cGUuSU5WQUxJRDtcclxuXHR9XHJcblxyXG59XHJcbiIsICJpbXBvcnQge0Fic3RyYWN0SW5wdXRGaWVsZH0gZnJvbSAnLi9BYnN0cmFjdElucHV0RmllbGQnO1xyXG5pbXBvcnQge1RleHRBcmVhQ29tcG9uZW50fSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7TG9nZ2VyfSBmcm9tICcuLi91dGlscy9Mb2dnZXInO1xyXG5pbXBvcnQge01ldGFCaW5kSW50ZXJuYWxFcnJvcn0gZnJvbSAnLi4vdXRpbHMvVXRpbHMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFRleHRBcmVhSW5wdXRGaWVsZCBleHRlbmRzIEFic3RyYWN0SW5wdXRGaWVsZCB7XHJcblx0dGV4dEFyZWFDb21wb25lbnQ6IFRleHRBcmVhQ29tcG9uZW50IHwgdW5kZWZpbmVkO1xyXG5cclxuXHRnZXRWYWx1ZSgpOiBhbnkge1xyXG5cdFx0aWYgKCF0aGlzLnRleHRBcmVhQ29tcG9uZW50KSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ3RleHQgYXJlYSBpbnB1dCBjb21wb25lbnQgaXMgdW5kZWZpbmVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMudGV4dEFyZWFDb21wb25lbnQuZ2V0VmFsdWUoKTtcclxuXHR9XHJcblxyXG5cdHNldFZhbHVlKHZhbHVlOiBhbnkpOiB2b2lkIHtcclxuXHRcdGlmICghdGhpcy50ZXh0QXJlYUNvbXBvbmVudCkge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCd0ZXh0IGFyZWEgaW5wdXQgY29tcG9uZW50IGlzIHVuZGVmaW5lZCcpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh2YWx1ZSAhPSBudWxsICYmIHR5cGVvZiB2YWx1ZSA9PSAnc3RyaW5nJykge1xyXG5cdFx0XHR0aGlzLnRleHRBcmVhQ29tcG9uZW50LnNldFZhbHVlKHZhbHVlKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdExvZ2dlci5sb2dXYXJuaW5nKGBjYW4gbm90IHNldCB2YWx1ZSBvZiB0ZXh0IGFyZWEgaW5wdXQgdG8gXFwnJHt2YWx1ZX1cXCdgKTtcclxuXHRcdFx0dGhpcy50ZXh0QXJlYUNvbXBvbmVudC5zZXRWYWx1ZSgnJyk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRpc0VxdWFsVmFsdWUodmFsdWU6IGFueSk6IGJvb2xlYW4ge1xyXG5cdFx0cmV0dXJuIHRoaXMuZ2V0VmFsdWUoKSA9PSB2YWx1ZTtcclxuXHR9XHJcblxyXG5cdGdldERlZmF1bHRWYWx1ZSgpOiBhbnkge1xyXG5cdFx0cmV0dXJuICcnO1xyXG5cdH1cclxuXHJcblx0Z2V0SHRtbEVsZW1lbnQoKTogSFRNTEVsZW1lbnQge1xyXG5cdFx0aWYgKCF0aGlzLnRleHRBcmVhQ29tcG9uZW50KSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ3RleHQgYXJlYSBpbnB1dCBjb21wb25lbnQgaXMgdW5kZWZpbmVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMudGV4dEFyZWFDb21wb25lbnQuaW5wdXRFbDtcclxuXHR9XHJcblxyXG5cdHJlbmRlcihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XHJcblx0XHRjb25zdCBjb21wb25lbnQgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQoY29udGFpbmVyKTtcclxuXHRcdGNvbXBvbmVudC5zZXRWYWx1ZSh0aGlzLmlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLmdldEluaXRpYWxWYWx1ZSgpKTtcclxuXHRcdGNvbXBvbmVudC5vbkNoYW5nZSh0aGlzLm9uVmFsdWVDaGFuZ2UpO1xyXG5cdFx0dGhpcy50ZXh0QXJlYUNvbXBvbmVudCA9IGNvbXBvbmVudDtcclxuXHR9XHJcblxyXG59XHJcbiIsICJpbXBvcnQge1NlbGVjdElucHV0RmllbGR9IGZyb20gJy4vU2VsZWN0SW5wdXRGaWVsZCc7XHJcblxyXG5leHBvcnQgY2xhc3MgU2VsZWN0SW5wdXRGaWVsZEVsZW1lbnQge1xyXG5cdHZhbHVlOiBzdHJpbmc7XHJcblx0c2VsZWN0SW5wdXRGaWVsZDogU2VsZWN0SW5wdXRGaWVsZDtcclxuXHRyZWFkb25seSBpZDogbnVtYmVyO1xyXG5cdGVsZW1lbnQ6IEhUTUxEaXZFbGVtZW50O1xyXG5cclxuXHRjc3NDbGFzczogc3RyaW5nO1xyXG5cdGFjdGl2ZUNsYXNzOiBzdHJpbmc7XHJcblx0aG92ZXJDbGFzczogc3RyaW5nO1xyXG5cclxuXHRwcml2YXRlIGFjdGl2ZTogYm9vbGVhbjtcclxuXHRwcml2YXRlIGhpZ2hsaWdodGVkOiBib29sZWFuO1xyXG5cclxuXHRjb25zdHJ1Y3Rvcih2YWx1ZTogc3RyaW5nLCBwYXJlbnRFbGVtZW50OiBIVE1MRWxlbWVudCwgaWQ6IG51bWJlciwgbXVsdGlTZWxlY3RJbnB1dEZpZWxkOiBTZWxlY3RJbnB1dEZpZWxkLCBhY3RpdmU6IGJvb2xlYW4gPSBmYWxzZSkge1xyXG5cdFx0dGhpcy52YWx1ZSA9IHZhbHVlO1xyXG5cdFx0dGhpcy5pZCA9IGlkO1xyXG5cdFx0dGhpcy5hY3RpdmUgPSBhY3RpdmU7XHJcblx0XHR0aGlzLmhpZ2hsaWdodGVkID0gZmFsc2U7XHJcblx0XHR0aGlzLnNlbGVjdElucHV0RmllbGQgPSBtdWx0aVNlbGVjdElucHV0RmllbGQ7XHJcblxyXG5cdFx0dGhpcy5jc3NDbGFzcyA9ICdtZXRhLWJpbmQtcGx1Z2luLXNlbGVjdC1pbnB1dC1lbGVtZW50JztcclxuXHRcdHRoaXMuYWN0aXZlQ2xhc3MgPSAnbWV0YS1iaW5kLXBsdWdpbi1zZWxlY3QtaW5wdXQtZWxlbWVudC1zZWxlY3RlZCc7XHJcblx0XHR0aGlzLmhvdmVyQ2xhc3MgPSAnbWV0YS1iaW5kLXBsdWdpbi1zZWxlY3QtaW5wdXQtZWxlbWVudC1ob3Zlcic7XHJcblxyXG5cdFx0dGhpcy5lbGVtZW50ID0gcGFyZW50RWxlbWVudC5jcmVhdGVEaXYoe2NsczogdGhpcy5jc3NDbGFzc30pO1xyXG5cdFx0dGhpcy5lbGVtZW50LmlkID0gdGhpcy5nZXRIVE1MSWQoKTtcclxuXHRcdHRoaXMuZWxlbWVudC5vbignY2xpY2snLCAnIycgKyB0aGlzLmdldEhUTUxJZCgpLCAoKSA9PiB7XHJcblx0XHRcdHRoaXMuc2V0QWN0aXZlKCF0aGlzLmFjdGl2ZSk7XHJcblx0XHRcdGlmICghdGhpcy5zZWxlY3RJbnB1dEZpZWxkLmFsbG93TXVsdGlTZWxlY3QpIHtcclxuXHRcdFx0XHR0aGlzLnNlbGVjdElucHV0RmllbGQuZGlzYWJsZUFsbE90aGVyRWxlbWVudHModGhpcy5pZCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0dGhpcy5lbGVtZW50Lm9uKCdtb3VzZWVudGVyJywgJyMnICsgdGhpcy5nZXRIVE1MSWQoKSwgKCkgPT4ge1xyXG5cdFx0XHR0aGlzLnNldEhpZ2hsaWdodGVkKHRydWUpO1xyXG5cdFx0fSk7XHJcblx0XHR0aGlzLmVsZW1lbnQub24oJ21vdXNlbGVhdmUnLCAnIycgKyB0aGlzLmdldEhUTUxJZCgpLCAoKSA9PiB7XHJcblx0XHRcdHRoaXMuc2V0SGlnaGxpZ2h0ZWQoZmFsc2UpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHRnZXRIVE1MSWQoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiBgbWV0YS1iaW5kLXNlbGVjdC1pbnB1dC1lbGVtZW50LSR7dGhpcy5zZWxlY3RJbnB1dEZpZWxkLmlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLnVpZH0tJHt0aGlzLmlkfWA7XHJcblx0fVxyXG5cclxuXHRpc0hpZ2hsaWdodGVkKCk6IGJvb2xlYW4ge1xyXG5cdFx0cmV0dXJuIHRoaXMuaGlnaGxpZ2h0ZWQ7XHJcblx0fVxyXG5cclxuXHRzZXRIaWdobGlnaHRlZCh2YWx1ZTogYm9vbGVhbik6IHZvaWQge1xyXG5cdFx0dGhpcy5oaWdobGlnaHRlZCA9IHZhbHVlO1xyXG5cdFx0aWYgKHRoaXMuaGlnaGxpZ2h0ZWQpIHtcclxuXHRcdFx0dGhpcy5hZGRDbGFzcyh0aGlzLmhvdmVyQ2xhc3MpO1xyXG5cdFx0XHR0aGlzLnNlbGVjdElucHV0RmllbGQuZGVIaWdobGlnaHRBbGxPdGhlckVsZW1lbnRzKHRoaXMuaWQpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhpcy5yZW1vdmVDbGFzcyh0aGlzLmhvdmVyQ2xhc3MpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0aXNBY3RpdmUoKTogYm9vbGVhbiB7XHJcblx0XHRyZXR1cm4gdGhpcy5hY3RpdmU7XHJcblx0fVxyXG5cclxuXHRzZXRBY3RpdmUoYWN0aXZlOiBib29sZWFuLCB1cGRhdGVQYXJlbnQ6IGJvb2xlYW4gPSB0cnVlKTogdm9pZCB7XHJcblx0XHR0aGlzLmFjdGl2ZSA9IGFjdGl2ZTtcclxuXHRcdHRoaXMudXBkYXRlKHVwZGF0ZVBhcmVudCk7XHJcblx0fVxyXG5cclxuXHR1cGRhdGUodXBkYXRlUGFyZW50OiBib29sZWFuKTogdm9pZCB7XHJcblx0XHRpZiAodGhpcy5hY3RpdmUpIHtcclxuXHRcdFx0dGhpcy5hZGRDbGFzcyh0aGlzLmFjdGl2ZUNsYXNzKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRoaXMucmVtb3ZlQ2xhc3ModGhpcy5hY3RpdmVDbGFzcyk7XHJcblx0XHR9XHJcblx0XHRpZiAodXBkYXRlUGFyZW50KSB7XHJcblx0XHRcdHRoaXMuc2VsZWN0SW5wdXRGaWVsZC5vbkNoYW5nZSgpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0YWRkQ2xhc3MoY3NzQ2xhc3M6IHN0cmluZyk6IHZvaWQge1xyXG5cdFx0aWYgKCF0aGlzLmVsZW1lbnQuaGFzQ2xhc3MoY3NzQ2xhc3MpKSB7XHJcblx0XHRcdHRoaXMuZWxlbWVudC5hZGRDbGFzcyhjc3NDbGFzcyk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRyZW1vdmVDbGFzcyhjc3NDbGFzczogc3RyaW5nKTogdm9pZCB7XHJcblx0XHRpZiAodGhpcy5lbGVtZW50Lmhhc0NsYXNzKGNzc0NsYXNzKSkge1xyXG5cdFx0XHR0aGlzLmVsZW1lbnQucmVtb3ZlQ2xhc3MoY3NzQ2xhc3MpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cmVuZGVyKCk6IHZvaWQge1xyXG5cdFx0dGhpcy5lbGVtZW50LmNyZWF0ZUVsKCdkaXYnLCB7dGV4dDogdGhpcy52YWx1ZX0pO1xyXG5cdH1cclxufVxyXG4iLCAiaW1wb3J0IHtBYnN0cmFjdElucHV0RmllbGR9IGZyb20gJy4vQWJzdHJhY3RJbnB1dEZpZWxkJztcclxuaW1wb3J0IHtTZWxlY3RJbnB1dEZpZWxkRWxlbWVudH0gZnJvbSAnLi9TZWxlY3RJbnB1dEZpZWxkRWxlbWVudCc7XHJcbmltcG9ydCB7TWV0YUJpbmRJbnRlcm5hbEVycm9yLCBtb2R9IGZyb20gJy4uL3V0aWxzL1V0aWxzJztcclxuaW1wb3J0IHtJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZH0gZnJvbSAnLi4vSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQnO1xyXG5pbXBvcnQge0lucHV0RmllbGRBcmd1bWVudFR5cGV9IGZyb20gXCIuLi9wYXJzZXJzL0lucHV0RmllbGREZWNsYXJhdGlvblBhcnNlclwiO1xyXG5pbXBvcnQge0Fic3RyYWN0SW5wdXRGaWVsZEFyZ3VtZW50fSBmcm9tIFwiLi4vaW5wdXRGaWVsZEFyZ3VtZW50cy9BYnN0cmFjdElucHV0RmllbGRBcmd1bWVudFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFNlbGVjdElucHV0RmllbGQgZXh0ZW5kcyBBYnN0cmFjdElucHV0RmllbGQge1xyXG5cdHN0YXRpYyBhbGxvd0lubGluZUNvZGVCbG9jazogYm9vbGVhbiA9IGZhbHNlO1xyXG5cdGVsZW1lbnRzOiBTZWxlY3RJbnB1dEZpZWxkRWxlbWVudFtdO1xyXG5cdGFsbG93TXVsdGlTZWxlY3Q6IGJvb2xlYW47XHJcblx0Y29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCB8IHVuZGVmaW5lZDtcclxuXHJcblx0Y29uc3RydWN0b3IoaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQ6IElucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLCBvblZhbHVlQ2hhbmdlOiAodmFsdWU6IGFueSkgPT4gKHZvaWQgfCBQcm9taXNlPHZvaWQ+KSkge1xyXG5cdFx0c3VwZXIoaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQsIG9uVmFsdWVDaGFuZ2UpO1xyXG5cdFx0dGhpcy5lbGVtZW50cyA9IFtdO1xyXG5cdFx0dGhpcy5hbGxvd011bHRpU2VsZWN0ID0gZmFsc2U7XHJcblx0fVxyXG5cclxuXHRnZXRIdG1sRWxlbWVudCgpOiBIVE1MRWxlbWVudCB7XHJcblx0XHRpZiAoIXRoaXMuY29udGFpbmVyKSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ3NlbGVjdCBpbnB1dCBjb250YWluZXIgaXMgdW5kZWZpbmVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMuY29udGFpbmVyO1xyXG5cdH1cclxuXHJcblx0Z2V0VmFsdWUoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiB0aGlzLmVsZW1lbnRzLmZpbHRlcih4ID0+IHguaXNBY3RpdmUoKSkuZmlyc3QoKT8udmFsdWUgPz8gJyc7XHJcblx0fVxyXG5cclxuXHRzZXRWYWx1ZSh2YWx1ZTogYW55KTogdm9pZCB7XHJcblx0XHRmb3IgKGNvbnN0IGVsZW1lbnQgb2YgdGhpcy5lbGVtZW50cykge1xyXG5cdFx0XHRpZiAodmFsdWUgPT09IGVsZW1lbnQudmFsdWUpIHtcclxuXHRcdFx0XHRlbGVtZW50LnNldEFjdGl2ZSh0cnVlLCBmYWxzZSk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0ZWxlbWVudC5zZXRBY3RpdmUoZmFsc2UsIGZhbHNlKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0aXNFcXVhbFZhbHVlKHZhbHVlOiBhbnkpOiBib29sZWFuIHtcclxuXHRcdHJldHVybiB0aGlzLmdldFZhbHVlKCkgPT0gdmFsdWU7XHJcblx0fVxyXG5cclxuXHRnZXREZWZhdWx0VmFsdWUoKTogYW55IHtcclxuXHRcdHJldHVybiAnJztcclxuXHR9XHJcblxyXG5cdG9uQ2hhbmdlKCk6IHZvaWQge1xyXG5cdFx0dGhpcy5vblZhbHVlQ2hhbmdlKHRoaXMuZ2V0VmFsdWUoKSk7XHJcblx0fVxyXG5cclxuXHRyZW5kZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xyXG5cdFx0Y29udGFpbmVyLmFkZENsYXNzKCdtZXRhLWJpbmQtcGx1Z2luLXNlbGVjdC1pbnB1dC1iZycpO1xyXG5cdFx0dGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XHJcblxyXG5cdFx0Y29uc3QgZWxlbWVudFdyYXBwZXIgPSBjb250YWluZXIuY3JlYXRlRGl2KHtjbHM6ICdtZXRhLWJpbmQtcGx1Z2luLXNlbGVjdC1pbnB1dC13cmFwcGVyJ30pO1xyXG5cclxuXHRcdGNvbnN0IHRpdGxlQXJndW1lbnQgPSB0aGlzLmlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLmdldEFyZ3VtZW50KElucHV0RmllbGRBcmd1bWVudFR5cGUuVElUTEUpO1xyXG5cdFx0aWYgKHRpdGxlQXJndW1lbnQpIHtcclxuXHRcdFx0ZWxlbWVudFdyYXBwZXIuY3JlYXRlRWwoJ2RpdicsIHt0ZXh0OiB0aXRsZUFyZ3VtZW50LnZhbHVlLCBjbHM6ICdtZXRhLWJpbmQtcGx1Z2luLXNlbGVjdC1pbnB1dC1oZWFkZXInfSk7XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3QgZWxlbWVudEFyZ3VtZW50czogQWJzdHJhY3RJbnB1dEZpZWxkQXJndW1lbnRbXSA9IHRoaXMuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQuZ2V0QXJndW1lbnRzKElucHV0RmllbGRBcmd1bWVudFR5cGUuT1BUSU9OKTtcclxuXHJcblx0XHRsZXQgaSA9IDA7XHJcblx0XHRmb3IgKGNvbnN0IGVsZW1lbnRBcmd1bWVudCBvZiBlbGVtZW50QXJndW1lbnRzKSB7XHJcblx0XHRcdGNvbnN0IHNlbGVjdElucHV0RmllbGRFbGVtZW50ID0gbmV3IFNlbGVjdElucHV0RmllbGRFbGVtZW50KGVsZW1lbnRBcmd1bWVudC52YWx1ZSwgZWxlbWVudFdyYXBwZXIsIGksIHRoaXMsIGZhbHNlKTtcclxuXHJcblx0XHRcdHRoaXMuZWxlbWVudHMucHVzaChzZWxlY3RJbnB1dEZpZWxkRWxlbWVudCk7XHJcblxyXG5cdFx0XHRzZWxlY3RJbnB1dEZpZWxkRWxlbWVudC5yZW5kZXIoKTtcclxuXHJcblx0XHRcdGkgKz0gMTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLnNldFZhbHVlKHRoaXMuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQuZ2V0SW5pdGlhbFZhbHVlKCkpO1xyXG5cdH1cclxuXHJcblx0ZGlzYWJsZUFsbE90aGVyRWxlbWVudHMoZWxlbWVudElkOiBudW1iZXIpOiB2b2lkIHtcclxuXHRcdGZvciAoY29uc3Qgc2VsZWN0TW9kYWxFbGVtZW50IG9mIHRoaXMuZWxlbWVudHMpIHtcclxuXHRcdFx0aWYgKHNlbGVjdE1vZGFsRWxlbWVudC5pZCAhPT0gZWxlbWVudElkKSB7XHJcblx0XHRcdFx0c2VsZWN0TW9kYWxFbGVtZW50LnNldEFjdGl2ZShmYWxzZSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGRlSGlnaGxpZ2h0QWxsT3RoZXJFbGVtZW50cyhlbGVtZW50SWQ6IG51bWJlcik6IHZvaWQge1xyXG5cdFx0Zm9yIChjb25zdCBzZWxlY3RNb2RhbEVsZW1lbnQgb2YgdGhpcy5lbGVtZW50cykge1xyXG5cdFx0XHRpZiAoc2VsZWN0TW9kYWxFbGVtZW50LmlkICE9PSBlbGVtZW50SWQpIHtcclxuXHRcdFx0XHRzZWxlY3RNb2RhbEVsZW1lbnQuc2V0SGlnaGxpZ2h0ZWQoZmFsc2UpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRhY3RpdmF0ZUhpZ2hsaWdodGVkKCk6IHZvaWQge1xyXG5cdFx0Zm9yIChjb25zdCBzZWxlY3RNb2RhbEVsZW1lbnQgb2YgdGhpcy5lbGVtZW50cykge1xyXG5cdFx0XHRpZiAoc2VsZWN0TW9kYWxFbGVtZW50LmlzSGlnaGxpZ2h0ZWQoKSkge1xyXG5cdFx0XHRcdHNlbGVjdE1vZGFsRWxlbWVudC5zZXRBY3RpdmUoIXNlbGVjdE1vZGFsRWxlbWVudC5pc0FjdGl2ZSgpKTtcclxuXHRcdFx0XHRpZiAoIXRoaXMuYWxsb3dNdWx0aVNlbGVjdCkge1xyXG5cdFx0XHRcdFx0dGhpcy5kaXNhYmxlQWxsT3RoZXJFbGVtZW50cyhzZWxlY3RNb2RhbEVsZW1lbnQuaWQpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0aGlnaGxpZ2h0VXAoKTogdm9pZCB7XHJcblx0XHRmb3IgKGNvbnN0IHNlbGVjdE1vZGFsRWxlbWVudCBvZiB0aGlzLmVsZW1lbnRzKSB7XHJcblx0XHRcdGlmIChzZWxlY3RNb2RhbEVsZW1lbnQuaXNIaWdobGlnaHRlZCgpKSB7XHJcblx0XHRcdFx0dGhpcy5nZXRQcmV2aW91c1NlbGVjdE1vZGFsRWxlbWVudChzZWxlY3RNb2RhbEVsZW1lbnQpPy5zZXRIaWdobGlnaHRlZCh0cnVlKTtcclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvLyBub3RoaW5nIGlzIGhpZ2hsaWdodGVkXHJcblx0XHR0aGlzLmVsZW1lbnRzLmF0KC0xKT8uc2V0SGlnaGxpZ2h0ZWQodHJ1ZSk7XHJcblx0fVxyXG5cclxuXHRoaWdobGlnaHREb3duKCk6IHZvaWQge1xyXG5cdFx0Zm9yIChjb25zdCBzZWxlY3RNb2RhbEVsZW1lbnQgb2YgdGhpcy5lbGVtZW50cykge1xyXG5cdFx0XHRpZiAoc2VsZWN0TW9kYWxFbGVtZW50LmlzSGlnaGxpZ2h0ZWQoKSkge1xyXG5cdFx0XHRcdHRoaXMuZ2V0TmV4dFNlbGVjdE1vZGFsRWxlbWVudChzZWxlY3RNb2RhbEVsZW1lbnQpPy5zZXRIaWdobGlnaHRlZCh0cnVlKTtcclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvLyBub3RoaW5nIGlzIGhpZ2hsaWdodGVkXHJcblx0XHR0aGlzLmVsZW1lbnRzLmF0KDApPy5zZXRIaWdobGlnaHRlZCh0cnVlKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgZ2V0TmV4dFNlbGVjdE1vZGFsRWxlbWVudChlbGVtZW50OiBTZWxlY3RJbnB1dEZpZWxkRWxlbWVudCk6IFNlbGVjdElucHV0RmllbGRFbGVtZW50IHwgdW5kZWZpbmVkIHtcclxuXHRcdGxldCBuZXh0SWQgPSBlbGVtZW50LmlkICsgMTtcclxuXHRcdG5leHRJZCA9IG1vZChuZXh0SWQsIHRoaXMuZWxlbWVudHMubGVuZ3RoKTtcclxuXHJcblx0XHRyZXR1cm4gdGhpcy5lbGVtZW50cy5maWx0ZXIoeCA9PiB4LmlkID09PSBuZXh0SWQpLmF0KDApO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBnZXRQcmV2aW91c1NlbGVjdE1vZGFsRWxlbWVudChlbGVtZW50OiBTZWxlY3RJbnB1dEZpZWxkRWxlbWVudCk6IFNlbGVjdElucHV0RmllbGRFbGVtZW50IHwgdW5kZWZpbmVkIHtcclxuXHRcdGxldCBuZXh0SWQgPSBlbGVtZW50LmlkIC0gMTtcclxuXHRcdG5leHRJZCA9IG1vZChuZXh0SWQsIHRoaXMuZWxlbWVudHMubGVuZ3RoKTtcclxuXHJcblx0XHRyZXR1cm4gdGhpcy5lbGVtZW50cy5maWx0ZXIoeCA9PiB4LmlkID09PSBuZXh0SWQpLmF0KDApO1xyXG5cdH1cclxufVxyXG4iLCAiaW1wb3J0IHtTZWxlY3RJbnB1dEZpZWxkfSBmcm9tICcuL1NlbGVjdElucHV0RmllbGQnO1xyXG5pbXBvcnQge0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkfSBmcm9tICcuLi9JbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCc7XHJcbmltcG9ydCB7YXJyYXlFcXVhbHN9IGZyb20gJy4uL3V0aWxzL1V0aWxzJztcclxuXHJcbmV4cG9ydCBjbGFzcyBNdWx0aVNlbGVjdElucHV0RmllbGQgZXh0ZW5kcyBTZWxlY3RJbnB1dEZpZWxkIHtcclxuXHJcblx0Y29uc3RydWN0b3IoaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQ6IElucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLCBvblZhbHVlQ2hhbmdlOiAodmFsdWU6IGFueSkgPT4gKHZvaWQgfCBQcm9taXNlPHZvaWQ+KSkge1xyXG5cdFx0c3VwZXIoaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQsIG9uVmFsdWVDaGFuZ2UpO1xyXG5cdFx0dGhpcy5hbGxvd011bHRpU2VsZWN0ID0gdHJ1ZTtcclxuXHR9XHJcblxyXG5cdGdldFZhbHVlKCk6IGFueSB7XHJcblx0XHRyZXR1cm4gdGhpcy5lbGVtZW50cy5maWx0ZXIoeCA9PiB4LmlzQWN0aXZlKCkpLm1hcCh4ID0+IHgudmFsdWUpO1xyXG5cdH1cclxuXHJcblx0c2V0VmFsdWUodmFsdWU6IHN0cmluZ1tdKTogdm9pZCB7XHJcblx0XHRpZiAodmFsdWUubGVuZ3RoID09PSAwKSB7XHJcblx0XHRcdGZvciAoY29uc3QgZWxlbWVudCBvZiB0aGlzLmVsZW1lbnRzKSB7XHJcblx0XHRcdFx0ZWxlbWVudC5zZXRBY3RpdmUoZmFsc2UsIGZhbHNlKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0ZWxlbWVudExvb3AgOiBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgdGhpcy5lbGVtZW50cykge1xyXG5cdFx0XHRmb3IgKGNvbnN0IHZhbHVlRWxlbWVudCBvZiB2YWx1ZSkge1xyXG5cdFx0XHRcdGlmICh2YWx1ZUVsZW1lbnQgPT09IGVsZW1lbnQudmFsdWUpIHtcclxuXHRcdFx0XHRcdGVsZW1lbnQuc2V0QWN0aXZlKHRydWUsIGZhbHNlKTtcclxuXHRcdFx0XHRcdGNvbnRpbnVlIGVsZW1lbnRMb29wO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRlbGVtZW50LnNldEFjdGl2ZShmYWxzZSwgZmFsc2UpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0aXNFcXVhbFZhbHVlKHZhbHVlOiBhbnkpOiBib29sZWFuIHtcclxuXHRcdGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBhcnJheUVxdWFscyh0aGlzLmdldFZhbHVlKCksIHZhbHVlKTtcclxuXHR9XHJcblxyXG5cdGdldERlZmF1bHRWYWx1ZSgpOiBzdHJpbmdbXSB7XHJcblx0XHRyZXR1cm4gW107XHJcblx0fVxyXG59XHJcbiIsICJpbXBvcnQge0Fic3RyYWN0SW5wdXRGaWVsZH0gZnJvbSAnLi9BYnN0cmFjdElucHV0RmllbGQnO1xyXG5pbXBvcnQge0Ryb3Bkb3duQ29tcG9uZW50LCBtb21lbnQsIFRleHRDb21wb25lbnR9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHtJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZH0gZnJvbSAnLi4vSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQnO1xyXG5pbXBvcnQge0RhdGVQYXJzZXJ9IGZyb20gJy4uL3BhcnNlcnMvRGF0ZVBhcnNlcic7XHJcbmltcG9ydCB7TWV0YUJpbmRJbnRlcm5hbEVycm9yfSBmcm9tICcuLi91dGlscy9VdGlscyc7XHJcblxyXG5leHBvcnQgY2xhc3MgRGF0ZUlucHV0RmllbGQgZXh0ZW5kcyBBYnN0cmFjdElucHV0RmllbGQge1xyXG5cdGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQgfCB1bmRlZmluZWQ7XHJcblx0ZGF0ZTogbW9tZW50Lk1vbWVudDtcclxuXHJcblx0bW9udGhzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xyXG5cdFx0JzAnOiAnSmFudWFyeScsXHJcblx0XHQnMSc6ICdGZWJydWFyeScsXHJcblx0XHQnMic6ICdNYXJjaCcsXHJcblx0XHQnMyc6ICdBcHJpbCcsXHJcblx0XHQnNCc6ICdNYXknLFxyXG5cdFx0JzUnOiAnSnVuZScsXHJcblx0XHQnNic6ICdKdWx5JyxcclxuXHRcdCc3JzogJ0F1Z3VzdCcsXHJcblx0XHQnOCc6ICdTZXB0ZW1iZXInLFxyXG5cdFx0JzknOiAnT2N0b2JlcicsXHJcblx0XHQnMTAnOiAnTm92ZW1iZXInLFxyXG5cdFx0JzExJzogJ0RlY2VtYmVyJyxcclxuXHR9O1xyXG5cdGRheXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XHJcblxyXG5cdG1vbnRoQ29tcG9uZW50OiBEcm9wZG93bkNvbXBvbmVudCB8IHVuZGVmaW5lZDtcclxuXHRkYXlDb21wb25lbnQ6IERyb3Bkb3duQ29tcG9uZW50IHwgdW5kZWZpbmVkO1xyXG5cdHllYXJDb21wb25lbnQ6IFRleHRDb21wb25lbnQgfCB1bmRlZmluZWQ7XHJcblxyXG5cclxuXHRjb25zdHJ1Y3RvcihpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZDogSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQsIG9uVmFsdWVDaGFuZ2U6ICh2YWx1ZTogYW55KSA9PiAodm9pZCB8IFByb21pc2U8dm9pZD4pKSB7XHJcblx0XHRzdXBlcihpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCwgb25WYWx1ZUNoYW5nZSk7XHJcblxyXG5cdFx0dGhpcy5kYXRlID0gRGF0ZVBhcnNlci5nZXREZWZhdWx0RGF0ZSgpO1xyXG5cclxuXHRcdHRoaXMuZGF5cyA9IHt9O1xyXG5cdFx0Zm9yIChsZXQgaSA9IDE7IGkgPD0gMzE7IGkrKykge1xyXG5cdFx0XHR0aGlzLmRheXNbaS50b1N0cmluZygpXSA9IGkudG9TdHJpbmcoKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRIdG1sRWxlbWVudCgpOiBIVE1MRWxlbWVudCB7XHJcblx0XHRpZiAoIXRoaXMuY29udGFpbmVyKSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ3RvZ2dsZSBpbnB1dCBjb250YWluZXIgaXMgdW5kZWZpbmVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMuY29udGFpbmVyO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldFZhbHVlKCk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gRGF0ZVBhcnNlci5zdHJpbmdpZnkodGhpcy5kYXRlKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzZXRWYWx1ZSh2YWx1ZTogc3RyaW5nKTogdm9pZCB7XHJcblx0XHRpZiAoIXRoaXMubW9udGhDb21wb25lbnQpIHtcclxuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcignZGF0ZSBpbnB1dCBtb250aCBjb21wb25lbnQgaXMgdW5kZWZpbmVkJyk7XHJcblx0XHR9XHJcblx0XHRpZiAoIXRoaXMuZGF5Q29tcG9uZW50KSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ2RhdGUgaW5wdXQgZGF5IGNvbXBvbmVudCBpcyB1bmRlZmluZWQnKTtcclxuXHRcdH1cclxuXHRcdGlmICghdGhpcy55ZWFyQ29tcG9uZW50KSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ2RhdGUgaW5wdXQgaG91ciBjb21wb25lbnQgaXMgdW5kZWZpbmVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5kYXRlID0gRGF0ZVBhcnNlci5wYXJzZSh2YWx1ZSkgPz8gRGF0ZVBhcnNlci5nZXREZWZhdWx0RGF0ZSgpO1xyXG5cclxuXHRcdGlmICghdGhpcy5kYXRlLmlzVmFsaWQoKSkge1xyXG5cdFx0XHR0aGlzLmRhdGUgPSBEYXRlUGFyc2VyLmdldERlZmF1bHREYXRlKCk7XHJcblx0XHRcdHRoaXMub25WYWx1ZUNoYW5nZSh0aGlzLmdldFZhbHVlKCkpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIGNvbnNvbGUubG9nKHRoaXMuZGF0ZSk7XHJcblx0XHR0aGlzLm1vbnRoQ29tcG9uZW50LnNldFZhbHVlKHRoaXMuZGF0ZS5tb250aCgpLnRvU3RyaW5nKCkpO1xyXG5cdFx0dGhpcy5kYXlDb21wb25lbnQuc2V0VmFsdWUodGhpcy5kYXRlLmRhdGUoKS50b1N0cmluZygpKTtcclxuXHRcdHRoaXMueWVhckNvbXBvbmVudC5zZXRWYWx1ZSh0aGlzLmRhdGUueWVhcigpLnRvU3RyaW5nKCkpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGlzRXF1YWxWYWx1ZSh2YWx1ZTogYW55KTogYm9vbGVhbiB7XHJcblx0XHRyZXR1cm4gdmFsdWUgPT0gdGhpcy5nZXRWYWx1ZSgpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldERlZmF1bHRWYWx1ZSgpOiBhbnkge1xyXG5cdFx0cmV0dXJuIERhdGVQYXJzZXIuc3RyaW5naWZ5KERhdGVQYXJzZXIuZ2V0RGVmYXVsdERhdGUoKSk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgcmVuZGVyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcclxuXHRcdHRoaXMuZGF0ZSA9IERhdGVQYXJzZXIucGFyc2UodGhpcy5pbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZC5nZXRJbml0aWFsVmFsdWUoKSkgPz8gRGF0ZVBhcnNlci5nZXREZWZhdWx0RGF0ZSgpO1xyXG5cdFx0aWYgKCF0aGlzLmRhdGUuaXNWYWxpZCgpKSB7XHJcblx0XHRcdHRoaXMuZGF0ZSA9IERhdGVQYXJzZXIuZ2V0RGVmYXVsdERhdGUoKTtcclxuXHRcdFx0dGhpcy5vblZhbHVlQ2hhbmdlKHRoaXMuZ2V0VmFsdWUoKSk7XHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IHVzZVVzSW5wdXRPcmRlciA9IHRoaXMuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQucGx1Z2luLnNldHRpbmdzLnVzZVVzRGF0ZUlucHV0T3JkZXI7XHJcblxyXG5cdFx0Y29udGFpbmVyLnJlbW92ZUNsYXNzKCdtZXRhLWJpbmQtcGx1Z2luLWlucHV0LXdyYXBwZXInKTtcclxuXHRcdGNvbnRhaW5lci5hZGRDbGFzcygnbWV0YS1iaW5kLXBsdWdpbi1mbGV4LWlucHV0LXdyYXBwZXInLCAnbWV0YS1iaW5kLXBsdWdpbi1pbnB1dC1lbGVtZW50LWdyb3VwJyk7XHJcblxyXG5cdFx0aWYgKCF1c2VVc0lucHV0T3JkZXIpIHtcclxuXHRcdFx0dGhpcy5kYXlDb21wb25lbnQgPSBuZXcgRHJvcGRvd25Db21wb25lbnQoY29udGFpbmVyKTtcclxuXHRcdFx0dGhpcy5kYXlDb21wb25lbnQuYWRkT3B0aW9ucyh0aGlzLmRheXMpO1xyXG5cdFx0XHR0aGlzLmRheUNvbXBvbmVudC5zZXRWYWx1ZSh0aGlzLmRhdGUuZGF0ZSgpLnRvU3RyaW5nKCkpO1xyXG5cdFx0XHR0aGlzLmRheUNvbXBvbmVudC5vbkNoYW5nZSh0aGlzLm9uRGF5Q2hhbmdlLmJpbmQodGhpcykpO1xyXG5cclxuXHRcdFx0dGhpcy5tb250aENvbXBvbmVudCA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChjb250YWluZXIpO1xyXG5cdFx0XHR0aGlzLm1vbnRoQ29tcG9uZW50LmFkZE9wdGlvbnModGhpcy5tb250aHMpO1xyXG5cdFx0XHR0aGlzLm1vbnRoQ29tcG9uZW50LnNldFZhbHVlKHRoaXMuZGF0ZS5tb250aCgpLnRvU3RyaW5nKCkpO1xyXG5cdFx0XHR0aGlzLm1vbnRoQ29tcG9uZW50Lm9uQ2hhbmdlKHRoaXMub25Nb250aENoYW5nZS5iaW5kKHRoaXMpKTtcclxuXHJcblx0XHRcdHRoaXMuZGF5Q29tcG9uZW50LnNlbGVjdEVsLmFkZENsYXNzKCdtZXRhLWJpbmQtcGx1Z2luLWlucHV0LWVsZW1lbnQtZ3JvdXAtZWxlbWVudCcpO1xyXG5cdFx0XHR0aGlzLm1vbnRoQ29tcG9uZW50LnNlbGVjdEVsLmFkZENsYXNzKCdtZXRhLWJpbmQtcGx1Z2luLWlucHV0LWVsZW1lbnQtZ3JvdXAtZWxlbWVudCcpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhpcy5tb250aENvbXBvbmVudCA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChjb250YWluZXIpO1xyXG5cdFx0XHR0aGlzLm1vbnRoQ29tcG9uZW50LmFkZE9wdGlvbnModGhpcy5tb250aHMpO1xyXG5cdFx0XHR0aGlzLm1vbnRoQ29tcG9uZW50LnNldFZhbHVlKHRoaXMuZGF0ZS5tb250aCgpLnRvU3RyaW5nKCkpO1xyXG5cdFx0XHR0aGlzLm1vbnRoQ29tcG9uZW50Lm9uQ2hhbmdlKHRoaXMub25Nb250aENoYW5nZS5iaW5kKHRoaXMpKTtcclxuXHJcblx0XHRcdHRoaXMuZGF5Q29tcG9uZW50ID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KGNvbnRhaW5lcik7XHJcblx0XHRcdHRoaXMuZGF5Q29tcG9uZW50LmFkZE9wdGlvbnModGhpcy5kYXlzKTtcclxuXHRcdFx0dGhpcy5kYXlDb21wb25lbnQuc2V0VmFsdWUodGhpcy5kYXRlLmRhdGUoKS50b1N0cmluZygpKTtcclxuXHRcdFx0dGhpcy5kYXlDb21wb25lbnQub25DaGFuZ2UodGhpcy5vbkRheUNoYW5nZS5iaW5kKHRoaXMpKTtcclxuXHJcblx0XHRcdHRoaXMuZGF5Q29tcG9uZW50LnNlbGVjdEVsLmFkZENsYXNzKCdtZXRhLWJpbmQtcGx1Z2luLWlucHV0LWVsZW1lbnQtZ3JvdXAtZWxlbWVudCcpO1xyXG5cdFx0XHR0aGlzLm1vbnRoQ29tcG9uZW50LnNlbGVjdEVsLmFkZENsYXNzKCdtZXRhLWJpbmQtcGx1Z2luLWlucHV0LWVsZW1lbnQtZ3JvdXAtZWxlbWVudCcpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMueWVhckNvbXBvbmVudCA9IG5ldyBUZXh0Q29tcG9uZW50KGNvbnRhaW5lcik7XHJcblx0XHR0aGlzLnllYXJDb21wb25lbnQuc2V0VmFsdWUodGhpcy5kYXRlLnllYXIoKS50b1N0cmluZygpKTtcclxuXHRcdHRoaXMueWVhckNvbXBvbmVudC5vbkNoYW5nZSh0aGlzLm9uWWVhckNoYW5nZS5iaW5kKHRoaXMpKTtcclxuXHJcblx0XHR0aGlzLnllYXJDb21wb25lbnQuaW5wdXRFbC5hZGRDbGFzcygnbWV0YS1iaW5kLXBsdWdpbi1kYXRlLWlucHV0LXllYXItaW5wdXQnKTtcclxuXHRcdHRoaXMueWVhckNvbXBvbmVudC5pbnB1dEVsLmFkZENsYXNzKCdtZXRhLWJpbmQtcGx1Z2luLWlucHV0LWVsZW1lbnQtZ3JvdXAtZWxlbWVudCcpO1xyXG5cdFx0dGhpcy55ZWFyQ29tcG9uZW50LmlucHV0RWwudHlwZSA9ICdudW1iZXInO1xyXG5cdFx0dGhpcy55ZWFyQ29tcG9uZW50LmlucHV0RWwubWF4ID0gJzk5OTknO1xyXG5cclxuXHRcdHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBvbk1vbnRoQ2hhbmdlKHZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcclxuXHRcdHRoaXMuZGF0ZS5tb250aCh2YWx1ZSk7XHJcblxyXG5cdFx0Y29uc3QgY2xhbXBlZERheSA9IHRoaXMuY2xhbXBEYXkodGhpcy5kYXRlLmRhdGUoKSk7XHJcblx0XHR0aGlzLmRheUNvbXBvbmVudD8uc2V0VmFsdWUoY2xhbXBlZERheS50b1N0cmluZygpKTtcclxuXHRcdHRoaXMuZGF0ZS5kYXRlKGNsYW1wZWREYXkpO1xyXG5cclxuXHRcdHRoaXMub25WYWx1ZUNoYW5nZSh0aGlzLmdldFZhbHVlKCkpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBvbkRheUNoYW5nZSh2YWx1ZTogc3RyaW5nKTogdm9pZCB7XHJcblx0XHRjb25zdCBkYXkgPSBOdW1iZXIucGFyc2VJbnQodmFsdWUpO1xyXG5cdFx0Y29uc3QgY2xhbXBlZERheSA9IHRoaXMuY2xhbXBEYXkoZGF5KTtcclxuXHRcdGlmIChjbGFtcGVkRGF5ICE9PSBkYXkpIHtcclxuXHRcdFx0dGhpcy5kYXlDb21wb25lbnQ/LnNldFZhbHVlKGNsYW1wZWREYXkudG9TdHJpbmcoKSk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5kYXRlLmRhdGUoY2xhbXBlZERheSk7XHJcblx0XHR0aGlzLm9uVmFsdWVDaGFuZ2UodGhpcy5nZXRWYWx1ZSgpKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgb25ZZWFyQ2hhbmdlKHZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcclxuXHRcdGNvbnN0IHllYXIgPSBOdW1iZXIucGFyc2VJbnQodmFsdWUpO1xyXG5cdFx0dGhpcy5kYXRlLnllYXIoTnVtYmVyLmlzTmFOKHllYXIpID8gRGF0ZVBhcnNlci5nZXREZWZhdWx0WWVhcigpIDogeWVhcik7XHJcblx0XHR0aGlzLm9uVmFsdWVDaGFuZ2UodGhpcy5nZXRWYWx1ZSgpKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgY2xhbXBEYXkoZGF5OiBudW1iZXIpOiBudW1iZXIge1xyXG5cdFx0aWYgKE51bWJlci5pc05hTihkYXkpKSB7XHJcblx0XHRcdHJldHVybiBEYXRlUGFyc2VyLmdldERlZmF1bHREYXkoKTtcclxuXHRcdH0gZWxzZSBpZiAoZGF5IDwgMSkge1xyXG5cdFx0XHRyZXR1cm4gMTtcclxuXHRcdH0gZWxzZSBpZiAoZGF5ID4gdGhpcy5kYXRlLmRheXNJbk1vbnRoKCkpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuZGF0ZS5kYXlzSW5Nb250aCgpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGRheTtcclxuXHR9XHJcblxyXG59XHJcbiIsICJpbXBvcnQge21vbWVudH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuZXhwb3J0IGNsYXNzIERhdGVQYXJzZXIge1xyXG5cdHB1YmxpYyBzdGF0aWMgZGF0ZUZvcm1hdDogc3RyaW5nO1xyXG5cclxuXHRwdWJsaWMgc3RhdGljIHN0cmluZ2lmeShkYXRlOiBtb21lbnQuTW9tZW50KTogc3RyaW5nIHtcclxuXHRcdHJldHVybiBkYXRlLmZvcm1hdCh0aGlzLmRhdGVGb3JtYXQpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHN0YXRpYyBwYXJzZShkYXRlU3RyaW5nOiBzdHJpbmcpOiBtb21lbnQuTW9tZW50IHtcclxuXHRcdHJldHVybiBtb21lbnQoZGF0ZVN0cmluZywgRGF0ZVBhcnNlci5kYXRlRm9ybWF0KTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzdGF0aWMgZ2V0RGVmYXVsdERhdGUoKTogbW9tZW50Lk1vbWVudCB7XHJcblx0XHRyZXR1cm4gbW9tZW50KG5ldyBEYXRlKERhdGVQYXJzZXIuZ2V0RGVmYXVsdFllYXIoKSwgRGF0ZVBhcnNlci5nZXREZWZhdWx0TW9udGgoKSwgRGF0ZVBhcnNlci5nZXREZWZhdWx0RGF5KCkpKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzdGF0aWMgZ2V0RGVmYXVsdERheSgpOiBudW1iZXIge1xyXG5cdFx0cmV0dXJuIDE7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc3RhdGljIGdldERlZmF1bHRNb250aCgpOiBudW1iZXIge1xyXG5cdFx0cmV0dXJuIDE7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc3RhdGljIGdldERlZmF1bHRZZWFyKCk6IG51bWJlciB7XHJcblx0XHRyZXR1cm4gMjAyMjtcclxuXHR9XHJcbn1cclxuIiwgImltcG9ydCB7QWJzdHJhY3RJbnB1dEZpZWxkfSBmcm9tICcuL0Fic3RyYWN0SW5wdXRGaWVsZCc7XHJcbmltcG9ydCB7RHJvcGRvd25Db21wb25lbnR9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHtJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZH0gZnJvbSAnLi4vSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQnO1xyXG5pbXBvcnQge1RpbWUsIFRpbWVQYXJzZXJ9IGZyb20gJy4uL3BhcnNlcnMvVGltZVBhcnNlcic7XHJcbmltcG9ydCB7TWV0YUJpbmRJbnRlcm5hbEVycm9yfSBmcm9tICcuLi91dGlscy9VdGlscyc7XHJcblxyXG5leHBvcnQgY2xhc3MgVGltZUlucHV0RmllbGQgZXh0ZW5kcyBBYnN0cmFjdElucHV0RmllbGQge1xyXG5cdGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQgfCB1bmRlZmluZWQ7XHJcblx0dGltZTogVGltZTtcclxuXHJcblx0aG91cnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XHJcblx0bWludXRlczogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcclxuXHJcblx0aG91ckNvbXBvbmVudDogRHJvcGRvd25Db21wb25lbnQgfCB1bmRlZmluZWQ7XHJcblx0bWludXRlQ29tcG9uZW50OiBEcm9wZG93bkNvbXBvbmVudCB8IHVuZGVmaW5lZDtcclxuXHJcblxyXG5cdGNvbnN0cnVjdG9yKGlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkOiBJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCwgb25WYWx1ZUNoYW5nZTogKHZhbHVlOiBhbnkpID0+ICh2b2lkIHwgUHJvbWlzZTx2b2lkPikpIHtcclxuXHRcdHN1cGVyKGlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLCBvblZhbHVlQ2hhbmdlKTtcclxuXHJcblx0XHR0aGlzLnRpbWUgPSBUaW1lUGFyc2VyLmdldERlZmF1bHRUaW1lKCk7XHJcblxyXG5cdFx0dGhpcy5ob3VycyA9IHt9O1xyXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPD0gMjQ7IGkrKykge1xyXG5cdFx0XHR0aGlzLmhvdXJzW2kudG9TdHJpbmcoKV0gPSBpLnRvU3RyaW5nKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5taW51dGVzID0ge307XHJcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8PSA1OTsgaSsrKSB7XHJcblx0XHRcdHRoaXMubWludXRlc1tpLnRvU3RyaW5nKCldID0gaS50b1N0cmluZygpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cHVibGljIGdldEh0bWxFbGVtZW50KCk6IEhUTUxFbGVtZW50IHtcclxuXHRcdGlmICghdGhpcy5jb250YWluZXIpIHtcclxuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcigndGltZSBpbnB1dCBjb250YWluZXIgaXMgdW5kZWZpbmVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMuY29udGFpbmVyO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldFZhbHVlKCk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gVGltZVBhcnNlci5zdHJpbmdpZnkodGhpcy50aW1lKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzZXRWYWx1ZSh2YWx1ZTogc3RyaW5nKTogdm9pZCB7XHJcblx0XHRpZiAoIXRoaXMuaG91ckNvbXBvbmVudCkge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCd0aW1lIGlucHV0IGhvdXIgY29tcG9uZW50IGlzIHVuZGVmaW5lZCcpO1xyXG5cdFx0fVxyXG5cdFx0aWYgKCF0aGlzLm1pbnV0ZUNvbXBvbmVudCkge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCd0aW1lIGlucHV0IG1pbnV0ZSBjb21wb25lbnQgaXMgdW5kZWZpbmVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy50aW1lID0gVGltZVBhcnNlci5wYXJzZSh2YWx1ZSkgPz8gVGltZVBhcnNlci5nZXREZWZhdWx0VGltZSgpO1xyXG5cdFx0Ly8gY29uc29sZS5sb2codGhpcy50aW1lKTtcclxuXHRcdHRoaXMuaG91ckNvbXBvbmVudC5zZXRWYWx1ZSh0aGlzLnRpbWUuZ2V0SG91cigpLnRvU3RyaW5nKCkpO1xyXG5cdFx0dGhpcy5taW51dGVDb21wb25lbnQuc2V0VmFsdWUodGhpcy50aW1lLmdldE1pbnV0ZSgpLnRvU3RyaW5nKCkpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGlzRXF1YWxWYWx1ZSh2YWx1ZTogYW55KTogYm9vbGVhbiB7XHJcblx0XHRyZXR1cm4gdmFsdWUgPT0gdGhpcy5nZXRWYWx1ZSgpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldERlZmF1bHRWYWx1ZSgpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIFRpbWVQYXJzZXIuc3RyaW5naWZ5KFRpbWVQYXJzZXIuZ2V0RGVmYXVsdFRpbWUoKSk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgcmVuZGVyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcclxuXHRcdHRoaXMudGltZSA9IFRpbWVQYXJzZXIucGFyc2UodGhpcy5pbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZC5nZXRJbml0aWFsVmFsdWUoKSkgPz8gVGltZVBhcnNlci5nZXREZWZhdWx0VGltZSgpO1xyXG5cclxuXHRcdGNvbnRhaW5lci5yZW1vdmVDbGFzcygnbWV0YS1iaW5kLXBsdWdpbi1pbnB1dC13cmFwcGVyJyk7XHJcblx0XHRjb250YWluZXIuYWRkQ2xhc3MoJ21ldGEtYmluZC1wbHVnaW4tZmxleC1pbnB1dC13cmFwcGVyJywgJ21ldGEtYmluZC1wbHVnaW4taW5wdXQtZWxlbWVudC1ncm91cCcpO1xyXG5cclxuXHRcdHRoaXMuaG91ckNvbXBvbmVudCA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChjb250YWluZXIpO1xyXG5cdFx0dGhpcy5ob3VyQ29tcG9uZW50LmFkZE9wdGlvbnModGhpcy5ob3Vycyk7XHJcblx0XHR0aGlzLmhvdXJDb21wb25lbnQuc2V0VmFsdWUodGhpcy50aW1lLmdldEhvdXIoKS50b1N0cmluZygpKTtcclxuXHRcdHRoaXMuaG91ckNvbXBvbmVudC5vbkNoYW5nZSh0aGlzLm9uSG91ckNoYW5nZS5iaW5kKHRoaXMpKTtcclxuXHJcblx0XHR0aGlzLm1pbnV0ZUNvbXBvbmVudCA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChjb250YWluZXIpO1xyXG5cdFx0dGhpcy5taW51dGVDb21wb25lbnQuYWRkT3B0aW9ucyh0aGlzLm1pbnV0ZXMpO1xyXG5cdFx0dGhpcy5taW51dGVDb21wb25lbnQuc2V0VmFsdWUodGhpcy50aW1lLmdldE1pbnV0ZSgpLnRvU3RyaW5nKCkpO1xyXG5cdFx0dGhpcy5taW51dGVDb21wb25lbnQub25DaGFuZ2UodGhpcy5vbk1pbnV0ZUNoYW5nZS5iaW5kKHRoaXMpKTtcclxuXHJcblx0XHR0aGlzLmhvdXJDb21wb25lbnQuc2VsZWN0RWwuYWRkQ2xhc3MoJ21ldGEtYmluZC1wbHVnaW4taW5wdXQtZWxlbWVudC1ncm91cC1lbGVtZW50Jyk7XHJcblx0XHR0aGlzLm1pbnV0ZUNvbXBvbmVudC5zZWxlY3RFbC5hZGRDbGFzcygnbWV0YS1iaW5kLXBsdWdpbi1pbnB1dC1lbGVtZW50LWdyb3VwLWVsZW1lbnQnKTtcclxuXHJcblx0XHR0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgb25Ib3VyQ2hhbmdlKHZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcclxuXHRcdHRoaXMudGltZS5zZXRIb3VyRnJvbVN0cmluZyh2YWx1ZSk7XHJcblx0XHR0aGlzLm9uVmFsdWVDaGFuZ2UodGhpcy5nZXRWYWx1ZSgpKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgb25NaW51dGVDaGFuZ2UodmFsdWU6IHN0cmluZyk6IHZvaWQge1xyXG5cdFx0dGhpcy50aW1lLnNldE1pbnV0ZUZyb21TdHJpbmcodmFsdWUpO1xyXG5cdFx0dGhpcy5vblZhbHVlQ2hhbmdlKHRoaXMuZ2V0VmFsdWUoKSk7XHJcblx0fVxyXG59XHJcbiIsICJleHBvcnQgY2xhc3MgVGltZSB7XHJcblx0cHJpdmF0ZSBfaG91cjogbnVtYmVyO1xyXG5cdHByaXZhdGUgX21pbnV0ZTogbnVtYmVyO1xyXG5cclxuXHRjb25zdHJ1Y3RvcigpIHtcclxuXHRcdHRoaXMuX2hvdXIgPSBUaW1lUGFyc2VyLmdldERlZmF1bHRIb3VyKCk7XHJcblx0XHR0aGlzLl9taW51dGUgPSBUaW1lUGFyc2VyLmdldERlZmF1bHRIb3VyKCk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0SG91cigpOiBudW1iZXIge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2hvdXI7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc2V0SG91cih2YWx1ZTogbnVtYmVyKTogdm9pZCB7XHJcblx0XHRpZiAodmFsdWUgPCAwIHx8IHZhbHVlID4gMjQpIHtcclxuXHRcdFx0dGhpcy5faG91ciA9IFRpbWVQYXJzZXIuZ2V0RGVmYXVsdEhvdXIoKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy5faG91ciA9IHZhbHVlO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldE1pbnV0ZSgpOiBudW1iZXIge1xyXG5cdFx0cmV0dXJuIHRoaXMuX21pbnV0ZTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzZXRNaW51dGUodmFsdWU6IG51bWJlcik6IHZvaWQge1xyXG5cdFx0aWYgKHZhbHVlIDwgMCB8fCB2YWx1ZSA+IDU5KSB7XHJcblx0XHRcdHRoaXMuX21pbnV0ZSA9IFRpbWVQYXJzZXIuZ2V0RGVmYXVsdE1pbnV0ZSgpO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHR0aGlzLl9taW51dGUgPSB2YWx1ZTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRVbmlmb3JtSG91cigpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuICgnMDAnICsgdGhpcy5nZXRIb3VyKCkudG9TdHJpbmcoKSkuc2xpY2UoLTIpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldFVuaWZvcm1NaW51dGUoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiAoJzAwJyArIHRoaXMuZ2V0TWludXRlKCkudG9TdHJpbmcoKSkuc2xpY2UoLTIpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHNldEhvdXJGcm9tU3RyaW5nKHN0cjogc3RyaW5nKTogdm9pZCB7XHJcblx0XHRjb25zdCB2ID0gTnVtYmVyLnBhcnNlSW50KHN0cik7XHJcblx0XHR0aGlzLnNldEhvdXIoTnVtYmVyLmlzTmFOKHYpID8gVGltZVBhcnNlci5nZXREZWZhdWx0SG91cigpIDogdik7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc2V0TWludXRlRnJvbVN0cmluZyhzdHI6IHN0cmluZyk6IHZvaWQge1xyXG5cdFx0Y29uc3QgdiA9IE51bWJlci5wYXJzZUludChzdHIpO1xyXG5cdFx0dGhpcy5zZXRNaW51dGUoTnVtYmVyLmlzTmFOKHYpID8gVGltZVBhcnNlci5nZXREZWZhdWx0TWludXRlKCkgOiB2KTtcclxuXHR9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBUaW1lUGFyc2VyIHtcclxuXHRwdWJsaWMgc3RhdGljIHBhcnNlKHRpbWVTdHJpbmc6IHN0cmluZyk6IFRpbWUgfCB1bmRlZmluZWQge1xyXG5cdFx0Y29uc3QgdGltZTogVGltZSA9IFRpbWVQYXJzZXIuZ2V0RGVmYXVsdFRpbWUoKTtcclxuXHJcblx0XHRjb25zdCB0aW1lUGFydHMgPSB0aW1lU3RyaW5nLnNwbGl0KCc6Jyk7XHJcblx0XHRpZiAodGltZVBhcnRzLmxlbmd0aCAhPT0gMikge1xyXG5cdFx0XHRyZXR1cm4gdW5kZWZpbmVkO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRpbWUuc2V0SG91ckZyb21TdHJpbmcodGltZVBhcnRzWzBdKTtcclxuXHRcdHRpbWUuc2V0TWludXRlRnJvbVN0cmluZyh0aW1lUGFydHNbMV0pO1xyXG5cclxuXHRcdHJldHVybiB0aW1lO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHN0YXRpYyBzdHJpbmdpZnkodGltZTogVGltZSk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gYCR7dGltZS5nZXRVbmlmb3JtSG91cigpfToke3RpbWUuZ2V0VW5pZm9ybU1pbnV0ZSgpfWA7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc3RhdGljIGdldERlZmF1bHRUaW1lKCk6IFRpbWUge1xyXG5cdFx0cmV0dXJuIG5ldyBUaW1lKCk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc3RhdGljIGdldERlZmF1bHRIb3VyKCk6IG51bWJlciB7XHJcblx0XHRyZXR1cm4gMDtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzdGF0aWMgZ2V0RGVmYXVsdE1pbnV0ZSgpOiBudW1iZXIge1xyXG5cdFx0cmV0dXJuIDA7XHJcblx0fVxyXG59XHJcbiIsICJmdW5jdGlvbiBub29wKCkgeyB9XG5jb25zdCBpZGVudGl0eSA9IHggPT4geDtcbmZ1bmN0aW9uIGFzc2lnbih0YXIsIHNyYykge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBmb3IgKGNvbnN0IGsgaW4gc3JjKVxuICAgICAgICB0YXJba10gPSBzcmNba107XG4gICAgcmV0dXJuIHRhcjtcbn1cbmZ1bmN0aW9uIGlzX3Byb21pc2UodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgdmFsdWUudGhlbiA9PT0gJ2Z1bmN0aW9uJztcbn1cbmZ1bmN0aW9uIGFkZF9sb2NhdGlvbihlbGVtZW50LCBmaWxlLCBsaW5lLCBjb2x1bW4sIGNoYXIpIHtcbiAgICBlbGVtZW50Ll9fc3ZlbHRlX21ldGEgPSB7XG4gICAgICAgIGxvYzogeyBmaWxlLCBsaW5lLCBjb2x1bW4sIGNoYXIgfVxuICAgIH07XG59XG5mdW5jdGlvbiBydW4oZm4pIHtcbiAgICByZXR1cm4gZm4oKTtcbn1cbmZ1bmN0aW9uIGJsYW5rX29iamVjdCgpIHtcbiAgICByZXR1cm4gT2JqZWN0LmNyZWF0ZShudWxsKTtcbn1cbmZ1bmN0aW9uIHJ1bl9hbGwoZm5zKSB7XG4gICAgZm5zLmZvckVhY2gocnVuKTtcbn1cbmZ1bmN0aW9uIGlzX2Z1bmN0aW9uKHRoaW5nKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB0aGluZyA9PT0gJ2Z1bmN0aW9uJztcbn1cbmZ1bmN0aW9uIHNhZmVfbm90X2VxdWFsKGEsIGIpIHtcbiAgICByZXR1cm4gYSAhPSBhID8gYiA9PSBiIDogYSAhPT0gYiB8fCAoKGEgJiYgdHlwZW9mIGEgPT09ICdvYmplY3QnKSB8fCB0eXBlb2YgYSA9PT0gJ2Z1bmN0aW9uJyk7XG59XG5sZXQgc3JjX3VybF9lcXVhbF9hbmNob3I7XG5mdW5jdGlvbiBzcmNfdXJsX2VxdWFsKGVsZW1lbnRfc3JjLCB1cmwpIHtcbiAgICBpZiAoIXNyY191cmxfZXF1YWxfYW5jaG9yKSB7XG4gICAgICAgIHNyY191cmxfZXF1YWxfYW5jaG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgIH1cbiAgICBzcmNfdXJsX2VxdWFsX2FuY2hvci5ocmVmID0gdXJsO1xuICAgIHJldHVybiBlbGVtZW50X3NyYyA9PT0gc3JjX3VybF9lcXVhbF9hbmNob3IuaHJlZjtcbn1cbmZ1bmN0aW9uIG5vdF9lcXVhbChhLCBiKSB7XG4gICAgcmV0dXJuIGEgIT0gYSA/IGIgPT0gYiA6IGEgIT09IGI7XG59XG5mdW5jdGlvbiBpc19lbXB0eShvYmopIHtcbiAgICByZXR1cm4gT2JqZWN0LmtleXMob2JqKS5sZW5ndGggPT09IDA7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV9zdG9yZShzdG9yZSwgbmFtZSkge1xuICAgIGlmIChzdG9yZSAhPSBudWxsICYmIHR5cGVvZiBzdG9yZS5zdWJzY3JpYmUgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAnJHtuYW1lfScgaXMgbm90IGEgc3RvcmUgd2l0aCBhICdzdWJzY3JpYmUnIG1ldGhvZGApO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHN1YnNjcmliZShzdG9yZSwgLi4uY2FsbGJhY2tzKSB7XG4gICAgaWYgKHN0b3JlID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIG5vb3A7XG4gICAgfVxuICAgIGNvbnN0IHVuc3ViID0gc3RvcmUuc3Vic2NyaWJlKC4uLmNhbGxiYWNrcyk7XG4gICAgcmV0dXJuIHVuc3ViLnVuc3Vic2NyaWJlID8gKCkgPT4gdW5zdWIudW5zdWJzY3JpYmUoKSA6IHVuc3ViO1xufVxuZnVuY3Rpb24gZ2V0X3N0b3JlX3ZhbHVlKHN0b3JlKSB7XG4gICAgbGV0IHZhbHVlO1xuICAgIHN1YnNjcmliZShzdG9yZSwgXyA9PiB2YWx1ZSA9IF8pKCk7XG4gICAgcmV0dXJuIHZhbHVlO1xufVxuZnVuY3Rpb24gY29tcG9uZW50X3N1YnNjcmliZShjb21wb25lbnQsIHN0b3JlLCBjYWxsYmFjaykge1xuICAgIGNvbXBvbmVudC4kJC5vbl9kZXN0cm95LnB1c2goc3Vic2NyaWJlKHN0b3JlLCBjYWxsYmFjaykpO1xufVxuZnVuY3Rpb24gY3JlYXRlX3Nsb3QoZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBmbikge1xuICAgIGlmIChkZWZpbml0aW9uKSB7XG4gICAgICAgIGNvbnN0IHNsb3RfY3R4ID0gZ2V0X3Nsb3RfY29udGV4dChkZWZpbml0aW9uLCBjdHgsICQkc2NvcGUsIGZuKTtcbiAgICAgICAgcmV0dXJuIGRlZmluaXRpb25bMF0oc2xvdF9jdHgpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGdldF9zbG90X2NvbnRleHQoZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBmbikge1xuICAgIHJldHVybiBkZWZpbml0aW9uWzFdICYmIGZuXG4gICAgICAgID8gYXNzaWduKCQkc2NvcGUuY3R4LnNsaWNlKCksIGRlZmluaXRpb25bMV0oZm4oY3R4KSkpXG4gICAgICAgIDogJCRzY29wZS5jdHg7XG59XG5mdW5jdGlvbiBnZXRfc2xvdF9jaGFuZ2VzKGRlZmluaXRpb24sICQkc2NvcGUsIGRpcnR5LCBmbikge1xuICAgIGlmIChkZWZpbml0aW9uWzJdICYmIGZuKSB7XG4gICAgICAgIGNvbnN0IGxldHMgPSBkZWZpbml0aW9uWzJdKGZuKGRpcnR5KSk7XG4gICAgICAgIGlmICgkJHNjb3BlLmRpcnR5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBsZXRzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgbGV0cyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIGNvbnN0IG1lcmdlZCA9IFtdO1xuICAgICAgICAgICAgY29uc3QgbGVuID0gTWF0aC5tYXgoJCRzY29wZS5kaXJ0eS5sZW5ndGgsIGxldHMubGVuZ3RoKTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpICs9IDEpIHtcbiAgICAgICAgICAgICAgICBtZXJnZWRbaV0gPSAkJHNjb3BlLmRpcnR5W2ldIHwgbGV0c1tpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBtZXJnZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICQkc2NvcGUuZGlydHkgfCBsZXRzO1xuICAgIH1cbiAgICByZXR1cm4gJCRzY29wZS5kaXJ0eTtcbn1cbmZ1bmN0aW9uIHVwZGF0ZV9zbG90X2Jhc2Uoc2xvdCwgc2xvdF9kZWZpbml0aW9uLCBjdHgsICQkc2NvcGUsIHNsb3RfY2hhbmdlcywgZ2V0X3Nsb3RfY29udGV4dF9mbikge1xuICAgIGlmIChzbG90X2NoYW5nZXMpIHtcbiAgICAgICAgY29uc3Qgc2xvdF9jb250ZXh0ID0gZ2V0X3Nsb3RfY29udGV4dChzbG90X2RlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZ2V0X3Nsb3RfY29udGV4dF9mbik7XG4gICAgICAgIHNsb3QucChzbG90X2NvbnRleHQsIHNsb3RfY2hhbmdlcyk7XG4gICAgfVxufVxuZnVuY3Rpb24gdXBkYXRlX3Nsb3Qoc2xvdCwgc2xvdF9kZWZpbml0aW9uLCBjdHgsICQkc2NvcGUsIGRpcnR5LCBnZXRfc2xvdF9jaGFuZ2VzX2ZuLCBnZXRfc2xvdF9jb250ZXh0X2ZuKSB7XG4gICAgY29uc3Qgc2xvdF9jaGFuZ2VzID0gZ2V0X3Nsb3RfY2hhbmdlcyhzbG90X2RlZmluaXRpb24sICQkc2NvcGUsIGRpcnR5LCBnZXRfc2xvdF9jaGFuZ2VzX2ZuKTtcbiAgICB1cGRhdGVfc2xvdF9iYXNlKHNsb3QsIHNsb3RfZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBzbG90X2NoYW5nZXMsIGdldF9zbG90X2NvbnRleHRfZm4pO1xufVxuZnVuY3Rpb24gZ2V0X2FsbF9kaXJ0eV9mcm9tX3Njb3BlKCQkc2NvcGUpIHtcbiAgICBpZiAoJCRzY29wZS5jdHgubGVuZ3RoID4gMzIpIHtcbiAgICAgICAgY29uc3QgZGlydHkgPSBbXTtcbiAgICAgICAgY29uc3QgbGVuZ3RoID0gJCRzY29wZS5jdHgubGVuZ3RoIC8gMzI7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGRpcnR5W2ldID0gLTE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRpcnR5O1xuICAgIH1cbiAgICByZXR1cm4gLTE7XG59XG5mdW5jdGlvbiBleGNsdWRlX2ludGVybmFsX3Byb3BzKHByb3BzKSB7XG4gICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgZm9yIChjb25zdCBrIGluIHByb3BzKVxuICAgICAgICBpZiAoa1swXSAhPT0gJyQnKVxuICAgICAgICAgICAgcmVzdWx0W2tdID0gcHJvcHNba107XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGNvbXB1dGVfcmVzdF9wcm9wcyhwcm9wcywga2V5cykge1xuICAgIGNvbnN0IHJlc3QgPSB7fTtcbiAgICBrZXlzID0gbmV3IFNldChrZXlzKTtcbiAgICBmb3IgKGNvbnN0IGsgaW4gcHJvcHMpXG4gICAgICAgIGlmICgha2V5cy5oYXMoaykgJiYga1swXSAhPT0gJyQnKVxuICAgICAgICAgICAgcmVzdFtrXSA9IHByb3BzW2tdO1xuICAgIHJldHVybiByZXN0O1xufVxuZnVuY3Rpb24gY29tcHV0ZV9zbG90cyhzbG90cykge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgIGZvciAoY29uc3Qga2V5IGluIHNsb3RzKSB7XG4gICAgICAgIHJlc3VsdFtrZXldID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIG9uY2UoZm4pIHtcbiAgICBsZXQgcmFuID0gZmFsc2U7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICguLi5hcmdzKSB7XG4gICAgICAgIGlmIChyYW4pXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHJhbiA9IHRydWU7XG4gICAgICAgIGZuLmNhbGwodGhpcywgLi4uYXJncyk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIG51bGxfdG9fZW1wdHkodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgPT0gbnVsbCA/ICcnIDogdmFsdWU7XG59XG5mdW5jdGlvbiBzZXRfc3RvcmVfdmFsdWUoc3RvcmUsIHJldCwgdmFsdWUpIHtcbiAgICBzdG9yZS5zZXQodmFsdWUpO1xuICAgIHJldHVybiByZXQ7XG59XG5jb25zdCBoYXNfcHJvcCA9IChvYmosIHByb3ApID0+IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApO1xuZnVuY3Rpb24gYWN0aW9uX2Rlc3Ryb3llcihhY3Rpb25fcmVzdWx0KSB7XG4gICAgcmV0dXJuIGFjdGlvbl9yZXN1bHQgJiYgaXNfZnVuY3Rpb24oYWN0aW9uX3Jlc3VsdC5kZXN0cm95KSA/IGFjdGlvbl9yZXN1bHQuZGVzdHJveSA6IG5vb3A7XG59XG5cbmNvbnN0IGlzX2NsaWVudCA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnO1xubGV0IG5vdyA9IGlzX2NsaWVudFxuICAgID8gKCkgPT4gd2luZG93LnBlcmZvcm1hbmNlLm5vdygpXG4gICAgOiAoKSA9PiBEYXRlLm5vdygpO1xubGV0IHJhZiA9IGlzX2NsaWVudCA/IGNiID0+IHJlcXVlc3RBbmltYXRpb25GcmFtZShjYikgOiBub29wO1xuLy8gdXNlZCBpbnRlcm5hbGx5IGZvciB0ZXN0aW5nXG5mdW5jdGlvbiBzZXRfbm93KGZuKSB7XG4gICAgbm93ID0gZm47XG59XG5mdW5jdGlvbiBzZXRfcmFmKGZuKSB7XG4gICAgcmFmID0gZm47XG59XG5cbmNvbnN0IHRhc2tzID0gbmV3IFNldCgpO1xuZnVuY3Rpb24gcnVuX3Rhc2tzKG5vdykge1xuICAgIHRhc2tzLmZvckVhY2godGFzayA9PiB7XG4gICAgICAgIGlmICghdGFzay5jKG5vdykpIHtcbiAgICAgICAgICAgIHRhc2tzLmRlbGV0ZSh0YXNrKTtcbiAgICAgICAgICAgIHRhc2suZigpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgaWYgKHRhc2tzLnNpemUgIT09IDApXG4gICAgICAgIHJhZihydW5fdGFza3MpO1xufVxuLyoqXG4gKiBGb3IgdGVzdGluZyBwdXJwb3NlcyBvbmx5IVxuICovXG5mdW5jdGlvbiBjbGVhcl9sb29wcygpIHtcbiAgICB0YXNrcy5jbGVhcigpO1xufVxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IHRhc2sgdGhhdCBydW5zIG9uIGVhY2ggcmFmIGZyYW1lXG4gKiB1bnRpbCBpdCByZXR1cm5zIGEgZmFsc3kgdmFsdWUgb3IgaXMgYWJvcnRlZFxuICovXG5mdW5jdGlvbiBsb29wKGNhbGxiYWNrKSB7XG4gICAgbGV0IHRhc2s7XG4gICAgaWYgKHRhc2tzLnNpemUgPT09IDApXG4gICAgICAgIHJhZihydW5fdGFza3MpO1xuICAgIHJldHVybiB7XG4gICAgICAgIHByb21pc2U6IG5ldyBQcm9taXNlKGZ1bGZpbGwgPT4ge1xuICAgICAgICAgICAgdGFza3MuYWRkKHRhc2sgPSB7IGM6IGNhbGxiYWNrLCBmOiBmdWxmaWxsIH0pO1xuICAgICAgICB9KSxcbiAgICAgICAgYWJvcnQoKSB7XG4gICAgICAgICAgICB0YXNrcy5kZWxldGUodGFzayk7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG4vLyBUcmFjayB3aGljaCBub2RlcyBhcmUgY2xhaW1lZCBkdXJpbmcgaHlkcmF0aW9uLiBVbmNsYWltZWQgbm9kZXMgY2FuIHRoZW4gYmUgcmVtb3ZlZCBmcm9tIHRoZSBET01cbi8vIGF0IHRoZSBlbmQgb2YgaHlkcmF0aW9uIHdpdGhvdXQgdG91Y2hpbmcgdGhlIHJlbWFpbmluZyBub2Rlcy5cbmxldCBpc19oeWRyYXRpbmcgPSBmYWxzZTtcbmZ1bmN0aW9uIHN0YXJ0X2h5ZHJhdGluZygpIHtcbiAgICBpc19oeWRyYXRpbmcgPSB0cnVlO1xufVxuZnVuY3Rpb24gZW5kX2h5ZHJhdGluZygpIHtcbiAgICBpc19oeWRyYXRpbmcgPSBmYWxzZTtcbn1cbmZ1bmN0aW9uIHVwcGVyX2JvdW5kKGxvdywgaGlnaCwga2V5LCB2YWx1ZSkge1xuICAgIC8vIFJldHVybiBmaXJzdCBpbmRleCBvZiB2YWx1ZSBsYXJnZXIgdGhhbiBpbnB1dCB2YWx1ZSBpbiB0aGUgcmFuZ2UgW2xvdywgaGlnaClcbiAgICB3aGlsZSAobG93IDwgaGlnaCkge1xuICAgICAgICBjb25zdCBtaWQgPSBsb3cgKyAoKGhpZ2ggLSBsb3cpID4+IDEpO1xuICAgICAgICBpZiAoa2V5KG1pZCkgPD0gdmFsdWUpIHtcbiAgICAgICAgICAgIGxvdyA9IG1pZCArIDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBoaWdoID0gbWlkO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBsb3c7XG59XG5mdW5jdGlvbiBpbml0X2h5ZHJhdGUodGFyZ2V0KSB7XG4gICAgaWYgKHRhcmdldC5oeWRyYXRlX2luaXQpXG4gICAgICAgIHJldHVybjtcbiAgICB0YXJnZXQuaHlkcmF0ZV9pbml0ID0gdHJ1ZTtcbiAgICAvLyBXZSBrbm93IHRoYXQgYWxsIGNoaWxkcmVuIGhhdmUgY2xhaW1fb3JkZXIgdmFsdWVzIHNpbmNlIHRoZSB1bmNsYWltZWQgaGF2ZSBiZWVuIGRldGFjaGVkIGlmIHRhcmdldCBpcyBub3QgPGhlYWQ+XG4gICAgbGV0IGNoaWxkcmVuID0gdGFyZ2V0LmNoaWxkTm9kZXM7XG4gICAgLy8gSWYgdGFyZ2V0IGlzIDxoZWFkPiwgdGhlcmUgbWF5IGJlIGNoaWxkcmVuIHdpdGhvdXQgY2xhaW1fb3JkZXJcbiAgICBpZiAodGFyZ2V0Lm5vZGVOYW1lID09PSAnSEVBRCcpIHtcbiAgICAgICAgY29uc3QgbXlDaGlsZHJlbiA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBub2RlID0gY2hpbGRyZW5baV07XG4gICAgICAgICAgICBpZiAobm9kZS5jbGFpbV9vcmRlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgbXlDaGlsZHJlbi5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNoaWxkcmVuID0gbXlDaGlsZHJlbjtcbiAgICB9XG4gICAgLypcbiAgICAqIFJlb3JkZXIgY2xhaW1lZCBjaGlsZHJlbiBvcHRpbWFsbHkuXG4gICAgKiBXZSBjYW4gcmVvcmRlciBjbGFpbWVkIGNoaWxkcmVuIG9wdGltYWxseSBieSBmaW5kaW5nIHRoZSBsb25nZXN0IHN1YnNlcXVlbmNlIG9mXG4gICAgKiBub2RlcyB0aGF0IGFyZSBhbHJlYWR5IGNsYWltZWQgaW4gb3JkZXIgYW5kIG9ubHkgbW92aW5nIHRoZSByZXN0LiBUaGUgbG9uZ2VzdFxuICAgICogc3Vic2VxdWVuY2Ugc3Vic2VxdWVuY2Ugb2Ygbm9kZXMgdGhhdCBhcmUgY2xhaW1lZCBpbiBvcmRlciBjYW4gYmUgZm91bmQgYnlcbiAgICAqIGNvbXB1dGluZyB0aGUgbG9uZ2VzdCBpbmNyZWFzaW5nIHN1YnNlcXVlbmNlIG9mIC5jbGFpbV9vcmRlciB2YWx1ZXMuXG4gICAgKlxuICAgICogVGhpcyBhbGdvcml0aG0gaXMgb3B0aW1hbCBpbiBnZW5lcmF0aW5nIHRoZSBsZWFzdCBhbW91bnQgb2YgcmVvcmRlciBvcGVyYXRpb25zXG4gICAgKiBwb3NzaWJsZS5cbiAgICAqXG4gICAgKiBQcm9vZjpcbiAgICAqIFdlIGtub3cgdGhhdCwgZ2l2ZW4gYSBzZXQgb2YgcmVvcmRlcmluZyBvcGVyYXRpb25zLCB0aGUgbm9kZXMgdGhhdCBkbyBub3QgbW92ZVxuICAgICogYWx3YXlzIGZvcm0gYW4gaW5jcmVhc2luZyBzdWJzZXF1ZW5jZSwgc2luY2UgdGhleSBkbyBub3QgbW92ZSBhbW9uZyBlYWNoIG90aGVyXG4gICAgKiBtZWFuaW5nIHRoYXQgdGhleSBtdXN0IGJlIGFscmVhZHkgb3JkZXJlZCBhbW9uZyBlYWNoIG90aGVyLiBUaHVzLCB0aGUgbWF4aW1hbFxuICAgICogc2V0IG9mIG5vZGVzIHRoYXQgZG8gbm90IG1vdmUgZm9ybSBhIGxvbmdlc3QgaW5jcmVhc2luZyBzdWJzZXF1ZW5jZS5cbiAgICAqL1xuICAgIC8vIENvbXB1dGUgbG9uZ2VzdCBpbmNyZWFzaW5nIHN1YnNlcXVlbmNlXG4gICAgLy8gbTogc3Vic2VxdWVuY2UgbGVuZ3RoIGogPT4gaW5kZXggayBvZiBzbWFsbGVzdCB2YWx1ZSB0aGF0IGVuZHMgYW4gaW5jcmVhc2luZyBzdWJzZXF1ZW5jZSBvZiBsZW5ndGggalxuICAgIGNvbnN0IG0gPSBuZXcgSW50MzJBcnJheShjaGlsZHJlbi5sZW5ndGggKyAxKTtcbiAgICAvLyBQcmVkZWNlc3NvciBpbmRpY2VzICsgMVxuICAgIGNvbnN0IHAgPSBuZXcgSW50MzJBcnJheShjaGlsZHJlbi5sZW5ndGgpO1xuICAgIG1bMF0gPSAtMTtcbiAgICBsZXQgbG9uZ2VzdCA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBjdXJyZW50ID0gY2hpbGRyZW5baV0uY2xhaW1fb3JkZXI7XG4gICAgICAgIC8vIEZpbmQgdGhlIGxhcmdlc3Qgc3Vic2VxdWVuY2UgbGVuZ3RoIHN1Y2ggdGhhdCBpdCBlbmRzIGluIGEgdmFsdWUgbGVzcyB0aGFuIG91ciBjdXJyZW50IHZhbHVlXG4gICAgICAgIC8vIHVwcGVyX2JvdW5kIHJldHVybnMgZmlyc3QgZ3JlYXRlciB2YWx1ZSwgc28gd2Ugc3VidHJhY3Qgb25lXG4gICAgICAgIC8vIHdpdGggZmFzdCBwYXRoIGZvciB3aGVuIHdlIGFyZSBvbiB0aGUgY3VycmVudCBsb25nZXN0IHN1YnNlcXVlbmNlXG4gICAgICAgIGNvbnN0IHNlcUxlbiA9ICgobG9uZ2VzdCA+IDAgJiYgY2hpbGRyZW5bbVtsb25nZXN0XV0uY2xhaW1fb3JkZXIgPD0gY3VycmVudCkgPyBsb25nZXN0ICsgMSA6IHVwcGVyX2JvdW5kKDEsIGxvbmdlc3QsIGlkeCA9PiBjaGlsZHJlblttW2lkeF1dLmNsYWltX29yZGVyLCBjdXJyZW50KSkgLSAxO1xuICAgICAgICBwW2ldID0gbVtzZXFMZW5dICsgMTtcbiAgICAgICAgY29uc3QgbmV3TGVuID0gc2VxTGVuICsgMTtcbiAgICAgICAgLy8gV2UgY2FuIGd1YXJhbnRlZSB0aGF0IGN1cnJlbnQgaXMgdGhlIHNtYWxsZXN0IHZhbHVlLiBPdGhlcndpc2UsIHdlIHdvdWxkIGhhdmUgZ2VuZXJhdGVkIGEgbG9uZ2VyIHNlcXVlbmNlLlxuICAgICAgICBtW25ld0xlbl0gPSBpO1xuICAgICAgICBsb25nZXN0ID0gTWF0aC5tYXgobmV3TGVuLCBsb25nZXN0KTtcbiAgICB9XG4gICAgLy8gVGhlIGxvbmdlc3QgaW5jcmVhc2luZyBzdWJzZXF1ZW5jZSBvZiBub2RlcyAoaW5pdGlhbGx5IHJldmVyc2VkKVxuICAgIGNvbnN0IGxpcyA9IFtdO1xuICAgIC8vIFRoZSByZXN0IG9mIHRoZSBub2Rlcywgbm9kZXMgdGhhdCB3aWxsIGJlIG1vdmVkXG4gICAgY29uc3QgdG9Nb3ZlID0gW107XG4gICAgbGV0IGxhc3QgPSBjaGlsZHJlbi5sZW5ndGggLSAxO1xuICAgIGZvciAobGV0IGN1ciA9IG1bbG9uZ2VzdF0gKyAxOyBjdXIgIT0gMDsgY3VyID0gcFtjdXIgLSAxXSkge1xuICAgICAgICBsaXMucHVzaChjaGlsZHJlbltjdXIgLSAxXSk7XG4gICAgICAgIGZvciAoOyBsYXN0ID49IGN1cjsgbGFzdC0tKSB7XG4gICAgICAgICAgICB0b01vdmUucHVzaChjaGlsZHJlbltsYXN0XSk7XG4gICAgICAgIH1cbiAgICAgICAgbGFzdC0tO1xuICAgIH1cbiAgICBmb3IgKDsgbGFzdCA+PSAwOyBsYXN0LS0pIHtcbiAgICAgICAgdG9Nb3ZlLnB1c2goY2hpbGRyZW5bbGFzdF0pO1xuICAgIH1cbiAgICBsaXMucmV2ZXJzZSgpO1xuICAgIC8vIFdlIHNvcnQgdGhlIG5vZGVzIGJlaW5nIG1vdmVkIHRvIGd1YXJhbnRlZSB0aGF0IHRoZWlyIGluc2VydGlvbiBvcmRlciBtYXRjaGVzIHRoZSBjbGFpbSBvcmRlclxuICAgIHRvTW92ZS5zb3J0KChhLCBiKSA9PiBhLmNsYWltX29yZGVyIC0gYi5jbGFpbV9vcmRlcik7XG4gICAgLy8gRmluYWxseSwgd2UgbW92ZSB0aGUgbm9kZXNcbiAgICBmb3IgKGxldCBpID0gMCwgaiA9IDA7IGkgPCB0b01vdmUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgd2hpbGUgKGogPCBsaXMubGVuZ3RoICYmIHRvTW92ZVtpXS5jbGFpbV9vcmRlciA+PSBsaXNbal0uY2xhaW1fb3JkZXIpIHtcbiAgICAgICAgICAgIGorKztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBhbmNob3IgPSBqIDwgbGlzLmxlbmd0aCA/IGxpc1tqXSA6IG51bGw7XG4gICAgICAgIHRhcmdldC5pbnNlcnRCZWZvcmUodG9Nb3ZlW2ldLCBhbmNob3IpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGFwcGVuZCh0YXJnZXQsIG5vZGUpIHtcbiAgICB0YXJnZXQuYXBwZW5kQ2hpbGQobm9kZSk7XG59XG5mdW5jdGlvbiBhcHBlbmRfc3R5bGVzKHRhcmdldCwgc3R5bGVfc2hlZXRfaWQsIHN0eWxlcykge1xuICAgIGNvbnN0IGFwcGVuZF9zdHlsZXNfdG8gPSBnZXRfcm9vdF9mb3Jfc3R5bGUodGFyZ2V0KTtcbiAgICBpZiAoIWFwcGVuZF9zdHlsZXNfdG8uZ2V0RWxlbWVudEJ5SWQoc3R5bGVfc2hlZXRfaWQpKSB7XG4gICAgICAgIGNvbnN0IHN0eWxlID0gZWxlbWVudCgnc3R5bGUnKTtcbiAgICAgICAgc3R5bGUuaWQgPSBzdHlsZV9zaGVldF9pZDtcbiAgICAgICAgc3R5bGUudGV4dENvbnRlbnQgPSBzdHlsZXM7XG4gICAgICAgIGFwcGVuZF9zdHlsZXNoZWV0KGFwcGVuZF9zdHlsZXNfdG8sIHN0eWxlKTtcbiAgICB9XG59XG5mdW5jdGlvbiBnZXRfcm9vdF9mb3Jfc3R5bGUobm9kZSkge1xuICAgIGlmICghbm9kZSlcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50O1xuICAgIGNvbnN0IHJvb3QgPSBub2RlLmdldFJvb3ROb2RlID8gbm9kZS5nZXRSb290Tm9kZSgpIDogbm9kZS5vd25lckRvY3VtZW50O1xuICAgIGlmIChyb290ICYmIHJvb3QuaG9zdCkge1xuICAgICAgICByZXR1cm4gcm9vdDtcbiAgICB9XG4gICAgcmV0dXJuIG5vZGUub3duZXJEb2N1bWVudDtcbn1cbmZ1bmN0aW9uIGFwcGVuZF9lbXB0eV9zdHlsZXNoZWV0KG5vZGUpIHtcbiAgICBjb25zdCBzdHlsZV9lbGVtZW50ID0gZWxlbWVudCgnc3R5bGUnKTtcbiAgICBhcHBlbmRfc3R5bGVzaGVldChnZXRfcm9vdF9mb3Jfc3R5bGUobm9kZSksIHN0eWxlX2VsZW1lbnQpO1xuICAgIHJldHVybiBzdHlsZV9lbGVtZW50LnNoZWV0O1xufVxuZnVuY3Rpb24gYXBwZW5kX3N0eWxlc2hlZXQobm9kZSwgc3R5bGUpIHtcbiAgICBhcHBlbmQobm9kZS5oZWFkIHx8IG5vZGUsIHN0eWxlKTtcbn1cbmZ1bmN0aW9uIGFwcGVuZF9oeWRyYXRpb24odGFyZ2V0LCBub2RlKSB7XG4gICAgaWYgKGlzX2h5ZHJhdGluZykge1xuICAgICAgICBpbml0X2h5ZHJhdGUodGFyZ2V0KTtcbiAgICAgICAgaWYgKCh0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZCA9PT0gdW5kZWZpbmVkKSB8fCAoKHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkICE9PSBudWxsKSAmJiAodGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQucGFyZW50RWxlbWVudCAhPT0gdGFyZ2V0KSkpIHtcbiAgICAgICAgICAgIHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkID0gdGFyZ2V0LmZpcnN0Q2hpbGQ7XG4gICAgICAgIH1cbiAgICAgICAgLy8gU2tpcCBub2RlcyBvZiB1bmRlZmluZWQgb3JkZXJpbmdcbiAgICAgICAgd2hpbGUgKCh0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZCAhPT0gbnVsbCkgJiYgKHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkLmNsYWltX29yZGVyID09PSB1bmRlZmluZWQpKSB7XG4gICAgICAgICAgICB0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZCA9IHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkLm5leHRTaWJsaW5nO1xuICAgICAgICB9XG4gICAgICAgIGlmIChub2RlICE9PSB0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZCkge1xuICAgICAgICAgICAgLy8gV2Ugb25seSBpbnNlcnQgaWYgdGhlIG9yZGVyaW5nIG9mIHRoaXMgbm9kZSBzaG91bGQgYmUgbW9kaWZpZWQgb3IgdGhlIHBhcmVudCBub2RlIGlzIG5vdCB0YXJnZXRcbiAgICAgICAgICAgIGlmIChub2RlLmNsYWltX29yZGVyICE9PSB1bmRlZmluZWQgfHwgbm9kZS5wYXJlbnROb2RlICE9PSB0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQuaW5zZXJ0QmVmb3JlKG5vZGUsIHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkID0gbm9kZS5uZXh0U2libGluZztcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChub2RlLnBhcmVudE5vZGUgIT09IHRhcmdldCB8fCBub2RlLm5leHRTaWJsaW5nICE9PSBudWxsKSB7XG4gICAgICAgIHRhcmdldC5hcHBlbmRDaGlsZChub2RlKTtcbiAgICB9XG59XG5mdW5jdGlvbiBpbnNlcnQodGFyZ2V0LCBub2RlLCBhbmNob3IpIHtcbiAgICB0YXJnZXQuaW5zZXJ0QmVmb3JlKG5vZGUsIGFuY2hvciB8fCBudWxsKTtcbn1cbmZ1bmN0aW9uIGluc2VydF9oeWRyYXRpb24odGFyZ2V0LCBub2RlLCBhbmNob3IpIHtcbiAgICBpZiAoaXNfaHlkcmF0aW5nICYmICFhbmNob3IpIHtcbiAgICAgICAgYXBwZW5kX2h5ZHJhdGlvbih0YXJnZXQsIG5vZGUpO1xuICAgIH1cbiAgICBlbHNlIGlmIChub2RlLnBhcmVudE5vZGUgIT09IHRhcmdldCB8fCBub2RlLm5leHRTaWJsaW5nICE9IGFuY2hvcikge1xuICAgICAgICB0YXJnZXQuaW5zZXJ0QmVmb3JlKG5vZGUsIGFuY2hvciB8fCBudWxsKTtcbiAgICB9XG59XG5mdW5jdGlvbiBkZXRhY2gobm9kZSkge1xuICAgIG5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChub2RlKTtcbn1cbmZ1bmN0aW9uIGRlc3Ryb3lfZWFjaChpdGVyYXRpb25zLCBkZXRhY2hpbmcpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZXJhdGlvbnMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgaWYgKGl0ZXJhdGlvbnNbaV0pXG4gICAgICAgICAgICBpdGVyYXRpb25zW2ldLmQoZGV0YWNoaW5nKTtcbiAgICB9XG59XG5mdW5jdGlvbiBlbGVtZW50KG5hbWUpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChuYW1lKTtcbn1cbmZ1bmN0aW9uIGVsZW1lbnRfaXMobmFtZSwgaXMpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChuYW1lLCB7IGlzIH0pO1xufVxuZnVuY3Rpb24gb2JqZWN0X3dpdGhvdXRfcHJvcGVydGllcyhvYmosIGV4Y2x1ZGUpIHtcbiAgICBjb25zdCB0YXJnZXQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGsgaW4gb2JqKSB7XG4gICAgICAgIGlmIChoYXNfcHJvcChvYmosIGspXG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAmJiBleGNsdWRlLmluZGV4T2YoaykgPT09IC0xKSB7XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICB0YXJnZXRba10gPSBvYmpba107XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRhcmdldDtcbn1cbmZ1bmN0aW9uIHN2Z19lbGVtZW50KG5hbWUpIHtcbiAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsIG5hbWUpO1xufVxuZnVuY3Rpb24gdGV4dChkYXRhKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGRhdGEpO1xufVxuZnVuY3Rpb24gc3BhY2UoKSB7XG4gICAgcmV0dXJuIHRleHQoJyAnKTtcbn1cbmZ1bmN0aW9uIGVtcHR5KCkge1xuICAgIHJldHVybiB0ZXh0KCcnKTtcbn1cbmZ1bmN0aW9uIGxpc3Rlbihub2RlLCBldmVudCwgaGFuZGxlciwgb3B0aW9ucykge1xuICAgIG5vZGUuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlciwgb3B0aW9ucyk7XG4gICAgcmV0dXJuICgpID0+IG5vZGUucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlciwgb3B0aW9ucyk7XG59XG5mdW5jdGlvbiBwcmV2ZW50X2RlZmF1bHQoZm4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgcmV0dXJuIGZuLmNhbGwodGhpcywgZXZlbnQpO1xuICAgIH07XG59XG5mdW5jdGlvbiBzdG9wX3Byb3BhZ2F0aW9uKGZuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICByZXR1cm4gZm4uY2FsbCh0aGlzLCBldmVudCk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHNlbGYoZm4pIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldCA9PT0gdGhpcylcbiAgICAgICAgICAgIGZuLmNhbGwodGhpcywgZXZlbnQpO1xuICAgIH07XG59XG5mdW5jdGlvbiB0cnVzdGVkKGZuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGlmIChldmVudC5pc1RydXN0ZWQpXG4gICAgICAgICAgICBmbi5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICB9O1xufVxuZnVuY3Rpb24gYXR0cihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlID09IG51bGwpXG4gICAgICAgIG5vZGUucmVtb3ZlQXR0cmlidXRlKGF0dHJpYnV0ZSk7XG4gICAgZWxzZSBpZiAobm9kZS5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlKSAhPT0gdmFsdWUpXG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKGF0dHJpYnV0ZSwgdmFsdWUpO1xufVxuZnVuY3Rpb24gc2V0X2F0dHJpYnV0ZXMobm9kZSwgYXR0cmlidXRlcykge1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjb25zdCBkZXNjcmlwdG9ycyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKG5vZGUuX19wcm90b19fKTtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVzW2tleV0gPT0gbnVsbCkge1xuICAgICAgICAgICAgbm9kZS5yZW1vdmVBdHRyaWJ1dGUoa2V5KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChrZXkgPT09ICdzdHlsZScpIHtcbiAgICAgICAgICAgIG5vZGUuc3R5bGUuY3NzVGV4dCA9IGF0dHJpYnV0ZXNba2V5XTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChrZXkgPT09ICdfX3ZhbHVlJykge1xuICAgICAgICAgICAgbm9kZS52YWx1ZSA9IG5vZGVba2V5XSA9IGF0dHJpYnV0ZXNba2V5XTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkZXNjcmlwdG9yc1trZXldICYmIGRlc2NyaXB0b3JzW2tleV0uc2V0KSB7XG4gICAgICAgICAgICBub2RlW2tleV0gPSBhdHRyaWJ1dGVzW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBhdHRyKG5vZGUsIGtleSwgYXR0cmlidXRlc1trZXldKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIHNldF9zdmdfYXR0cmlidXRlcyhub2RlLCBhdHRyaWJ1dGVzKSB7XG4gICAgZm9yIChjb25zdCBrZXkgaW4gYXR0cmlidXRlcykge1xuICAgICAgICBhdHRyKG5vZGUsIGtleSwgYXR0cmlidXRlc1trZXldKTtcbiAgICB9XG59XG5mdW5jdGlvbiBzZXRfY3VzdG9tX2VsZW1lbnRfZGF0YShub2RlLCBwcm9wLCB2YWx1ZSkge1xuICAgIGlmIChwcm9wIGluIG5vZGUpIHtcbiAgICAgICAgbm9kZVtwcm9wXSA9IHR5cGVvZiBub2RlW3Byb3BdID09PSAnYm9vbGVhbicgJiYgdmFsdWUgPT09ICcnID8gdHJ1ZSA6IHZhbHVlO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgYXR0cihub2RlLCBwcm9wLCB2YWx1ZSk7XG4gICAgfVxufVxuZnVuY3Rpb24geGxpbmtfYXR0cihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKSB7XG4gICAgbm9kZS5zZXRBdHRyaWJ1dGVOUygnaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycsIGF0dHJpYnV0ZSwgdmFsdWUpO1xufVxuZnVuY3Rpb24gZ2V0X2JpbmRpbmdfZ3JvdXBfdmFsdWUoZ3JvdXAsIF9fdmFsdWUsIGNoZWNrZWQpIHtcbiAgICBjb25zdCB2YWx1ZSA9IG5ldyBTZXQoKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGdyb3VwLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGlmIChncm91cFtpXS5jaGVja2VkKVxuICAgICAgICAgICAgdmFsdWUuYWRkKGdyb3VwW2ldLl9fdmFsdWUpO1xuICAgIH1cbiAgICBpZiAoIWNoZWNrZWQpIHtcbiAgICAgICAgdmFsdWUuZGVsZXRlKF9fdmFsdWUpO1xuICAgIH1cbiAgICByZXR1cm4gQXJyYXkuZnJvbSh2YWx1ZSk7XG59XG5mdW5jdGlvbiB0b19udW1iZXIodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgPT09ICcnID8gbnVsbCA6ICt2YWx1ZTtcbn1cbmZ1bmN0aW9uIHRpbWVfcmFuZ2VzX3RvX2FycmF5KHJhbmdlcykge1xuICAgIGNvbnN0IGFycmF5ID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByYW5nZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgYXJyYXkucHVzaCh7IHN0YXJ0OiByYW5nZXMuc3RhcnQoaSksIGVuZDogcmFuZ2VzLmVuZChpKSB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGFycmF5O1xufVxuZnVuY3Rpb24gY2hpbGRyZW4oZWxlbWVudCkge1xuICAgIHJldHVybiBBcnJheS5mcm9tKGVsZW1lbnQuY2hpbGROb2Rlcyk7XG59XG5mdW5jdGlvbiBpbml0X2NsYWltX2luZm8obm9kZXMpIHtcbiAgICBpZiAobm9kZXMuY2xhaW1faW5mbyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIG5vZGVzLmNsYWltX2luZm8gPSB7IGxhc3RfaW5kZXg6IDAsIHRvdGFsX2NsYWltZWQ6IDAgfTtcbiAgICB9XG59XG5mdW5jdGlvbiBjbGFpbV9ub2RlKG5vZGVzLCBwcmVkaWNhdGUsIHByb2Nlc3NOb2RlLCBjcmVhdGVOb2RlLCBkb250VXBkYXRlTGFzdEluZGV4ID0gZmFsc2UpIHtcbiAgICAvLyBUcnkgdG8gZmluZCBub2RlcyBpbiBhbiBvcmRlciBzdWNoIHRoYXQgd2UgbGVuZ3RoZW4gdGhlIGxvbmdlc3QgaW5jcmVhc2luZyBzdWJzZXF1ZW5jZVxuICAgIGluaXRfY2xhaW1faW5mbyhub2Rlcyk7XG4gICAgY29uc3QgcmVzdWx0Tm9kZSA9ICgoKSA9PiB7XG4gICAgICAgIC8vIFdlIGZpcnN0IHRyeSB0byBmaW5kIGFuIGVsZW1lbnQgYWZ0ZXIgdGhlIHByZXZpb3VzIG9uZVxuICAgICAgICBmb3IgKGxldCBpID0gbm9kZXMuY2xhaW1faW5mby5sYXN0X2luZGV4OyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IG5vZGUgPSBub2Rlc1tpXTtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUobm9kZSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXBsYWNlbWVudCA9IHByb2Nlc3NOb2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChyZXBsYWNlbWVudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldID0gcmVwbGFjZW1lbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghZG9udFVwZGF0ZUxhc3RJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBub2Rlcy5jbGFpbV9pbmZvLmxhc3RfaW5kZXggPSBpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBPdGhlcndpc2UsIHdlIHRyeSB0byBmaW5kIG9uZSBiZWZvcmVcbiAgICAgICAgLy8gV2UgaXRlcmF0ZSBpbiByZXZlcnNlIHNvIHRoYXQgd2UgZG9uJ3QgZ28gdG9vIGZhciBiYWNrXG4gICAgICAgIGZvciAobGV0IGkgPSBub2Rlcy5jbGFpbV9pbmZvLmxhc3RfaW5kZXggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgY29uc3Qgbm9kZSA9IG5vZGVzW2ldO1xuICAgICAgICAgICAgaWYgKHByZWRpY2F0ZShub2RlKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlcGxhY2VtZW50ID0gcHJvY2Vzc05vZGUobm9kZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlcGxhY2VtZW50ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXMuc3BsaWNlKGksIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXNbaV0gPSByZXBsYWNlbWVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFkb250VXBkYXRlTGFzdEluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzLmNsYWltX2luZm8ubGFzdF9pbmRleCA9IGk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHJlcGxhY2VtZW50ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gU2luY2Ugd2Ugc3BsaWNlZCBiZWZvcmUgdGhlIGxhc3RfaW5kZXgsIHdlIGRlY3JlYXNlIGl0XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzLmNsYWltX2luZm8ubGFzdF9pbmRleC0tO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gbm9kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBJZiB3ZSBjYW4ndCBmaW5kIGFueSBtYXRjaGluZyBub2RlLCB3ZSBjcmVhdGUgYSBuZXcgb25lXG4gICAgICAgIHJldHVybiBjcmVhdGVOb2RlKCk7XG4gICAgfSkoKTtcbiAgICByZXN1bHROb2RlLmNsYWltX29yZGVyID0gbm9kZXMuY2xhaW1faW5mby50b3RhbF9jbGFpbWVkO1xuICAgIG5vZGVzLmNsYWltX2luZm8udG90YWxfY2xhaW1lZCArPSAxO1xuICAgIHJldHVybiByZXN1bHROb2RlO1xufVxuZnVuY3Rpb24gY2xhaW1fZWxlbWVudF9iYXNlKG5vZGVzLCBuYW1lLCBhdHRyaWJ1dGVzLCBjcmVhdGVfZWxlbWVudCkge1xuICAgIHJldHVybiBjbGFpbV9ub2RlKG5vZGVzLCAobm9kZSkgPT4gbm9kZS5ub2RlTmFtZSA9PT0gbmFtZSwgKG5vZGUpID0+IHtcbiAgICAgICAgY29uc3QgcmVtb3ZlID0gW107XG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgbm9kZS5hdHRyaWJ1dGVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGUgPSBub2RlLmF0dHJpYnV0ZXNbal07XG4gICAgICAgICAgICBpZiAoIWF0dHJpYnV0ZXNbYXR0cmlidXRlLm5hbWVdKSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlLnB1c2goYXR0cmlidXRlLm5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJlbW92ZS5mb3JFYWNoKHYgPT4gbm9kZS5yZW1vdmVBdHRyaWJ1dGUodikpO1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH0sICgpID0+IGNyZWF0ZV9lbGVtZW50KG5hbWUpKTtcbn1cbmZ1bmN0aW9uIGNsYWltX2VsZW1lbnQobm9kZXMsIG5hbWUsIGF0dHJpYnV0ZXMpIHtcbiAgICByZXR1cm4gY2xhaW1fZWxlbWVudF9iYXNlKG5vZGVzLCBuYW1lLCBhdHRyaWJ1dGVzLCBlbGVtZW50KTtcbn1cbmZ1bmN0aW9uIGNsYWltX3N2Z19lbGVtZW50KG5vZGVzLCBuYW1lLCBhdHRyaWJ1dGVzKSB7XG4gICAgcmV0dXJuIGNsYWltX2VsZW1lbnRfYmFzZShub2RlcywgbmFtZSwgYXR0cmlidXRlcywgc3ZnX2VsZW1lbnQpO1xufVxuZnVuY3Rpb24gY2xhaW1fdGV4dChub2RlcywgZGF0YSkge1xuICAgIHJldHVybiBjbGFpbV9ub2RlKG5vZGVzLCAobm9kZSkgPT4gbm9kZS5ub2RlVHlwZSA9PT0gMywgKG5vZGUpID0+IHtcbiAgICAgICAgY29uc3QgZGF0YVN0ciA9ICcnICsgZGF0YTtcbiAgICAgICAgaWYgKG5vZGUuZGF0YS5zdGFydHNXaXRoKGRhdGFTdHIpKSB7XG4gICAgICAgICAgICBpZiAobm9kZS5kYXRhLmxlbmd0aCAhPT0gZGF0YVN0ci5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbm9kZS5zcGxpdFRleHQoZGF0YVN0ci5sZW5ndGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbm9kZS5kYXRhID0gZGF0YVN0cjtcbiAgICAgICAgfVxuICAgIH0sICgpID0+IHRleHQoZGF0YSksIHRydWUgLy8gVGV4dCBub2RlcyBzaG91bGQgbm90IHVwZGF0ZSBsYXN0IGluZGV4IHNpbmNlIGl0IGlzIGxpa2VseSBub3Qgd29ydGggaXQgdG8gZWxpbWluYXRlIGFuIGluY3JlYXNpbmcgc3Vic2VxdWVuY2Ugb2YgYWN0dWFsIGVsZW1lbnRzXG4gICAgKTtcbn1cbmZ1bmN0aW9uIGNsYWltX3NwYWNlKG5vZGVzKSB7XG4gICAgcmV0dXJuIGNsYWltX3RleHQobm9kZXMsICcgJyk7XG59XG5mdW5jdGlvbiBmaW5kX2NvbW1lbnQobm9kZXMsIHRleHQsIHN0YXJ0KSB7XG4gICAgZm9yIChsZXQgaSA9IHN0YXJ0OyBpIDwgbm9kZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgY29uc3Qgbm9kZSA9IG5vZGVzW2ldO1xuICAgICAgICBpZiAobm9kZS5ub2RlVHlwZSA9PT0gOCAvKiBjb21tZW50IG5vZGUgKi8gJiYgbm9kZS50ZXh0Q29udGVudC50cmltKCkgPT09IHRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBub2Rlcy5sZW5ndGg7XG59XG5mdW5jdGlvbiBjbGFpbV9odG1sX3RhZyhub2RlcywgaXNfc3ZnKSB7XG4gICAgLy8gZmluZCBodG1sIG9wZW5pbmcgdGFnXG4gICAgY29uc3Qgc3RhcnRfaW5kZXggPSBmaW5kX2NvbW1lbnQobm9kZXMsICdIVE1MX1RBR19TVEFSVCcsIDApO1xuICAgIGNvbnN0IGVuZF9pbmRleCA9IGZpbmRfY29tbWVudChub2RlcywgJ0hUTUxfVEFHX0VORCcsIHN0YXJ0X2luZGV4KTtcbiAgICBpZiAoc3RhcnRfaW5kZXggPT09IGVuZF9pbmRleCkge1xuICAgICAgICByZXR1cm4gbmV3IEh0bWxUYWdIeWRyYXRpb24odW5kZWZpbmVkLCBpc19zdmcpO1xuICAgIH1cbiAgICBpbml0X2NsYWltX2luZm8obm9kZXMpO1xuICAgIGNvbnN0IGh0bWxfdGFnX25vZGVzID0gbm9kZXMuc3BsaWNlKHN0YXJ0X2luZGV4LCBlbmRfaW5kZXggLSBzdGFydF9pbmRleCArIDEpO1xuICAgIGRldGFjaChodG1sX3RhZ19ub2Rlc1swXSk7XG4gICAgZGV0YWNoKGh0bWxfdGFnX25vZGVzW2h0bWxfdGFnX25vZGVzLmxlbmd0aCAtIDFdKTtcbiAgICBjb25zdCBjbGFpbWVkX25vZGVzID0gaHRtbF90YWdfbm9kZXMuc2xpY2UoMSwgaHRtbF90YWdfbm9kZXMubGVuZ3RoIC0gMSk7XG4gICAgZm9yIChjb25zdCBuIG9mIGNsYWltZWRfbm9kZXMpIHtcbiAgICAgICAgbi5jbGFpbV9vcmRlciA9IG5vZGVzLmNsYWltX2luZm8udG90YWxfY2xhaW1lZDtcbiAgICAgICAgbm9kZXMuY2xhaW1faW5mby50b3RhbF9jbGFpbWVkICs9IDE7XG4gICAgfVxuICAgIHJldHVybiBuZXcgSHRtbFRhZ0h5ZHJhdGlvbihjbGFpbWVkX25vZGVzLCBpc19zdmcpO1xufVxuZnVuY3Rpb24gc2V0X2RhdGEodGV4dCwgZGF0YSkge1xuICAgIGRhdGEgPSAnJyArIGRhdGE7XG4gICAgaWYgKHRleHQud2hvbGVUZXh0ICE9PSBkYXRhKVxuICAgICAgICB0ZXh0LmRhdGEgPSBkYXRhO1xufVxuZnVuY3Rpb24gc2V0X2lucHV0X3ZhbHVlKGlucHV0LCB2YWx1ZSkge1xuICAgIGlucHV0LnZhbHVlID0gdmFsdWUgPT0gbnVsbCA/ICcnIDogdmFsdWU7XG59XG5mdW5jdGlvbiBzZXRfaW5wdXRfdHlwZShpbnB1dCwgdHlwZSkge1xuICAgIHRyeSB7XG4gICAgICAgIGlucHV0LnR5cGUgPSB0eXBlO1xuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICAvLyBkbyBub3RoaW5nXG4gICAgfVxufVxuZnVuY3Rpb24gc2V0X3N0eWxlKG5vZGUsIGtleSwgdmFsdWUsIGltcG9ydGFudCkge1xuICAgIGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICBub2RlLnN0eWxlLnJlbW92ZVByb3BlcnR5KGtleSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBub2RlLnN0eWxlLnNldFByb3BlcnR5KGtleSwgdmFsdWUsIGltcG9ydGFudCA/ICdpbXBvcnRhbnQnIDogJycpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNlbGVjdF9vcHRpb24oc2VsZWN0LCB2YWx1ZSkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0Lm9wdGlvbnMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgY29uc3Qgb3B0aW9uID0gc2VsZWN0Lm9wdGlvbnNbaV07XG4gICAgICAgIGlmIChvcHRpb24uX192YWx1ZSA9PT0gdmFsdWUpIHtcbiAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG4gICAgc2VsZWN0LnNlbGVjdGVkSW5kZXggPSAtMTsgLy8gbm8gb3B0aW9uIHNob3VsZCBiZSBzZWxlY3RlZFxufVxuZnVuY3Rpb24gc2VsZWN0X29wdGlvbnMoc2VsZWN0LCB2YWx1ZSkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0Lm9wdGlvbnMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgY29uc3Qgb3B0aW9uID0gc2VsZWN0Lm9wdGlvbnNbaV07XG4gICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IH52YWx1ZS5pbmRleE9mKG9wdGlvbi5fX3ZhbHVlKTtcbiAgICB9XG59XG5mdW5jdGlvbiBzZWxlY3RfdmFsdWUoc2VsZWN0KSB7XG4gICAgY29uc3Qgc2VsZWN0ZWRfb3B0aW9uID0gc2VsZWN0LnF1ZXJ5U2VsZWN0b3IoJzpjaGVja2VkJykgfHwgc2VsZWN0Lm9wdGlvbnNbMF07XG4gICAgcmV0dXJuIHNlbGVjdGVkX29wdGlvbiAmJiBzZWxlY3RlZF9vcHRpb24uX192YWx1ZTtcbn1cbmZ1bmN0aW9uIHNlbGVjdF9tdWx0aXBsZV92YWx1ZShzZWxlY3QpIHtcbiAgICByZXR1cm4gW10ubWFwLmNhbGwoc2VsZWN0LnF1ZXJ5U2VsZWN0b3JBbGwoJzpjaGVja2VkJyksIG9wdGlvbiA9PiBvcHRpb24uX192YWx1ZSk7XG59XG4vLyB1bmZvcnR1bmF0ZWx5IHRoaXMgY2FuJ3QgYmUgYSBjb25zdGFudCBhcyB0aGF0IHdvdWxkbid0IGJlIHRyZWUtc2hha2VhYmxlXG4vLyBzbyB3ZSBjYWNoZSB0aGUgcmVzdWx0IGluc3RlYWRcbmxldCBjcm9zc29yaWdpbjtcbmZ1bmN0aW9uIGlzX2Nyb3Nzb3JpZ2luKCkge1xuICAgIGlmIChjcm9zc29yaWdpbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNyb3Nzb3JpZ2luID0gZmFsc2U7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LnBhcmVudCkge1xuICAgICAgICAgICAgICAgIHZvaWQgd2luZG93LnBhcmVudC5kb2N1bWVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNyb3Nzb3JpZ2luID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gY3Jvc3NvcmlnaW47XG59XG5mdW5jdGlvbiBhZGRfcmVzaXplX2xpc3RlbmVyKG5vZGUsIGZuKSB7XG4gICAgY29uc3QgY29tcHV0ZWRfc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKG5vZGUpO1xuICAgIGlmIChjb21wdXRlZF9zdHlsZS5wb3NpdGlvbiA9PT0gJ3N0YXRpYycpIHtcbiAgICAgICAgbm9kZS5zdHlsZS5wb3NpdGlvbiA9ICdyZWxhdGl2ZSc7XG4gICAgfVxuICAgIGNvbnN0IGlmcmFtZSA9IGVsZW1lbnQoJ2lmcmFtZScpO1xuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgJ2Rpc3BsYXk6IGJsb2NrOyBwb3NpdGlvbjogYWJzb2x1dGU7IHRvcDogMDsgbGVmdDogMDsgd2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsgJyArXG4gICAgICAgICdvdmVyZmxvdzogaGlkZGVuOyBib3JkZXI6IDA7IG9wYWNpdHk6IDA7IHBvaW50ZXItZXZlbnRzOiBub25lOyB6LWluZGV4OiAtMTsnKTtcbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICd0cnVlJyk7XG4gICAgaWZyYW1lLnRhYkluZGV4ID0gLTE7XG4gICAgY29uc3QgY3Jvc3NvcmlnaW4gPSBpc19jcm9zc29yaWdpbigpO1xuICAgIGxldCB1bnN1YnNjcmliZTtcbiAgICBpZiAoY3Jvc3NvcmlnaW4pIHtcbiAgICAgICAgaWZyYW1lLnNyYyA9IFwiZGF0YTp0ZXh0L2h0bWwsPHNjcmlwdD5vbnJlc2l6ZT1mdW5jdGlvbigpe3BhcmVudC5wb3N0TWVzc2FnZSgwLCcqJyl9PC9zY3JpcHQ+XCI7XG4gICAgICAgIHVuc3Vic2NyaWJlID0gbGlzdGVuKHdpbmRvdywgJ21lc3NhZ2UnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmIChldmVudC5zb3VyY2UgPT09IGlmcmFtZS5jb250ZW50V2luZG93KVxuICAgICAgICAgICAgICAgIGZuKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaWZyYW1lLnNyYyA9ICdhYm91dDpibGFuayc7XG4gICAgICAgIGlmcmFtZS5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICAgICAgICB1bnN1YnNjcmliZSA9IGxpc3RlbihpZnJhbWUuY29udGVudFdpbmRvdywgJ3Jlc2l6ZScsIGZuKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgYXBwZW5kKG5vZGUsIGlmcmFtZSk7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgaWYgKGNyb3Nzb3JpZ2luKSB7XG4gICAgICAgICAgICB1bnN1YnNjcmliZSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHVuc3Vic2NyaWJlICYmIGlmcmFtZS5jb250ZW50V2luZG93KSB7XG4gICAgICAgICAgICB1bnN1YnNjcmliZSgpO1xuICAgICAgICB9XG4gICAgICAgIGRldGFjaChpZnJhbWUpO1xuICAgIH07XG59XG5mdW5jdGlvbiB0b2dnbGVfY2xhc3MoZWxlbWVudCwgbmFtZSwgdG9nZ2xlKSB7XG4gICAgZWxlbWVudC5jbGFzc0xpc3RbdG9nZ2xlID8gJ2FkZCcgOiAncmVtb3ZlJ10obmFtZSk7XG59XG5mdW5jdGlvbiBjdXN0b21fZXZlbnQodHlwZSwgZGV0YWlsLCB7IGJ1YmJsZXMgPSBmYWxzZSwgY2FuY2VsYWJsZSA9IGZhbHNlIH0gPSB7fSkge1xuICAgIGNvbnN0IGUgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnQ3VzdG9tRXZlbnQnKTtcbiAgICBlLmluaXRDdXN0b21FdmVudCh0eXBlLCBidWJibGVzLCBjYW5jZWxhYmxlLCBkZXRhaWwpO1xuICAgIHJldHVybiBlO1xufVxuZnVuY3Rpb24gcXVlcnlfc2VsZWN0b3JfYWxsKHNlbGVjdG9yLCBwYXJlbnQgPSBkb2N1bWVudC5ib2R5KSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20ocGFyZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpKTtcbn1cbmNsYXNzIEh0bWxUYWcge1xuICAgIGNvbnN0cnVjdG9yKGlzX3N2ZyA9IGZhbHNlKSB7XG4gICAgICAgIHRoaXMuaXNfc3ZnID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaXNfc3ZnID0gaXNfc3ZnO1xuICAgICAgICB0aGlzLmUgPSB0aGlzLm4gPSBudWxsO1xuICAgIH1cbiAgICBjKGh0bWwpIHtcbiAgICAgICAgdGhpcy5oKGh0bWwpO1xuICAgIH1cbiAgICBtKGh0bWwsIHRhcmdldCwgYW5jaG9yID0gbnVsbCkge1xuICAgICAgICBpZiAoIXRoaXMuZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNfc3ZnKVxuICAgICAgICAgICAgICAgIHRoaXMuZSA9IHN2Z19lbGVtZW50KHRhcmdldC5ub2RlTmFtZSk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgdGhpcy5lID0gZWxlbWVudCh0YXJnZXQubm9kZU5hbWUpO1xuICAgICAgICAgICAgdGhpcy50ID0gdGFyZ2V0O1xuICAgICAgICAgICAgdGhpcy5jKGh0bWwpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaShhbmNob3IpO1xuICAgIH1cbiAgICBoKGh0bWwpIHtcbiAgICAgICAgdGhpcy5lLmlubmVySFRNTCA9IGh0bWw7XG4gICAgICAgIHRoaXMubiA9IEFycmF5LmZyb20odGhpcy5lLmNoaWxkTm9kZXMpO1xuICAgIH1cbiAgICBpKGFuY2hvcikge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubi5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgaW5zZXJ0KHRoaXMudCwgdGhpcy5uW2ldLCBhbmNob3IpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHAoaHRtbCkge1xuICAgICAgICB0aGlzLmQoKTtcbiAgICAgICAgdGhpcy5oKGh0bWwpO1xuICAgICAgICB0aGlzLmkodGhpcy5hKTtcbiAgICB9XG4gICAgZCgpIHtcbiAgICAgICAgdGhpcy5uLmZvckVhY2goZGV0YWNoKTtcbiAgICB9XG59XG5jbGFzcyBIdG1sVGFnSHlkcmF0aW9uIGV4dGVuZHMgSHRtbFRhZyB7XG4gICAgY29uc3RydWN0b3IoY2xhaW1lZF9ub2RlcywgaXNfc3ZnID0gZmFsc2UpIHtcbiAgICAgICAgc3VwZXIoaXNfc3ZnKTtcbiAgICAgICAgdGhpcy5lID0gdGhpcy5uID0gbnVsbDtcbiAgICAgICAgdGhpcy5sID0gY2xhaW1lZF9ub2RlcztcbiAgICB9XG4gICAgYyhodG1sKSB7XG4gICAgICAgIGlmICh0aGlzLmwpIHtcbiAgICAgICAgICAgIHRoaXMubiA9IHRoaXMubDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHN1cGVyLmMoaHRtbCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaShhbmNob3IpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm4ubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgICAgIGluc2VydF9oeWRyYXRpb24odGhpcy50LCB0aGlzLm5baV0sIGFuY2hvcik7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBhdHRyaWJ1dGVfdG9fb2JqZWN0KGF0dHJpYnV0ZXMpIHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGF0dHJpYnV0ZSBvZiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgIHJlc3VsdFthdHRyaWJ1dGUubmFtZV0gPSBhdHRyaWJ1dGUudmFsdWU7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBnZXRfY3VzdG9tX2VsZW1lbnRzX3Nsb3RzKGVsZW1lbnQpIHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBlbGVtZW50LmNoaWxkTm9kZXMuZm9yRWFjaCgobm9kZSkgPT4ge1xuICAgICAgICByZXN1bHRbbm9kZS5zbG90IHx8ICdkZWZhdWx0J10gPSB0cnVlO1xuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5cbi8vIHdlIG5lZWQgdG8gc3RvcmUgdGhlIGluZm9ybWF0aW9uIGZvciBtdWx0aXBsZSBkb2N1bWVudHMgYmVjYXVzZSBhIFN2ZWx0ZSBhcHBsaWNhdGlvbiBjb3VsZCBhbHNvIGNvbnRhaW4gaWZyYW1lc1xuLy8gaHR0cHM6Ly9naXRodWIuY29tL3N2ZWx0ZWpzL3N2ZWx0ZS9pc3N1ZXMvMzYyNFxuY29uc3QgbWFuYWdlZF9zdHlsZXMgPSBuZXcgTWFwKCk7XG5sZXQgYWN0aXZlID0gMDtcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9kYXJrc2t5YXBwL3N0cmluZy1oYXNoL2Jsb2IvbWFzdGVyL2luZGV4LmpzXG5mdW5jdGlvbiBoYXNoKHN0cikge1xuICAgIGxldCBoYXNoID0gNTM4MTtcbiAgICBsZXQgaSA9IHN0ci5sZW5ndGg7XG4gICAgd2hpbGUgKGktLSlcbiAgICAgICAgaGFzaCA9ICgoaGFzaCA8PCA1KSAtIGhhc2gpIF4gc3RyLmNoYXJDb2RlQXQoaSk7XG4gICAgcmV0dXJuIGhhc2ggPj4+IDA7XG59XG5mdW5jdGlvbiBjcmVhdGVfc3R5bGVfaW5mb3JtYXRpb24oZG9jLCBub2RlKSB7XG4gICAgY29uc3QgaW5mbyA9IHsgc3R5bGVzaGVldDogYXBwZW5kX2VtcHR5X3N0eWxlc2hlZXQobm9kZSksIHJ1bGVzOiB7fSB9O1xuICAgIG1hbmFnZWRfc3R5bGVzLnNldChkb2MsIGluZm8pO1xuICAgIHJldHVybiBpbmZvO1xufVxuZnVuY3Rpb24gY3JlYXRlX3J1bGUobm9kZSwgYSwgYiwgZHVyYXRpb24sIGRlbGF5LCBlYXNlLCBmbiwgdWlkID0gMCkge1xuICAgIGNvbnN0IHN0ZXAgPSAxNi42NjYgLyBkdXJhdGlvbjtcbiAgICBsZXQga2V5ZnJhbWVzID0gJ3tcXG4nO1xuICAgIGZvciAobGV0IHAgPSAwOyBwIDw9IDE7IHAgKz0gc3RlcCkge1xuICAgICAgICBjb25zdCB0ID0gYSArIChiIC0gYSkgKiBlYXNlKHApO1xuICAgICAgICBrZXlmcmFtZXMgKz0gcCAqIDEwMCArIGAleyR7Zm4odCwgMSAtIHQpfX1cXG5gO1xuICAgIH1cbiAgICBjb25zdCBydWxlID0ga2V5ZnJhbWVzICsgYDEwMCUgeyR7Zm4oYiwgMSAtIGIpfX1cXG59YDtcbiAgICBjb25zdCBuYW1lID0gYF9fc3ZlbHRlXyR7aGFzaChydWxlKX1fJHt1aWR9YDtcbiAgICBjb25zdCBkb2MgPSBnZXRfcm9vdF9mb3Jfc3R5bGUobm9kZSk7XG4gICAgY29uc3QgeyBzdHlsZXNoZWV0LCBydWxlcyB9ID0gbWFuYWdlZF9zdHlsZXMuZ2V0KGRvYykgfHwgY3JlYXRlX3N0eWxlX2luZm9ybWF0aW9uKGRvYywgbm9kZSk7XG4gICAgaWYgKCFydWxlc1tuYW1lXSkge1xuICAgICAgICBydWxlc1tuYW1lXSA9IHRydWU7XG4gICAgICAgIHN0eWxlc2hlZXQuaW5zZXJ0UnVsZShgQGtleWZyYW1lcyAke25hbWV9ICR7cnVsZX1gLCBzdHlsZXNoZWV0LmNzc1J1bGVzLmxlbmd0aCk7XG4gICAgfVxuICAgIGNvbnN0IGFuaW1hdGlvbiA9IG5vZGUuc3R5bGUuYW5pbWF0aW9uIHx8ICcnO1xuICAgIG5vZGUuc3R5bGUuYW5pbWF0aW9uID0gYCR7YW5pbWF0aW9uID8gYCR7YW5pbWF0aW9ufSwgYCA6ICcnfSR7bmFtZX0gJHtkdXJhdGlvbn1tcyBsaW5lYXIgJHtkZWxheX1tcyAxIGJvdGhgO1xuICAgIGFjdGl2ZSArPSAxO1xuICAgIHJldHVybiBuYW1lO1xufVxuZnVuY3Rpb24gZGVsZXRlX3J1bGUobm9kZSwgbmFtZSkge1xuICAgIGNvbnN0IHByZXZpb3VzID0gKG5vZGUuc3R5bGUuYW5pbWF0aW9uIHx8ICcnKS5zcGxpdCgnLCAnKTtcbiAgICBjb25zdCBuZXh0ID0gcHJldmlvdXMuZmlsdGVyKG5hbWVcbiAgICAgICAgPyBhbmltID0+IGFuaW0uaW5kZXhPZihuYW1lKSA8IDAgLy8gcmVtb3ZlIHNwZWNpZmljIGFuaW1hdGlvblxuICAgICAgICA6IGFuaW0gPT4gYW5pbS5pbmRleE9mKCdfX3N2ZWx0ZScpID09PSAtMSAvLyByZW1vdmUgYWxsIFN2ZWx0ZSBhbmltYXRpb25zXG4gICAgKTtcbiAgICBjb25zdCBkZWxldGVkID0gcHJldmlvdXMubGVuZ3RoIC0gbmV4dC5sZW5ndGg7XG4gICAgaWYgKGRlbGV0ZWQpIHtcbiAgICAgICAgbm9kZS5zdHlsZS5hbmltYXRpb24gPSBuZXh0LmpvaW4oJywgJyk7XG4gICAgICAgIGFjdGl2ZSAtPSBkZWxldGVkO1xuICAgICAgICBpZiAoIWFjdGl2ZSlcbiAgICAgICAgICAgIGNsZWFyX3J1bGVzKCk7XG4gICAgfVxufVxuZnVuY3Rpb24gY2xlYXJfcnVsZXMoKSB7XG4gICAgcmFmKCgpID0+IHtcbiAgICAgICAgaWYgKGFjdGl2ZSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgbWFuYWdlZF9zdHlsZXMuZm9yRWFjaChpbmZvID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHsgc3R5bGVzaGVldCB9ID0gaW5mbztcbiAgICAgICAgICAgIGxldCBpID0gc3R5bGVzaGVldC5jc3NSdWxlcy5sZW5ndGg7XG4gICAgICAgICAgICB3aGlsZSAoaS0tKVxuICAgICAgICAgICAgICAgIHN0eWxlc2hlZXQuZGVsZXRlUnVsZShpKTtcbiAgICAgICAgICAgIGluZm8ucnVsZXMgPSB7fTtcbiAgICAgICAgfSk7XG4gICAgICAgIG1hbmFnZWRfc3R5bGVzLmNsZWFyKCk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZV9hbmltYXRpb24obm9kZSwgZnJvbSwgZm4sIHBhcmFtcykge1xuICAgIGlmICghZnJvbSlcbiAgICAgICAgcmV0dXJuIG5vb3A7XG4gICAgY29uc3QgdG8gPSBub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIGlmIChmcm9tLmxlZnQgPT09IHRvLmxlZnQgJiYgZnJvbS5yaWdodCA9PT0gdG8ucmlnaHQgJiYgZnJvbS50b3AgPT09IHRvLnRvcCAmJiBmcm9tLmJvdHRvbSA9PT0gdG8uYm90dG9tKVxuICAgICAgICByZXR1cm4gbm9vcDtcbiAgICBjb25zdCB7IGRlbGF5ID0gMCwgZHVyYXRpb24gPSAzMDAsIGVhc2luZyA9IGlkZW50aXR5LCBcbiAgICAvLyBAdHMtaWdub3JlIHRvZG86IHNob3VsZCB0aGlzIGJlIHNlcGFyYXRlZCBmcm9tIGRlc3RydWN0dXJpbmc/IE9yIHN0YXJ0L2VuZCBhZGRlZCB0byBwdWJsaWMgYXBpIGFuZCBkb2N1bWVudGF0aW9uP1xuICAgIHN0YXJ0OiBzdGFydF90aW1lID0gbm93KCkgKyBkZWxheSwgXG4gICAgLy8gQHRzLWlnbm9yZSB0b2RvOlxuICAgIGVuZCA9IHN0YXJ0X3RpbWUgKyBkdXJhdGlvbiwgdGljayA9IG5vb3AsIGNzcyB9ID0gZm4obm9kZSwgeyBmcm9tLCB0byB9LCBwYXJhbXMpO1xuICAgIGxldCBydW5uaW5nID0gdHJ1ZTtcbiAgICBsZXQgc3RhcnRlZCA9IGZhbHNlO1xuICAgIGxldCBuYW1lO1xuICAgIGZ1bmN0aW9uIHN0YXJ0KCkge1xuICAgICAgICBpZiAoY3NzKSB7XG4gICAgICAgICAgICBuYW1lID0gY3JlYXRlX3J1bGUobm9kZSwgMCwgMSwgZHVyYXRpb24sIGRlbGF5LCBlYXNpbmcsIGNzcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFkZWxheSkge1xuICAgICAgICAgICAgc3RhcnRlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICAgICAgaWYgKGNzcylcbiAgICAgICAgICAgIGRlbGV0ZV9ydWxlKG5vZGUsIG5hbWUpO1xuICAgICAgICBydW5uaW5nID0gZmFsc2U7XG4gICAgfVxuICAgIGxvb3Aobm93ID0+IHtcbiAgICAgICAgaWYgKCFzdGFydGVkICYmIG5vdyA+PSBzdGFydF90aW1lKSB7XG4gICAgICAgICAgICBzdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RhcnRlZCAmJiBub3cgPj0gZW5kKSB7XG4gICAgICAgICAgICB0aWNrKDEsIDApO1xuICAgICAgICAgICAgc3RvcCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcnVubmluZykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdGFydGVkKSB7XG4gICAgICAgICAgICBjb25zdCBwID0gbm93IC0gc3RhcnRfdGltZTtcbiAgICAgICAgICAgIGNvbnN0IHQgPSAwICsgMSAqIGVhc2luZyhwIC8gZHVyYXRpb24pO1xuICAgICAgICAgICAgdGljayh0LCAxIC0gdCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSk7XG4gICAgc3RhcnQoKTtcbiAgICB0aWNrKDAsIDEpO1xuICAgIHJldHVybiBzdG9wO1xufVxuZnVuY3Rpb24gZml4X3Bvc2l0aW9uKG5vZGUpIHtcbiAgICBjb25zdCBzdHlsZSA9IGdldENvbXB1dGVkU3R5bGUobm9kZSk7XG4gICAgaWYgKHN0eWxlLnBvc2l0aW9uICE9PSAnYWJzb2x1dGUnICYmIHN0eWxlLnBvc2l0aW9uICE9PSAnZml4ZWQnKSB7XG4gICAgICAgIGNvbnN0IHsgd2lkdGgsIGhlaWdodCB9ID0gc3R5bGU7XG4gICAgICAgIGNvbnN0IGEgPSBub2RlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICBub2RlLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcbiAgICAgICAgbm9kZS5zdHlsZS53aWR0aCA9IHdpZHRoO1xuICAgICAgICBub2RlLnN0eWxlLmhlaWdodCA9IGhlaWdodDtcbiAgICAgICAgYWRkX3RyYW5zZm9ybShub2RlLCBhKTtcbiAgICB9XG59XG5mdW5jdGlvbiBhZGRfdHJhbnNmb3JtKG5vZGUsIGEpIHtcbiAgICBjb25zdCBiID0gbm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBpZiAoYS5sZWZ0ICE9PSBiLmxlZnQgfHwgYS50b3AgIT09IGIudG9wKSB7XG4gICAgICAgIGNvbnN0IHN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShub2RlKTtcbiAgICAgICAgY29uc3QgdHJhbnNmb3JtID0gc3R5bGUudHJhbnNmb3JtID09PSAnbm9uZScgPyAnJyA6IHN0eWxlLnRyYW5zZm9ybTtcbiAgICAgICAgbm9kZS5zdHlsZS50cmFuc2Zvcm0gPSBgJHt0cmFuc2Zvcm19IHRyYW5zbGF0ZSgke2EubGVmdCAtIGIubGVmdH1weCwgJHthLnRvcCAtIGIudG9wfXB4KWA7XG4gICAgfVxufVxuXG5sZXQgY3VycmVudF9jb21wb25lbnQ7XG5mdW5jdGlvbiBzZXRfY3VycmVudF9jb21wb25lbnQoY29tcG9uZW50KSB7XG4gICAgY3VycmVudF9jb21wb25lbnQgPSBjb21wb25lbnQ7XG59XG5mdW5jdGlvbiBnZXRfY3VycmVudF9jb21wb25lbnQoKSB7XG4gICAgaWYgKCFjdXJyZW50X2NvbXBvbmVudClcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGdW5jdGlvbiBjYWxsZWQgb3V0c2lkZSBjb21wb25lbnQgaW5pdGlhbGl6YXRpb24nKTtcbiAgICByZXR1cm4gY3VycmVudF9jb21wb25lbnQ7XG59XG5mdW5jdGlvbiBiZWZvcmVVcGRhdGUoZm4pIHtcbiAgICBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5iZWZvcmVfdXBkYXRlLnB1c2goZm4pO1xufVxuZnVuY3Rpb24gb25Nb3VudChmbikge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLm9uX21vdW50LnB1c2goZm4pO1xufVxuZnVuY3Rpb24gYWZ0ZXJVcGRhdGUoZm4pIHtcbiAgICBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5hZnRlcl91cGRhdGUucHVzaChmbik7XG59XG5mdW5jdGlvbiBvbkRlc3Ryb3koZm4pIHtcbiAgICBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5vbl9kZXN0cm95LnB1c2goZm4pO1xufVxuZnVuY3Rpb24gY3JlYXRlRXZlbnREaXNwYXRjaGVyKCkge1xuICAgIGNvbnN0IGNvbXBvbmVudCA9IGdldF9jdXJyZW50X2NvbXBvbmVudCgpO1xuICAgIHJldHVybiAodHlwZSwgZGV0YWlsLCB7IGNhbmNlbGFibGUgPSBmYWxzZSB9ID0ge30pID0+IHtcbiAgICAgICAgY29uc3QgY2FsbGJhY2tzID0gY29tcG9uZW50LiQkLmNhbGxiYWNrc1t0eXBlXTtcbiAgICAgICAgaWYgKGNhbGxiYWNrcykge1xuICAgICAgICAgICAgLy8gVE9ETyBhcmUgdGhlcmUgc2l0dWF0aW9ucyB3aGVyZSBldmVudHMgY291bGQgYmUgZGlzcGF0Y2hlZFxuICAgICAgICAgICAgLy8gaW4gYSBzZXJ2ZXIgKG5vbi1ET00pIGVudmlyb25tZW50P1xuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBjdXN0b21fZXZlbnQodHlwZSwgZGV0YWlsLCB7IGNhbmNlbGFibGUgfSk7XG4gICAgICAgICAgICBjYWxsYmFja3Muc2xpY2UoKS5mb3JFYWNoKGZuID0+IHtcbiAgICAgICAgICAgICAgICBmbi5jYWxsKGNvbXBvbmVudCwgZXZlbnQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gIWV2ZW50LmRlZmF1bHRQcmV2ZW50ZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHNldENvbnRleHQoa2V5LCBjb250ZXh0KSB7XG4gICAgZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQuY29udGV4dC5zZXQoa2V5LCBjb250ZXh0KTtcbiAgICByZXR1cm4gY29udGV4dDtcbn1cbmZ1bmN0aW9uIGdldENvbnRleHQoa2V5KSB7XG4gICAgcmV0dXJuIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmNvbnRleHQuZ2V0KGtleSk7XG59XG5mdW5jdGlvbiBnZXRBbGxDb250ZXh0cygpIHtcbiAgICByZXR1cm4gZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQuY29udGV4dDtcbn1cbmZ1bmN0aW9uIGhhc0NvbnRleHQoa2V5KSB7XG4gICAgcmV0dXJuIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmNvbnRleHQuaGFzKGtleSk7XG59XG4vLyBUT0RPIGZpZ3VyZSBvdXQgaWYgd2Ugc3RpbGwgd2FudCB0byBzdXBwb3J0XG4vLyBzaG9ydGhhbmQgZXZlbnRzLCBvciBpZiB3ZSB3YW50IHRvIGltcGxlbWVudFxuLy8gYSByZWFsIGJ1YmJsaW5nIG1lY2hhbmlzbVxuZnVuY3Rpb24gYnViYmxlKGNvbXBvbmVudCwgZXZlbnQpIHtcbiAgICBjb25zdCBjYWxsYmFja3MgPSBjb21wb25lbnQuJCQuY2FsbGJhY2tzW2V2ZW50LnR5cGVdO1xuICAgIGlmIChjYWxsYmFja3MpIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBjYWxsYmFja3Muc2xpY2UoKS5mb3JFYWNoKGZuID0+IGZuLmNhbGwodGhpcywgZXZlbnQpKTtcbiAgICB9XG59XG5cbmNvbnN0IGRpcnR5X2NvbXBvbmVudHMgPSBbXTtcbmNvbnN0IGludHJvcyA9IHsgZW5hYmxlZDogZmFsc2UgfTtcbmNvbnN0IGJpbmRpbmdfY2FsbGJhY2tzID0gW107XG5jb25zdCByZW5kZXJfY2FsbGJhY2tzID0gW107XG5jb25zdCBmbHVzaF9jYWxsYmFja3MgPSBbXTtcbmNvbnN0IHJlc29sdmVkX3Byb21pc2UgPSBQcm9taXNlLnJlc29sdmUoKTtcbmxldCB1cGRhdGVfc2NoZWR1bGVkID0gZmFsc2U7XG5mdW5jdGlvbiBzY2hlZHVsZV91cGRhdGUoKSB7XG4gICAgaWYgKCF1cGRhdGVfc2NoZWR1bGVkKSB7XG4gICAgICAgIHVwZGF0ZV9zY2hlZHVsZWQgPSB0cnVlO1xuICAgICAgICByZXNvbHZlZF9wcm9taXNlLnRoZW4oZmx1c2gpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHRpY2soKSB7XG4gICAgc2NoZWR1bGVfdXBkYXRlKCk7XG4gICAgcmV0dXJuIHJlc29sdmVkX3Byb21pc2U7XG59XG5mdW5jdGlvbiBhZGRfcmVuZGVyX2NhbGxiYWNrKGZuKSB7XG4gICAgcmVuZGVyX2NhbGxiYWNrcy5wdXNoKGZuKTtcbn1cbmZ1bmN0aW9uIGFkZF9mbHVzaF9jYWxsYmFjayhmbikge1xuICAgIGZsdXNoX2NhbGxiYWNrcy5wdXNoKGZuKTtcbn1cbi8vIGZsdXNoKCkgY2FsbHMgY2FsbGJhY2tzIGluIHRoaXMgb3JkZXI6XG4vLyAxLiBBbGwgYmVmb3JlVXBkYXRlIGNhbGxiYWNrcywgaW4gb3JkZXI6IHBhcmVudHMgYmVmb3JlIGNoaWxkcmVuXG4vLyAyLiBBbGwgYmluZDp0aGlzIGNhbGxiYWNrcywgaW4gcmV2ZXJzZSBvcmRlcjogY2hpbGRyZW4gYmVmb3JlIHBhcmVudHMuXG4vLyAzLiBBbGwgYWZ0ZXJVcGRhdGUgY2FsbGJhY2tzLCBpbiBvcmRlcjogcGFyZW50cyBiZWZvcmUgY2hpbGRyZW4uIEVYQ0VQVFxuLy8gICAgZm9yIGFmdGVyVXBkYXRlcyBjYWxsZWQgZHVyaW5nIHRoZSBpbml0aWFsIG9uTW91bnQsIHdoaWNoIGFyZSBjYWxsZWQgaW5cbi8vICAgIHJldmVyc2Ugb3JkZXI6IGNoaWxkcmVuIGJlZm9yZSBwYXJlbnRzLlxuLy8gU2luY2UgY2FsbGJhY2tzIG1pZ2h0IHVwZGF0ZSBjb21wb25lbnQgdmFsdWVzLCB3aGljaCBjb3VsZCB0cmlnZ2VyIGFub3RoZXJcbi8vIGNhbGwgdG8gZmx1c2goKSwgdGhlIGZvbGxvd2luZyBzdGVwcyBndWFyZCBhZ2FpbnN0IHRoaXM6XG4vLyAxLiBEdXJpbmcgYmVmb3JlVXBkYXRlLCBhbnkgdXBkYXRlZCBjb21wb25lbnRzIHdpbGwgYmUgYWRkZWQgdG8gdGhlXG4vLyAgICBkaXJ0eV9jb21wb25lbnRzIGFycmF5IGFuZCB3aWxsIGNhdXNlIGEgcmVlbnRyYW50IGNhbGwgdG8gZmx1c2goKS4gQmVjYXVzZVxuLy8gICAgdGhlIGZsdXNoIGluZGV4IGlzIGtlcHQgb3V0c2lkZSB0aGUgZnVuY3Rpb24sIHRoZSByZWVudHJhbnQgY2FsbCB3aWxsIHBpY2tcbi8vICAgIHVwIHdoZXJlIHRoZSBlYXJsaWVyIGNhbGwgbGVmdCBvZmYgYW5kIGdvIHRocm91Z2ggYWxsIGRpcnR5IGNvbXBvbmVudHMuIFRoZVxuLy8gICAgY3VycmVudF9jb21wb25lbnQgdmFsdWUgaXMgc2F2ZWQgYW5kIHJlc3RvcmVkIHNvIHRoYXQgdGhlIHJlZW50cmFudCBjYWxsIHdpbGxcbi8vICAgIG5vdCBpbnRlcmZlcmUgd2l0aCB0aGUgXCJwYXJlbnRcIiBmbHVzaCgpIGNhbGwuXG4vLyAyLiBiaW5kOnRoaXMgY2FsbGJhY2tzIGNhbm5vdCB0cmlnZ2VyIG5ldyBmbHVzaCgpIGNhbGxzLlxuLy8gMy4gRHVyaW5nIGFmdGVyVXBkYXRlLCBhbnkgdXBkYXRlZCBjb21wb25lbnRzIHdpbGwgTk9UIGhhdmUgdGhlaXIgYWZ0ZXJVcGRhdGVcbi8vICAgIGNhbGxiYWNrIGNhbGxlZCBhIHNlY29uZCB0aW1lOyB0aGUgc2Vlbl9jYWxsYmFja3Mgc2V0LCBvdXRzaWRlIHRoZSBmbHVzaCgpXG4vLyAgICBmdW5jdGlvbiwgZ3VhcmFudGVlcyB0aGlzIGJlaGF2aW9yLlxuY29uc3Qgc2Vlbl9jYWxsYmFja3MgPSBuZXcgU2V0KCk7XG5sZXQgZmx1c2hpZHggPSAwOyAvLyBEbyAqbm90KiBtb3ZlIHRoaXMgaW5zaWRlIHRoZSBmbHVzaCgpIGZ1bmN0aW9uXG5mdW5jdGlvbiBmbHVzaCgpIHtcbiAgICBjb25zdCBzYXZlZF9jb21wb25lbnQgPSBjdXJyZW50X2NvbXBvbmVudDtcbiAgICBkbyB7XG4gICAgICAgIC8vIGZpcnN0LCBjYWxsIGJlZm9yZVVwZGF0ZSBmdW5jdGlvbnNcbiAgICAgICAgLy8gYW5kIHVwZGF0ZSBjb21wb25lbnRzXG4gICAgICAgIHdoaWxlIChmbHVzaGlkeCA8IGRpcnR5X2NvbXBvbmVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCBjb21wb25lbnQgPSBkaXJ0eV9jb21wb25lbnRzW2ZsdXNoaWR4XTtcbiAgICAgICAgICAgIGZsdXNoaWR4Kys7XG4gICAgICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQoY29tcG9uZW50KTtcbiAgICAgICAgICAgIHVwZGF0ZShjb21wb25lbnQuJCQpO1xuICAgICAgICB9XG4gICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChudWxsKTtcbiAgICAgICAgZGlydHlfY29tcG9uZW50cy5sZW5ndGggPSAwO1xuICAgICAgICBmbHVzaGlkeCA9IDA7XG4gICAgICAgIHdoaWxlIChiaW5kaW5nX2NhbGxiYWNrcy5sZW5ndGgpXG4gICAgICAgICAgICBiaW5kaW5nX2NhbGxiYWNrcy5wb3AoKSgpO1xuICAgICAgICAvLyB0aGVuLCBvbmNlIGNvbXBvbmVudHMgYXJlIHVwZGF0ZWQsIGNhbGxcbiAgICAgICAgLy8gYWZ0ZXJVcGRhdGUgZnVuY3Rpb25zLiBUaGlzIG1heSBjYXVzZVxuICAgICAgICAvLyBzdWJzZXF1ZW50IHVwZGF0ZXMuLi5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZW5kZXJfY2FsbGJhY2tzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICBjb25zdCBjYWxsYmFjayA9IHJlbmRlcl9jYWxsYmFja3NbaV07XG4gICAgICAgICAgICBpZiAoIXNlZW5fY2FsbGJhY2tzLmhhcyhjYWxsYmFjaykpIHtcbiAgICAgICAgICAgICAgICAvLyAuLi5zbyBndWFyZCBhZ2FpbnN0IGluZmluaXRlIGxvb3BzXG4gICAgICAgICAgICAgICAgc2Vlbl9jYWxsYmFja3MuYWRkKGNhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJlbmRlcl9jYWxsYmFja3MubGVuZ3RoID0gMDtcbiAgICB9IHdoaWxlIChkaXJ0eV9jb21wb25lbnRzLmxlbmd0aCk7XG4gICAgd2hpbGUgKGZsdXNoX2NhbGxiYWNrcy5sZW5ndGgpIHtcbiAgICAgICAgZmx1c2hfY2FsbGJhY2tzLnBvcCgpKCk7XG4gICAgfVxuICAgIHVwZGF0ZV9zY2hlZHVsZWQgPSBmYWxzZTtcbiAgICBzZWVuX2NhbGxiYWNrcy5jbGVhcigpO1xuICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChzYXZlZF9jb21wb25lbnQpO1xufVxuZnVuY3Rpb24gdXBkYXRlKCQkKSB7XG4gICAgaWYgKCQkLmZyYWdtZW50ICE9PSBudWxsKSB7XG4gICAgICAgICQkLnVwZGF0ZSgpO1xuICAgICAgICBydW5fYWxsKCQkLmJlZm9yZV91cGRhdGUpO1xuICAgICAgICBjb25zdCBkaXJ0eSA9ICQkLmRpcnR5O1xuICAgICAgICAkJC5kaXJ0eSA9IFstMV07XG4gICAgICAgICQkLmZyYWdtZW50ICYmICQkLmZyYWdtZW50LnAoJCQuY3R4LCBkaXJ0eSk7XG4gICAgICAgICQkLmFmdGVyX3VwZGF0ZS5mb3JFYWNoKGFkZF9yZW5kZXJfY2FsbGJhY2spO1xuICAgIH1cbn1cblxubGV0IHByb21pc2U7XG5mdW5jdGlvbiB3YWl0KCkge1xuICAgIGlmICghcHJvbWlzZSkge1xuICAgICAgICBwcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIHByb21pc2UudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBwcm9taXNlID0gbnVsbDtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBwcm9taXNlO1xufVxuZnVuY3Rpb24gZGlzcGF0Y2gobm9kZSwgZGlyZWN0aW9uLCBraW5kKSB7XG4gICAgbm9kZS5kaXNwYXRjaEV2ZW50KGN1c3RvbV9ldmVudChgJHtkaXJlY3Rpb24gPyAnaW50cm8nIDogJ291dHJvJ30ke2tpbmR9YCkpO1xufVxuY29uc3Qgb3V0cm9pbmcgPSBuZXcgU2V0KCk7XG5sZXQgb3V0cm9zO1xuZnVuY3Rpb24gZ3JvdXBfb3V0cm9zKCkge1xuICAgIG91dHJvcyA9IHtcbiAgICAgICAgcjogMCxcbiAgICAgICAgYzogW10sXG4gICAgICAgIHA6IG91dHJvcyAvLyBwYXJlbnQgZ3JvdXBcbiAgICB9O1xufVxuZnVuY3Rpb24gY2hlY2tfb3V0cm9zKCkge1xuICAgIGlmICghb3V0cm9zLnIpIHtcbiAgICAgICAgcnVuX2FsbChvdXRyb3MuYyk7XG4gICAgfVxuICAgIG91dHJvcyA9IG91dHJvcy5wO1xufVxuZnVuY3Rpb24gdHJhbnNpdGlvbl9pbihibG9jaywgbG9jYWwpIHtcbiAgICBpZiAoYmxvY2sgJiYgYmxvY2suaSkge1xuICAgICAgICBvdXRyb2luZy5kZWxldGUoYmxvY2spO1xuICAgICAgICBibG9jay5pKGxvY2FsKTtcbiAgICB9XG59XG5mdW5jdGlvbiB0cmFuc2l0aW9uX291dChibG9jaywgbG9jYWwsIGRldGFjaCwgY2FsbGJhY2spIHtcbiAgICBpZiAoYmxvY2sgJiYgYmxvY2subykge1xuICAgICAgICBpZiAob3V0cm9pbmcuaGFzKGJsb2NrKSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgb3V0cm9pbmcuYWRkKGJsb2NrKTtcbiAgICAgICAgb3V0cm9zLmMucHVzaCgoKSA9PiB7XG4gICAgICAgICAgICBvdXRyb2luZy5kZWxldGUoYmxvY2spO1xuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGRldGFjaClcbiAgICAgICAgICAgICAgICAgICAgYmxvY2suZCgxKTtcbiAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgYmxvY2subyhsb2NhbCk7XG4gICAgfVxufVxuY29uc3QgbnVsbF90cmFuc2l0aW9uID0geyBkdXJhdGlvbjogMCB9O1xuZnVuY3Rpb24gY3JlYXRlX2luX3RyYW5zaXRpb24obm9kZSwgZm4sIHBhcmFtcykge1xuICAgIGxldCBjb25maWcgPSBmbihub2RlLCBwYXJhbXMpO1xuICAgIGxldCBydW5uaW5nID0gZmFsc2U7XG4gICAgbGV0IGFuaW1hdGlvbl9uYW1lO1xuICAgIGxldCB0YXNrO1xuICAgIGxldCB1aWQgPSAwO1xuICAgIGZ1bmN0aW9uIGNsZWFudXAoKSB7XG4gICAgICAgIGlmIChhbmltYXRpb25fbmFtZSlcbiAgICAgICAgICAgIGRlbGV0ZV9ydWxlKG5vZGUsIGFuaW1hdGlvbl9uYW1lKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ28oKSB7XG4gICAgICAgIGNvbnN0IHsgZGVsYXkgPSAwLCBkdXJhdGlvbiA9IDMwMCwgZWFzaW5nID0gaWRlbnRpdHksIHRpY2sgPSBub29wLCBjc3MgfSA9IGNvbmZpZyB8fCBudWxsX3RyYW5zaXRpb247XG4gICAgICAgIGlmIChjc3MpXG4gICAgICAgICAgICBhbmltYXRpb25fbmFtZSA9IGNyZWF0ZV9ydWxlKG5vZGUsIDAsIDEsIGR1cmF0aW9uLCBkZWxheSwgZWFzaW5nLCBjc3MsIHVpZCsrKTtcbiAgICAgICAgdGljaygwLCAxKTtcbiAgICAgICAgY29uc3Qgc3RhcnRfdGltZSA9IG5vdygpICsgZGVsYXk7XG4gICAgICAgIGNvbnN0IGVuZF90aW1lID0gc3RhcnRfdGltZSArIGR1cmF0aW9uO1xuICAgICAgICBpZiAodGFzaylcbiAgICAgICAgICAgIHRhc2suYWJvcnQoKTtcbiAgICAgICAgcnVubmluZyA9IHRydWU7XG4gICAgICAgIGFkZF9yZW5kZXJfY2FsbGJhY2soKCkgPT4gZGlzcGF0Y2gobm9kZSwgdHJ1ZSwgJ3N0YXJ0JykpO1xuICAgICAgICB0YXNrID0gbG9vcChub3cgPT4ge1xuICAgICAgICAgICAgaWYgKHJ1bm5pbmcpIHtcbiAgICAgICAgICAgICAgICBpZiAobm93ID49IGVuZF90aW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHRpY2soMSwgMCk7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoKG5vZGUsIHRydWUsICdlbmQnKTtcbiAgICAgICAgICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobm93ID49IHN0YXJ0X3RpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGVhc2luZygobm93IC0gc3RhcnRfdGltZSkgLyBkdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHRpY2sodCwgMSAtIHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBydW5uaW5nO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgbGV0IHN0YXJ0ZWQgPSBmYWxzZTtcbiAgICByZXR1cm4ge1xuICAgICAgICBzdGFydCgpIHtcbiAgICAgICAgICAgIGlmIChzdGFydGVkKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIHN0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgZGVsZXRlX3J1bGUobm9kZSk7XG4gICAgICAgICAgICBpZiAoaXNfZnVuY3Rpb24oY29uZmlnKSkge1xuICAgICAgICAgICAgICAgIGNvbmZpZyA9IGNvbmZpZygpO1xuICAgICAgICAgICAgICAgIHdhaXQoKS50aGVuKGdvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGdvKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGludmFsaWRhdGUoKSB7XG4gICAgICAgICAgICBzdGFydGVkID0gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIGVuZCgpIHtcbiAgICAgICAgICAgIGlmIChydW5uaW5nKSB7XG4gICAgICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgICAgIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG59XG5mdW5jdGlvbiBjcmVhdGVfb3V0X3RyYW5zaXRpb24obm9kZSwgZm4sIHBhcmFtcykge1xuICAgIGxldCBjb25maWcgPSBmbihub2RlLCBwYXJhbXMpO1xuICAgIGxldCBydW5uaW5nID0gdHJ1ZTtcbiAgICBsZXQgYW5pbWF0aW9uX25hbWU7XG4gICAgY29uc3QgZ3JvdXAgPSBvdXRyb3M7XG4gICAgZ3JvdXAuciArPSAxO1xuICAgIGZ1bmN0aW9uIGdvKCkge1xuICAgICAgICBjb25zdCB7IGRlbGF5ID0gMCwgZHVyYXRpb24gPSAzMDAsIGVhc2luZyA9IGlkZW50aXR5LCB0aWNrID0gbm9vcCwgY3NzIH0gPSBjb25maWcgfHwgbnVsbF90cmFuc2l0aW9uO1xuICAgICAgICBpZiAoY3NzKVxuICAgICAgICAgICAgYW5pbWF0aW9uX25hbWUgPSBjcmVhdGVfcnVsZShub2RlLCAxLCAwLCBkdXJhdGlvbiwgZGVsYXksIGVhc2luZywgY3NzKTtcbiAgICAgICAgY29uc3Qgc3RhcnRfdGltZSA9IG5vdygpICsgZGVsYXk7XG4gICAgICAgIGNvbnN0IGVuZF90aW1lID0gc3RhcnRfdGltZSArIGR1cmF0aW9uO1xuICAgICAgICBhZGRfcmVuZGVyX2NhbGxiYWNrKCgpID0+IGRpc3BhdGNoKG5vZGUsIGZhbHNlLCAnc3RhcnQnKSk7XG4gICAgICAgIGxvb3Aobm93ID0+IHtcbiAgICAgICAgICAgIGlmIChydW5uaW5nKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vdyA+PSBlbmRfdGltZSkge1xuICAgICAgICAgICAgICAgICAgICB0aWNrKDAsIDEpO1xuICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaChub2RlLCBmYWxzZSwgJ2VuZCcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIS0tZ3JvdXAucikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyB3aWxsIHJlc3VsdCBpbiBgZW5kKClgIGJlaW5nIGNhbGxlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNvIHdlIGRvbid0IG5lZWQgdG8gY2xlYW4gdXAgaGVyZVxuICAgICAgICAgICAgICAgICAgICAgICAgcnVuX2FsbChncm91cC5jKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChub3cgPj0gc3RhcnRfdGltZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gZWFzaW5nKChub3cgLSBzdGFydF90aW1lKSAvIGR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgdGljaygxIC0gdCwgdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJ1bm5pbmc7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoaXNfZnVuY3Rpb24oY29uZmlnKSkge1xuICAgICAgICB3YWl0KCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICBjb25maWcgPSBjb25maWcoKTtcbiAgICAgICAgICAgIGdvKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZ28oKTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZW5kKHJlc2V0KSB7XG4gICAgICAgICAgICBpZiAocmVzZXQgJiYgY29uZmlnLnRpY2spIHtcbiAgICAgICAgICAgICAgICBjb25maWcudGljaygxLCAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChydW5uaW5nKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFuaW1hdGlvbl9uYW1lKVxuICAgICAgICAgICAgICAgICAgICBkZWxldGVfcnVsZShub2RlLCBhbmltYXRpb25fbmFtZSk7XG4gICAgICAgICAgICAgICAgcnVubmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZV9iaWRpcmVjdGlvbmFsX3RyYW5zaXRpb24obm9kZSwgZm4sIHBhcmFtcywgaW50cm8pIHtcbiAgICBsZXQgY29uZmlnID0gZm4obm9kZSwgcGFyYW1zKTtcbiAgICBsZXQgdCA9IGludHJvID8gMCA6IDE7XG4gICAgbGV0IHJ1bm5pbmdfcHJvZ3JhbSA9IG51bGw7XG4gICAgbGV0IHBlbmRpbmdfcHJvZ3JhbSA9IG51bGw7XG4gICAgbGV0IGFuaW1hdGlvbl9uYW1lID0gbnVsbDtcbiAgICBmdW5jdGlvbiBjbGVhcl9hbmltYXRpb24oKSB7XG4gICAgICAgIGlmIChhbmltYXRpb25fbmFtZSlcbiAgICAgICAgICAgIGRlbGV0ZV9ydWxlKG5vZGUsIGFuaW1hdGlvbl9uYW1lKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gaW5pdChwcm9ncmFtLCBkdXJhdGlvbikge1xuICAgICAgICBjb25zdCBkID0gKHByb2dyYW0uYiAtIHQpO1xuICAgICAgICBkdXJhdGlvbiAqPSBNYXRoLmFicyhkKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGE6IHQsXG4gICAgICAgICAgICBiOiBwcm9ncmFtLmIsXG4gICAgICAgICAgICBkLFxuICAgICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgICBzdGFydDogcHJvZ3JhbS5zdGFydCxcbiAgICAgICAgICAgIGVuZDogcHJvZ3JhbS5zdGFydCArIGR1cmF0aW9uLFxuICAgICAgICAgICAgZ3JvdXA6IHByb2dyYW0uZ3JvdXBcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZnVuY3Rpb24gZ28oYikge1xuICAgICAgICBjb25zdCB7IGRlbGF5ID0gMCwgZHVyYXRpb24gPSAzMDAsIGVhc2luZyA9IGlkZW50aXR5LCB0aWNrID0gbm9vcCwgY3NzIH0gPSBjb25maWcgfHwgbnVsbF90cmFuc2l0aW9uO1xuICAgICAgICBjb25zdCBwcm9ncmFtID0ge1xuICAgICAgICAgICAgc3RhcnQ6IG5vdygpICsgZGVsYXksXG4gICAgICAgICAgICBiXG4gICAgICAgIH07XG4gICAgICAgIGlmICghYikge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZSB0b2RvOiBpbXByb3ZlIHR5cGluZ3NcbiAgICAgICAgICAgIHByb2dyYW0uZ3JvdXAgPSBvdXRyb3M7XG4gICAgICAgICAgICBvdXRyb3MuciArPSAxO1xuICAgICAgICB9XG4gICAgICAgIGlmIChydW5uaW5nX3Byb2dyYW0gfHwgcGVuZGluZ19wcm9ncmFtKSB7XG4gICAgICAgICAgICBwZW5kaW5nX3Byb2dyYW0gPSBwcm9ncmFtO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gaWYgdGhpcyBpcyBhbiBpbnRybywgYW5kIHRoZXJlJ3MgYSBkZWxheSwgd2UgbmVlZCB0byBkb1xuICAgICAgICAgICAgLy8gYW4gaW5pdGlhbCB0aWNrIGFuZC9vciBhcHBseSBDU1MgYW5pbWF0aW9uIGltbWVkaWF0ZWx5XG4gICAgICAgICAgICBpZiAoY3NzKSB7XG4gICAgICAgICAgICAgICAgY2xlYXJfYW5pbWF0aW9uKCk7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uX25hbWUgPSBjcmVhdGVfcnVsZShub2RlLCB0LCBiLCBkdXJhdGlvbiwgZGVsYXksIGVhc2luZywgY3NzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChiKVxuICAgICAgICAgICAgICAgIHRpY2soMCwgMSk7XG4gICAgICAgICAgICBydW5uaW5nX3Byb2dyYW0gPSBpbml0KHByb2dyYW0sIGR1cmF0aW9uKTtcbiAgICAgICAgICAgIGFkZF9yZW5kZXJfY2FsbGJhY2soKCkgPT4gZGlzcGF0Y2gobm9kZSwgYiwgJ3N0YXJ0JykpO1xuICAgICAgICAgICAgbG9vcChub3cgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nX3Byb2dyYW0gJiYgbm93ID4gcGVuZGluZ19wcm9ncmFtLnN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJ1bm5pbmdfcHJvZ3JhbSA9IGluaXQocGVuZGluZ19wcm9ncmFtLCBkdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHBlbmRpbmdfcHJvZ3JhbSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGRpc3BhdGNoKG5vZGUsIHJ1bm5pbmdfcHJvZ3JhbS5iLCAnc3RhcnQnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJfYW5pbWF0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb25fbmFtZSA9IGNyZWF0ZV9ydWxlKG5vZGUsIHQsIHJ1bm5pbmdfcHJvZ3JhbS5iLCBydW5uaW5nX3Byb2dyYW0uZHVyYXRpb24sIDAsIGVhc2luZywgY29uZmlnLmNzcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJ1bm5pbmdfcHJvZ3JhbSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm93ID49IHJ1bm5pbmdfcHJvZ3JhbS5lbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpY2sodCA9IHJ1bm5pbmdfcHJvZ3JhbS5iLCAxIC0gdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaChub2RlLCBydW5uaW5nX3Byb2dyYW0uYiwgJ2VuZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwZW5kaW5nX3Byb2dyYW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSdyZSBkb25lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJ1bm5pbmdfcHJvZ3JhbS5iKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGludHJvIFx1MjAxNCB3ZSBjYW4gdGlkeSB1cCBpbW1lZGlhdGVseVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhcl9hbmltYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG91dHJvIFx1MjAxNCBuZWVkcyB0byBiZSBjb29yZGluYXRlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIS0tcnVubmluZ19wcm9ncmFtLmdyb3VwLnIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBydW5fYWxsKHJ1bm5pbmdfcHJvZ3JhbS5ncm91cC5jKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBydW5uaW5nX3Byb2dyYW0gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKG5vdyA+PSBydW5uaW5nX3Byb2dyYW0uc3RhcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHAgPSBub3cgLSBydW5uaW5nX3Byb2dyYW0uc3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ID0gcnVubmluZ19wcm9ncmFtLmEgKyBydW5uaW5nX3Byb2dyYW0uZCAqIGVhc2luZyhwIC8gcnVubmluZ19wcm9ncmFtLmR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpY2sodCwgMSAtIHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAhIShydW5uaW5nX3Byb2dyYW0gfHwgcGVuZGluZ19wcm9ncmFtKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIHJ1bihiKSB7XG4gICAgICAgICAgICBpZiAoaXNfZnVuY3Rpb24oY29uZmlnKSkge1xuICAgICAgICAgICAgICAgIHdhaXQoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICBjb25maWcgPSBjb25maWcoKTtcbiAgICAgICAgICAgICAgICAgICAgZ28oYik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBnbyhiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW5kKCkge1xuICAgICAgICAgICAgY2xlYXJfYW5pbWF0aW9uKCk7XG4gICAgICAgICAgICBydW5uaW5nX3Byb2dyYW0gPSBwZW5kaW5nX3Byb2dyYW0gPSBudWxsO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlX3Byb21pc2UocHJvbWlzZSwgaW5mbykge1xuICAgIGNvbnN0IHRva2VuID0gaW5mby50b2tlbiA9IHt9O1xuICAgIGZ1bmN0aW9uIHVwZGF0ZSh0eXBlLCBpbmRleCwga2V5LCB2YWx1ZSkge1xuICAgICAgICBpZiAoaW5mby50b2tlbiAhPT0gdG9rZW4pXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGluZm8ucmVzb2x2ZWQgPSB2YWx1ZTtcbiAgICAgICAgbGV0IGNoaWxkX2N0eCA9IGluZm8uY3R4O1xuICAgICAgICBpZiAoa2V5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNoaWxkX2N0eCA9IGNoaWxkX2N0eC5zbGljZSgpO1xuICAgICAgICAgICAgY2hpbGRfY3R4W2tleV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBibG9jayA9IHR5cGUgJiYgKGluZm8uY3VycmVudCA9IHR5cGUpKGNoaWxkX2N0eCk7XG4gICAgICAgIGxldCBuZWVkc19mbHVzaCA9IGZhbHNlO1xuICAgICAgICBpZiAoaW5mby5ibG9jaykge1xuICAgICAgICAgICAgaWYgKGluZm8uYmxvY2tzKSB7XG4gICAgICAgICAgICAgICAgaW5mby5ibG9ja3MuZm9yRWFjaCgoYmxvY2ssIGkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgIT09IGluZGV4ICYmIGJsb2NrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBncm91cF9vdXRyb3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zaXRpb25fb3V0KGJsb2NrLCAxLCAxLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZm8uYmxvY2tzW2ldID09PSBibG9jaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvLmJsb2Nrc1tpXSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja19vdXRyb3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5mby5ibG9jay5kKDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYmxvY2suYygpO1xuICAgICAgICAgICAgdHJhbnNpdGlvbl9pbihibG9jaywgMSk7XG4gICAgICAgICAgICBibG9jay5tKGluZm8ubW91bnQoKSwgaW5mby5hbmNob3IpO1xuICAgICAgICAgICAgbmVlZHNfZmx1c2ggPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGluZm8uYmxvY2sgPSBibG9jaztcbiAgICAgICAgaWYgKGluZm8uYmxvY2tzKVxuICAgICAgICAgICAgaW5mby5ibG9ja3NbaW5kZXhdID0gYmxvY2s7XG4gICAgICAgIGlmIChuZWVkc19mbHVzaCkge1xuICAgICAgICAgICAgZmx1c2goKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoaXNfcHJvbWlzZShwcm9taXNlKSkge1xuICAgICAgICBjb25zdCBjdXJyZW50X2NvbXBvbmVudCA9IGdldF9jdXJyZW50X2NvbXBvbmVudCgpO1xuICAgICAgICBwcm9taXNlLnRoZW4odmFsdWUgPT4ge1xuICAgICAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KGN1cnJlbnRfY29tcG9uZW50KTtcbiAgICAgICAgICAgIHVwZGF0ZShpbmZvLnRoZW4sIDEsIGluZm8udmFsdWUsIHZhbHVlKTtcbiAgICAgICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChudWxsKTtcbiAgICAgICAgfSwgZXJyb3IgPT4ge1xuICAgICAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KGN1cnJlbnRfY29tcG9uZW50KTtcbiAgICAgICAgICAgIHVwZGF0ZShpbmZvLmNhdGNoLCAyLCBpbmZvLmVycm9yLCBlcnJvcik7XG4gICAgICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQobnVsbCk7XG4gICAgICAgICAgICBpZiAoIWluZm8uaGFzQ2F0Y2gpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIGlmIHdlIHByZXZpb3VzbHkgaGFkIGEgdGhlbi9jYXRjaCBibG9jaywgZGVzdHJveSBpdFxuICAgICAgICBpZiAoaW5mby5jdXJyZW50ICE9PSBpbmZvLnBlbmRpbmcpIHtcbiAgICAgICAgICAgIHVwZGF0ZShpbmZvLnBlbmRpbmcsIDApO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmIChpbmZvLmN1cnJlbnQgIT09IGluZm8udGhlbikge1xuICAgICAgICAgICAgdXBkYXRlKGluZm8udGhlbiwgMSwgaW5mby52YWx1ZSwgcHJvbWlzZSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpbmZvLnJlc29sdmVkID0gcHJvbWlzZTtcbiAgICB9XG59XG5mdW5jdGlvbiB1cGRhdGVfYXdhaXRfYmxvY2tfYnJhbmNoKGluZm8sIGN0eCwgZGlydHkpIHtcbiAgICBjb25zdCBjaGlsZF9jdHggPSBjdHguc2xpY2UoKTtcbiAgICBjb25zdCB7IHJlc29sdmVkIH0gPSBpbmZvO1xuICAgIGlmIChpbmZvLmN1cnJlbnQgPT09IGluZm8udGhlbikge1xuICAgICAgICBjaGlsZF9jdHhbaW5mby52YWx1ZV0gPSByZXNvbHZlZDtcbiAgICB9XG4gICAgaWYgKGluZm8uY3VycmVudCA9PT0gaW5mby5jYXRjaCkge1xuICAgICAgICBjaGlsZF9jdHhbaW5mby5lcnJvcl0gPSByZXNvbHZlZDtcbiAgICB9XG4gICAgaW5mby5ibG9jay5wKGNoaWxkX2N0eCwgZGlydHkpO1xufVxuXG5jb25zdCBnbG9iYWxzID0gKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnXG4gICAgPyB3aW5kb3dcbiAgICA6IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJ1xuICAgICAgICA/IGdsb2JhbFRoaXNcbiAgICAgICAgOiBnbG9iYWwpO1xuXG5mdW5jdGlvbiBkZXN0cm95X2Jsb2NrKGJsb2NrLCBsb29rdXApIHtcbiAgICBibG9jay5kKDEpO1xuICAgIGxvb2t1cC5kZWxldGUoYmxvY2sua2V5KTtcbn1cbmZ1bmN0aW9uIG91dHJvX2FuZF9kZXN0cm95X2Jsb2NrKGJsb2NrLCBsb29rdXApIHtcbiAgICB0cmFuc2l0aW9uX291dChibG9jaywgMSwgMSwgKCkgPT4ge1xuICAgICAgICBsb29rdXAuZGVsZXRlKGJsb2NrLmtleSk7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBmaXhfYW5kX2Rlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCkge1xuICAgIGJsb2NrLmYoKTtcbiAgICBkZXN0cm95X2Jsb2NrKGJsb2NrLCBsb29rdXApO1xufVxuZnVuY3Rpb24gZml4X2FuZF9vdXRyb19hbmRfZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKSB7XG4gICAgYmxvY2suZigpO1xuICAgIG91dHJvX2FuZF9kZXN0cm95X2Jsb2NrKGJsb2NrLCBsb29rdXApO1xufVxuZnVuY3Rpb24gdXBkYXRlX2tleWVkX2VhY2gob2xkX2Jsb2NrcywgZGlydHksIGdldF9rZXksIGR5bmFtaWMsIGN0eCwgbGlzdCwgbG9va3VwLCBub2RlLCBkZXN0cm95LCBjcmVhdGVfZWFjaF9ibG9jaywgbmV4dCwgZ2V0X2NvbnRleHQpIHtcbiAgICBsZXQgbyA9IG9sZF9ibG9ja3MubGVuZ3RoO1xuICAgIGxldCBuID0gbGlzdC5sZW5ndGg7XG4gICAgbGV0IGkgPSBvO1xuICAgIGNvbnN0IG9sZF9pbmRleGVzID0ge307XG4gICAgd2hpbGUgKGktLSlcbiAgICAgICAgb2xkX2luZGV4ZXNbb2xkX2Jsb2Nrc1tpXS5rZXldID0gaTtcbiAgICBjb25zdCBuZXdfYmxvY2tzID0gW107XG4gICAgY29uc3QgbmV3X2xvb2t1cCA9IG5ldyBNYXAoKTtcbiAgICBjb25zdCBkZWx0YXMgPSBuZXcgTWFwKCk7XG4gICAgaSA9IG47XG4gICAgd2hpbGUgKGktLSkge1xuICAgICAgICBjb25zdCBjaGlsZF9jdHggPSBnZXRfY29udGV4dChjdHgsIGxpc3QsIGkpO1xuICAgICAgICBjb25zdCBrZXkgPSBnZXRfa2V5KGNoaWxkX2N0eCk7XG4gICAgICAgIGxldCBibG9jayA9IGxvb2t1cC5nZXQoa2V5KTtcbiAgICAgICAgaWYgKCFibG9jaykge1xuICAgICAgICAgICAgYmxvY2sgPSBjcmVhdGVfZWFjaF9ibG9jayhrZXksIGNoaWxkX2N0eCk7XG4gICAgICAgICAgICBibG9jay5jKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZHluYW1pYykge1xuICAgICAgICAgICAgYmxvY2sucChjaGlsZF9jdHgsIGRpcnR5KTtcbiAgICAgICAgfVxuICAgICAgICBuZXdfbG9va3VwLnNldChrZXksIG5ld19ibG9ja3NbaV0gPSBibG9jayk7XG4gICAgICAgIGlmIChrZXkgaW4gb2xkX2luZGV4ZXMpXG4gICAgICAgICAgICBkZWx0YXMuc2V0KGtleSwgTWF0aC5hYnMoaSAtIG9sZF9pbmRleGVzW2tleV0pKTtcbiAgICB9XG4gICAgY29uc3Qgd2lsbF9tb3ZlID0gbmV3IFNldCgpO1xuICAgIGNvbnN0IGRpZF9tb3ZlID0gbmV3IFNldCgpO1xuICAgIGZ1bmN0aW9uIGluc2VydChibG9jaykge1xuICAgICAgICB0cmFuc2l0aW9uX2luKGJsb2NrLCAxKTtcbiAgICAgICAgYmxvY2subShub2RlLCBuZXh0KTtcbiAgICAgICAgbG9va3VwLnNldChibG9jay5rZXksIGJsb2NrKTtcbiAgICAgICAgbmV4dCA9IGJsb2NrLmZpcnN0O1xuICAgICAgICBuLS07XG4gICAgfVxuICAgIHdoaWxlIChvICYmIG4pIHtcbiAgICAgICAgY29uc3QgbmV3X2Jsb2NrID0gbmV3X2Jsb2Nrc1tuIC0gMV07XG4gICAgICAgIGNvbnN0IG9sZF9ibG9jayA9IG9sZF9ibG9ja3NbbyAtIDFdO1xuICAgICAgICBjb25zdCBuZXdfa2V5ID0gbmV3X2Jsb2NrLmtleTtcbiAgICAgICAgY29uc3Qgb2xkX2tleSA9IG9sZF9ibG9jay5rZXk7XG4gICAgICAgIGlmIChuZXdfYmxvY2sgPT09IG9sZF9ibG9jaykge1xuICAgICAgICAgICAgLy8gZG8gbm90aGluZ1xuICAgICAgICAgICAgbmV4dCA9IG5ld19ibG9jay5maXJzdDtcbiAgICAgICAgICAgIG8tLTtcbiAgICAgICAgICAgIG4tLTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghbmV3X2xvb2t1cC5oYXMob2xkX2tleSkpIHtcbiAgICAgICAgICAgIC8vIHJlbW92ZSBvbGQgYmxvY2tcbiAgICAgICAgICAgIGRlc3Ryb3kob2xkX2Jsb2NrLCBsb29rdXApO1xuICAgICAgICAgICAgby0tO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFsb29rdXAuaGFzKG5ld19rZXkpIHx8IHdpbGxfbW92ZS5oYXMobmV3X2tleSkpIHtcbiAgICAgICAgICAgIGluc2VydChuZXdfYmxvY2spO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGRpZF9tb3ZlLmhhcyhvbGRfa2V5KSkge1xuICAgICAgICAgICAgby0tO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGRlbHRhcy5nZXQobmV3X2tleSkgPiBkZWx0YXMuZ2V0KG9sZF9rZXkpKSB7XG4gICAgICAgICAgICBkaWRfbW92ZS5hZGQobmV3X2tleSk7XG4gICAgICAgICAgICBpbnNlcnQobmV3X2Jsb2NrKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHdpbGxfbW92ZS5hZGQob2xkX2tleSk7XG4gICAgICAgICAgICBvLS07XG4gICAgICAgIH1cbiAgICB9XG4gICAgd2hpbGUgKG8tLSkge1xuICAgICAgICBjb25zdCBvbGRfYmxvY2sgPSBvbGRfYmxvY2tzW29dO1xuICAgICAgICBpZiAoIW5ld19sb29rdXAuaGFzKG9sZF9ibG9jay5rZXkpKVxuICAgICAgICAgICAgZGVzdHJveShvbGRfYmxvY2ssIGxvb2t1cCk7XG4gICAgfVxuICAgIHdoaWxlIChuKVxuICAgICAgICBpbnNlcnQobmV3X2Jsb2Nrc1tuIC0gMV0pO1xuICAgIHJldHVybiBuZXdfYmxvY2tzO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVfZWFjaF9rZXlzKGN0eCwgbGlzdCwgZ2V0X2NvbnRleHQsIGdldF9rZXkpIHtcbiAgICBjb25zdCBrZXlzID0gbmV3IFNldCgpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBrZXkgPSBnZXRfa2V5KGdldF9jb250ZXh0KGN0eCwgbGlzdCwgaSkpO1xuICAgICAgICBpZiAoa2V5cy5oYXMoa2V5KSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgaGF2ZSBkdXBsaWNhdGUga2V5cyBpbiBhIGtleWVkIGVhY2gnKTtcbiAgICAgICAgfVxuICAgICAgICBrZXlzLmFkZChrZXkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZ2V0X3NwcmVhZF91cGRhdGUobGV2ZWxzLCB1cGRhdGVzKSB7XG4gICAgY29uc3QgdXBkYXRlID0ge307XG4gICAgY29uc3QgdG9fbnVsbF9vdXQgPSB7fTtcbiAgICBjb25zdCBhY2NvdW50ZWRfZm9yID0geyAkJHNjb3BlOiAxIH07XG4gICAgbGV0IGkgPSBsZXZlbHMubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgY29uc3QgbyA9IGxldmVsc1tpXTtcbiAgICAgICAgY29uc3QgbiA9IHVwZGF0ZXNbaV07XG4gICAgICAgIGlmIChuKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBvKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEoa2V5IGluIG4pKVxuICAgICAgICAgICAgICAgICAgICB0b19udWxsX291dFtrZXldID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIG4pIHtcbiAgICAgICAgICAgICAgICBpZiAoIWFjY291bnRlZF9mb3Jba2V5XSkge1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVba2V5XSA9IG5ba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgYWNjb3VudGVkX2ZvcltrZXldID0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXZlbHNbaV0gPSBuO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gbykge1xuICAgICAgICAgICAgICAgIGFjY291bnRlZF9mb3Jba2V5XSA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZm9yIChjb25zdCBrZXkgaW4gdG9fbnVsbF9vdXQpIHtcbiAgICAgICAgaWYgKCEoa2V5IGluIHVwZGF0ZSkpXG4gICAgICAgICAgICB1cGRhdGVba2V5XSA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgcmV0dXJuIHVwZGF0ZTtcbn1cbmZ1bmN0aW9uIGdldF9zcHJlYWRfb2JqZWN0KHNwcmVhZF9wcm9wcykge1xuICAgIHJldHVybiB0eXBlb2Ygc3ByZWFkX3Byb3BzID09PSAnb2JqZWN0JyAmJiBzcHJlYWRfcHJvcHMgIT09IG51bGwgPyBzcHJlYWRfcHJvcHMgOiB7fTtcbn1cblxuLy8gc291cmNlOiBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9pbmRpY2VzLmh0bWxcbmNvbnN0IGJvb2xlYW5fYXR0cmlidXRlcyA9IG5ldyBTZXQoW1xuICAgICdhbGxvd2Z1bGxzY3JlZW4nLFxuICAgICdhbGxvd3BheW1lbnRyZXF1ZXN0JyxcbiAgICAnYXN5bmMnLFxuICAgICdhdXRvZm9jdXMnLFxuICAgICdhdXRvcGxheScsXG4gICAgJ2NoZWNrZWQnLFxuICAgICdjb250cm9scycsXG4gICAgJ2RlZmF1bHQnLFxuICAgICdkZWZlcicsXG4gICAgJ2Rpc2FibGVkJyxcbiAgICAnZm9ybW5vdmFsaWRhdGUnLFxuICAgICdoaWRkZW4nLFxuICAgICdpc21hcCcsXG4gICAgJ2xvb3AnLFxuICAgICdtdWx0aXBsZScsXG4gICAgJ211dGVkJyxcbiAgICAnbm9tb2R1bGUnLFxuICAgICdub3ZhbGlkYXRlJyxcbiAgICAnb3BlbicsXG4gICAgJ3BsYXlzaW5saW5lJyxcbiAgICAncmVhZG9ubHknLFxuICAgICdyZXF1aXJlZCcsXG4gICAgJ3JldmVyc2VkJyxcbiAgICAnc2VsZWN0ZWQnXG5dKTtcblxuY29uc3Qgdm9pZF9lbGVtZW50X25hbWVzID0gL14oPzphcmVhfGJhc2V8YnJ8Y29sfGNvbW1hbmR8ZW1iZWR8aHJ8aW1nfGlucHV0fGtleWdlbnxsaW5rfG1ldGF8cGFyYW18c291cmNlfHRyYWNrfHdicikkLztcbmZ1bmN0aW9uIGlzX3ZvaWQobmFtZSkge1xuICAgIHJldHVybiB2b2lkX2VsZW1lbnRfbmFtZXMudGVzdChuYW1lKSB8fCBuYW1lLnRvTG93ZXJDYXNlKCkgPT09ICchZG9jdHlwZSc7XG59XG5cbmNvbnN0IGludmFsaWRfYXR0cmlidXRlX25hbWVfY2hhcmFjdGVyID0gL1tcXHMnXCI+Lz1cXHV7RkREMH0tXFx1e0ZERUZ9XFx1e0ZGRkV9XFx1e0ZGRkZ9XFx1ezFGRkZFfVxcdXsxRkZGRn1cXHV7MkZGRkV9XFx1ezJGRkZGfVxcdXszRkZGRX1cXHV7M0ZGRkZ9XFx1ezRGRkZFfVxcdXs0RkZGRn1cXHV7NUZGRkV9XFx1ezVGRkZGfVxcdXs2RkZGRX1cXHV7NkZGRkZ9XFx1ezdGRkZFfVxcdXs3RkZGRn1cXHV7OEZGRkV9XFx1ezhGRkZGfVxcdXs5RkZGRX1cXHV7OUZGRkZ9XFx1e0FGRkZFfVxcdXtBRkZGRn1cXHV7QkZGRkV9XFx1e0JGRkZGfVxcdXtDRkZGRX1cXHV7Q0ZGRkZ9XFx1e0RGRkZFfVxcdXtERkZGRn1cXHV7RUZGRkV9XFx1e0VGRkZGfVxcdXtGRkZGRX1cXHV7RkZGRkZ9XFx1ezEwRkZGRX1cXHV7MTBGRkZGfV0vdTtcbi8vIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL3N5bnRheC5odG1sI2F0dHJpYnV0ZXMtMlxuLy8gaHR0cHM6Ly9pbmZyYS5zcGVjLndoYXR3Zy5vcmcvI25vbmNoYXJhY3RlclxuZnVuY3Rpb24gc3ByZWFkKGFyZ3MsIGF0dHJzX3RvX2FkZCkge1xuICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBPYmplY3QuYXNzaWduKHt9LCAuLi5hcmdzKTtcbiAgICBpZiAoYXR0cnNfdG9fYWRkKSB7XG4gICAgICAgIGNvbnN0IGNsYXNzZXNfdG9fYWRkID0gYXR0cnNfdG9fYWRkLmNsYXNzZXM7XG4gICAgICAgIGNvbnN0IHN0eWxlc190b19hZGQgPSBhdHRyc190b19hZGQuc3R5bGVzO1xuICAgICAgICBpZiAoY2xhc3Nlc190b19hZGQpIHtcbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzLmNsYXNzID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLmNsYXNzID0gY2xhc3Nlc190b19hZGQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLmNsYXNzICs9ICcgJyArIGNsYXNzZXNfdG9fYWRkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChzdHlsZXNfdG9fYWRkKSB7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlcy5zdHlsZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcy5zdHlsZSA9IHN0eWxlX29iamVjdF90b19zdHJpbmcoc3R5bGVzX3RvX2FkZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLnN0eWxlID0gc3R5bGVfb2JqZWN0X3RvX3N0cmluZyhtZXJnZV9zc3Jfc3R5bGVzKGF0dHJpYnV0ZXMuc3R5bGUsIHN0eWxlc190b19hZGQpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBsZXQgc3RyID0gJyc7XG4gICAgT2JqZWN0LmtleXMoYXR0cmlidXRlcykuZm9yRWFjaChuYW1lID0+IHtcbiAgICAgICAgaWYgKGludmFsaWRfYXR0cmlidXRlX25hbWVfY2hhcmFjdGVyLnRlc3QobmFtZSkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGNvbnN0IHZhbHVlID0gYXR0cmlidXRlc1tuYW1lXTtcbiAgICAgICAgaWYgKHZhbHVlID09PSB0cnVlKVxuICAgICAgICAgICAgc3RyICs9ICcgJyArIG5hbWU7XG4gICAgICAgIGVsc2UgaWYgKGJvb2xlYW5fYXR0cmlidXRlcy5oYXMobmFtZS50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlKVxuICAgICAgICAgICAgICAgIHN0ciArPSAnICcgKyBuYW1lO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlICE9IG51bGwpIHtcbiAgICAgICAgICAgIHN0ciArPSBgICR7bmFtZX09XCIke3ZhbHVlfVwiYDtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBzdHI7XG59XG5mdW5jdGlvbiBtZXJnZV9zc3Jfc3R5bGVzKHN0eWxlX2F0dHJpYnV0ZSwgc3R5bGVfZGlyZWN0aXZlKSB7XG4gICAgY29uc3Qgc3R5bGVfb2JqZWN0ID0ge307XG4gICAgZm9yIChjb25zdCBpbmRpdmlkdWFsX3N0eWxlIG9mIHN0eWxlX2F0dHJpYnV0ZS5zcGxpdCgnOycpKSB7XG4gICAgICAgIGNvbnN0IGNvbG9uX2luZGV4ID0gaW5kaXZpZHVhbF9zdHlsZS5pbmRleE9mKCc6Jyk7XG4gICAgICAgIGNvbnN0IG5hbWUgPSBpbmRpdmlkdWFsX3N0eWxlLnNsaWNlKDAsIGNvbG9uX2luZGV4KS50cmltKCk7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gaW5kaXZpZHVhbF9zdHlsZS5zbGljZShjb2xvbl9pbmRleCArIDEpLnRyaW0oKTtcbiAgICAgICAgaWYgKCFuYW1lKVxuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIHN0eWxlX29iamVjdFtuYW1lXSA9IHZhbHVlO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IG5hbWUgaW4gc3R5bGVfZGlyZWN0aXZlKSB7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gc3R5bGVfZGlyZWN0aXZlW25hbWVdO1xuICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIHN0eWxlX29iamVjdFtuYW1lXSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZGVsZXRlIHN0eWxlX29iamVjdFtuYW1lXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc3R5bGVfb2JqZWN0O1xufVxuY29uc3QgZXNjYXBlZCA9IHtcbiAgICAnXCInOiAnJnF1b3Q7JyxcbiAgICBcIidcIjogJyYjMzk7JyxcbiAgICAnJic6ICcmYW1wOycsXG4gICAgJzwnOiAnJmx0OycsXG4gICAgJz4nOiAnJmd0Oydcbn07XG5mdW5jdGlvbiBlc2NhcGUoaHRtbCkge1xuICAgIHJldHVybiBTdHJpbmcoaHRtbCkucmVwbGFjZSgvW1wiJyY8Pl0vZywgbWF0Y2ggPT4gZXNjYXBlZFttYXRjaF0pO1xufVxuZnVuY3Rpb24gZXNjYXBlX2F0dHJpYnV0ZV92YWx1ZSh2YWx1ZSkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnID8gZXNjYXBlKHZhbHVlKSA6IHZhbHVlO1xufVxuZnVuY3Rpb24gZXNjYXBlX29iamVjdChvYmopIHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBvYmopIHtcbiAgICAgICAgcmVzdWx0W2tleV0gPSBlc2NhcGVfYXR0cmlidXRlX3ZhbHVlKG9ialtrZXldKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGVhY2goaXRlbXMsIGZuKSB7XG4gICAgbGV0IHN0ciA9ICcnO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgc3RyICs9IGZuKGl0ZW1zW2ldLCBpKTtcbiAgICB9XG4gICAgcmV0dXJuIHN0cjtcbn1cbmNvbnN0IG1pc3NpbmdfY29tcG9uZW50ID0ge1xuICAgICQkcmVuZGVyOiAoKSA9PiAnJ1xufTtcbmZ1bmN0aW9uIHZhbGlkYXRlX2NvbXBvbmVudChjb21wb25lbnQsIG5hbWUpIHtcbiAgICBpZiAoIWNvbXBvbmVudCB8fCAhY29tcG9uZW50LiQkcmVuZGVyKSB7XG4gICAgICAgIGlmIChuYW1lID09PSAnc3ZlbHRlOmNvbXBvbmVudCcpXG4gICAgICAgICAgICBuYW1lICs9ICcgdGhpcz17Li4ufSc7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgPCR7bmFtZX0+IGlzIG5vdCBhIHZhbGlkIFNTUiBjb21wb25lbnQuIFlvdSBtYXkgbmVlZCB0byByZXZpZXcgeW91ciBidWlsZCBjb25maWcgdG8gZW5zdXJlIHRoYXQgZGVwZW5kZW5jaWVzIGFyZSBjb21waWxlZCwgcmF0aGVyIHRoYW4gaW1wb3J0ZWQgYXMgcHJlLWNvbXBpbGVkIG1vZHVsZXNgKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbXBvbmVudDtcbn1cbmZ1bmN0aW9uIGRlYnVnKGZpbGUsIGxpbmUsIGNvbHVtbiwgdmFsdWVzKSB7XG4gICAgY29uc29sZS5sb2coYHtAZGVidWd9ICR7ZmlsZSA/IGZpbGUgKyAnICcgOiAnJ30oJHtsaW5lfToke2NvbHVtbn0pYCk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgIGNvbnNvbGUubG9nKHZhbHVlcyk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgIHJldHVybiAnJztcbn1cbmxldCBvbl9kZXN0cm95O1xuZnVuY3Rpb24gY3JlYXRlX3Nzcl9jb21wb25lbnQoZm4pIHtcbiAgICBmdW5jdGlvbiAkJHJlbmRlcihyZXN1bHQsIHByb3BzLCBiaW5kaW5ncywgc2xvdHMsIGNvbnRleHQpIHtcbiAgICAgICAgY29uc3QgcGFyZW50X2NvbXBvbmVudCA9IGN1cnJlbnRfY29tcG9uZW50O1xuICAgICAgICBjb25zdCAkJCA9IHtcbiAgICAgICAgICAgIG9uX2Rlc3Ryb3ksXG4gICAgICAgICAgICBjb250ZXh0OiBuZXcgTWFwKGNvbnRleHQgfHwgKHBhcmVudF9jb21wb25lbnQgPyBwYXJlbnRfY29tcG9uZW50LiQkLmNvbnRleHQgOiBbXSkpLFxuICAgICAgICAgICAgLy8gdGhlc2Ugd2lsbCBiZSBpbW1lZGlhdGVseSBkaXNjYXJkZWRcbiAgICAgICAgICAgIG9uX21vdW50OiBbXSxcbiAgICAgICAgICAgIGJlZm9yZV91cGRhdGU6IFtdLFxuICAgICAgICAgICAgYWZ0ZXJfdXBkYXRlOiBbXSxcbiAgICAgICAgICAgIGNhbGxiYWNrczogYmxhbmtfb2JqZWN0KClcbiAgICAgICAgfTtcbiAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KHsgJCQgfSk7XG4gICAgICAgIGNvbnN0IGh0bWwgPSBmbihyZXN1bHQsIHByb3BzLCBiaW5kaW5ncywgc2xvdHMpO1xuICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQocGFyZW50X2NvbXBvbmVudCk7XG4gICAgICAgIHJldHVybiBodG1sO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICByZW5kZXI6IChwcm9wcyA9IHt9LCB7ICQkc2xvdHMgPSB7fSwgY29udGV4dCA9IG5ldyBNYXAoKSB9ID0ge30pID0+IHtcbiAgICAgICAgICAgIG9uX2Rlc3Ryb3kgPSBbXTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHsgdGl0bGU6ICcnLCBoZWFkOiAnJywgY3NzOiBuZXcgU2V0KCkgfTtcbiAgICAgICAgICAgIGNvbnN0IGh0bWwgPSAkJHJlbmRlcihyZXN1bHQsIHByb3BzLCB7fSwgJCRzbG90cywgY29udGV4dCk7XG4gICAgICAgICAgICBydW5fYWxsKG9uX2Rlc3Ryb3kpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBodG1sLFxuICAgICAgICAgICAgICAgIGNzczoge1xuICAgICAgICAgICAgICAgICAgICBjb2RlOiBBcnJheS5mcm9tKHJlc3VsdC5jc3MpLm1hcChjc3MgPT4gY3NzLmNvZGUpLmpvaW4oJ1xcbicpLFxuICAgICAgICAgICAgICAgICAgICBtYXA6IG51bGwgLy8gVE9ET1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgaGVhZDogcmVzdWx0LnRpdGxlICsgcmVzdWx0LmhlYWRcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgICQkcmVuZGVyXG4gICAgfTtcbn1cbmZ1bmN0aW9uIGFkZF9hdHRyaWJ1dGUobmFtZSwgdmFsdWUsIGJvb2xlYW4pIHtcbiAgICBpZiAodmFsdWUgPT0gbnVsbCB8fCAoYm9vbGVhbiAmJiAhdmFsdWUpKVxuICAgICAgICByZXR1cm4gJyc7XG4gICAgY29uc3QgYXNzaWdubWVudCA9IChib29sZWFuICYmIHZhbHVlID09PSB0cnVlKSA/ICcnIDogYD1cIiR7ZXNjYXBlX2F0dHJpYnV0ZV92YWx1ZSh2YWx1ZS50b1N0cmluZygpKX1cImA7XG4gICAgcmV0dXJuIGAgJHtuYW1lfSR7YXNzaWdubWVudH1gO1xufVxuZnVuY3Rpb24gYWRkX2NsYXNzZXMoY2xhc3Nlcykge1xuICAgIHJldHVybiBjbGFzc2VzID8gYCBjbGFzcz1cIiR7Y2xhc3Nlc31cImAgOiAnJztcbn1cbmZ1bmN0aW9uIHN0eWxlX29iamVjdF90b19zdHJpbmcoc3R5bGVfb2JqZWN0KSB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHN0eWxlX29iamVjdClcbiAgICAgICAgLmZpbHRlcihrZXkgPT4gc3R5bGVfb2JqZWN0W2tleV0pXG4gICAgICAgIC5tYXAoa2V5ID0+IGAke2tleX06ICR7c3R5bGVfb2JqZWN0W2tleV19O2ApXG4gICAgICAgIC5qb2luKCcgJyk7XG59XG5mdW5jdGlvbiBhZGRfc3R5bGVzKHN0eWxlX29iamVjdCkge1xuICAgIGNvbnN0IHN0eWxlcyA9IHN0eWxlX29iamVjdF90b19zdHJpbmcoc3R5bGVfb2JqZWN0KTtcbiAgICByZXR1cm4gc3R5bGVzID8gYCBzdHlsZT1cIiR7c3R5bGVzfVwiYCA6ICcnO1xufVxuXG5mdW5jdGlvbiBiaW5kKGNvbXBvbmVudCwgbmFtZSwgY2FsbGJhY2spIHtcbiAgICBjb25zdCBpbmRleCA9IGNvbXBvbmVudC4kJC5wcm9wc1tuYW1lXTtcbiAgICBpZiAoaW5kZXggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjb21wb25lbnQuJCQuYm91bmRbaW5kZXhdID0gY2FsbGJhY2s7XG4gICAgICAgIGNhbGxiYWNrKGNvbXBvbmVudC4kJC5jdHhbaW5kZXhdKTtcbiAgICB9XG59XG5mdW5jdGlvbiBjcmVhdGVfY29tcG9uZW50KGJsb2NrKSB7XG4gICAgYmxvY2sgJiYgYmxvY2suYygpO1xufVxuZnVuY3Rpb24gY2xhaW1fY29tcG9uZW50KGJsb2NrLCBwYXJlbnRfbm9kZXMpIHtcbiAgICBibG9jayAmJiBibG9jay5sKHBhcmVudF9ub2Rlcyk7XG59XG5mdW5jdGlvbiBtb3VudF9jb21wb25lbnQoY29tcG9uZW50LCB0YXJnZXQsIGFuY2hvciwgY3VzdG9tRWxlbWVudCkge1xuICAgIGNvbnN0IHsgZnJhZ21lbnQsIG9uX21vdW50LCBvbl9kZXN0cm95LCBhZnRlcl91cGRhdGUgfSA9IGNvbXBvbmVudC4kJDtcbiAgICBmcmFnbWVudCAmJiBmcmFnbWVudC5tKHRhcmdldCwgYW5jaG9yKTtcbiAgICBpZiAoIWN1c3RvbUVsZW1lbnQpIHtcbiAgICAgICAgLy8gb25Nb3VudCBoYXBwZW5zIGJlZm9yZSB0aGUgaW5pdGlhbCBhZnRlclVwZGF0ZVxuICAgICAgICBhZGRfcmVuZGVyX2NhbGxiYWNrKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5ld19vbl9kZXN0cm95ID0gb25fbW91bnQubWFwKHJ1bikuZmlsdGVyKGlzX2Z1bmN0aW9uKTtcbiAgICAgICAgICAgIGlmIChvbl9kZXN0cm95KSB7XG4gICAgICAgICAgICAgICAgb25fZGVzdHJveS5wdXNoKC4uLm5ld19vbl9kZXN0cm95KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIEVkZ2UgY2FzZSAtIGNvbXBvbmVudCB3YXMgZGVzdHJveWVkIGltbWVkaWF0ZWx5LFxuICAgICAgICAgICAgICAgIC8vIG1vc3QgbGlrZWx5IGFzIGEgcmVzdWx0IG9mIGEgYmluZGluZyBpbml0aWFsaXNpbmdcbiAgICAgICAgICAgICAgICBydW5fYWxsKG5ld19vbl9kZXN0cm95KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbXBvbmVudC4kJC5vbl9tb3VudCA9IFtdO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgYWZ0ZXJfdXBkYXRlLmZvckVhY2goYWRkX3JlbmRlcl9jYWxsYmFjayk7XG59XG5mdW5jdGlvbiBkZXN0cm95X2NvbXBvbmVudChjb21wb25lbnQsIGRldGFjaGluZykge1xuICAgIGNvbnN0ICQkID0gY29tcG9uZW50LiQkO1xuICAgIGlmICgkJC5mcmFnbWVudCAhPT0gbnVsbCkge1xuICAgICAgICBydW5fYWxsKCQkLm9uX2Rlc3Ryb3kpO1xuICAgICAgICAkJC5mcmFnbWVudCAmJiAkJC5mcmFnbWVudC5kKGRldGFjaGluZyk7XG4gICAgICAgIC8vIFRPRE8gbnVsbCBvdXQgb3RoZXIgcmVmcywgaW5jbHVkaW5nIGNvbXBvbmVudC4kJCAoYnV0IG5lZWQgdG9cbiAgICAgICAgLy8gcHJlc2VydmUgZmluYWwgc3RhdGU/KVxuICAgICAgICAkJC5vbl9kZXN0cm95ID0gJCQuZnJhZ21lbnQgPSBudWxsO1xuICAgICAgICAkJC5jdHggPSBbXTtcbiAgICB9XG59XG5mdW5jdGlvbiBtYWtlX2RpcnR5KGNvbXBvbmVudCwgaSkge1xuICAgIGlmIChjb21wb25lbnQuJCQuZGlydHlbMF0gPT09IC0xKSB7XG4gICAgICAgIGRpcnR5X2NvbXBvbmVudHMucHVzaChjb21wb25lbnQpO1xuICAgICAgICBzY2hlZHVsZV91cGRhdGUoKTtcbiAgICAgICAgY29tcG9uZW50LiQkLmRpcnR5LmZpbGwoMCk7XG4gICAgfVxuICAgIGNvbXBvbmVudC4kJC5kaXJ0eVsoaSAvIDMxKSB8IDBdIHw9ICgxIDw8IChpICUgMzEpKTtcbn1cbmZ1bmN0aW9uIGluaXQoY29tcG9uZW50LCBvcHRpb25zLCBpbnN0YW5jZSwgY3JlYXRlX2ZyYWdtZW50LCBub3RfZXF1YWwsIHByb3BzLCBhcHBlbmRfc3R5bGVzLCBkaXJ0eSA9IFstMV0pIHtcbiAgICBjb25zdCBwYXJlbnRfY29tcG9uZW50ID0gY3VycmVudF9jb21wb25lbnQ7XG4gICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KGNvbXBvbmVudCk7XG4gICAgY29uc3QgJCQgPSBjb21wb25lbnQuJCQgPSB7XG4gICAgICAgIGZyYWdtZW50OiBudWxsLFxuICAgICAgICBjdHg6IG51bGwsXG4gICAgICAgIC8vIHN0YXRlXG4gICAgICAgIHByb3BzLFxuICAgICAgICB1cGRhdGU6IG5vb3AsXG4gICAgICAgIG5vdF9lcXVhbCxcbiAgICAgICAgYm91bmQ6IGJsYW5rX29iamVjdCgpLFxuICAgICAgICAvLyBsaWZlY3ljbGVcbiAgICAgICAgb25fbW91bnQ6IFtdLFxuICAgICAgICBvbl9kZXN0cm95OiBbXSxcbiAgICAgICAgb25fZGlzY29ubmVjdDogW10sXG4gICAgICAgIGJlZm9yZV91cGRhdGU6IFtdLFxuICAgICAgICBhZnRlcl91cGRhdGU6IFtdLFxuICAgICAgICBjb250ZXh0OiBuZXcgTWFwKG9wdGlvbnMuY29udGV4dCB8fCAocGFyZW50X2NvbXBvbmVudCA/IHBhcmVudF9jb21wb25lbnQuJCQuY29udGV4dCA6IFtdKSksXG4gICAgICAgIC8vIGV2ZXJ5dGhpbmcgZWxzZVxuICAgICAgICBjYWxsYmFja3M6IGJsYW5rX29iamVjdCgpLFxuICAgICAgICBkaXJ0eSxcbiAgICAgICAgc2tpcF9ib3VuZDogZmFsc2UsXG4gICAgICAgIHJvb3Q6IG9wdGlvbnMudGFyZ2V0IHx8IHBhcmVudF9jb21wb25lbnQuJCQucm9vdFxuICAgIH07XG4gICAgYXBwZW5kX3N0eWxlcyAmJiBhcHBlbmRfc3R5bGVzKCQkLnJvb3QpO1xuICAgIGxldCByZWFkeSA9IGZhbHNlO1xuICAgICQkLmN0eCA9IGluc3RhbmNlXG4gICAgICAgID8gaW5zdGFuY2UoY29tcG9uZW50LCBvcHRpb25zLnByb3BzIHx8IHt9LCAoaSwgcmV0LCAuLi5yZXN0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHJlc3QubGVuZ3RoID8gcmVzdFswXSA6IHJldDtcbiAgICAgICAgICAgIGlmICgkJC5jdHggJiYgbm90X2VxdWFsKCQkLmN0eFtpXSwgJCQuY3R4W2ldID0gdmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEkJC5za2lwX2JvdW5kICYmICQkLmJvdW5kW2ldKVxuICAgICAgICAgICAgICAgICAgICAkJC5ib3VuZFtpXSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlYWR5KVxuICAgICAgICAgICAgICAgICAgICBtYWtlX2RpcnR5KGNvbXBvbmVudCwgaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9KVxuICAgICAgICA6IFtdO1xuICAgICQkLnVwZGF0ZSgpO1xuICAgIHJlYWR5ID0gdHJ1ZTtcbiAgICBydW5fYWxsKCQkLmJlZm9yZV91cGRhdGUpO1xuICAgIC8vIGBmYWxzZWAgYXMgYSBzcGVjaWFsIGNhc2Ugb2Ygbm8gRE9NIGNvbXBvbmVudFxuICAgICQkLmZyYWdtZW50ID0gY3JlYXRlX2ZyYWdtZW50ID8gY3JlYXRlX2ZyYWdtZW50KCQkLmN0eCkgOiBmYWxzZTtcbiAgICBpZiAob3B0aW9ucy50YXJnZXQpIHtcbiAgICAgICAgaWYgKG9wdGlvbnMuaHlkcmF0ZSkge1xuICAgICAgICAgICAgc3RhcnRfaHlkcmF0aW5nKCk7XG4gICAgICAgICAgICBjb25zdCBub2RlcyA9IGNoaWxkcmVuKG9wdGlvbnMudGFyZ2V0KTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tbm9uLW51bGwtYXNzZXJ0aW9uXG4gICAgICAgICAgICAkJC5mcmFnbWVudCAmJiAkJC5mcmFnbWVudC5sKG5vZGVzKTtcbiAgICAgICAgICAgIG5vZGVzLmZvckVhY2goZGV0YWNoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tbm9uLW51bGwtYXNzZXJ0aW9uXG4gICAgICAgICAgICAkJC5mcmFnbWVudCAmJiAkJC5mcmFnbWVudC5jKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdGlvbnMuaW50cm8pXG4gICAgICAgICAgICB0cmFuc2l0aW9uX2luKGNvbXBvbmVudC4kJC5mcmFnbWVudCk7XG4gICAgICAgIG1vdW50X2NvbXBvbmVudChjb21wb25lbnQsIG9wdGlvbnMudGFyZ2V0LCBvcHRpb25zLmFuY2hvciwgb3B0aW9ucy5jdXN0b21FbGVtZW50KTtcbiAgICAgICAgZW5kX2h5ZHJhdGluZygpO1xuICAgICAgICBmbHVzaCgpO1xuICAgIH1cbiAgICBzZXRfY3VycmVudF9jb21wb25lbnQocGFyZW50X2NvbXBvbmVudCk7XG59XG5sZXQgU3ZlbHRlRWxlbWVudDtcbmlmICh0eXBlb2YgSFRNTEVsZW1lbnQgPT09ICdmdW5jdGlvbicpIHtcbiAgICBTdmVsdGVFbGVtZW50ID0gY2xhc3MgZXh0ZW5kcyBIVE1MRWxlbWVudCB7XG4gICAgICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgICAgIHRoaXMuYXR0YWNoU2hhZG93KHsgbW9kZTogJ29wZW4nIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgICAgICAgICAgY29uc3QgeyBvbl9tb3VudCB9ID0gdGhpcy4kJDtcbiAgICAgICAgICAgIHRoaXMuJCQub25fZGlzY29ubmVjdCA9IG9uX21vdW50Lm1hcChydW4pLmZpbHRlcihpc19mdW5jdGlvbik7XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlIHRvZG86IGltcHJvdmUgdHlwaW5nc1xuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy4kJC5zbG90dGVkKSB7XG4gICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZSB0b2RvOiBpbXByb3ZlIHR5cGluZ3NcbiAgICAgICAgICAgICAgICB0aGlzLmFwcGVuZENoaWxkKHRoaXMuJCQuc2xvdHRlZFtrZXldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBhdHRyaWJ1dGVDaGFuZ2VkQ2FsbGJhY2soYXR0ciwgX29sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgdGhpc1thdHRyXSA9IG5ld1ZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xuICAgICAgICAgICAgcnVuX2FsbCh0aGlzLiQkLm9uX2Rpc2Nvbm5lY3QpO1xuICAgICAgICB9XG4gICAgICAgICRkZXN0cm95KCkge1xuICAgICAgICAgICAgZGVzdHJveV9jb21wb25lbnQodGhpcywgMSk7XG4gICAgICAgICAgICB0aGlzLiRkZXN0cm95ID0gbm9vcDtcbiAgICAgICAgfVxuICAgICAgICAkb24odHlwZSwgY2FsbGJhY2spIHtcbiAgICAgICAgICAgIC8vIFRPRE8gc2hvdWxkIHRoaXMgZGVsZWdhdGUgdG8gYWRkRXZlbnRMaXN0ZW5lcj9cbiAgICAgICAgICAgIGNvbnN0IGNhbGxiYWNrcyA9ICh0aGlzLiQkLmNhbGxiYWNrc1t0eXBlXSB8fCAodGhpcy4kJC5jYWxsYmFja3NbdHlwZV0gPSBbXSkpO1xuICAgICAgICAgICAgY2FsbGJhY2tzLnB1c2goY2FsbGJhY2spO1xuICAgICAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IGNhbGxiYWNrcy5pbmRleE9mKGNhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggIT09IC0xKVxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFja3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgJHNldCgkJHByb3BzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy4kJHNldCAmJiAhaXNfZW1wdHkoJCRwcm9wcykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLiQkLnNraXBfYm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuJCRzZXQoJCRwcm9wcyk7XG4gICAgICAgICAgICAgICAgdGhpcy4kJC5za2lwX2JvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufVxuLyoqXG4gKiBCYXNlIGNsYXNzIGZvciBTdmVsdGUgY29tcG9uZW50cy4gVXNlZCB3aGVuIGRldj1mYWxzZS5cbiAqL1xuY2xhc3MgU3ZlbHRlQ29tcG9uZW50IHtcbiAgICAkZGVzdHJveSgpIHtcbiAgICAgICAgZGVzdHJveV9jb21wb25lbnQodGhpcywgMSk7XG4gICAgICAgIHRoaXMuJGRlc3Ryb3kgPSBub29wO1xuICAgIH1cbiAgICAkb24odHlwZSwgY2FsbGJhY2spIHtcbiAgICAgICAgY29uc3QgY2FsbGJhY2tzID0gKHRoaXMuJCQuY2FsbGJhY2tzW3R5cGVdIHx8ICh0aGlzLiQkLmNhbGxiYWNrc1t0eXBlXSA9IFtdKSk7XG4gICAgICAgIGNhbGxiYWNrcy5wdXNoKGNhbGxiYWNrKTtcbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gY2FsbGJhY2tzLmluZGV4T2YoY2FsbGJhY2spO1xuICAgICAgICAgICAgaWYgKGluZGV4ICE9PSAtMSlcbiAgICAgICAgICAgICAgICBjYWxsYmFja3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgJHNldCgkJHByb3BzKSB7XG4gICAgICAgIGlmICh0aGlzLiQkc2V0ICYmICFpc19lbXB0eSgkJHByb3BzKSkge1xuICAgICAgICAgICAgdGhpcy4kJC5za2lwX2JvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuJCRzZXQoJCRwcm9wcyk7XG4gICAgICAgICAgICB0aGlzLiQkLnNraXBfYm91bmQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gZGlzcGF0Y2hfZGV2KHR5cGUsIGRldGFpbCkge1xuICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQoY3VzdG9tX2V2ZW50KHR5cGUsIE9iamVjdC5hc3NpZ24oeyB2ZXJzaW9uOiAnMy40OC4wJyB9LCBkZXRhaWwpLCB7IGJ1YmJsZXM6IHRydWUgfSkpO1xufVxuZnVuY3Rpb24gYXBwZW5kX2Rldih0YXJnZXQsIG5vZGUpIHtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTUluc2VydCcsIHsgdGFyZ2V0LCBub2RlIH0pO1xuICAgIGFwcGVuZCh0YXJnZXQsIG5vZGUpO1xufVxuZnVuY3Rpb24gYXBwZW5kX2h5ZHJhdGlvbl9kZXYodGFyZ2V0LCBub2RlKSB7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01JbnNlcnQnLCB7IHRhcmdldCwgbm9kZSB9KTtcbiAgICBhcHBlbmRfaHlkcmF0aW9uKHRhcmdldCwgbm9kZSk7XG59XG5mdW5jdGlvbiBpbnNlcnRfZGV2KHRhcmdldCwgbm9kZSwgYW5jaG9yKSB7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01JbnNlcnQnLCB7IHRhcmdldCwgbm9kZSwgYW5jaG9yIH0pO1xuICAgIGluc2VydCh0YXJnZXQsIG5vZGUsIGFuY2hvcik7XG59XG5mdW5jdGlvbiBpbnNlcnRfaHlkcmF0aW9uX2Rldih0YXJnZXQsIG5vZGUsIGFuY2hvcikge1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NSW5zZXJ0JywgeyB0YXJnZXQsIG5vZGUsIGFuY2hvciB9KTtcbiAgICBpbnNlcnRfaHlkcmF0aW9uKHRhcmdldCwgbm9kZSwgYW5jaG9yKTtcbn1cbmZ1bmN0aW9uIGRldGFjaF9kZXYobm9kZSkge1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NUmVtb3ZlJywgeyBub2RlIH0pO1xuICAgIGRldGFjaChub2RlKTtcbn1cbmZ1bmN0aW9uIGRldGFjaF9iZXR3ZWVuX2RldihiZWZvcmUsIGFmdGVyKSB7XG4gICAgd2hpbGUgKGJlZm9yZS5uZXh0U2libGluZyAmJiBiZWZvcmUubmV4dFNpYmxpbmcgIT09IGFmdGVyKSB7XG4gICAgICAgIGRldGFjaF9kZXYoYmVmb3JlLm5leHRTaWJsaW5nKTtcbiAgICB9XG59XG5mdW5jdGlvbiBkZXRhY2hfYmVmb3JlX2RldihhZnRlcikge1xuICAgIHdoaWxlIChhZnRlci5wcmV2aW91c1NpYmxpbmcpIHtcbiAgICAgICAgZGV0YWNoX2RldihhZnRlci5wcmV2aW91c1NpYmxpbmcpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGRldGFjaF9hZnRlcl9kZXYoYmVmb3JlKSB7XG4gICAgd2hpbGUgKGJlZm9yZS5uZXh0U2libGluZykge1xuICAgICAgICBkZXRhY2hfZGV2KGJlZm9yZS5uZXh0U2libGluZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gbGlzdGVuX2Rldihub2RlLCBldmVudCwgaGFuZGxlciwgb3B0aW9ucywgaGFzX3ByZXZlbnRfZGVmYXVsdCwgaGFzX3N0b3BfcHJvcGFnYXRpb24pIHtcbiAgICBjb25zdCBtb2RpZmllcnMgPSBvcHRpb25zID09PSB0cnVlID8gWydjYXB0dXJlJ10gOiBvcHRpb25zID8gQXJyYXkuZnJvbShPYmplY3Qua2V5cyhvcHRpb25zKSkgOiBbXTtcbiAgICBpZiAoaGFzX3ByZXZlbnRfZGVmYXVsdClcbiAgICAgICAgbW9kaWZpZXJzLnB1c2goJ3ByZXZlbnREZWZhdWx0Jyk7XG4gICAgaWYgKGhhc19zdG9wX3Byb3BhZ2F0aW9uKVxuICAgICAgICBtb2RpZmllcnMucHVzaCgnc3RvcFByb3BhZ2F0aW9uJyk7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01BZGRFdmVudExpc3RlbmVyJywgeyBub2RlLCBldmVudCwgaGFuZGxlciwgbW9kaWZpZXJzIH0pO1xuICAgIGNvbnN0IGRpc3Bvc2UgPSBsaXN0ZW4obm9kZSwgZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NUmVtb3ZlRXZlbnRMaXN0ZW5lcicsIHsgbm9kZSwgZXZlbnQsIGhhbmRsZXIsIG1vZGlmaWVycyB9KTtcbiAgICAgICAgZGlzcG9zZSgpO1xuICAgIH07XG59XG5mdW5jdGlvbiBhdHRyX2Rldihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKSB7XG4gICAgYXR0cihub2RlLCBhdHRyaWJ1dGUsIHZhbHVlKTtcbiAgICBpZiAodmFsdWUgPT0gbnVsbClcbiAgICAgICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01SZW1vdmVBdHRyaWJ1dGUnLCB7IG5vZGUsIGF0dHJpYnV0ZSB9KTtcbiAgICBlbHNlXG4gICAgICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NU2V0QXR0cmlidXRlJywgeyBub2RlLCBhdHRyaWJ1dGUsIHZhbHVlIH0pO1xufVxuZnVuY3Rpb24gcHJvcF9kZXYobm9kZSwgcHJvcGVydHksIHZhbHVlKSB7XG4gICAgbm9kZVtwcm9wZXJ0eV0gPSB2YWx1ZTtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTVNldFByb3BlcnR5JywgeyBub2RlLCBwcm9wZXJ0eSwgdmFsdWUgfSk7XG59XG5mdW5jdGlvbiBkYXRhc2V0X2Rldihub2RlLCBwcm9wZXJ0eSwgdmFsdWUpIHtcbiAgICBub2RlLmRhdGFzZXRbcHJvcGVydHldID0gdmFsdWU7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01TZXREYXRhc2V0JywgeyBub2RlLCBwcm9wZXJ0eSwgdmFsdWUgfSk7XG59XG5mdW5jdGlvbiBzZXRfZGF0YV9kZXYodGV4dCwgZGF0YSkge1xuICAgIGRhdGEgPSAnJyArIGRhdGE7XG4gICAgaWYgKHRleHQud2hvbGVUZXh0ID09PSBkYXRhKVxuICAgICAgICByZXR1cm47XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01TZXREYXRhJywgeyBub2RlOiB0ZXh0LCBkYXRhIH0pO1xuICAgIHRleHQuZGF0YSA9IGRhdGE7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV9lYWNoX2FyZ3VtZW50KGFyZykge1xuICAgIGlmICh0eXBlb2YgYXJnICE9PSAnc3RyaW5nJyAmJiAhKGFyZyAmJiB0eXBlb2YgYXJnID09PSAnb2JqZWN0JyAmJiAnbGVuZ3RoJyBpbiBhcmcpKSB7XG4gICAgICAgIGxldCBtc2cgPSAneyNlYWNofSBvbmx5IGl0ZXJhdGVzIG92ZXIgYXJyYXktbGlrZSBvYmplY3RzLic7XG4gICAgICAgIGlmICh0eXBlb2YgU3ltYm9sID09PSAnZnVuY3Rpb24nICYmIGFyZyAmJiBTeW1ib2wuaXRlcmF0b3IgaW4gYXJnKSB7XG4gICAgICAgICAgICBtc2cgKz0gJyBZb3UgY2FuIHVzZSBhIHNwcmVhZCB0byBjb252ZXJ0IHRoaXMgaXRlcmFibGUgaW50byBhbiBhcnJheS4nO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihtc2cpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHZhbGlkYXRlX3Nsb3RzKG5hbWUsIHNsb3QsIGtleXMpIHtcbiAgICBmb3IgKGNvbnN0IHNsb3Rfa2V5IG9mIE9iamVjdC5rZXlzKHNsb3QpKSB7XG4gICAgICAgIGlmICghfmtleXMuaW5kZXhPZihzbG90X2tleSkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgPCR7bmFtZX0+IHJlY2VpdmVkIGFuIHVuZXhwZWN0ZWQgc2xvdCBcIiR7c2xvdF9rZXl9XCIuYCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV9keW5hbWljX2VsZW1lbnQodGFnKSB7XG4gICAgY29uc3QgaXNfc3RyaW5nID0gdHlwZW9mIHRhZyA9PT0gJ3N0cmluZyc7XG4gICAgaWYgKHRhZyAmJiAhaXNfc3RyaW5nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignPHN2ZWx0ZTplbGVtZW50PiBleHBlY3RzIFwidGhpc1wiIGF0dHJpYnV0ZSB0byBiZSBhIHN0cmluZy4nKTtcbiAgICB9XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV92b2lkX2R5bmFtaWNfZWxlbWVudCh0YWcpIHtcbiAgICBpZiAodGFnICYmIGlzX3ZvaWQodGFnKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYDxzdmVsdGU6ZWxlbWVudCB0aGlzPVwiJHt0YWd9XCI+IGlzIHNlbGYtY2xvc2luZyBhbmQgY2Fubm90IGhhdmUgY29udGVudC5gKTtcbiAgICB9XG59XG4vKipcbiAqIEJhc2UgY2xhc3MgZm9yIFN2ZWx0ZSBjb21wb25lbnRzIHdpdGggc29tZSBtaW5vciBkZXYtZW5oYW5jZW1lbnRzLiBVc2VkIHdoZW4gZGV2PXRydWUuXG4gKi9cbmNsYXNzIFN2ZWx0ZUNvbXBvbmVudERldiBleHRlbmRzIFN2ZWx0ZUNvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgICAgICBpZiAoIW9wdGlvbnMgfHwgKCFvcHRpb25zLnRhcmdldCAmJiAhb3B0aW9ucy4kJGlubGluZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIid0YXJnZXQnIGlzIGEgcmVxdWlyZWQgb3B0aW9uXCIpO1xuICAgICAgICB9XG4gICAgICAgIHN1cGVyKCk7XG4gICAgfVxuICAgICRkZXN0cm95KCkge1xuICAgICAgICBzdXBlci4kZGVzdHJveSgpO1xuICAgICAgICB0aGlzLiRkZXN0cm95ID0gKCkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKCdDb21wb25lbnQgd2FzIGFscmVhZHkgZGVzdHJveWVkJyk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgICAgICB9O1xuICAgIH1cbiAgICAkY2FwdHVyZV9zdGF0ZSgpIHsgfVxuICAgICRpbmplY3Rfc3RhdGUoKSB7IH1cbn1cbi8qKlxuICogQmFzZSBjbGFzcyB0byBjcmVhdGUgc3Ryb25nbHkgdHlwZWQgU3ZlbHRlIGNvbXBvbmVudHMuXG4gKiBUaGlzIG9ubHkgZXhpc3RzIGZvciB0eXBpbmcgcHVycG9zZXMgYW5kIHNob3VsZCBiZSB1c2VkIGluIGAuZC50c2AgZmlsZXMuXG4gKlxuICogIyMjIEV4YW1wbGU6XG4gKlxuICogWW91IGhhdmUgY29tcG9uZW50IGxpYnJhcnkgb24gbnBtIGNhbGxlZCBgY29tcG9uZW50LWxpYnJhcnlgLCBmcm9tIHdoaWNoXG4gKiB5b3UgZXhwb3J0IGEgY29tcG9uZW50IGNhbGxlZCBgTXlDb21wb25lbnRgLiBGb3IgU3ZlbHRlK1R5cGVTY3JpcHQgdXNlcnMsXG4gKiB5b3Ugd2FudCB0byBwcm92aWRlIHR5cGluZ3MuIFRoZXJlZm9yZSB5b3UgY3JlYXRlIGEgYGluZGV4LmQudHNgOlxuICogYGBgdHNcbiAqIGltcG9ydCB7IFN2ZWx0ZUNvbXBvbmVudFR5cGVkIH0gZnJvbSBcInN2ZWx0ZVwiO1xuICogZXhwb3J0IGNsYXNzIE15Q29tcG9uZW50IGV4dGVuZHMgU3ZlbHRlQ29tcG9uZW50VHlwZWQ8e2Zvbzogc3RyaW5nfT4ge31cbiAqIGBgYFxuICogVHlwaW5nIHRoaXMgbWFrZXMgaXQgcG9zc2libGUgZm9yIElERXMgbGlrZSBWUyBDb2RlIHdpdGggdGhlIFN2ZWx0ZSBleHRlbnNpb25cbiAqIHRvIHByb3ZpZGUgaW50ZWxsaXNlbnNlIGFuZCB0byB1c2UgdGhlIGNvbXBvbmVudCBsaWtlIHRoaXMgaW4gYSBTdmVsdGUgZmlsZVxuICogd2l0aCBUeXBlU2NyaXB0OlxuICogYGBgc3ZlbHRlXG4gKiA8c2NyaXB0IGxhbmc9XCJ0c1wiPlxuICogXHRpbXBvcnQgeyBNeUNvbXBvbmVudCB9IGZyb20gXCJjb21wb25lbnQtbGlicmFyeVwiO1xuICogPC9zY3JpcHQ+XG4gKiA8TXlDb21wb25lbnQgZm9vPXsnYmFyJ30gLz5cbiAqIGBgYFxuICpcbiAqICMjIyMgV2h5IG5vdCBtYWtlIHRoaXMgcGFydCBvZiBgU3ZlbHRlQ29tcG9uZW50KERldilgP1xuICogQmVjYXVzZVxuICogYGBgdHNcbiAqIGNsYXNzIEFTdWJjbGFzc09mU3ZlbHRlQ29tcG9uZW50IGV4dGVuZHMgU3ZlbHRlQ29tcG9uZW50PHtmb286IHN0cmluZ30+IHt9XG4gKiBjb25zdCBjb21wb25lbnQ6IHR5cGVvZiBTdmVsdGVDb21wb25lbnQgPSBBU3ViY2xhc3NPZlN2ZWx0ZUNvbXBvbmVudDtcbiAqIGBgYFxuICogd2lsbCB0aHJvdyBhIHR5cGUgZXJyb3IsIHNvIHdlIG5lZWQgdG8gc2VwYXJhdGUgdGhlIG1vcmUgc3RyaWN0bHkgdHlwZWQgY2xhc3MuXG4gKi9cbmNsYXNzIFN2ZWx0ZUNvbXBvbmVudFR5cGVkIGV4dGVuZHMgU3ZlbHRlQ29tcG9uZW50RGV2IHtcbiAgICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgICAgIHN1cGVyKG9wdGlvbnMpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGxvb3BfZ3VhcmQodGltZW91dCkge1xuICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIHN0YXJ0ID4gdGltZW91dCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbmZpbml0ZSBsb29wIGRldGVjdGVkJyk7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG5leHBvcnQgeyBIdG1sVGFnLCBIdG1sVGFnSHlkcmF0aW9uLCBTdmVsdGVDb21wb25lbnQsIFN2ZWx0ZUNvbXBvbmVudERldiwgU3ZlbHRlQ29tcG9uZW50VHlwZWQsIFN2ZWx0ZUVsZW1lbnQsIGFjdGlvbl9kZXN0cm95ZXIsIGFkZF9hdHRyaWJ1dGUsIGFkZF9jbGFzc2VzLCBhZGRfZmx1c2hfY2FsbGJhY2ssIGFkZF9sb2NhdGlvbiwgYWRkX3JlbmRlcl9jYWxsYmFjaywgYWRkX3Jlc2l6ZV9saXN0ZW5lciwgYWRkX3N0eWxlcywgYWRkX3RyYW5zZm9ybSwgYWZ0ZXJVcGRhdGUsIGFwcGVuZCwgYXBwZW5kX2RldiwgYXBwZW5kX2VtcHR5X3N0eWxlc2hlZXQsIGFwcGVuZF9oeWRyYXRpb24sIGFwcGVuZF9oeWRyYXRpb25fZGV2LCBhcHBlbmRfc3R5bGVzLCBhc3NpZ24sIGF0dHIsIGF0dHJfZGV2LCBhdHRyaWJ1dGVfdG9fb2JqZWN0LCBiZWZvcmVVcGRhdGUsIGJpbmQsIGJpbmRpbmdfY2FsbGJhY2tzLCBibGFua19vYmplY3QsIGJ1YmJsZSwgY2hlY2tfb3V0cm9zLCBjaGlsZHJlbiwgY2xhaW1fY29tcG9uZW50LCBjbGFpbV9lbGVtZW50LCBjbGFpbV9odG1sX3RhZywgY2xhaW1fc3BhY2UsIGNsYWltX3N2Z19lbGVtZW50LCBjbGFpbV90ZXh0LCBjbGVhcl9sb29wcywgY29tcG9uZW50X3N1YnNjcmliZSwgY29tcHV0ZV9yZXN0X3Byb3BzLCBjb21wdXRlX3Nsb3RzLCBjcmVhdGVFdmVudERpc3BhdGNoZXIsIGNyZWF0ZV9hbmltYXRpb24sIGNyZWF0ZV9iaWRpcmVjdGlvbmFsX3RyYW5zaXRpb24sIGNyZWF0ZV9jb21wb25lbnQsIGNyZWF0ZV9pbl90cmFuc2l0aW9uLCBjcmVhdGVfb3V0X3RyYW5zaXRpb24sIGNyZWF0ZV9zbG90LCBjcmVhdGVfc3NyX2NvbXBvbmVudCwgY3VycmVudF9jb21wb25lbnQsIGN1c3RvbV9ldmVudCwgZGF0YXNldF9kZXYsIGRlYnVnLCBkZXN0cm95X2Jsb2NrLCBkZXN0cm95X2NvbXBvbmVudCwgZGVzdHJveV9lYWNoLCBkZXRhY2gsIGRldGFjaF9hZnRlcl9kZXYsIGRldGFjaF9iZWZvcmVfZGV2LCBkZXRhY2hfYmV0d2Vlbl9kZXYsIGRldGFjaF9kZXYsIGRpcnR5X2NvbXBvbmVudHMsIGRpc3BhdGNoX2RldiwgZWFjaCwgZWxlbWVudCwgZWxlbWVudF9pcywgZW1wdHksIGVuZF9oeWRyYXRpbmcsIGVzY2FwZSwgZXNjYXBlX2F0dHJpYnV0ZV92YWx1ZSwgZXNjYXBlX29iamVjdCwgZXNjYXBlZCwgZXhjbHVkZV9pbnRlcm5hbF9wcm9wcywgZml4X2FuZF9kZXN0cm95X2Jsb2NrLCBmaXhfYW5kX291dHJvX2FuZF9kZXN0cm95X2Jsb2NrLCBmaXhfcG9zaXRpb24sIGZsdXNoLCBnZXRBbGxDb250ZXh0cywgZ2V0Q29udGV4dCwgZ2V0X2FsbF9kaXJ0eV9mcm9tX3Njb3BlLCBnZXRfYmluZGluZ19ncm91cF92YWx1ZSwgZ2V0X2N1cnJlbnRfY29tcG9uZW50LCBnZXRfY3VzdG9tX2VsZW1lbnRzX3Nsb3RzLCBnZXRfcm9vdF9mb3Jfc3R5bGUsIGdldF9zbG90X2NoYW5nZXMsIGdldF9zcHJlYWRfb2JqZWN0LCBnZXRfc3ByZWFkX3VwZGF0ZSwgZ2V0X3N0b3JlX3ZhbHVlLCBnbG9iYWxzLCBncm91cF9vdXRyb3MsIGhhbmRsZV9wcm9taXNlLCBoYXNDb250ZXh0LCBoYXNfcHJvcCwgaWRlbnRpdHksIGluaXQsIGluc2VydCwgaW5zZXJ0X2RldiwgaW5zZXJ0X2h5ZHJhdGlvbiwgaW5zZXJ0X2h5ZHJhdGlvbl9kZXYsIGludHJvcywgaW52YWxpZF9hdHRyaWJ1dGVfbmFtZV9jaGFyYWN0ZXIsIGlzX2NsaWVudCwgaXNfY3Jvc3NvcmlnaW4sIGlzX2VtcHR5LCBpc19mdW5jdGlvbiwgaXNfcHJvbWlzZSwgaXNfdm9pZCwgbGlzdGVuLCBsaXN0ZW5fZGV2LCBsb29wLCBsb29wX2d1YXJkLCBtZXJnZV9zc3Jfc3R5bGVzLCBtaXNzaW5nX2NvbXBvbmVudCwgbW91bnRfY29tcG9uZW50LCBub29wLCBub3RfZXF1YWwsIG5vdywgbnVsbF90b19lbXB0eSwgb2JqZWN0X3dpdGhvdXRfcHJvcGVydGllcywgb25EZXN0cm95LCBvbk1vdW50LCBvbmNlLCBvdXRyb19hbmRfZGVzdHJveV9ibG9jaywgcHJldmVudF9kZWZhdWx0LCBwcm9wX2RldiwgcXVlcnlfc2VsZWN0b3JfYWxsLCByYWYsIHJ1biwgcnVuX2FsbCwgc2FmZV9ub3RfZXF1YWwsIHNjaGVkdWxlX3VwZGF0ZSwgc2VsZWN0X211bHRpcGxlX3ZhbHVlLCBzZWxlY3Rfb3B0aW9uLCBzZWxlY3Rfb3B0aW9ucywgc2VsZWN0X3ZhbHVlLCBzZWxmLCBzZXRDb250ZXh0LCBzZXRfYXR0cmlidXRlcywgc2V0X2N1cnJlbnRfY29tcG9uZW50LCBzZXRfY3VzdG9tX2VsZW1lbnRfZGF0YSwgc2V0X2RhdGEsIHNldF9kYXRhX2Rldiwgc2V0X2lucHV0X3R5cGUsIHNldF9pbnB1dF92YWx1ZSwgc2V0X25vdywgc2V0X3JhZiwgc2V0X3N0b3JlX3ZhbHVlLCBzZXRfc3R5bGUsIHNldF9zdmdfYXR0cmlidXRlcywgc3BhY2UsIHNwcmVhZCwgc3JjX3VybF9lcXVhbCwgc3RhcnRfaHlkcmF0aW5nLCBzdG9wX3Byb3BhZ2F0aW9uLCBzdWJzY3JpYmUsIHN2Z19lbGVtZW50LCB0ZXh0LCB0aWNrLCB0aW1lX3Jhbmdlc190b19hcnJheSwgdG9fbnVtYmVyLCB0b2dnbGVfY2xhc3MsIHRyYW5zaXRpb25faW4sIHRyYW5zaXRpb25fb3V0LCB0cnVzdGVkLCB1cGRhdGVfYXdhaXRfYmxvY2tfYnJhbmNoLCB1cGRhdGVfa2V5ZWRfZWFjaCwgdXBkYXRlX3Nsb3QsIHVwZGF0ZV9zbG90X2Jhc2UsIHZhbGlkYXRlX2NvbXBvbmVudCwgdmFsaWRhdGVfZHluYW1pY19lbGVtZW50LCB2YWxpZGF0ZV9lYWNoX2FyZ3VtZW50LCB2YWxpZGF0ZV9lYWNoX2tleXMsIHZhbGlkYXRlX3Nsb3RzLCB2YWxpZGF0ZV9zdG9yZSwgdmFsaWRhdGVfdm9pZF9keW5hbWljX2VsZW1lbnQsIHhsaW5rX2F0dHIgfTtcbiIsICJpbXBvcnQge21vbWVudH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuY29uc3QgbW9udGhOYW1lcyA9IFtcclxuXHQnSmFudWFyeScsXHJcblx0J0ZlYnJ1YXJ5JyxcclxuXHQnTWFyY2gnLFxyXG5cdCdBcHJpbCcsXHJcblx0J01heScsXHJcblx0J0p1bmUnLFxyXG5cdCdKdWx5JyxcclxuXHQnQXVndXN0JyxcclxuXHQnU2VwdGVtYmVyJyxcclxuXHQnT2N0b2JlcicsXHJcblx0J05vdmVtYmVyJyxcclxuXHQnRGVjZW1iZXInLFxyXG5dO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldE1vbnRoTmFtZShpbmRleDogbnVtYmVyKTogc3RyaW5nIHtcclxuXHRyZXR1cm4gbW9udGhOYW1lc1tpbmRleF07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXREYXRlUm93cyhtb250aEluZGV4OiBudW1iZXIsIHllYXI6IG51bWJlcik6IG51bWJlcltdIHtcclxuXHRjb25zdCBkYXlzOiBudW1iZXIgPSBtb21lbnQobmV3IERhdGUoeWVhciwgbW9udGhJbmRleCkpLmRheXNJbk1vbnRoKCk7IC8vIGFtb3VudCBvZiBkYXlzIGluIG1vbnRoXHJcblx0bGV0IHJvd3M6IG51bWJlcltdID0gKG5ldyBBcnJheSg0MikpLmZpbGwodW5kZWZpbmVkKTsgLy8gZW1wdHkgNDIgbG9uZyBhcnJheVxyXG5cdGNvbnN0IHN0YXJ0SW5kZXg6IG51bWJlciA9IGdldFdlZWtEYXkobmV3IERhdGUoeWVhciwgbW9udGhJbmRleCwgMSkpOyAvLyBpbmRleCBvZmZzZXQgYmFzZWQgb24gd2Vla2RheSBvZiBmaXJzdCBkYXkgaW4gbW9udGhcclxuXHJcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBkYXlzOyBpKyspIHtcclxuXHRcdHJvd3NbaSArIHN0YXJ0SW5kZXhdID0gaSArIDE7XHJcblx0fVxyXG5cclxuXHRyb3dzID0gcm93c1tyb3dzLmxlbmd0aCAtIDddID8gcm93cyA6IHJvd3Muc2xpY2UoMCwgLTcpOyAvLyBzbGljZSBsYXN0IHdlZWsgaWYgaXQgaXMgZW1wdHlcclxuXHRyb3dzID0gcm93c1tyb3dzLmxlbmd0aCAtIDddID8gcm93cyA6IHJvd3Muc2xpY2UoMCwgLTcpOyAvLyBzbGljZSBsYXN0IHdlZWsgaWYgaXQgaXMgZW1wdHlcclxuXHJcblx0cmV0dXJuIHJvd3M7XHJcbn1cclxuXHJcbi8vIGZpcnN0IGRheSBvZiB0aGUgd2VlayBpcyBtb25kYXkgd2hlcmUgSSBsaXZlXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRXZWVrRGF5KGRhdGU6IERhdGUpOiBudW1iZXIge1xyXG5cdHJldHVybiBkYXRlLmdldERheSgpID09PSAwID8gNiA6IGRhdGUuZ2V0RGF5KCkgLSAxO1xyXG59XHJcblxyXG4vLyBmaXJzdCBkYXkgb2YgdGhlIHdlZWsgaXMgbW9uZGF5IHdoZXJlIEkgbGl2ZVxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0V2Vla0RheXMoKTogc3RyaW5nW10ge1xyXG5cdHJldHVybiBbJ01vJywgJ1R1JywgJ1dlJywgJ1RoJywgJ0ZyJywgJ1NhJywgJ1N1J107XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB1dWlkKCk6ICgpID0+IG51bWJlciB7XHJcblx0bGV0IGlkID0gMDtcclxuXHRyZXR1cm4gKCkgPT4ge1xyXG5cdFx0cmV0dXJuICsraWQ7XHJcblx0fTtcclxufVxyXG4iLCAiPHNjcmlwdCBsYW5nPVwidHNcIj5cclxuXHRpbXBvcnQge2dldERhdGVSb3dzLCBnZXRXZWVrRGF5cywgdXVpZH0gZnJvbSAnLi9EYXRlUGlja2VySW5wdXRTdmVsdGVIZWxwZXJzLmpzJztcclxuXHRpbXBvcnQge2NyZWF0ZUV2ZW50RGlzcGF0Y2hlcn0gZnJvbSAnc3ZlbHRlJztcclxuXHRpbXBvcnQge21vbWVudH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cdGltcG9ydCB0eXBlIHtNb21lbnR9IGZyb20gJ21vbWVudCc7XHJcblxyXG5cdGNvbnN0IGRpc3BhdGNoID0gY3JlYXRlRXZlbnREaXNwYXRjaGVyKCk7XHJcblxyXG5cdC8vIHByb3BzXHJcblx0ZXhwb3J0IGxldCBzZWxlY3RlZERhdGU6IE1vbWVudDtcclxuXHRleHBvcnQgbGV0IG1vbnRoOiBudW1iZXI7XHJcblx0ZXhwb3J0IGxldCB5ZWFyOiBudW1iZXI7XHJcblxyXG5cdC8vIGxvY2FsIHZhcnMgdG8gaGVscCBpbiByZW5kZXJcclxuXHRsZXQgY2VsbHM7XHJcblxyXG5cdC8vIGZ1bmN0aW9uIGhlbHBlcnNcclxuXHRmdW5jdGlvbiBvbkNoYW5nZShkYXRlOiBudW1iZXIpIHtcclxuXHRcdGRpc3BhdGNoKCdkYXRlQ2hhbmdlJywgbW9tZW50KG5ldyBEYXRlKHllYXIsIG1vbnRoLCBkYXRlKSkpO1xyXG5cdH1cclxuXHJcblx0JDogY2VsbHMgPSBnZXREYXRlUm93cyhtb250aCwgeWVhcik7XHJcbjwvc2NyaXB0PlxyXG5cclxuPHN0eWxlPlxyXG5cdC5jYWxlbmRhciB7XHJcblx0XHRtYXJnaW4tdG9wOiAxMHB4O1xyXG5cdH1cclxuXHJcblx0LmNhbGVuZGFyLWhlYWRlciB7XHJcblx0XHRkaXNwbGF5OiAgICAgICAgIGZsZXg7XHJcblx0XHRqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWFyb3VuZDtcclxuXHRcdGZsZXgtd3JhcDogICAgICAgd3JhcDtcclxuXHRcdGdhcDogICAgICAgICAgICAgMnB4O1xyXG5cdFx0YmFja2dyb3VuZDogICAgICB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xyXG5cdFx0Ym9yZGVyLXJhZGl1czogICB2YXIoLS1tZXRhLWJpbmQtcGx1Z2luLWJvcmRlci1yYWRpdXMpO1xyXG5cdFx0bWFyZ2luLWJvdHRvbTogICAycHg7XHJcblx0fVxyXG5cclxuXHQuY2FsZW5kYXItY29udGVudCB7XHJcblx0XHRkaXNwbGF5OiAgICAgICAgICAgICAgIGdyaWQ7XHJcblx0XHRmbGV4LXdyYXA6ICAgICAgICAgICAgIHdyYXA7XHJcblx0XHRncmlkLXRlbXBsYXRlLWNvbHVtbnM6IHJlcGVhdCg3LCAxZnIpO1xyXG5cdFx0Z2FwOiAgICAgICAgICAgICAgICAgICAycHg7XHJcblx0fVxyXG5cclxuXHQuY2VsbCB7XHJcblx0XHRtaW4td2lkdGg6ICAgICAgIDQwcHg7XHJcblx0XHRoZWlnaHQ6ICAgICAgICAgIDMwcHg7XHJcblx0XHRwYWRkaW5nOiAgICAgICAgIDVweDtcclxuXHRcdGRpc3BsYXk6ICAgICAgICAgZmxleDtcclxuXHRcdGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG5cdFx0YWxpZ24taXRlbXM6ICAgICBjZW50ZXI7XHJcblx0XHRib3JkZXItcmFkaXVzOiAgIHZhcigtLW1ldGEtYmluZC1wbHVnaW4tYm9yZGVyLXJhZGl1cyk7XHJcblx0fVxyXG5cclxuXHQuY29udGVudC1jZWxsIHtcclxuXHRcdGN1cnNvcjogcG9pbnRlcjtcclxuXHR9XHJcblxyXG5cdC5jZWxsLXRleHQge1xyXG5cdFx0bWFyZ2luOiAgICAgYXV0bztcclxuXHRcdHRleHQtYWxpZ246IGNlbnRlcjtcclxuXHR9XHJcblxyXG5cdC5zZWxlY3RlZCB7XHJcblx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLXN1Y2Nlc3MpO1xyXG5cdH1cclxuXHJcblx0LmhpZ2hsaWdodDpob3ZlciB7XHJcblx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1pbnRlcmFjdGl2ZS1ob3Zlcik7XHJcblx0fVxyXG5cclxuXHQuc2VsZWN0ZWQuaGlnaGxpZ2h0OmhvdmVyIHtcclxuXHRcdGJhY2tncm91bmQ6IGdyZWVuO1xyXG5cdH1cclxuPC9zdHlsZT5cclxuXHJcbjxkaXYgY2xhc3M9XCJjYWxlbmRhclwiPlxyXG5cdDxkaXYgY2xhc3M9XCJjYWxlbmRhci1oZWFkZXJcIj5cclxuXHRcdHsjZWFjaCBnZXRXZWVrRGF5cygpIGFzIGRheX1cclxuXHRcdFx0PGRpdiBjbGFzcz1cImNlbGwgaGVhZGVyLWNlbGxcIj5cclxuXHRcdFx0XHQ8c3BhbiBjbGFzcz1cImNlbGwtdGV4dFwiPntkYXl9PC9zcGFuPlxyXG5cdFx0XHQ8L2Rpdj5cclxuXHRcdHsvZWFjaH1cclxuXHQ8L2Rpdj5cclxuXHJcblx0PGRpdiBjbGFzcz1cImNhbGVuZGFyLWNvbnRlbnRcIj5cclxuXHRcdHsjZWFjaCBjZWxscyBhcyB2YWx1ZSAodXVpZCgpKX1cclxuXHRcdFx0PGRpdlxyXG5cdFx0XHRcdGNsYXNzPVwiY2VsbFwiXHJcblx0XHRcdFx0b246Y2xpY2s9e3ZhbHVlID8gKCkgPT4gb25DaGFuZ2UodmFsdWUpIDogKCkgPT4ge319XHJcblx0XHRcdFx0Y2xhc3M6aGlnaGxpZ2h0PXt2YWx1ZX1cclxuXHRcdFx0XHRjbGFzczpjb250ZW50LWNlbGw9e3ZhbHVlfVxyXG5cdFx0XHRcdGNsYXNzOnNlbGVjdGVkPXtzZWxlY3RlZERhdGUueWVhcigpID09PSB5ZWFyICYmIHNlbGVjdGVkRGF0ZS5tb250aCgpID09PSBtb250aCAmJiBzZWxlY3RlZERhdGUuZGF0ZSgpID09PSB2YWx1ZX0+XHJcblx0XHRcdFx0PHNwYW4gY2xhc3M9XCJjZWxsLXRleHRcIj57dmFsdWUgfHwgJyd9PC9zcGFuPlxyXG5cdFx0XHQ8L2Rpdj5cclxuXHRcdHsvZWFjaH1cclxuXHQ8L2Rpdj5cclxuPC9kaXY+XHJcbiIsICI8IS0tYWRhcHRlZCBmcm9tIEBqb2V0aGVpJ3MgY29kZTogaHR0cHM6Ly9naXRodWIuY29tL2pvZXRoZWkvb2JzaWRpYW4tcnNzL2Jsb2IvbWFzdGVyL3NyYy92aWV3L0ljb25Db21wb25lbnQuc3ZlbHRlLS0+XHJcbjwhLS1hZGFwdGVkIGZyb20gQGphdmFsZW50J3MgY29kZTogaHR0cHM6Ly9kaXNjb3JkLmNvbS9jaGFubmVscy82ODYwNTM3MDgyNjEyMjg1NzcvODQwMjg2MjY0OTY0MDIyMzAyLzkwMjk0OTc2NDIwOTk4NzY1NC0tPlxyXG48c2NyaXB0IGxhbmc9XCJ0c1wiPlxyXG5cdGltcG9ydCB7c2V0SWNvbn0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cdGltcG9ydCB7b25Nb3VudH0gZnJvbSAnc3ZlbHRlJztcclxuXHJcblx0ZXhwb3J0IGxldCBpY29uTmFtZTogc3RyaW5nID0gJyc7XHJcblx0ZXhwb3J0IGxldCBpY29uU2l6ZTogbnVtYmVyID0gMjA7XHJcblxyXG5cdGxldCBpY29uRWw6IEhUTUxFbGVtZW50O1xyXG5cclxuXHRvbk1vdW50KCgpID0+IHtcclxuXHRcdHNldEljb24oaWNvbkVsLCBpY29uTmFtZSwgaWNvblNpemUpO1xyXG5cdH0pO1xyXG48L3NjcmlwdD5cclxuXHJcbjxzdHlsZT5cclxuXHQuaWNvbi13cmFwcGVyIHtcclxuXHRcdGRpc3BsYXk6ICBpbmxpbmUtYmxvY2s7XHJcblx0XHRwb3NpdGlvbjogcmVsYXRpdmU7XHJcblx0XHR3aWR0aDogICAgMjBweDtcclxuXHR9XHJcblxyXG5cdC5pY29uIHtcclxuXHRcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuXHRcdGhlaWdodDogICAyMHB4O1xyXG5cdFx0d2lkdGg6ICAgIDIwcHg7XHJcblx0XHRib3R0b206ICAgLTVweDtcclxuXHR9XHJcbjwvc3R5bGU+XHJcblxyXG57I2lmIGljb25OYW1lLmxlbmd0aCA+IDB9XHJcblx0PGRpdiBjbGFzcz1cImljb24td3JhcHBlclwiPlxyXG5cdFx0PGRpdiBiaW5kOnRoaXM9e2ljb25FbH0gY2xhc3M9XCJpY29uXCI+PC9kaXY+XHJcblx0PC9kaXY+XHJcbnsvaWZ9XHJcbiIsICI8c2NyaXB0IGxhbmc9XCJ0c1wiPlxyXG5cdGltcG9ydCB7Y3JlYXRlRXZlbnREaXNwYXRjaGVyfSBmcm9tICdzdmVsdGUnO1xyXG5cdGltcG9ydCBDYWxlbmRlciBmcm9tICcuL0NhbGVuZGVyLnN2ZWx0ZSc7XHJcblx0aW1wb3J0IHtnZXRNb250aE5hbWV9IGZyb20gJy4vRGF0ZVBpY2tlcklucHV0U3ZlbHRlSGVscGVycy5qcyc7XHJcblx0aW1wb3J0IHttb21lbnR9IGZyb20gJ29ic2lkaWFuJztcclxuXHRpbXBvcnQgdHlwZSB7TW9tZW50fSBmcm9tICdtb21lbnQnO1xyXG5cdGltcG9ydCBJY29uIGZyb20gJy4vSWNvbi5zdmVsdGUnO1xyXG5cclxuXHRjb25zdCBkaXNwYXRjaCA9IGNyZWF0ZUV2ZW50RGlzcGF0Y2hlcigpO1xyXG5cclxuXHRleHBvcnQgbGV0IHNlbGVjdGVkRGF0ZTogTW9tZW50ID0gbW9tZW50KCk7XHJcblx0ZXhwb3J0IGxldCBkYXRlRm9ybWF0OiBzdHJpbmcgPSAnZGRkZCwgTU1NTSBEbyBZWVlZJztcclxuXHRleHBvcnQgbGV0IGRhdGVDaGFuZ2VDYWxsYmFjazogKGRhdGU6IE1vbWVudCkgPT4gdm9pZDtcclxuXHJcblx0ZXhwb3J0IGxldCBhbGlnblJpZ2h0OiBib29sZWFuO1xyXG5cclxuXHRsZXQgZGF0ZTogbnVtYmVyO1xyXG5cdGxldCBtb250aDogbnVtYmVyO1xyXG5cdGxldCB5ZWFyOiBudW1iZXI7XHJcblx0bGV0IHNob3dEYXRlUGlja2VyOiBib29sZWFuO1xyXG5cclxuXHQvLyBzbyB0aGF0IHRoZXNlIGNoYW5nZSB3aXRoIHByb3BzXHJcblx0JDoge1xyXG5cdFx0Y29uc29sZS5sb2coJ3VwZGF0ZSBkYXRlIHBpY2tlcicsIHNlbGVjdGVkRGF0ZSk7XHJcblx0XHRkYXRlID0gc2VsZWN0ZWREYXRlLmRhdGUoKTtcclxuXHRcdG1vbnRoID0gc2VsZWN0ZWREYXRlLm1vbnRoKCk7XHJcblx0XHR5ZWFyID0gc2VsZWN0ZWREYXRlLnllYXIoKTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIG5leHRNb250aCgpOiB2b2lkIHtcclxuXHRcdGlmIChtb250aCA9PT0gMTEpIHtcclxuXHRcdFx0bW9udGggPSAwO1xyXG5cdFx0XHR5ZWFyICs9IDE7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdG1vbnRoID0gbW9udGggKyAxO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gcHJldk1vbnRoKCk6IHZvaWQge1xyXG5cdFx0aWYgKG1vbnRoID09PSAwKSB7XHJcblx0XHRcdG1vbnRoID0gMTE7XHJcblx0XHRcdHllYXIgLT0gMTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0bW9udGggLT0gMTtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIGNoYW5nZVllYXIodmFsdWU6IGFueSk6IHZvaWQge1xyXG5cdFx0Y29uc3QgdiA9IHZhbHVlLnRhcmdldC52YWx1ZTtcclxuXHRcdGNvbnN0IHZOdW0gPSBOdW1iZXIucGFyc2VJbnQodik7XHJcblx0XHRpZiAoIU51bWJlci5pc05hTih2TnVtKSkge1xyXG5cdFx0XHR5ZWFyID0gdk51bTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIG9uRGF0ZUNoYW5nZShkOiB7IGRldGFpbDogTW9tZW50IH0pOiB2b2lkIHtcclxuXHRcdHNob3dEYXRlUGlja2VyID0gZmFsc2U7XHJcblx0XHRzZWxlY3RlZERhdGUgPSBkLmRldGFpbDtcclxuXHRcdGRhdGVDaGFuZ2VDYWxsYmFjayhkLmRldGFpbCk7XHJcblx0fVxyXG48L3NjcmlwdD5cclxuXHJcbjxzdHlsZT5cclxuXHQuZGF0ZS1waWNrZXItaW5wdXQge1xyXG5cdFx0cG9zaXRpb246IHJlbGF0aXZlO1xyXG5cdFx0Y29sb3I6ICAgIHZhcigtLXRleHQtbm9ybWFsKTtcclxuXHRcdGRpc3BsYXk6ICBpbmxpbmUtYmxvY2s7XHJcblx0fVxyXG5cclxuXHQuZGF0ZS1waWNrZXIge1xyXG5cdFx0cG9zaXRpb246ICAgICAgYWJzb2x1dGU7XHJcblx0XHR0b3A6ICAgICAgICAgICAzNXB4O1xyXG5cdFx0ZGlzcGxheTogICAgICAgaW5saW5lLWJsb2NrO1xyXG5cdFx0YmFja2dyb3VuZDogICAgdmFyKC0tYmFja2dyb3VuZC1zZWNvbmRhcnkpO1xyXG5cdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tbWV0YS1iaW5kLXBsdWdpbi1ib3JkZXItcmFkaXVzKTtcclxuXHRcdGJvcmRlcjogICAgICAgIHZhcigtLW1ldGEtYmluZC1wbHVnaW4tYm9yZGVyLXdpZHRoKSBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XHJcblx0XHRwYWRkaW5nOiAgICAgICAxMHB4O1xyXG5cdFx0ei1pbmRleDogICAgICAgMTAwMDAwMDtcclxuXHR9XHJcblxyXG5cdC5kYXRlLXBpY2tlci10ZXh0IHtcclxuXHRcdGJhY2tncm91bmQ6ICAgIHZhcigtLWJhY2tncm91bmQtc2Vjb25kYXJ5KTtcclxuXHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLW1ldGEtYmluZC1wbHVnaW4tYm9yZGVyLXJhZGl1cyk7XHJcblx0XHRib3JkZXI6ICAgICAgICB2YXIoLS1tZXRhLWJpbmQtcGx1Z2luLWJvcmRlci13aWR0aCkgc29saWQgdmFyKC0tYmFja2dyb3VuZC1tb2RpZmllci1ib3JkZXIpO1xyXG5cdFx0cGFkZGluZzogICAgICAgNXB4IDVweCA1cHggN3B4O1xyXG5cdFx0Y3Vyc29yOiAgICAgICAgcG9pbnRlcjtcclxuXHRcdHdpZHRoOiAgICAgICAgIGZpdC1jb250ZW50O1xyXG5cdFx0ZGlzcGxheTogICAgICAgaW5saW5lLWJsb2NrO1xyXG5cdH1cclxuXHJcblx0LmRhdGUtcGlja2VyLWNsb3NlLWxheWVyIHtcclxuXHRcdHBvc2l0aW9uOiBmaXhlZDtcclxuXHRcdHRvcDogICAgICAwO1xyXG5cdFx0bGVmdDogICAgIDA7XHJcblx0XHR3aWR0aDogICAgMTAwdnc7XHJcblx0XHRoZWlnaHQ6ICAgMTAwdmg7XHJcblx0XHR6LWluZGV4OiAgOTAwMDAwOyAvKiBzbyBpdCBvdmVybGF5cyBldmVyeXRoaW5nIGV4Y2VwdCB0aGUgZGF0ZSBwaWNrZXIqL1xyXG5cdH1cclxuXHJcblx0LmRhdGUtcGlja2VyLWhlYWRlciB7XHJcblx0XHRkaXNwbGF5OiAgICAgICAgIGZsZXg7XHJcblx0XHRnYXA6ICAgICAgICAgICAgIDVweDtcclxuXHRcdGFsaWduLWl0ZW1zOiAgICAgY2VudGVyO1xyXG5cdFx0anVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XHJcblx0fVxyXG5cclxuXHQuZGF0ZS1waWNrZXItaGVhZGVyLXRleHQge1xyXG5cdFx0ZmxleDogICAgICAgICAgICAxO1xyXG5cdFx0dGV4dC1hbGlnbjogICAgICBjZW50ZXI7XHJcblx0XHRkaXNwbGF5OiAgICAgICAgIGZsZXg7XHJcblx0XHRnYXA6ICAgICAgICAgICAgIDVweDtcclxuXHRcdGFsaWduLWl0ZW1zOiAgICAgY2VudGVyO1xyXG5cdFx0anVzdGlmeS1jb250ZW50OiBjZW50ZXI7XHJcblx0XHR3aWR0aDogICAgICAgICAgIG1pbi1jb250ZW50O1xyXG5cdH1cclxuXHJcblx0LmRhdGUtcGlja2VyLWhlYWRlci10ZXh0LXllYXIge1xyXG5cdFx0d2lkdGg6ICAgNjBweDtcclxuXHRcdHBhZGRpbmc6IDVweDtcclxuXHR9XHJcblxyXG5cdC5kYXRlLXBpY2tlci1oZWFkZXItdGV4dC1tb250aCB7XHJcblx0XHRoZWlnaHQ6IG1pbi1jb250ZW50O1xyXG5cdH1cclxuXHJcblx0Lm1vbnRoLXN3aXRjaC1idXR0b24ge1xyXG5cdFx0bWFyZ2luOiAwO1xyXG5cdH1cclxuPC9zdHlsZT5cclxuXHJcbjxkaXYgY2xhc3M9XCJkYXRlLXBpY2tlci1pbnB1dFwiPlxyXG5cdDxkaXYgY2xhc3M9XCJkYXRlLXBpY2tlci10ZXh0XCIgb246Y2xpY2s9eygpID0+IHNob3dEYXRlUGlja2VyID0gdHJ1ZX0+XHJcblx0XHR7c2VsZWN0ZWREYXRlLmZvcm1hdChkYXRlRm9ybWF0KX1cclxuXHRcdDxJY29uIGljb25OYW1lPVwiY2FsZW5kYXJcIi8+XHJcblx0PC9kaXY+XHJcblx0eyNpZiBzaG93RGF0ZVBpY2tlcn1cclxuXHRcdDxkaXYgY2xhc3M9XCJkYXRlLXBpY2tlci1jbG9zZS1sYXllclwiIG9uOmNsaWNrPXsoKSA9PiBzaG93RGF0ZVBpY2tlciA9IGZhbHNlfT48L2Rpdj5cclxuXHRcdDxkaXYgY2xhc3M9XCJkYXRlLXBpY2tlclwiIHN0eWxlPVwie2FsaWduUmlnaHQgPyAnbGVmdDogYXV0bzsgcmlnaHQ6IDA7JyA6ICdyaWdodDogYXV0bzsgbGVmdDogMDsnfVwiPlxyXG5cdFx0XHQ8ZGl2IGNsYXNzPVwiZGF0ZS1waWNrZXItaGVhZGVyXCI+XHJcblx0XHRcdFx0PGJ1dHRvbiBjbGFzcz1cIm1vbnRoLXN3aXRjaC1idXR0b25cIiBvbjpjbGljaz17cHJldk1vbnRofT5QcmV2PC9idXR0b24+XHJcblx0XHRcdFx0PGRpdiBjbGFzcz1cImRhdGUtcGlja2VyLWhlYWRlci10ZXh0XCI+XHJcblx0XHRcdFx0XHQ8c3BhbiBjbGFzcz1cImRhdGUtcGlja2VyLWhlYWRlci10ZXh0LW1vbnRoXCI+e2dldE1vbnRoTmFtZShtb250aCl9PC9zcGFuPlxyXG5cdFx0XHRcdFx0PGlucHV0IGNsYXNzPVwiZGF0ZS1waWNrZXItaGVhZGVyLXRleHQteWVhclwiIHR5cGU9XCJudW1iZXJcIiB2YWx1ZT1cInt5ZWFyLnRvU3RyaW5nKCl9XCJcclxuXHRcdFx0XHRcdFx0ICAgb246aW5wdXQ9XCJ7Y2hhbmdlWWVhcn1cIj5cclxuXHRcdFx0XHQ8L2Rpdj5cclxuXHRcdFx0XHQ8YnV0dG9uIGNsYXNzPVwibW9udGgtc3dpdGNoLWJ1dHRvblwiIG9uOmNsaWNrPXtuZXh0TW9udGh9Pk5leHQ8L2J1dHRvbj5cclxuXHRcdFx0PC9kaXY+XHJcblx0XHRcdDxDYWxlbmRlclxyXG5cdFx0XHRcdG9uOmRhdGVDaGFuZ2U9e29uRGF0ZUNoYW5nZX1cclxuXHRcdFx0XHRtb250aD17bW9udGh9XHJcblx0XHRcdFx0eWVhcj17eWVhcn1cclxuXHRcdFx0XHRzZWxlY3RlZERhdGU9e3NlbGVjdGVkRGF0ZX0+XHJcblx0XHRcdDwvQ2FsZW5kZXI+XHJcblx0XHQ8L2Rpdj5cclxuXHR7L2lmfVxyXG48L2Rpdj5cclxuIiwgImltcG9ydCB7SW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGR9IGZyb20gJy4uLy4uL0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkJztcbmltcG9ydCB7QWJzdHJhY3RJbnB1dEZpZWxkfSBmcm9tICcuLi9BYnN0cmFjdElucHV0RmllbGQnO1xuaW1wb3J0IHtpc1RydXRoeSwgTWV0YUJpbmRJbnRlcm5hbEVycm9yfSBmcm9tICcuLi8uLi91dGlscy9VdGlscyc7XG5pbXBvcnQgRGF0ZVBpY2tlciBmcm9tICcuL0RhdGVQaWNrZXIuc3ZlbHRlJztcbmltcG9ydCB7bW9tZW50fSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQge0RhdGVQYXJzZXJ9IGZyb20gJy4uLy4uL3BhcnNlcnMvRGF0ZVBhcnNlcic7XG5pbXBvcnQge0lucHV0RmllbGRBcmd1bWVudFR5cGV9IGZyb20gJy4uLy4uL3BhcnNlcnMvSW5wdXRGaWVsZERlY2xhcmF0aW9uUGFyc2VyJztcblxuZXhwb3J0IGNsYXNzIERhdGVQaWNrZXJJbnB1dEZpZWxkIGV4dGVuZHMgQWJzdHJhY3RJbnB1dEZpZWxkIHtcblx0Y29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCB8IHVuZGVmaW5lZDtcblx0Y29tcG9uZW50OiBEYXRlUGlja2VyIHwgdW5kZWZpbmVkO1xuXHRkYXRlOiBtb21lbnQuTW9tZW50O1xuXG5cdGNvbnN0cnVjdG9yKGlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkOiBJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCwgb25WYWx1ZUNoYW5nZTogKHZhbHVlOiBhbnkpID0+ICh2b2lkIHwgUHJvbWlzZTx2b2lkPikpIHtcblx0XHRzdXBlcihpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCwgb25WYWx1ZUNoYW5nZSk7XG5cblx0XHR0aGlzLmRhdGUgPSBEYXRlUGFyc2VyLmdldERlZmF1bHREYXRlKCk7XG5cdH1cblxuXHRnZXRWYWx1ZSgpOiBhbnkge1xuXHRcdHJldHVybiBEYXRlUGFyc2VyLnN0cmluZ2lmeSh0aGlzLmRhdGUpO1xuXHR9XG5cblx0c2V0VmFsdWUodmFsdWU6IGFueSk6IHZvaWQge1xuXHRcdHRoaXMuZGF0ZSA9IERhdGVQYXJzZXIucGFyc2UodmFsdWUpID8/IERhdGVQYXJzZXIuZ2V0RGVmYXVsdERhdGUoKTtcblxuXHRcdGlmICghdGhpcy5kYXRlLmlzVmFsaWQoKSkge1xuXHRcdFx0dGhpcy5kYXRlID0gRGF0ZVBhcnNlci5nZXREZWZhdWx0RGF0ZSgpO1xuXHRcdFx0dGhpcy5vblZhbHVlQ2hhbmdlKHRoaXMuZ2V0VmFsdWUoKSk7XG5cdFx0fVxuXG5cdFx0dGhpcy5jb21wb25lbnQ/LiRzZXQoeydzZWxlY3RlZERhdGUnOiB0aGlzLmRhdGV9KTtcblx0fVxuXG5cdGlzRXF1YWxWYWx1ZSh2YWx1ZTogYW55KTogYm9vbGVhbiB7XG5cdFx0cmV0dXJuIHRoaXMuZ2V0VmFsdWUoKSA9PSB2YWx1ZTtcblx0fVxuXG5cdGdldERlZmF1bHRWYWx1ZSgpOiBhbnkge1xuXHRcdHJldHVybiBEYXRlUGFyc2VyLnN0cmluZ2lmeShEYXRlUGFyc2VyLmdldERlZmF1bHREYXRlKCkpO1xuXHR9XG5cblx0Z2V0SHRtbEVsZW1lbnQoKTogSFRNTEVsZW1lbnQge1xuXHRcdGlmICghdGhpcy5jb250YWluZXIpIHtcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJycpO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzLmNvbnRhaW5lcjtcblx0fVxuXG5cdGRhdGVQaWNrZXJWYWx1ZUNoYW5nZWQoZGF0ZTogbW9tZW50Lk1vbWVudCk6IHZvaWQge1xuXHRcdHRoaXMuZGF0ZSA9IGRhdGU7XG5cdFx0Ly8gY29uc29sZS5sb2coJ2RhdGUgcGlja2VyIHZhbHVlIGNoYW5nZScsIHRoaXMuZGF0ZSk7XG5cblx0XHRpZiAodGhpcy5kYXRlLmlzVmFsaWQoKSkge1xuXHRcdFx0dGhpcy5vblZhbHVlQ2hhbmdlKHRoaXMuZ2V0VmFsdWUoKSk7XG5cdFx0fVxuXHR9XG5cblx0cmVuZGVyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcblx0XHR0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcblxuXHRcdHRoaXMuZGF0ZSA9IERhdGVQYXJzZXIucGFyc2UodGhpcy5pbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZC5nZXRJbml0aWFsVmFsdWUoKSkgPz8gRGF0ZVBhcnNlci5nZXREZWZhdWx0RGF0ZSgpO1xuXHRcdGlmICghdGhpcy5kYXRlLmlzVmFsaWQoKSkge1xuXHRcdFx0dGhpcy5kYXRlID0gRGF0ZVBhcnNlci5nZXREZWZhdWx0RGF0ZSgpO1xuXHRcdFx0dGhpcy5vblZhbHVlQ2hhbmdlKHRoaXMuZ2V0VmFsdWUoKSk7XG5cdFx0fVxuXG5cdFx0dGhpcy5jb21wb25lbnQgPSBuZXcgRGF0ZVBpY2tlcih7XG5cdFx0XHR0YXJnZXQ6IGNvbnRhaW5lcixcblx0XHRcdHByb3BzOiB7XG5cdFx0XHRcdGFsaWduUmlnaHQ6IHRoaXMuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQuZ2V0QXJndW1lbnQoSW5wdXRGaWVsZEFyZ3VtZW50VHlwZS5BTElHTl9SSUdIVCk/LnZhbHVlLFxuXHRcdFx0XHRzZWxlY3RlZERhdGU6IHRoaXMuZGF0ZSxcblx0XHRcdFx0ZGF0ZUZvcm1hdDogdGhpcy5pbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZC5wbHVnaW4uc2V0dGluZ3MucHJlZmVycmVkRGF0ZUZvcm1hdCxcblx0XHRcdFx0ZGF0ZUNoYW5nZUNhbGxiYWNrOiAoZGF0ZTogbW9tZW50Lk1vbWVudCkgPT4gdGhpcy5kYXRlUGlja2VyVmFsdWVDaGFuZ2VkKGRhdGUpLFxuXHRcdFx0fSxcblx0XHR9KTtcblx0fVxuXG59XG4iLCAiaW1wb3J0IHtUb2dnbGVJbnB1dEZpZWxkfSBmcm9tICcuL1RvZ2dsZUlucHV0RmllbGQnO1xyXG5pbXBvcnQge0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLCBJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZFR5cGV9IGZyb20gJy4uL0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkJztcclxuaW1wb3J0IHtUZXh0SW5wdXRGaWVsZH0gZnJvbSAnLi9UZXh0SW5wdXRGaWVsZCc7XHJcbmltcG9ydCB7U2xpZGVySW5wdXRGaWVsZH0gZnJvbSAnLi9TbGlkZXJJbnB1dEZpZWxkJztcclxuaW1wb3J0IHtUZXh0QXJlYUlucHV0RmllbGR9IGZyb20gJy4vVGV4dEFyZWFJbnB1dEZpZWxkJztcclxuaW1wb3J0IHtTZWxlY3RJbnB1dEZpZWxkfSBmcm9tICcuL1NlbGVjdElucHV0RmllbGQnO1xyXG5pbXBvcnQge011bHRpU2VsZWN0SW5wdXRGaWVsZH0gZnJvbSAnLi9NdWx0aVNlbGVjdElucHV0RmllbGQnO1xyXG5pbXBvcnQge0RhdGVJbnB1dEZpZWxkfSBmcm9tICcuL0RhdGVJbnB1dEZpZWxkJztcclxuaW1wb3J0IHtUaW1lSW5wdXRGaWVsZH0gZnJvbSAnLi9UaW1lSW5wdXRGaWVsZCc7XHJcbmltcG9ydCB7TWV0YUJpbmRQYXJzaW5nRXJyb3J9IGZyb20gJy4uL3V0aWxzL1V0aWxzJztcclxuaW1wb3J0IHtBYnN0cmFjdElucHV0RmllbGR9IGZyb20gJy4vQWJzdHJhY3RJbnB1dEZpZWxkJztcclxuaW1wb3J0IHtJbnB1dEZpZWxkVHlwZX0gZnJvbSAnLi4vcGFyc2Vycy9JbnB1dEZpZWxkRGVjbGFyYXRpb25QYXJzZXInO1xyXG5pbXBvcnQge0RhdGVQaWNrZXJJbnB1dEZpZWxkfSBmcm9tICcuL0RhdGVQaWNrZXIvRGF0ZVBpY2tlcklucHV0RmllbGQnO1xyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBJbnB1dEZpZWxkRmFjdG9yeSB7XHJcblx0c3RhdGljIGFsbG93Q29kZUJsb2NrTWFwOiBSZWNvcmQ8c3RyaW5nLCB7IGNvZGVCbG9jazogYm9vbGVhbiwgaW5saW5lQ29kZUJsb2NrOiBib29sZWFuIH0+ID0ge1xyXG5cdFx0W0lucHV0RmllbGRUeXBlLlRPR0dMRV06IHtcclxuXHRcdFx0Y29kZUJsb2NrOiBUb2dnbGVJbnB1dEZpZWxkLmFsbG93Q29kZUJsb2NrLFxyXG5cdFx0XHRpbmxpbmVDb2RlQmxvY2s6IFRvZ2dsZUlucHV0RmllbGQuYWxsb3dJbmxpbmVDb2RlQmxvY2tcclxuXHRcdH0sXHJcblx0XHRbSW5wdXRGaWVsZFR5cGUuU0xJREVSXToge1xyXG5cdFx0XHRjb2RlQmxvY2s6IFNsaWRlcklucHV0RmllbGQuYWxsb3dDb2RlQmxvY2ssXHJcblx0XHRcdGlubGluZUNvZGVCbG9jazogU2xpZGVySW5wdXRGaWVsZC5hbGxvd0lubGluZUNvZGVCbG9ja1xyXG5cdFx0fSxcclxuXHRcdFtJbnB1dEZpZWxkVHlwZS5URVhUXToge1xyXG5cdFx0XHRjb2RlQmxvY2s6IFRleHRJbnB1dEZpZWxkLmFsbG93Q29kZUJsb2NrLFxyXG5cdFx0XHRpbmxpbmVDb2RlQmxvY2s6IFRleHRJbnB1dEZpZWxkLmFsbG93SW5saW5lQ29kZUJsb2NrXHJcblx0XHR9LFxyXG5cdFx0W0lucHV0RmllbGRUeXBlLlRFWFRfQVJFQV06IHtcclxuXHRcdFx0Y29kZUJsb2NrOiBUZXh0QXJlYUlucHV0RmllbGQuYWxsb3dDb2RlQmxvY2ssXHJcblx0XHRcdGlubGluZUNvZGVCbG9jazogVGV4dEFyZWFJbnB1dEZpZWxkLmFsbG93SW5saW5lQ29kZUJsb2NrXHJcblx0XHR9LFxyXG5cdFx0W0lucHV0RmllbGRUeXBlLlNFTEVDVF06IHtcclxuXHRcdFx0Y29kZUJsb2NrOiBTZWxlY3RJbnB1dEZpZWxkLmFsbG93Q29kZUJsb2NrLFxyXG5cdFx0XHRpbmxpbmVDb2RlQmxvY2s6IFNlbGVjdElucHV0RmllbGQuYWxsb3dJbmxpbmVDb2RlQmxvY2tcclxuXHRcdH0sXHJcblx0XHRbSW5wdXRGaWVsZFR5cGUuTVVMVElfU0VMRUNUXToge1xyXG5cdFx0XHRjb2RlQmxvY2s6IE11bHRpU2VsZWN0SW5wdXRGaWVsZC5hbGxvd0NvZGVCbG9jayxcclxuXHRcdFx0aW5saW5lQ29kZUJsb2NrOiBNdWx0aVNlbGVjdElucHV0RmllbGQuYWxsb3dJbmxpbmVDb2RlQmxvY2tcclxuXHRcdH0sXHJcblx0XHRbSW5wdXRGaWVsZFR5cGUuREFURV06IHtcclxuXHRcdFx0Y29kZUJsb2NrOiBEYXRlSW5wdXRGaWVsZC5hbGxvd0NvZGVCbG9jayxcclxuXHRcdFx0aW5saW5lQ29kZUJsb2NrOiBEYXRlSW5wdXRGaWVsZC5hbGxvd0lubGluZUNvZGVCbG9ja1xyXG5cdFx0fSxcclxuXHRcdFtJbnB1dEZpZWxkVHlwZS5USU1FXToge1xyXG5cdFx0XHRjb2RlQmxvY2s6IFRpbWVJbnB1dEZpZWxkLmFsbG93Q29kZUJsb2NrLFxyXG5cdFx0XHRpbmxpbmVDb2RlQmxvY2s6IFRpbWVJbnB1dEZpZWxkLmFsbG93SW5saW5lQ29kZUJsb2NrXHJcblx0XHR9LFxyXG5cdFx0W0lucHV0RmllbGRUeXBlLkRBVEVfUElDS0VSXToge1xyXG5cdFx0XHRjb2RlQmxvY2s6IERhdGVQaWNrZXJJbnB1dEZpZWxkLmFsbG93Q29kZUJsb2NrLFxyXG5cdFx0XHRpbmxpbmVDb2RlQmxvY2s6IERhdGVQaWNrZXJJbnB1dEZpZWxkLmFsbG93SW5saW5lQ29kZUJsb2NrXHJcblx0XHR9LFxyXG5cdH07XHJcblxyXG5cdHN0YXRpYyBjcmVhdGVJbnB1dEZpZWxkKGlucHV0RmllbGRUeXBlOiBJbnB1dEZpZWxkVHlwZSwgYXJnczogeyB0eXBlOiBJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZFR5cGUsIGlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkOiBJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCwgb25WYWx1ZUNoYW5nZWQ6ICh2YWx1ZTogYW55KSA9PiB2b2lkIHwgUHJvbWlzZTx2b2lkPiB9KTogQWJzdHJhY3RJbnB1dEZpZWxkIHwgdW5kZWZpbmVkIHtcclxuXHRcdGlmIChpbnB1dEZpZWxkVHlwZSA9PT0gSW5wdXRGaWVsZFR5cGUuVE9HR0xFKSB7XHJcblx0XHRcdElucHV0RmllbGRGYWN0b3J5LmNoZWNrSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGRUeXBlQWxsb3dlZChpbnB1dEZpZWxkVHlwZSwgYXJncy50eXBlKTtcclxuXHRcdFx0cmV0dXJuIG5ldyBUb2dnbGVJbnB1dEZpZWxkKGFyZ3MuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQsIGFyZ3Mub25WYWx1ZUNoYW5nZWQpO1xyXG5cdFx0fSBlbHNlIGlmIChpbnB1dEZpZWxkVHlwZSA9PT0gSW5wdXRGaWVsZFR5cGUuU0xJREVSKSB7XHJcblx0XHRcdElucHV0RmllbGRGYWN0b3J5LmNoZWNrSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGRUeXBlQWxsb3dlZChpbnB1dEZpZWxkVHlwZSwgYXJncy50eXBlKTtcclxuXHRcdFx0cmV0dXJuIG5ldyBTbGlkZXJJbnB1dEZpZWxkKGFyZ3MuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQsIGFyZ3Mub25WYWx1ZUNoYW5nZWQpO1xyXG5cdFx0fSBlbHNlIGlmIChpbnB1dEZpZWxkVHlwZSA9PT0gSW5wdXRGaWVsZFR5cGUuVEVYVCkge1xyXG5cdFx0XHRJbnB1dEZpZWxkRmFjdG9yeS5jaGVja0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkVHlwZUFsbG93ZWQoaW5wdXRGaWVsZFR5cGUsIGFyZ3MudHlwZSk7XHJcblx0XHRcdHJldHVybiBuZXcgVGV4dElucHV0RmllbGQoYXJncy5pbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCwgYXJncy5vblZhbHVlQ2hhbmdlZCk7XHJcblx0XHR9IGVsc2UgaWYgKGlucHV0RmllbGRUeXBlID09PSBJbnB1dEZpZWxkVHlwZS5URVhUX0FSRUEpIHtcclxuXHRcdFx0SW5wdXRGaWVsZEZhY3RvcnkuY2hlY2tJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZFR5cGVBbGxvd2VkKGlucHV0RmllbGRUeXBlLCBhcmdzLnR5cGUpO1xyXG5cdFx0XHRyZXR1cm4gbmV3IFRleHRBcmVhSW5wdXRGaWVsZChhcmdzLmlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLCBhcmdzLm9uVmFsdWVDaGFuZ2VkKTtcclxuXHRcdH0gZWxzZSBpZiAoaW5wdXRGaWVsZFR5cGUgPT09IElucHV0RmllbGRUeXBlLlNFTEVDVCkge1xyXG5cdFx0XHRJbnB1dEZpZWxkRmFjdG9yeS5jaGVja0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkVHlwZUFsbG93ZWQoaW5wdXRGaWVsZFR5cGUsIGFyZ3MudHlwZSk7XHJcblx0XHRcdHJldHVybiBuZXcgU2VsZWN0SW5wdXRGaWVsZChhcmdzLmlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLCBhcmdzLm9uVmFsdWVDaGFuZ2VkKTtcclxuXHRcdH0gZWxzZSBpZiAoaW5wdXRGaWVsZFR5cGUgPT09IElucHV0RmllbGRUeXBlLk1VTFRJX1NFTEVDVCkge1xyXG5cdFx0XHRJbnB1dEZpZWxkRmFjdG9yeS5jaGVja0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkVHlwZUFsbG93ZWQoaW5wdXRGaWVsZFR5cGUsIGFyZ3MudHlwZSk7XHJcblx0XHRcdHJldHVybiBuZXcgTXVsdGlTZWxlY3RJbnB1dEZpZWxkKGFyZ3MuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQsIGFyZ3Mub25WYWx1ZUNoYW5nZWQpO1xyXG5cdFx0fSBlbHNlIGlmIChpbnB1dEZpZWxkVHlwZSA9PT0gSW5wdXRGaWVsZFR5cGUuREFURSkge1xyXG5cdFx0XHRJbnB1dEZpZWxkRmFjdG9yeS5jaGVja0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkVHlwZUFsbG93ZWQoaW5wdXRGaWVsZFR5cGUsIGFyZ3MudHlwZSk7XHJcblx0XHRcdHJldHVybiBuZXcgRGF0ZUlucHV0RmllbGQoYXJncy5pbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCwgYXJncy5vblZhbHVlQ2hhbmdlZCk7XHJcblx0XHR9IGVsc2UgaWYgKGlucHV0RmllbGRUeXBlID09PSBJbnB1dEZpZWxkVHlwZS5USU1FKSB7XHJcblx0XHRcdElucHV0RmllbGRGYWN0b3J5LmNoZWNrSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGRUeXBlQWxsb3dlZChpbnB1dEZpZWxkVHlwZSwgYXJncy50eXBlKTtcclxuXHRcdFx0cmV0dXJuIG5ldyBUaW1lSW5wdXRGaWVsZChhcmdzLmlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLCBhcmdzLm9uVmFsdWVDaGFuZ2VkKTtcclxuXHRcdH0gZWxzZSBpZiAoaW5wdXRGaWVsZFR5cGUgPT09IElucHV0RmllbGRUeXBlLkRBVEVfUElDS0VSKSB7XHJcblx0XHRcdElucHV0RmllbGRGYWN0b3J5LmNoZWNrSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGRUeXBlQWxsb3dlZChpbnB1dEZpZWxkVHlwZSwgYXJncy50eXBlKTtcclxuXHRcdFx0cmV0dXJuIG5ldyBEYXRlUGlja2VySW5wdXRGaWVsZChhcmdzLmlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLCBhcmdzLm9uVmFsdWVDaGFuZ2VkKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdW5kZWZpbmVkO1xyXG5cdH1cclxuXHJcblx0c3RhdGljIGNoZWNrSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGRUeXBlQWxsb3dlZChpbnB1dEZpZWxkVHlwZTogSW5wdXRGaWVsZFR5cGUsIHR5cGU6IElucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkVHlwZSk6IHZvaWQge1xyXG5cdFx0Y29uc3QgYWxsb3dDb2RlQmxvY2s6IHsgY29kZUJsb2NrOiBib29sZWFuOyBpbmxpbmVDb2RlQmxvY2s6IGJvb2xlYW4gfSA9IElucHV0RmllbGRGYWN0b3J5LmFsbG93Q29kZUJsb2NrTWFwW2lucHV0RmllbGRUeXBlXTtcclxuXHRcdGlmICh0eXBlID09PSBJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZFR5cGUuQ09ERV9CTE9DSyAmJiAhYWxsb3dDb2RlQmxvY2suY29kZUJsb2NrKSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZFBhcnNpbmdFcnJvcihgXFwnJHtpbnB1dEZpZWxkVHlwZX1cXCcgaXMgbm90IGFsbG93ZWQgYXMgY29kZSBibG9ja2ApO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHR5cGUgPT09IElucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkVHlwZS5JTkxJTkVfQ09ERV9CTE9DSyAmJiAhYWxsb3dDb2RlQmxvY2suaW5saW5lQ29kZUJsb2NrKSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZFBhcnNpbmdFcnJvcihgXFwnJHtpbnB1dEZpZWxkVHlwZX1cXCcgaXMgbm90IGFsbG93ZWQgYXMgaW5saW5lIGNvZGUgYmxvY2tgKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG59XHJcbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSx3QkFBd0Y7OztBQ0F4RixzQkFBZ0U7QUFjekQsSUFBTSxtQkFBMkM7QUFBQSxFQUN2RCxTQUFTO0FBQUEsRUFDVCxxQkFBcUI7QUFBQSxFQUNyQixxQkFBcUI7QUFBQSxFQUNyQixjQUFjO0FBQUEsRUFDZCxpQkFBaUI7QUFB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
