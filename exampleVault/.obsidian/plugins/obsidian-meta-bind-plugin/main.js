"use strict";
/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod2) => __copyProps(__defProp({}, "__esModule", { value: true }), mod2);
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MetaBindPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian13 = require("obsidian");

// src/settings/Settings.ts
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  devMode: false,
  preferredDateFormat: "YYYY-MM-DD",
  useUsDateInputOrder: false,
  syncInterval: 200,
  minSyncInterval: 50,
  maxSyncInterval: 1e3
};
var MetaBindSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Meta Bind Plugin Settings" });
    new import_obsidian.Setting(containerEl).setName("Sync interval").setDesc(`The interval in milli-seconds between disk writes. Changing this number is not recommended except if your hard drive is exceptionally slow. Standard: ${DEFAULT_SETTINGS.syncInterval}; Minimum: ${DEFAULT_SETTINGS.minSyncInterval}; Maximum: ${DEFAULT_SETTINGS.maxSyncInterval}`).addText((cb) => {
      cb.setValue(this.plugin.settings.syncInterval.toString());
      cb.onChange((data) => {
        this.plugin.settings.syncInterval = Number.parseInt(data);
        if (Number.isNaN(this.plugin.settings.syncInterval)) {
          this.plugin.settings.syncInterval = DEFAULT_SETTINGS.syncInterval;
        }
        if (this.plugin.settings.syncInterval < DEFAULT_SETTINGS.minSyncInterval) {
          this.plugin.settings.syncInterval = DEFAULT_SETTINGS.minSyncInterval;
        }
        if (this.plugin.settings.syncInterval > DEFAULT_SETTINGS.maxSyncInterval) {
          this.plugin.settings.syncInterval = DEFAULT_SETTINGS.maxSyncInterval;
        }
        this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(containerEl).setName("Date format").setDesc(`The date format to be used by this plugin. Changing this setting will break the parsing of existing date inputs. Here is a list of all available date tokes https://momentjs.com/docs/#/displaying/.`).addText((cb) => {
      cb.setValue(this.plugin.settings.preferredDateFormat);
      cb.onChange((data) => {
        this.plugin.settings.preferredDateFormat = data;
        this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(containerEl).setName("Use US date input field order").setDesc(`When enabled the month input is before the day input.`).addToggle((cb) => {
      cb.setValue(this.plugin.settings.useUsDateInputOrder);
      cb.onChange((data) => {
        this.plugin.settings.useUsDateInputOrder = data;
        this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(containerEl).setName("Dev Mode").setDesc("Enable dev mode. Not recommended unless you want to debug this plugin.").addToggle((cb) => {
      cb.setValue(this.plugin.settings.devMode);
      cb.onChange((data) => {
        this.plugin.settings.devMode = data;
        this.plugin.saveSettings();
      });
    });
  }
};

// src/InputFieldMarkdownRenderChild.ts
var import_obsidian12 = require("obsidian");

// src/utils/Logger.ts
var _Logger = class {
  static log(...data) {
    console.log(this.prefix, ...data);
  }
  static logDebug(...data) {
    if (this.devMode) {
      _Logger.log(...data);
    }
  }
  static logWarning(...data) {
    console.warn(this.prefix, data);
  }
  static logError(...data) {
    console.error(this.prefix, data);
  }
};
var Logger = _Logger;
Logger.prefix = "meta-bind |";

// src/inputFields/AbstractInputField.ts
var AbstractInputField = class {
  constructor(inputFieldMarkdownRenderChild, onValueChange) {
    this.inputFieldMarkdownRenderChild = inputFieldMarkdownRenderChild;
    this.onValueChange = onValueChange;
  }
};
AbstractInputField.allowCodeBlock = true;
AbstractInputField.allowInlineCodeBlock = true;

// src/inputFields/ToggleInputField.ts
var import_obsidian2 = require("obsidian");

// src/utils/Utils.ts
var MetaBindInternalError = class extends Error {
  constructor(message) {
    super(`[MB_INTERNAL_ERROR - please report this error here https://github.com/mProjectsCode/obsidian-meta-bind-plugin/issues] ${message}`);
  }
};
var MetaBindParsingError = class extends Error {
  constructor(message) {
    super(`[MB_PARSING_ERROR] ${message}`);
  }
};
var MetaBindBindTargetError = class extends Error {
  constructor(message) {
    super(`[MB_BIND_TARGET_ERROR] ${message}`);
  }
};
function getFileName(path) {
  var _a;
  return (_a = path.split("/").at(-1)) != null ? _a : path;
}
function isPath(path) {
  return path.split("/").length > 1;
}
function removeFileEnding(fileName) {
  const fileNameParts = fileName.split(".");
  if (fileNameParts.length === 1) {
    return fileName;
  } else {
    let newFileName = fileNameParts[0];
    for (let i = 1; i < fileNameParts.length - 1; i++) {
      newFileName += "." + fileNameParts[i];
    }
    return newFileName;
  }
}
function mod(n, m) {
  return (n % m + m) % m;
}
function arrayEquals(arr1, arr2) {
  if (arr1.length !== arr2.length) {
    return false;
  }
  for (const arr1Element of arr1) {
    if (!arr2.contains(arr1Element)) {
      return false;
    }
  }
  return true;
}
function isTruthy(value) {
  return !!value;
}
function isFalsy(value) {
  return !value;
}
function equalOrIncludes(str1, str2) {
  return str1 === str2 || str1.includes(str2) || str2.includes(str1);
}

// src/inputFields/ToggleInputField.ts
var ToggleInputField = class extends AbstractInputField {
  getValue() {
    if (!this.toggleComponent) {
      throw new MetaBindInternalError("toggle input component is undefined");
    }
    return this.toggleComponent.getValue();
  }
  setValue(value) {
    if (!this.toggleComponent) {
      throw new MetaBindInternalError("toggle input component is undefined");
    }
    if (value != null && typeof value == "boolean") {
      this.toggleComponent.setValue(value);
    } else {
      Logger.logWarning(`can not set value of toggle to '${value}'`);
      this.toggleComponent.setValue(false);
    }
  }
  isEqualValue(value) {
    return this.getValue() == value;
  }
  getDefaultValue() {
    return false;
  }
  getHtmlElement() {
    if (!this.toggleComponent) {
      throw new MetaBindInternalError("toggle input component is undefined");
    }
    return this.toggleComponent.toggleEl;
  }
  render(container) {
    const component = new import_obsidian2.ToggleComponent(container);
    component.setValue(this.inputFieldMarkdownRenderChild.getInitialValue());
    component.onChange(this.onValueChange);
    this.toggleComponent = component;
  }
};

// src/inputFields/TextInputField.ts
var import_obsidian3 = require("obsidian");
var TextInputField = class extends AbstractInputField {
  getValue() {
    if (!this.textComponent) {
      throw new MetaBindInternalError("text input component is undefined");
    }
    return this.textComponent.getValue();
  }
  setValue(value) {
    if (!this.textComponent) {
      throw new MetaBindInternalError("text input component is undefined");
    }
    if (value != null && typeof value == "string") {
      this.textComponent.setValue(value);
    } else {
      Logger.logWarning(`can not set value of text input to '${value}'`);
      this.textComponent.setValue("");
    }
  }
  isEqualValue(value) {
    return this.getValue() == value;
  }
  getDefaultValue() {
    return "";
  }
  getHtmlElement() {
    if (!this.textComponent) {
      throw new MetaBindInternalError("text input component is undefined");
    }
    return this.textComponent.inputEl;
  }
  render(container) {
    const component = new import_obsidian3.TextComponent(container);
    component.setValue(this.inputFieldMarkdownRenderChild.getInitialValue());
    component.onChange(this.onValueChange);
    this.textComponent = component;
  }
};

// src/inputFields/SliderInputField.ts
var import_obsidian4 = require("obsidian");
var SliderInputField = class extends AbstractInputField {
  constructor(inputFieldMarkdownRenderChild, onValueChange) {
    var _a, _b, _c, _d;
    super(inputFieldMarkdownRenderChild, onValueChange);
    this.minValue = (_b = (_a = inputFieldMarkdownRenderChild.getArgument("minValue")) == null ? void 0 : _a.value) != null ? _b : 0;
    this.maxValue = (_d = (_c = inputFieldMarkdownRenderChild.getArgument("maxValue")) == null ? void 0 : _c.value) != null ? _d : 100;
  }
  getValue() {
    if (!this.sliderComponent) {
      throw new MetaBindInternalError("slider input component is undefined");
    }
    return this.sliderComponent.getValue();
  }
  setValue(value) {
    if (!this.sliderComponent) {
      throw new MetaBindInternalError("slider input component is undefined");
    }
    if (value != null && typeof value == "number") {
      if (value >= this.minValue && value <= this.maxValue) {
        this.sliderComponent.setValue(value);
      }
    } else {
      Logger.logWarning(`can not set value of slider to '${value}'`);
      this.sliderComponent.setValue(this.getDefaultValue());
    }
  }
  isEqualValue(value) {
    return this.getValue() == value;
  }
  getDefaultValue() {
    return this.minValue;
  }
  getHtmlElement() {
    if (!this.sliderComponent) {
      throw new MetaBindInternalError("slider input component is undefined");
    }
    return this.sliderComponent.sliderEl;
  }
  render(container) {
    container.removeClass("meta-bind-plugin-input-wrapper");
    container.addClass("meta-bind-plugin-flex-input-wrapper");
    const labelArgument = this.inputFieldMarkdownRenderChild.getArgument("labels");
    if (labelArgument && labelArgument.value === true) {
      container.createSpan({ text: this.minValue.toString(), cls: "meta-bind-plugin-slider-input-label" });
    }
    const component = new import_obsidian4.SliderComponent(container);
    component.setValue(this.inputFieldMarkdownRenderChild.getInitialValue());
    component.onChange(this.onValueChange);
    component.setDynamicTooltip();
    component.setLimits(this.minValue, this.maxValue, 1);
    component.sliderEl.addClass("meta-bind-plugin-slider-input");
    if (labelArgument && labelArgument.value === true) {
      container.createSpan({ text: this.maxValue.toString(), cls: "meta-bind-plugin-slider-input-label" });
    }
    this.sliderComponent = component;
  }
};

// src/inputFields/TextAreaInputField.ts
var import_obsidian5 = require("obsidian");
var TextAreaInputField = class extends AbstractInputField {
  getValue() {
    if (!this.textAreaComponent) {
      throw new MetaBindInternalError("text area input component is undefined");
    }
    return this.textAreaComponent.getValue();
  }
  setValue(value) {
    if (!this.textAreaComponent) {
      throw new MetaBindInternalError("text area input component is undefined");
    }
    if (value != null && typeof value == "string") {
      this.textAreaComponent.setValue(value);
    } else {
      Logger.logWarning(`can not set value of text area input to '${value}'`);
      this.textAreaComponent.setValue("");
    }
  }
  isEqualValue(value) {
    return this.getValue() == value;
  }
  getDefaultValue() {
    return "";
  }
  getHtmlElement() {
    if (!this.textAreaComponent) {
      throw new MetaBindInternalError("text area input component is undefined");
    }
    return this.textAreaComponent.inputEl;
  }
  render(container) {
    const component = new import_obsidian5.TextAreaComponent(container);
    component.setValue(this.inputFieldMarkdownRenderChild.getInitialValue());
    component.onChange(this.onValueChange);
    this.textAreaComponent = component;
  }
};

// src/inputFields/SelectInputFieldElement.ts
var SelectInputFieldElement = class {
  constructor(value, parentElement, id, multiSelectInputField, active = false) {
    this.value = value;
    this.id = id;
    this.active = active;
    this.highlighted = false;
    this.selectInputField = multiSelectInputField;
    this.cssClass = "meta-bind-plugin-select-input-element";
    this.activeClass = "meta-bind-plugin-select-input-element-selected";
    this.hoverClass = "meta-bind-plugin-select-input-element-hover";
    this.element = parentElement.createDiv({ cls: this.cssClass });
    this.element.id = this.getHTMLId();
    this.element.on("click", "#" + this.getHTMLId(), () => {
      this.setActive(!this.active);
      if (!this.selectInputField.allowMultiSelect) {
        this.selectInputField.disableAllOtherElements(this.id);
      }
    });
    this.element.on("mouseenter", "#" + this.getHTMLId(), () => {
      this.setHighlighted(true);
    });
    this.element.on("mouseleave", "#" + this.getHTMLId(), () => {
      this.setHighlighted(false);
    });
  }
  getHTMLId() {
    return `meta-bind-select-input-element-${this.selectInputField.inputFieldMarkdownRenderChild.uid}-${this.id}`;
  }
  isHighlighted() {
    return this.highlighted;
  }
  setHighlighted(value) {
    this.highlighted = value;
    if (this.highlighted) {
      this.addClass(this.hoverClass);
      this.selectInputField.deHighlightAllOtherElements(this.id);
    } else {
      this.removeClass(this.hoverClass);
    }
  }
  isActive() {
    return this.active;
  }
  setActive(active, updateParent = true) {
    this.active = active;
    this.update(updateParent);
  }
  update(updateParent) {
    if (this.active) {
      this.addClass(this.activeClass);
    } else {
      this.removeClass(this.activeClass);
    }
    if (updateParent) {
      this.selectInputField.onChange();
    }
  }
  addClass(cssClass) {
    if (!this.element.hasClass(cssClass)) {
      this.element.addClass(cssClass);
    }
  }
  removeClass(cssClass) {
    if (this.element.hasClass(cssClass)) {
      this.element.removeClass(cssClass);
    }
  }
  render() {
    this.element.createEl("div", { text: this.value });
  }
};

// src/inputFields/SelectInputField.ts
var SelectInputField = class extends AbstractInputField {
  constructor(inputFieldMarkdownRenderChild, onValueChange) {
    super(inputFieldMarkdownRenderChild, onValueChange);
    this.elements = [];
    this.allowMultiSelect = false;
  }
  getHtmlElement() {
    if (!this.container) {
      throw new MetaBindInternalError("select input container is undefined");
    }
    return this.container;
  }
  getValue() {
    var _a, _b;
    return (_b = (_a = this.elements.filter((x) => x.isActive()).first()) == null ? void 0 : _a.value) != null ? _b : "";
  }
  setValue(value) {
    for (const element2 of this.elements) {
      if (value === element2.value) {
        element2.setActive(true, false);
      } else {
        element2.setActive(false, false);
      }
    }
  }
  isEqualValue(value) {
    return this.getValue() == value;
  }
  getDefaultValue() {
    return "";
  }
  onChange() {
    this.onValueChange(this.getValue());
  }
  render(container) {
    container.addClass("meta-bind-plugin-select-input-bg");
    this.container = container;
    const elementWrapper = container.createDiv({ cls: "meta-bind-plugin-select-input-wrapper" });
    const titleArgument = this.inputFieldMarkdownRenderChild.getArgument("title");
    if (titleArgument) {
      elementWrapper.createEl("div", { text: titleArgument.value, cls: "meta-bind-plugin-select-input-header" });
    }
    const elementArguments = this.inputFieldMarkdownRenderChild.getArguments("option");
    let i = 0;
    for (const elementArgument of elementArguments) {
      const selectInputFieldElement = new SelectInputFieldElement(elementArgument.value, elementWrapper, i, this, false);
      this.elements.push(selectInputFieldElement);
      selectInputFieldElement.render();
      i += 1;
    }
    this.setValue(this.inputFieldMarkdownRenderChild.getInitialValue());
  }
  disableAllOtherElements(elementId) {
    for (const selectModalElement of this.elements) {
      if (selectModalElement.id !== elementId) {
        selectModalElement.setActive(false);
      }
    }
  }
  deHighlightAllOtherElements(elementId) {
    for (const selectModalElement of this.elements) {
      if (selectModalElement.id !== elementId) {
        selectModalElement.setHighlighted(false);
      }
    }
  }
  activateHighlighted() {
    for (const selectModalElement of this.elements) {
      if (selectModalElement.isHighlighted()) {
        selectModalElement.setActive(!selectModalElement.isActive());
        if (!this.allowMultiSelect) {
          this.disableAllOtherElements(selectModalElement.id);
        }
      }
    }
  }
  highlightUp() {
    var _a, _b;
    for (const selectModalElement of this.elements) {
      if (selectModalElement.isHighlighted()) {
        (_a = this.getPreviousSelectModalElement(selectModalElement)) == null ? void 0 : _a.setHighlighted(true);
        return;
      }
    }
    (_b = this.elements.at(-1)) == null ? void 0 : _b.setHighlighted(true);
  }
  highlightDown() {
    var _a, _b;
    for (const selectModalElement of this.elements) {
      if (selectModalElement.isHighlighted()) {
        (_a = this.getNextSelectModalElement(selectModalElement)) == null ? void 0 : _a.setHighlighted(true);
        return;
      }
    }
    (_b = this.elements.at(0)) == null ? void 0 : _b.setHighlighted(true);
  }
  getNextSelectModalElement(element2) {
    let nextId = element2.id + 1;
    nextId = mod(nextId, this.elements.length);
    return this.elements.filter((x) => x.id === nextId).at(0);
  }
  getPreviousSelectModalElement(element2) {
    let nextId = element2.id - 1;
    nextId = mod(nextId, this.elements.length);
    return this.elements.filter((x) => x.id === nextId).at(0);
  }
};
SelectInputField.allowInlineCodeBlock = false;

// src/inputFields/MultiSelectInputField.ts
var MultiSelectInputField = class extends SelectInputField {
  constructor(inputFieldMarkdownRenderChild, onValueChange) {
    super(inputFieldMarkdownRenderChild, onValueChange);
    this.allowMultiSelect = true;
  }
  getValue() {
    return this.elements.filter((x) => x.isActive()).map((x) => x.value);
  }
  setValue(value) {
    if (value.length === 0) {
      for (const element2 of this.elements) {
        element2.setActive(false, false);
      }
      return;
    }
    elementLoop:
      for (const element2 of this.elements) {
        for (const valueElement of value) {
          if (valueElement === element2.value) {
            element2.setActive(true, false);
            continue elementLoop;
          }
        }
        element2.setActive(false, false);
      }
  }
  isEqualValue(value) {
    if (!Array.isArray(value)) {
      return false;
    }
    return arrayEquals(this.getValue(), value);
  }
  getDefaultValue() {
    return [];
  }
};

// src/inputFields/DateInputField.ts
var import_obsidian7 = require("obsidian");

// src/parsers/DateParser.ts
var import_obsidian6 = require("obsidian");
var DateParser = class {
  static stringify(date) {
    return date.format(this.dateFormat);
  }
  static parse(dateString) {
    return (0, import_obsidian6.moment)(dateString, DateParser.dateFormat);
  }
  static getDefaultDate() {
    return (0, import_obsidian6.moment)(`${DateParser.getDefaultYear}-${DateParser.getDefaultMonth()}-${DateParser.getDefaultDay()}`);
  }
  static getDefaultDay() {
    return 1;
  }
  static getDefaultMonth() {
    return 1;
  }
  static getDefaultYear() {
    return 2022;
  }
};

// src/inputFields/DateInputField.ts
var DateInputField = class extends AbstractInputField {
  constructor(inputFieldMarkdownRenderChild, onValueChange) {
    super(inputFieldMarkdownRenderChild, onValueChange);
    this.months = {
      "0": "January",
      "1": "February",
      "2": "March",
      "3": "April",
      "4": "May",
      "5": "June",
      "6": "July",
      "7": "August",
      "8": "September",
      "9": "October",
      "10": "November",
      "11": "December"
    };
    this.date = DateParser.getDefaultDate();
    this.days = {};
    for (let i = 1; i <= 31; i++) {
      this.days[i.toString()] = i.toString();
    }
  }
  getHtmlElement() {
    if (!this.container) {
      throw new MetaBindInternalError("toggle input container is undefined");
    }
    return this.container;
  }
  getValue() {
    return DateParser.stringify(this.date);
  }
  setValue(value) {
    var _a;
    if (!this.monthComponent) {
      throw new MetaBindInternalError("date input month component is undefined");
    }
    if (!this.dayComponent) {
      throw new MetaBindInternalError("date input day component is undefined");
    }
    if (!this.yearComponent) {
      throw new MetaBindInternalError("date input hour component is undefined");
    }
    this.date = (_a = DateParser.parse(value)) != null ? _a : DateParser.getDefaultDate();
    this.monthComponent.setValue(this.date.month().toString());
    this.dayComponent.setValue(this.date.date().toString());
    this.yearComponent.setValue(this.date.year().toString());
  }
  isEqualValue(value) {
    return value == this.getValue();
  }
  getDefaultValue() {
    return DateParser.stringify(DateParser.getDefaultDate());
  }
  render(container) {
    var _a;
    this.date = (_a = DateParser.parse(this.inputFieldMarkdownRenderChild.getInitialValue())) != null ? _a : DateParser.getDefaultDate();
    let useUsInputOrder = this.inputFieldMarkdownRenderChild.plugin.settings.useUsDateInputOrder;
    container.removeClass("meta-bind-plugin-input-wrapper");
    container.addClass("meta-bind-plugin-flex-input-wrapper", "meta-bind-plugin-input-element-group");
    if (!useUsInputOrder) {
      this.dayComponent = new import_obsidian7.DropdownComponent(container);
      this.dayComponent.addOptions(this.days);
      this.dayComponent.setValue(this.date.date().toString());
      this.dayComponent.onChange(this.onDayChange.bind(this));
      this.monthComponent = new import_obsidian7.DropdownComponent(container);
      this.monthComponent.addOptions(this.months);
      this.monthComponent.setValue(this.date.month().toString());
      this.monthComponent.onChange(this.onMonthChange.bind(this));
      this.dayComponent.selectEl.addClass("meta-bind-plugin-input-element-group-element");
      this.monthComponent.selectEl.addClass("meta-bind-plugin-input-element-group-element");
    } else {
      this.monthComponent = new import_obsidian7.DropdownComponent(container);
      this.monthComponent.addOptions(this.months);
      this.monthComponent.setValue(this.date.month().toString());
      this.monthComponent.onChange(this.onMonthChange.bind(this));
      this.dayComponent = new import_obsidian7.DropdownComponent(container);
      this.dayComponent.addOptions(this.days);
      this.dayComponent.setValue(this.date.date().toString());
      this.dayComponent.onChange(this.onDayChange.bind(this));
      this.dayComponent.selectEl.addClass("meta-bind-plugin-input-element-group-element");
      this.monthComponent.selectEl.addClass("meta-bind-plugin-input-element-group-element");
    }
    this.yearComponent = new import_obsidian7.TextComponent(container);
    this.yearComponent.setValue(this.date.year().toString());
    this.yearComponent.onChange(this.onYearChange.bind(this));
    this.yearComponent.inputEl.addClass("meta-bind-plugin-date-input-year-input");
    this.yearComponent.inputEl.addClass("meta-bind-plugin-input-element-group-element");
    this.yearComponent.inputEl.type = "number";
    this.yearComponent.inputEl.max = "9999";
    this.container = container;
  }
  onMonthChange(value) {
    var _a;
    this.date.month(value);
    const clampedDay = this.clampDay(this.date.date());
    (_a = this.dayComponent) == null ? void 0 : _a.setValue(clampedDay.toString());
    this.date.date(clampedDay);
    this.onValueChange(this.getValue());
  }
  onDayChange(value) {
    var _a;
    const day = Number.parseInt(value);
    const clampedDay = this.clampDay(day);
    if (clampedDay !== day) {
      (_a = this.dayComponent) == null ? void 0 : _a.setValue(clampedDay.toString());
    }
    this.date.date(clampedDay);
    this.onValueChange(this.getValue());
  }
  onYearChange(value) {
    const year = Number.parseInt(value);
    this.date.year(Number.isNaN(year) ? DateParser.getDefaultYear() : year);
    this.onValueChange(this.getValue());
  }
  clampDay(day) {
    if (Number.isNaN(day)) {
      return DateParser.getDefaultDay();
    } else if (day < 1) {
      return 1;
    } else if (day > this.date.daysInMonth()) {
      return this.date.daysInMonth();
    }
    return day;
  }
};

// src/inputFields/TimeInputField.ts
var import_obsidian8 = require("obsidian");

// src/parsers/TimeParser.ts
var Time = class {
  constructor() {
    this._hour = TimeParser.getDefaultHour();
    this._minute = TimeParser.getDefaultHour();
  }
  getHour() {
    return this._hour;
  }
  setHour(value) {
    if (value < 0 || value > 24) {
      this._hour = TimeParser.getDefaultHour();
      return;
    }
    this._hour = value;
  }
  getMinute() {
    return this._minute;
  }
  setMinute(value) {
    if (value < 0 || value > 59) {
      this._minute = TimeParser.getDefaultMinute();
      return;
    }
    this._minute = value;
  }
  getUniformHour() {
    return ("00" + this.getHour().toString()).slice(-2);
  }
  getUniformMinute() {
    return ("00" + this.getMinute().toString()).slice(-2);
  }
  setHourFromString(str) {
    const v = Number.parseInt(str);
    this.setHour(Number.isNaN(v) ? TimeParser.getDefaultHour() : v);
  }
  setMinuteFromString(str) {
    const v = Number.parseInt(str);
    this.setMinute(Number.isNaN(v) ? TimeParser.getDefaultMinute() : v);
  }
};
var TimeParser = class {
  static parse(timeString) {
    const time = TimeParser.getDefaultTime();
    const timeParts = timeString.split(":");
    if (timeParts.length !== 2) {
      return void 0;
    }
    time.setHourFromString(timeParts[0]);
    time.setMinuteFromString(timeParts[1]);
    return time;
  }
  static stringify(time) {
    return `${time.getUniformHour()}:${time.getUniformMinute()}`;
  }
  static getDefaultTime() {
    return new Time();
  }
  static getDefaultHour() {
    return 0;
  }
  static getDefaultMinute() {
    return 0;
  }
};

// src/inputFields/TimeInputField.ts
var TimeInputField = class extends AbstractInputField {
  constructor(inputFieldMarkdownRenderChild, onValueChange) {
    super(inputFieldMarkdownRenderChild, onValueChange);
    this.time = TimeParser.getDefaultTime();
    this.hours = {};
    for (let i = 0; i <= 24; i++) {
      this.hours[i.toString()] = i.toString();
    }
    this.minutes = {};
    for (let i = 0; i <= 59; i++) {
      this.minutes[i.toString()] = i.toString();
    }
  }
  getHtmlElement() {
    if (!this.container) {
      throw new MetaBindInternalError("time input container is undefined");
    }
    return this.container;
  }
  getValue() {
    return TimeParser.stringify(this.time);
  }
  setValue(value) {
    var _a;
    if (!this.hourComponent) {
      throw new MetaBindInternalError("time input hour component is undefined");
    }
    if (!this.minuteComponent) {
      throw new MetaBindInternalError("time input minute component is undefined");
    }
    this.time = (_a = TimeParser.parse(value)) != null ? _a : TimeParser.getDefaultTime();
    this.hourComponent.setValue(this.time.getHour().toString());
    this.minuteComponent.setValue(this.time.getMinute().toString());
  }
  isEqualValue(value) {
    return value == this.getValue();
  }
  getDefaultValue() {
    return TimeParser.stringify(TimeParser.getDefaultTime());
  }
  render(container) {
    var _a;
    this.time = (_a = TimeParser.parse(this.inputFieldMarkdownRenderChild.getInitialValue())) != null ? _a : TimeParser.getDefaultTime();
    container.removeClass("meta-bind-plugin-input-wrapper");
    container.addClass("meta-bind-plugin-flex-input-wrapper", "meta-bind-plugin-input-element-group");
    this.hourComponent = new import_obsidian8.DropdownComponent(container);
    this.hourComponent.addOptions(this.hours);
    this.hourComponent.setValue(this.time.getHour().toString());
    this.hourComponent.onChange(this.onHourChange.bind(this));
    this.minuteComponent = new import_obsidian8.DropdownComponent(container);
    this.minuteComponent.addOptions(this.minutes);
    this.minuteComponent.setValue(this.time.getMinute().toString());
    this.minuteComponent.onChange(this.onMinuteChange.bind(this));
    this.hourComponent.selectEl.addClass("meta-bind-plugin-input-element-group-element");
    this.minuteComponent.selectEl.addClass("meta-bind-plugin-input-element-group-element");
    this.container = container;
  }
  onHourChange(value) {
    this.time.setHourFromString(value);
    this.onValueChange(this.getValue());
  }
  onMinuteChange(value) {
    this.time.setMinuteFromString(value);
    this.onValueChange(this.getValue());
  }
};

// src/utils/ParserUtils.ts
var EnclosingPair = class {
  constructor(openingString, closingString) {
    if (isFalsy(openingString)) {
      throw new MetaBindInternalError("opening string must not be empty");
    }
    this.openingEqualsClosing = isFalsy(closingString) || openingString === closingString;
    if (this.openingEqualsClosing) {
      this._openingString = openingString;
      this._closingString = openingString;
    } else {
      this._openingString = openingString;
      this._closingString = closingString;
    }
  }
  get openingString() {
    return this._openingString;
  }
  get closingString() {
    return this.openingEqualsClosing ? this._openingString : this._closingString;
  }
  overlaps(other) {
    return equalOrIncludes(this.openingString, other.openingString) || equalOrIncludes(this.openingString, other.closingString) || equalOrIncludes(this.closingString, other.openingString) || equalOrIncludes(this.closingString, other.closingString);
  }
  equals(other) {
    if (isFalsy(other)) {
      return false;
    }
    return this.openingString === other.openingString && this.closingString === other.closingString;
  }
  toString() {
    return JSON.stringify(this);
  }
};
var ParserUtils = class {
  static split(str, separator, ignore) {
    if (!str) {
      throw new MetaBindInternalError("string must not be empty");
    }
    if (!separator) {
      throw new MetaBindInternalError("separator must not be empty");
    }
    let subStr = "";
    const subStrings = [];
    if (ignore) {
      let remainingOpeningStringCount = ParserUtils.numberOfOccurrences(str, ignore.openingString);
      let remainingClosingStringCount = ParserUtils.numberOfOccurrences(str, ignore.closingString);
      let enclosingLevel = 0;
      strLoop:
        for (let i = 0; i < str.length; i++) {
          if (enclosingLevel === 0 && ParserUtils.isStringAt(str, separator, i)) {
            subStrings.push(subStr);
            subStr = "";
            i += separator.length - 1;
          } else {
            subStr += str[i];
          }
          if (ignore.openingEqualsClosing) {
            if (ParserUtils.isStringAt(str, ignore.openingString, i)) {
              if (enclosingLevel % 2 === 0 && remainingOpeningStringCount === 1) {
              } else if (enclosingLevel % 2 === 0) {
                enclosingLevel += 1;
                for (let j = 1; j < ignore.openingString.length; j++) {
                  i += 1;
                  subStr += str[i];
                  if (i >= str.length) {
                    break strLoop;
                  }
                }
              } else {
                enclosingLevel -= 1;
                for (let j = 1; j < ignore.closingString.length; j++) {
                  i += 1;
                  subStr += str[i];
                  if (i >= str.length) {
                    break strLoop;
                  }
                }
              }
              remainingOpeningStringCount -= 1;
            }
          } else {
            if (ParserUtils.isStringAt(str, ignore.openingString, i)) {
              if (remainingOpeningStringCount <= remainingClosingStringCount) {
                enclosingLevel += 1;
                for (let j = 1; j < ignore.openingString.length; j++) {
                  i += 1;
                  subStr += str[i];
                  if (i >= str.length) {
                    break strLoop;
                  }
                }
              }
              remainingOpeningStringCount -= 1;
            } else if (ParserUtils.isStringAt(str, ignore.closingString, i)) {
              if (enclosingLevel > 0) {
                enclosingLevel -= 1;
                for (let j = 1; j < ignore.closingString.length; j++) {
                  i += 1;
                  subStr += str[i];
                  if (i >= str.length) {
                    break strLoop;
                  }
                }
              }
              remainingClosingStringCount -= 1;
            }
          }
        }
    } else {
      for (let i = 0; i < str.length; i++) {
        if (ParserUtils.isStringAt(str, separator, i)) {
          subStrings.push(subStr);
          subStr = "";
          i += separator.length - 1;
        } else {
          subStr += str[i];
        }
      }
    }
    subStrings.push(subStr);
    return subStrings;
  }
  static removeInBetween(str, enclosingPair) {
    if (!str) {
      throw new MetaBindInternalError("string must not be empty");
    }
    let remainingOpeningStringCount = ParserUtils.numberOfOccurrences(str, enclosingPair.openingString);
    let remainingClosingStringCount = ParserUtils.numberOfOccurrences(str, enclosingPair.closingString);
    let enclosingLevel = 0;
    let subStr = "";
    for (let i = 0; i < str.length; i++) {
      if (enclosingPair.openingEqualsClosing) {
        if (ParserUtils.isStringAt(str, enclosingPair.openingString, i)) {
          if (enclosingLevel % 2 === 0 && remainingOpeningStringCount === 1) {
          } else if (enclosingLevel % 2 === 0) {
            enclosingLevel += 1;
            i += enclosingPair.openingString.length;
            if (i >= str.length) {
              break;
            }
          } else {
            enclosingLevel -= 1;
            i += enclosingPair.closingString.length;
            if (i >= str.length) {
              break;
            }
          }
          remainingOpeningStringCount -= 1;
        }
      } else {
        if (ParserUtils.isStringAt(str, enclosingPair.openingString, i)) {
          if (remainingOpeningStringCount <= remainingClosingStringCount) {
            enclosingLevel += 1;
            i += enclosingPair.openingString.length;
            if (i >= str.length) {
              break;
            }
          }
          remainingOpeningStringCount -= 1;
        } else if (ParserUtils.isStringAt(str, enclosingPair.closingString, i)) {
          if (enclosingLevel > 0) {
            enclosingLevel -= 1;
            i += enclosingPair.closingString.length;
            if (i >= str.length) {
              break;
            }
          }
          remainingClosingStringCount -= 1;
        }
      }
      if (enclosingLevel === 0) {
        subStr += str[i];
      }
    }
    return subStr;
  }
  static getInBetween(str, enclosingPair) {
    if (!str) {
      throw new MetaBindInternalError("string must not be empty");
    }
    let remainingOpeningStringCount = ParserUtils.numberOfOccurrences(str, enclosingPair.openingString);
    let remainingClosingStringCount = ParserUtils.numberOfOccurrences(str, enclosingPair.closingString);
    let enclosingLevel = 0;
    let subStr = "";
    const subStrings = [];
    strLoop:
      for (let i = 0; i < str.length; i++) {
        if (enclosingPair.openingEqualsClosing) {
          if (ParserUtils.isStringAt(str, enclosingPair.openingString, i)) {
            if (enclosingLevel % 2 === 0 && remainingOpeningStringCount === 1) {
            } else if (enclosingLevel % 2 === 0) {
              enclosingLevel += 1;
              subStr += str[i];
              for (let j = 1; j < enclosingPair.openingString.length; j++) {
                i += 1;
                subStr += str[i];
                if (i >= str.length) {
                  break strLoop;
                }
              }
            } else {
              enclosingLevel -= 1;
              subStr += str[i];
              for (let j = 1; j < enclosingPair.closingString.length; j++) {
                i += 1;
                subStr += str[i];
                if (i > str.length) {
                  break strLoop;
                }
              }
              subStrings.push(subStr);
              subStr = "";
            }
            remainingOpeningStringCount -= 1;
          } else {
            if (enclosingLevel >= 1) {
              subStr += str[i];
            }
          }
        } else {
          if (ParserUtils.isStringAt(str, enclosingPair.openingString, i)) {
            if (remainingOpeningStringCount <= remainingClosingStringCount) {
              enclosingLevel += 1;
              subStr += str[i];
              for (let j = 1; j < enclosingPair.openingString.length; j++) {
                i += 1;
                subStr += str[i];
                if (i >= str.length) {
                  break strLoop;
                }
              }
            }
            remainingOpeningStringCount -= 1;
          } else if (ParserUtils.isStringAt(str, enclosingPair.closingString, i)) {
            if (enclosingLevel > 0) {
              enclosingLevel -= 1;
              subStr += str[i];
              for (let j = 1; j < enclosingPair.closingString.length; j++) {
                i += 1;
                subStr += str[i];
                if (i > str.length) {
                  break strLoop;
                }
              }
              if (enclosingLevel === 0) {
                subStrings.push(subStr);
                subStr = "";
              }
            }
            remainingClosingStringCount -= 1;
          } else {
            if (enclosingLevel >= 1) {
              subStr += str[i];
            }
          }
        }
      }
    if (subStrings.length === 0) {
      return "";
    } else if (subStrings.length === 1) {
      return subStrings[0].substring(enclosingPair.openingString.length, subStrings[0].length - enclosingPair.closingString.length);
    } else {
      return subStrings.map((x) => x.substring(enclosingPair.openingString.length, x.length - enclosingPair.closingString.length));
    }
  }
  static isStringAt(str, subStr, index) {
    if (index < 0) {
      throw new MetaBindInternalError("index must be greater than 0");
    }
    if (index >= str.length) {
      throw new MetaBindInternalError("index out of bounds of string");
    }
    if (!str) {
      throw new MetaBindInternalError("string must not be empty");
    }
    if (!subStr) {
      throw new MetaBindInternalError("sub string must not be empty");
    }
    for (let i = 0; i < subStr.length; i++) {
      if (str[i + index] !== subStr[i]) {
        return false;
      }
    }
    return true;
  }
  static contains(str, subStr) {
    return ParserUtils.numberOfOccurrences(str, subStr) > 0;
  }
  static numberOfOccurrences(str, subStr) {
    if (!str) {
      throw new MetaBindInternalError("string must not be empty");
    }
    if (!subStr) {
      throw new MetaBindInternalError("sub string must not be empty");
    }
    let occurrences = 0;
    for (let i = 0; i < str.length; i++) {
      if (ParserUtils.isStringAt(str, subStr, i)) {
        occurrences += 1;
      }
    }
    return occurrences;
  }
};

// src/parsers/InputFieldDeclarationParser.ts
var InputFieldType = /* @__PURE__ */ ((InputFieldType2) => {
  InputFieldType2["TOGGLE"] = "toggle";
  InputFieldType2["SLIDER"] = "slider";
  InputFieldType2["TEXT"] = "text";
  InputFieldType2["TEXT_AREA"] = "text_area";
  InputFieldType2["SELECT"] = "select";
  InputFieldType2["MULTI_SELECT"] = "multi_select";
  InputFieldType2["DATE"] = "date";
  InputFieldType2["TIME"] = "time";
  InputFieldType2["DATE_PICKER"] = "date_picker";
  InputFieldType2["INVALID"] = "invalid";
  return InputFieldType2;
})(InputFieldType || {});
var _InputFieldDeclarationParser = class {
  static parse(fullDeclaration) {
    var _a;
    const inputFieldDeclaration = {};
    inputFieldDeclaration.fullDeclaration = fullDeclaration;
    inputFieldDeclaration.declaration = ParserUtils.getInBetween(fullDeclaration, _InputFieldDeclarationParser.squareBracesPair);
    const declarationParts = ParserUtils.split(inputFieldDeclaration.declaration, ":", _InputFieldDeclarationParser.squareBracesPair);
    inputFieldDeclaration.bindTarget = (_a = declarationParts[1]) != null ? _a : "";
    inputFieldDeclaration.isBound = isTruthy(inputFieldDeclaration.bindTarget);
    const inputFieldTypeWithArguments = declarationParts[0];
    const inputFieldTypeString = ParserUtils.removeInBetween(inputFieldTypeWithArguments, _InputFieldDeclarationParser.roundBracesPair);
    inputFieldDeclaration.inputFieldType = _InputFieldDeclarationParser.getInputFieldType(inputFieldTypeString);
    if (inputFieldDeclaration.inputFieldType === "invalid" /* INVALID */) {
      throw new MetaBindParsingError(`unknown input field type '${inputFieldTypeString}'`);
    }
    const inputFieldArgumentsString = ParserUtils.getInBetween(inputFieldTypeWithArguments, _InputFieldDeclarationParser.roundBracesPair);
    if (inputFieldArgumentsString) {
      inputFieldDeclaration.arguments = _InputFieldDeclarationParser.parseArguments(inputFieldArgumentsString, inputFieldDeclaration.inputFieldType);
    } else {
      inputFieldDeclaration.arguments = [];
    }
    return inputFieldDeclaration;
  }
  static parseArguments(inputFieldArgumentsString, inputFieldType) {
    let inputFieldArgumentStrings = ParserUtils.split(inputFieldArgumentsString, ",", _InputFieldDeclarationParser.roundBracesPair);
    inputFieldArgumentStrings = inputFieldArgumentStrings.map((x) => x.trim());
    const inputFieldArguments = [];
    for (const inputFieldArgumentString of inputFieldArgumentStrings) {
      const inputFieldArgumentName = _InputFieldDeclarationParser.extractInputFieldArgumentName(inputFieldArgumentString);
      if (inputFieldArgumentName === "class") {
        const inputFieldArgumentValue = _InputFieldDeclarationParser.extractInputFieldArgumentValue(inputFieldArgumentString);
        const inputFieldClassArgument = { name: inputFieldArgumentName, value: inputFieldArgumentValue };
        inputFieldArguments.push(inputFieldClassArgument);
      } else if (inputFieldArgumentName === "addLabels") {
        if (inputFieldType !== "slider" /* SLIDER */) {
          throw new MetaBindParsingError(`argument '${inputFieldArgumentName}' is only applicable to slider input fields`);
        }
        inputFieldArguments.push({ name: "labels", value: true });
      } else if (inputFieldArgumentName === "minValue") {
        if (inputFieldType !== "slider" /* SLIDER */) {
          throw new MetaBindParsingError(`argument '${inputFieldArgumentName}' is only applicable to slider input fields`);
        }
        const inputFieldArgumentValue = _InputFieldDeclarationParser.extractInputFieldArgumentValue(inputFieldArgumentString);
        const inputFieldArgumentValueAsNumber = Number.parseInt(inputFieldArgumentValue);
        if (Number.isNaN(inputFieldArgumentValueAsNumber)) {
          throw new MetaBindParsingError(`argument '${inputFieldArgumentName}' value must be of type number`);
        }
        const inputFieldArgumentObject = { name: inputFieldArgumentName, value: inputFieldArgumentValueAsNumber };
        inputFieldArguments.push(inputFieldArgumentObject);
      } else if (inputFieldArgumentName === "maxValue") {
        if (inputFieldType !== "slider" /* SLIDER */) {
          throw new MetaBindParsingError(`argument '${inputFieldArgumentName}' is only applicable to slider input fields`);
        }
        const inputFieldArgumentValue = _InputFieldDeclarationParser.extractInputFieldArgumentValue(inputFieldArgumentString);
        const inputFieldArgumentValueAsNumber = Number.parseInt(inputFieldArgumentValue);
        if (Number.isNaN(inputFieldArgumentValueAsNumber)) {
          throw new MetaBindParsingError(`argument '${inputFieldArgumentName}' value must be of type number`);
        }
        const inputFieldArgumentObject = { name: inputFieldArgumentName, value: inputFieldArgumentValueAsNumber };
        inputFieldArguments.push(inputFieldArgumentObject);
      } else if (inputFieldArgumentName === "option") {
        if (inputFieldType !== "select" /* SELECT */ && inputFieldType !== "multi_select" /* MULTI_SELECT */) {
          throw new MetaBindParsingError(`argument '${inputFieldArgumentName}' is only applicable to select and multi-select input fields`);
        }
        const inputFieldArgumentValue = _InputFieldDeclarationParser.extractInputFieldArgumentValue(inputFieldArgumentString);
        const inputFieldArgumentObject = { name: inputFieldArgumentName, value: inputFieldArgumentValue };
        inputFieldArguments.push(inputFieldArgumentObject);
      } else if (inputFieldArgumentName === "title") {
        if (inputFieldType !== "select" /* SELECT */ && inputFieldType !== "multi_select" /* MULTI_SELECT */) {
          throw new MetaBindParsingError(`argument '${inputFieldArgumentName}' is only applicable to select and multi-select input fields`);
        }
        const inputFieldArgumentValue = _InputFieldDeclarationParser.extractInputFieldArgumentValue(inputFieldArgumentString);
        const inputFieldArgumentObject = { name: inputFieldArgumentName, value: inputFieldArgumentValue };
        inputFieldArguments.push(inputFieldArgumentObject);
      } else {
        throw new MetaBindParsingError(`unknown argument '${inputFieldArgumentName}'`);
      }
    }
    return inputFieldArguments;
  }
  static extractInputFieldArgumentName(argumentString) {
    return ParserUtils.removeInBetween(argumentString, _InputFieldDeclarationParser.roundBracesPair);
  }
  static extractInputFieldArgumentValue(argumentString) {
    const argumentName = this.extractInputFieldArgumentName(argumentString);
    const argumentValue = ParserUtils.getInBetween(argumentString, _InputFieldDeclarationParser.roundBracesPair);
    if (!argumentValue) {
      throw new MetaBindParsingError(`argument '${argumentName}' requires a non empty value`);
    }
    return argumentValue;
  }
  static getInputFieldType(str) {
    for (const entry of Object.entries(InputFieldType)) {
      if (entry[1] === str) {
        return entry[1];
      }
    }
    return "invalid" /* INVALID */;
  }
};
var InputFieldDeclarationParser = _InputFieldDeclarationParser;
InputFieldDeclarationParser.roundBracesPair = new EnclosingPair("(", ")");
InputFieldDeclarationParser.squareBracesPair = new EnclosingPair("[", "]");
InputFieldDeclarationParser.curlyBracesPair = new EnclosingPair("{", "}");
InputFieldDeclarationParser.allBracesPairs = [
  _InputFieldDeclarationParser.roundBracesPair,
  _InputFieldDeclarationParser.squareBracesPair,
  _InputFieldDeclarationParser.curlyBracesPair
];

// node_modules/svelte/internal/index.mjs
function noop() {
}
function run(fn) {
  return fn();
}
function blank_object() {
  return /* @__PURE__ */ Object.create(null);
}
function run_all(fns) {
  fns.forEach(run);
}
function is_function(thing) {
  return typeof thing === "function";
}
function safe_not_equal(a, b) {
  return a != a ? b == b : a !== b || (a && typeof a === "object" || typeof a === "function");
}
function is_empty(obj) {
  return Object.keys(obj).length === 0;
}
var is_hydrating = false;
function start_hydrating() {
  is_hydrating = true;
}
function end_hydrating() {
  is_hydrating = false;
}
function append(target, node) {
  target.appendChild(node);
}
function append_styles(target, style_sheet_id, styles) {
  const append_styles_to = get_root_for_style(target);
  if (!append_styles_to.getElementById(style_sheet_id)) {
    const style = element("style");
    style.id = style_sheet_id;
    style.textContent = styles;
    append_stylesheet(append_styles_to, style);
  }
}
function get_root_for_style(node) {
  if (!node)
    return document;
  const root = node.getRootNode ? node.getRootNode() : node.ownerDocument;
  if (root && root.host) {
    return root;
  }
  return node.ownerDocument;
}
function append_stylesheet(node, style) {
  append(node.head || node, style);
}
function insert(target, node, anchor) {
  target.insertBefore(node, anchor || null);
}
function detach(node) {
  node.parentNode.removeChild(node);
}
function destroy_each(iterations, detaching) {
  for (let i = 0; i < iterations.length; i += 1) {
    if (iterations[i])
      iterations[i].d(detaching);
  }
}
function element(name) {
  return document.createElement(name);
}
function text(data) {
  return document.createTextNode(data);
}
function space() {
  return text(" ");
}
function listen(node, event, handler, options) {
  node.addEventListener(event, handler, options);
  return () => node.removeEventListener(event, handler, options);
}
function attr(node, attribute, value) {
  if (value == null)
    node.removeAttribute(attribute);
  else if (node.getAttribute(attribute) !== value)
    node.setAttribute(attribute, value);
}
function children(element2) {
  return Array.from(element2.childNodes);
}
function set_data(text2, data) {
  data = "" + data;
  if (text2.wholeText !== data)
    text2.data = data;
}
function toggle_class(element2, name, toggle) {
  element2.classList[toggle ? "add" : "remove"](name);
}
function custom_event(type, detail, { bubbles = false, cancelable = false } = {}) {
  const e = document.createEvent("CustomEvent");
  e.initCustomEvent(type, bubbles, cancelable, detail);
  return e;
}
var current_component;
function set_current_component(component) {
  current_component = component;
}
function get_current_component() {
  if (!current_component)
    throw new Error("Function called outside component initialization");
  return current_component;
}
function createEventDispatcher() {
  const component = get_current_component();
  return (type, detail, { cancelable = false } = {}) => {
    const callbacks = component.$$.callbacks[type];
    if (callbacks) {
      const event = custom_event(type, detail, { cancelable });
      callbacks.slice().forEach((fn) => {
        fn.call(component, event);
      });
      return !event.defaultPrevented;
    }
    return true;
  };
}
var dirty_components = [];
var binding_callbacks = [];
var render_callbacks = [];
var flush_callbacks = [];
var resolved_promise = Promise.resolve();
var update_scheduled = false;
function schedule_update() {
  if (!update_scheduled) {
    update_scheduled = true;
    resolved_promise.then(flush);
  }
}
function add_render_callback(fn) {
  render_callbacks.push(fn);
}
var seen_callbacks = /* @__PURE__ */ new Set();
var flushidx = 0;
function flush() {
  const saved_component = current_component;
  do {
    while (flushidx < dirty_components.length) {
      const component = dirty_components[flushidx];
      flushidx++;
      set_current_component(component);
      update(component.$$);
    }
    set_current_component(null);
    dirty_components.length = 0;
    flushidx = 0;
    while (binding_callbacks.length)
      binding_callbacks.pop()();
    for (let i = 0; i < render_callbacks.length; i += 1) {
      const callback = render_callbacks[i];
      if (!seen_callbacks.has(callback)) {
        seen_callbacks.add(callback);
        callback();
      }
    }
    render_callbacks.length = 0;
  } while (dirty_components.length);
  while (flush_callbacks.length) {
    flush_callbacks.pop()();
  }
  update_scheduled = false;
  seen_callbacks.clear();
  set_current_component(saved_component);
}
function update($$) {
  if ($$.fragment !== null) {
    $$.update();
    run_all($$.before_update);
    const dirty = $$.dirty;
    $$.dirty = [-1];
    $$.fragment && $$.fragment.p($$.ctx, dirty);
    $$.after_update.forEach(add_render_callback);
  }
}
var outroing = /* @__PURE__ */ new Set();
var outros;
function group_outros() {
  outros = {
    r: 0,
    c: [],
    p: outros
  };
}
function check_outros() {
  if (!outros.r) {
    run_all(outros.c);
  }
  outros = outros.p;
}
function transition_in(block, local) {
  if (block && block.i) {
    outroing.delete(block);
    block.i(local);
  }
}
function transition_out(block, local, detach2, callback) {
  if (block && block.o) {
    if (outroing.has(block))
      return;
    outroing.add(block);
    outros.c.push(() => {
      outroing.delete(block);
      if (callback) {
        if (detach2)
          block.d(1);
        callback();
      }
    });
    block.o(local);
  }
}
var globals = typeof window !== "undefined" ? window : typeof globalThis !== "undefined" ? globalThis : global;
function destroy_block(block, lookup) {
  block.d(1);
  lookup.delete(block.key);
}
function update_keyed_each(old_blocks, dirty, get_key, dynamic, ctx, list, lookup, node, destroy, create_each_block2, next, get_context) {
  let o = old_blocks.length;
  let n = list.length;
  let i = o;
  const old_indexes = {};
  while (i--)
    old_indexes[old_blocks[i].key] = i;
  const new_blocks = [];
  const new_lookup = /* @__PURE__ */ new Map();
  const deltas = /* @__PURE__ */ new Map();
  i = n;
  while (i--) {
    const child_ctx = get_context(ctx, list, i);
    const key = get_key(child_ctx);
    let block = lookup.get(key);
    if (!block) {
      block = create_each_block2(key, child_ctx);
      block.c();
    } else if (dynamic) {
      block.p(child_ctx, dirty);
    }
    new_lookup.set(key, new_blocks[i] = block);
    if (key in old_indexes)
      deltas.set(key, Math.abs(i - old_indexes[key]));
  }
  const will_move = /* @__PURE__ */ new Set();
  const did_move = /* @__PURE__ */ new Set();
  function insert2(block) {
    transition_in(block, 1);
    block.m(node, next);
    lookup.set(block.key, block);
    next = block.first;
    n--;
  }
  while (o && n) {
    const new_block = new_blocks[n - 1];
    const old_block = old_blocks[o - 1];
    const new_key = new_block.key;
    const old_key = old_block.key;
    if (new_block === old_block) {
      next = new_block.first;
      o--;
      n--;
    } else if (!new_lookup.has(old_key)) {
      destroy(old_block, lookup);
      o--;
    } else if (!lookup.has(new_key) || will_move.has(new_key)) {
      insert2(new_block);
    } else if (did_move.has(old_key)) {
      o--;
    } else if (deltas.get(new_key) > deltas.get(old_key)) {
      did_move.add(new_key);
      insert2(new_block);
    } else {
      will_move.add(old_key);
      o--;
    }
  }
  while (o--) {
    const old_block = old_blocks[o];
    if (!new_lookup.has(old_block.key))
      destroy(old_block, lookup);
  }
  while (n)
    insert2(new_blocks[n - 1]);
  return new_blocks;
}
function create_component(block) {
  block && block.c();
}
function mount_component(component, target, anchor, customElement) {
  const { fragment, on_mount, on_destroy, after_update } = component.$$;
  fragment && fragment.m(target, anchor);
  if (!customElement) {
    add_render_callback(() => {
      const new_on_destroy = on_mount.map(run).filter(is_function);
      if (on_destroy) {
        on_destroy.push(...new_on_destroy);
      } else {
        run_all(new_on_destroy);
      }
      component.$$.on_mount = [];
    });
  }
  after_update.forEach(add_render_callback);
}
function destroy_component(component, detaching) {
  const $$ = component.$$;
  if ($$.fragment !== null) {
    run_all($$.on_destroy);
    $$.fragment && $$.fragment.d(detaching);
    $$.on_destroy = $$.fragment = null;
    $$.ctx = [];
  }
}
function make_dirty(component, i) {
  if (component.$$.dirty[0] === -1) {
    dirty_components.push(component);
    schedule_update();
    component.$$.dirty.fill(0);
  }
  component.$$.dirty[i / 31 | 0] |= 1 << i % 31;
}
function init(component, options, instance3, create_fragment3, not_equal, props, append_styles2, dirty = [-1]) {
  const parent_component = current_component;
  set_current_component(component);
  const $$ = component.$$ = {
    fragment: null,
    ctx: null,
    props,
    update: noop,
    not_equal,
    bound: blank_object(),
    on_mount: [],
    on_destroy: [],
    on_disconnect: [],
    before_update: [],
    after_update: [],
    context: new Map(options.context || (parent_component ? parent_component.$$.context : [])),
    callbacks: blank_object(),
    dirty,
    skip_bound: false,
    root: options.target || parent_component.$$.root
  };
  append_styles2 && append_styles2($$.root);
  let ready = false;
  $$.ctx = instance3 ? instance3(component, options.props || {}, (i, ret, ...rest) => {
    const value = rest.length ? rest[0] : ret;
    if ($$.ctx && not_equal($$.ctx[i], $$.ctx[i] = value)) {
      if (!$$.skip_bound && $$.bound[i])
        $$.bound[i](value);
      if (ready)
        make_dirty(component, i);
    }
    return ret;
  }) : [];
  $$.update();
  ready = true;
  run_all($$.before_update);
  $$.fragment = create_fragment3 ? create_fragment3($$.ctx) : false;
  if (options.target) {
    if (options.hydrate) {
      start_hydrating();
      const nodes = children(options.target);
      $$.fragment && $$.fragment.l(nodes);
      nodes.forEach(detach);
    } else {
      $$.fragment && $$.fragment.c();
    }
    if (options.intro)
      transition_in(component.$$.fragment);
    mount_component(component, options.target, options.anchor, options.customElement);
    end_hydrating();
    flush();
  }
  set_current_component(parent_component);
}
var SvelteElement;
if (typeof HTMLElement === "function") {
  SvelteElement = class extends HTMLElement {
    constructor() {
      super();
      this.attachShadow({ mode: "open" });
    }
    connectedCallback() {
      const { on_mount } = this.$$;
      this.$$.on_disconnect = on_mount.map(run).filter(is_function);
      for (const key in this.$$.slotted) {
        this.appendChild(this.$$.slotted[key]);
      }
    }
    attributeChangedCallback(attr2, _oldValue, newValue) {
      this[attr2] = newValue;
    }
    disconnectedCallback() {
      run_all(this.$$.on_disconnect);
    }
    $destroy() {
      destroy_component(this, 1);
      this.$destroy = noop;
    }
    $on(type, callback) {
      const callbacks = this.$$.callbacks[type] || (this.$$.callbacks[type] = []);
      callbacks.push(callback);
      return () => {
        const index = callbacks.indexOf(callback);
        if (index !== -1)
          callbacks.splice(index, 1);
      };
    }
    $set($$props) {
      if (this.$$set && !is_empty($$props)) {
        this.$$.skip_bound = true;
        this.$$set($$props);
        this.$$.skip_bound = false;
      }
    }
  };
}
var SvelteComponent = class {
  $destroy() {
    destroy_component(this, 1);
    this.$destroy = noop;
  }
  $on(type, callback) {
    const callbacks = this.$$.callbacks[type] || (this.$$.callbacks[type] = []);
    callbacks.push(callback);
    return () => {
      const index = callbacks.indexOf(callback);
      if (index !== -1)
        callbacks.splice(index, 1);
    };
  }
  $set($$props) {
    if (this.$$set && !is_empty($$props)) {
      this.$$.skip_bound = true;
      this.$$set($$props);
      this.$$.skip_bound = false;
    }
  }
};

// src/inputFields/DatePicker/DatePickerInputSvelteHelpers.ts
var import_obsidian9 = require("obsidian");
var monthNames = [
  "January",
  "February",
  "March",
  "April",
  "May",
  "June",
  "July",
  "August",
  "September",
  "October",
  "November",
  "December"
];
function getMonthName(index) {
  return monthNames[index];
}
function getDateRows(monthIndex, year) {
  const days = (0, import_obsidian9.moment)(new Date(year, monthIndex)).daysInMonth();
  const rows = new Array(42).fill(void 0);
  const startIndex = getWeekDay(new Date(year, monthIndex, 1));
  for (let i = 0; i < days; i++) {
    rows[i + startIndex] = i + 1;
  }
  return rows[rows.length - 7] ? rows : rows.slice(0, -7);
}
function getWeekDay(date) {
  return date.getDay() === 0 ? 6 : date.getDay() - 1;
}
function getWeekDays() {
  return ["Mo", "Tu", "We", "Th", "Fr", "Sa", "Su"];
}
function uuid() {
  let id = 0;
  return () => {
    return ++id;
  };
}

// src/inputFields/DatePicker/Calender.svelte
var import_obsidian10 = require("obsidian");
function add_css(target) {
  append_styles(target, "svelte-1mqpn5e", ".calendar.svelte-1mqpn5e{margin-top:10px}.calendar-header.svelte-1mqpn5e{display:flex;flex-wrap:wrap;gap:2px;background:var(--background-primary);border-radius:var(--meta-bind-plugin-border-radius);margin-bottom:2px}.calendar-content.svelte-1mqpn5e{display:grid;flex-wrap:wrap;grid-template-columns:repeat(7, 1fr);gap:2px}.cell.svelte-1mqpn5e{width:40px;height:30px;padding:5px;display:flex;justify-content:center;align-items:center;border-radius:var(--meta-bind-plugin-border-radius)}.content-cell.svelte-1mqpn5e{cursor:pointer}.cell-text.svelte-1mqpn5e{margin:auto;text-align:center}.selected.svelte-1mqpn5e{background:var(--background-modifier-success)}.highlight.svelte-1mqpn5e:hover{background:var(--interactive-hover)}.selected.highlight.svelte-1mqpn5e:hover{background:green}");
}
function get_each_context(ctx, list, i) {
  const child_ctx = ctx.slice();
  child_ctx[7] = list[i];
  return child_ctx;
}
function get_each_context_1(ctx, list, i) {
  const child_ctx = ctx.slice();
  child_ctx[10] = list[i];
  return child_ctx;
}
function create_each_block_1(ctx) {
  let div;
  let span;
  let t0_value = ctx[10] + "";
  let t0;
  let t1;
  return {
    c() {
      div = element("div");
      span = element("span");
      t0 = text(t0_value);
      t1 = space();
      attr(span, "class", "cell-text svelte-1mqpn5e");
      attr(div, "class", "cell header-cell svelte-1mqpn5e");
    },
    m(target, anchor) {
      insert(target, div, anchor);
      append(div, span);
      append(span, t0);
      append(div, t1);
    },
    p: noop,
    d(detaching) {
      if (detaching)
        detach(div);
    }
  };
}
function create_each_block(key_1, ctx) {
  let div;
  let span;
  let t0_value = (ctx[7] || "") + "";
  let t0;
  let t1;
  let mounted;
  let dispose;
  function click_handler() {
    return ctx[5](ctx[7]);
  }
  return {
    key: key_1,
    first: null,
    c() {
      div = element("div");
      span = element("span");
      t0 = text(t0_value);
      t1 = space();
      attr(span, "class", "cell-text svelte-1mqpn5e");
      attr(div, "class", "cell svelte-1mqpn5e");
      toggle_class(div, "highlight", ctx[7]);
      toggle_class(div, "content-cell", ctx[7]);
      toggle_class(div, "selected", ctx[0].year() === ctx[2] && ctx[0].month() === ctx[1] && ctx[0].date() === ctx[7]);
      this.first = div;
    },
    m(target, anchor) {
      insert(target, div, anchor);
      append(div, span);
      append(span, t0);
      append(div, t1);
      if (!mounted) {
        dispose = listen(div, "click", function() {
          if (is_function(ctx[7] ? click_handler : click_handler_1))
            (ctx[7] ? click_handler : click_handler_1).apply(this, arguments);
        });
        mounted = true;
      }
    },
    p(new_ctx, dirty) {
      ctx = new_ctx;
      if (dirty & 8 && t0_value !== (t0_value = (ctx[7] || "") + ""))
        set_data(t0, t0_value);
      if (dirty & 8) {
        toggle_class(div, "highlight", ctx[7]);
      }
      if (dirty & 8) {
        toggle_class(div, "content-cell", ctx[7]);
      }
      if (dirty & 15) {
        toggle_class(div, "selected", ctx[0].year() === ctx[2] && ctx[0].month() === ctx[1] && ctx[0].date() === ctx[7]);
      }
    },
    d(detaching) {
      if (detaching)
        detach(div);
      mounted = false;
      dispose();
    }
  };
}
function create_fragment(ctx) {
  let div2;
  let div0;
  let t;
  let div1;
  let each_blocks = [];
  let each1_lookup = /* @__PURE__ */ new Map();
  let each_value_1 = getWeekDays();
  let each_blocks_1 = [];
  for (let i = 0; i < each_value_1.length; i += 1) {
    each_blocks_1[i] = create_each_block_1(get_each_context_1(ctx, each_value_1, i));
  }
  let each_value = ctx[3];
  const get_key = (ctx2) => uuid();
  for (let i = 0; i < each_value.length; i += 1) {
    let child_ctx = get_each_context(ctx, each_value, i);
    let key = get_key(child_ctx);
    each1_lookup.set(key, each_blocks[i] = create_each_block(key, child_ctx));
  }
  return {
    c() {
      div2 = element("div");
      div0 = element("div");
      for (let i = 0; i < each_blocks_1.length; i += 1) {
        each_blocks_1[i].c();
      }
      t = space();
      div1 = element("div");
      for (let i = 0; i < each_blocks.length; i += 1) {
        each_blocks[i].c();
      }
      attr(div0, "class", "calendar-header svelte-1mqpn5e");
      attr(div1, "class", "calendar-content svelte-1mqpn5e");
      attr(div2, "class", "calendar svelte-1mqpn5e");
    },
    m(target, anchor) {
      insert(target, div2, anchor);
      append(div2, div0);
      for (let i = 0; i < each_blocks_1.length; i += 1) {
        each_blocks_1[i].m(div0, null);
      }
      append(div2, t);
      append(div2, div1);
      for (let i = 0; i < each_blocks.length; i += 1) {
        each_blocks[i].m(div1, null);
      }
    },
    p(ctx2, [dirty]) {
      if (dirty & 0) {
        each_value_1 = getWeekDays();
        let i;
        for (i = 0; i < each_value_1.length; i += 1) {
          const child_ctx = get_each_context_1(ctx2, each_value_1, i);
          if (each_blocks_1[i]) {
            each_blocks_1[i].p(child_ctx, dirty);
          } else {
            each_blocks_1[i] = create_each_block_1(child_ctx);
            each_blocks_1[i].c();
            each_blocks_1[i].m(div0, null);
          }
        }
        for (; i < each_blocks_1.length; i += 1) {
          each_blocks_1[i].d(1);
        }
        each_blocks_1.length = each_value_1.length;
      }
      if (dirty & 31) {
        each_value = ctx2[3];
        each_blocks = update_keyed_each(each_blocks, dirty, get_key, 1, ctx2, each_value, each1_lookup, div1, destroy_block, create_each_block, null, get_each_context);
      }
    },
    i: noop,
    o: noop,
    d(detaching) {
      if (detaching)
        detach(div2);
      destroy_each(each_blocks_1, detaching);
      for (let i = 0; i < each_blocks.length; i += 1) {
        each_blocks[i].d();
      }
    }
  };
}
var click_handler_1 = () => {
};
function instance($$self, $$props, $$invalidate) {
  const dispatch = createEventDispatcher();
  let { selectedDate } = $$props;
  let { month } = $$props;
  let { year } = $$props;
  let cells;
  function onChange(date) {
    dispatch("dateChange", (0, import_obsidian10.moment)(new Date(year, month, date)));
  }
  const click_handler = (value) => onChange(value);
  $$self.$$set = ($$props2) => {
    if ("selectedDate" in $$props2)
      $$invalidate(0, selectedDate = $$props2.selectedDate);
    if ("month" in $$props2)
      $$invalidate(1, month = $$props2.month);
    if ("year" in $$props2)
      $$invalidate(2, year = $$props2.year);
  };
  $$self.$$.update = () => {
    if ($$self.$$.dirty & 6) {
      $:
        $$invalidate(3, cells = getDateRows(month, year));
    }
  };
  return [selectedDate, month, year, cells, onChange, click_handler];
}
var Calender = class extends SvelteComponent {
  constructor(options) {
    super();
    init(this, options, instance, create_fragment, safe_not_equal, { selectedDate: 0, month: 1, year: 2 }, add_css);
  }
};
var Calender_default = Calender;

// src/inputFields/DatePicker/DatePicker.svelte
var import_obsidian11 = require("obsidian");
function add_css2(target) {
  append_styles(target, "svelte-qr0qiv", ".date-picker-input.svelte-qr0qiv{position:relative;color:var(--text-normal)}.date-picker.svelte-qr0qiv{position:absolute;top:30px;left:0;display:inline-block;background:var(--background-secondary);border-radius:var(--meta-bind-plugin-border-radius);border:var(--meta-bind-plugin-border-width) solid var(--background-modifier-border);padding:10px;z-index:1000000}.date-picker-header.svelte-qr0qiv{display:flex;justify-content:center;align-items:center}.date-picker-header-text.svelte-qr0qiv{flex:1;text-align:center}.month-switch-button.svelte-qr0qiv{margin:0}");
}
function create_if_block(ctx) {
  let div2;
  let div1;
  let button0;
  let t1;
  let div0;
  let t2_value = getMonthName(ctx[1]) + "";
  let t2;
  let t3;
  let t4;
  let t5;
  let button1;
  let t7;
  let calender;
  let current;
  let mounted;
  let dispose;
  calender = new Calender_default({
    props: {
      month: ctx[1],
      year: ctx[2],
      selectedDate: ctx[0]
    }
  });
  calender.$on("dateChange", ctx[6]);
  return {
    c() {
      div2 = element("div");
      div1 = element("div");
      button0 = element("button");
      button0.textContent = "Prev";
      t1 = space();
      div0 = element("div");
      t2 = text(t2_value);
      t3 = space();
      t4 = text(ctx[2]);
      t5 = space();
      button1 = element("button");
      button1.textContent = "Next";
      t7 = space();
      create_component(calender.$$.fragment);
      attr(button0, "class", "month-switch-button svelte-qr0qiv");
      attr(div0, "class", "date-picker-header-text svelte-qr0qiv");
      attr(button1, "class", "month-switch-button svelte-qr0qiv");
      attr(div1, "class", "date-picker-header svelte-qr0qiv");
      attr(div2, "class", "date-picker svelte-qr0qiv");
    },
    m(target, anchor) {
      insert(target, div2, anchor);
      append(div2, div1);
      append(div1, button0);
      append(div1, t1);
      append(div1, div0);
      append(div0, t2);
      append(div0, t3);
      append(div0, t4);
      append(div1, t5);
      append(div1, button1);
      append(div2, t7);
      mount_component(calender, div2, null);
      current = true;
      if (!mounted) {
        dispose = [
          listen(button0, "click", ctx[5]),
          listen(button1, "click", ctx[4])
        ];
        mounted = true;
      }
    },
    p(ctx2, dirty) {
      if ((!current || dirty & 2) && t2_value !== (t2_value = getMonthName(ctx2[1]) + ""))
        set_data(t2, t2_value);
      if (!current || dirty & 4)
        set_data(t4, ctx2[2]);
      const calender_changes = {};
      if (dirty & 2)
        calender_changes.month = ctx2[1];
      if (dirty & 4)
        calender_changes.year = ctx2[2];
      if (dirty & 1)
        calender_changes.selectedDate = ctx2[0];
      calender.$set(calender_changes);
    },
    i(local) {
      if (current)
        return;
      transition_in(calender.$$.fragment, local);
      current = true;
    },
    o(local) {
      transition_out(calender.$$.fragment, local);
      current = false;
    },
    d(detaching) {
      if (detaching)
        detach(div2);
      destroy_component(calender);
      mounted = false;
      run_all(dispose);
    }
  };
}
function create_fragment2(ctx) {
  let div1;
  let div0;
  let t0_value = ctx[0].format("dddd, MMMM Do YYYY") + "";
  let t0;
  let t1;
  let current;
  let mounted;
  let dispose;
  let if_block = ctx[3] && create_if_block(ctx);
  return {
    c() {
      div1 = element("div");
      div0 = element("div");
      t0 = text(t0_value);
      t1 = space();
      if (if_block)
        if_block.c();
      attr(div1, "class", "date-picker-input svelte-qr0qiv");
    },
    m(target, anchor) {
      insert(target, div1, anchor);
      append(div1, div0);
      append(div0, t0);
      append(div1, t1);
      if (if_block)
        if_block.m(div1, null);
      current = true;
      if (!mounted) {
        dispose = listen(div0, "click", ctx[8]);
        mounted = true;
      }
    },
    p(ctx2, [dirty]) {
      if ((!current || dirty & 1) && t0_value !== (t0_value = ctx2[0].format("dddd, MMMM Do YYYY") + ""))
        set_data(t0, t0_value);
      if (ctx2[3]) {
        if (if_block) {
          if_block.p(ctx2, dirty);
          if (dirty & 8) {
            transition_in(if_block, 1);
          }
        } else {
          if_block = create_if_block(ctx2);
          if_block.c();
          transition_in(if_block, 1);
          if_block.m(div1, null);
        }
      } else if (if_block) {
        group_outros();
        transition_out(if_block, 1, 1, () => {
          if_block = null;
        });
        check_outros();
      }
    },
    i(local) {
      if (current)
        return;
      transition_in(if_block);
      current = true;
    },
    o(local) {
      transition_out(if_block);
      current = false;
    },
    d(detaching) {
      if (detaching)
        detach(div1);
      if (if_block)
        if_block.d();
      mounted = false;
      dispose();
    }
  };
}
function instance2($$self, $$props, $$invalidate) {
  const dispatch = createEventDispatcher();
  let { selectedDate = (0, import_obsidian11.moment)() } = $$props;
  let { dateChangeCallback } = $$props;
  let date;
  let month;
  let year;
  let showDatePicker;
  function onFocus() {
    $$invalidate(3, showDatePicker = true);
  }
  function next() {
    if (month === 11) {
      $$invalidate(1, month = 0);
      $$invalidate(2, year += 1);
      return;
    }
    $$invalidate(1, month = month + 1);
  }
  function prev() {
    if (month === 0) {
      $$invalidate(1, month = 11);
      $$invalidate(2, year -= 1);
      return;
    }
    $$invalidate(1, month -= 1);
  }
  function onDateChange(d) {
    $$invalidate(3, showDatePicker = false);
    $$invalidate(0, selectedDate = d.detail);
    dateChangeCallback(d.detail);
  }
  const click_handler = () => $$invalidate(3, showDatePicker = true);
  $$self.$$set = ($$props2) => {
    if ("selectedDate" in $$props2)
      $$invalidate(0, selectedDate = $$props2.selectedDate);
    if ("dateChangeCallback" in $$props2)
      $$invalidate(7, dateChangeCallback = $$props2.dateChangeCallback);
  };
  $$self.$$.update = () => {
    if ($$self.$$.dirty & 1) {
      $: {
        date = selectedDate.date();
        $$invalidate(1, month = selectedDate.month());
        $$invalidate(2, year = selectedDate.year());
      }
    }
  };
  return [
    selectedDate,
    month,
    year,
    showDatePicker,
    next,
    prev,
    onDateChange,
    dateChangeCallback,
    click_handler
  ];
}
var DatePicker = class extends SvelteComponent {
  constructor(options) {
    super();
    init(this, options, instance2, create_fragment2, safe_not_equal, { selectedDate: 0, dateChangeCallback: 7 }, add_css2);
  }
};
var DatePicker_default = DatePicker;

// src/inputFields/DatePicker/DatePickerInputField.ts
var DatePickerInputField = class extends AbstractInputField {
  constructor(inputFieldMarkdownRenderChild, onValueChange) {
    super(inputFieldMarkdownRenderChild, onValueChange);
    this.date = DateParser.getDefaultDate();
  }
  getValue() {
    return DateParser.stringify(this.date);
  }
  setValue(value) {
    var _a, _b;
    this.date = (_a = DateParser.parse(value)) != null ? _a : DateParser.getDefaultDate();
    (_b = this.component) == null ? void 0 : _b.$set({ "selectedDate": this.date });
  }
  isEqualValue(value) {
    return this.getValue() == value;
  }
  getDefaultValue() {
    return DateParser.stringify(DateParser.getDefaultDate());
  }
  getHtmlElement() {
    if (!this.container) {
      throw new MetaBindInternalError("");
    }
    return this.container;
  }
  datePickerValueChanged(date) {
    this.date = date;
    console.log("date picker value change", this.date);
    this.onValueChange(this.getValue());
  }
  render(container) {
    var _a;
    this.container = container;
    this.date = (_a = DateParser.parse(this.inputFieldMarkdownRenderChild.getInitialValue())) != null ? _a : DateParser.getDefaultDate();
    this.component = new DatePicker_default({
      target: container,
      props: {
        selectedDate: this.date,
        dateChangeCallback: (date) => this.datePickerValueChanged(date)
      }
    });
  }
};

// src/inputFields/InputFieldFactory.ts
var _InputFieldFactory = class {
  static createInputField(inputFieldType, args) {
    if (inputFieldType === "toggle" /* TOGGLE */) {
      _InputFieldFactory.checkInputFieldMarkdownRenderChildTypeAllowed(inputFieldType, args.type);
      return new ToggleInputField(args.inputFieldMarkdownRenderChild, args.onValueChanged);
    } else if (inputFieldType === "slider" /* SLIDER */) {
      _InputFieldFactory.checkInputFieldMarkdownRenderChildTypeAllowed(inputFieldType, args.type);
      return new SliderInputField(args.inputFieldMarkdownRenderChild, args.onValueChanged);
    } else if (inputFieldType === "text" /* TEXT */) {
      _InputFieldFactory.checkInputFieldMarkdownRenderChildTypeAllowed(inputFieldType, args.type);
      return new TextInputField(args.inputFieldMarkdownRenderChild, args.onValueChanged);
    } else if (inputFieldType === "text_area" /* TEXT_AREA */) {
      _InputFieldFactory.checkInputFieldMarkdownRenderChildTypeAllowed(inputFieldType, args.type);
      return new TextAreaInputField(args.inputFieldMarkdownRenderChild, args.onValueChanged);
    } else if (inputFieldType === "select" /* SELECT */) {
      _InputFieldFactory.checkInputFieldMarkdownRenderChildTypeAllowed(inputFieldType, args.type);
      return new SelectInputField(args.inputFieldMarkdownRenderChild, args.onValueChanged);
    } else if (inputFieldType === "multi_select" /* MULTI_SELECT */) {
      _InputFieldFactory.checkInputFieldMarkdownRenderChildTypeAllowed(inputFieldType, args.type);
      return new MultiSelectInputField(args.inputFieldMarkdownRenderChild, args.onValueChanged);
    } else if (inputFieldType === "date" /* DATE */) {
      _InputFieldFactory.checkInputFieldMarkdownRenderChildTypeAllowed(inputFieldType, args.type);
      return new DateInputField(args.inputFieldMarkdownRenderChild, args.onValueChanged);
    } else if (inputFieldType === "time" /* TIME */) {
      _InputFieldFactory.checkInputFieldMarkdownRenderChildTypeAllowed(inputFieldType, args.type);
      return new TimeInputField(args.inputFieldMarkdownRenderChild, args.onValueChanged);
    } else if (inputFieldType === "date_picker" /* DATE_PICKER */) {
      _InputFieldFactory.checkInputFieldMarkdownRenderChildTypeAllowed(inputFieldType, args.type);
      return new DatePickerInputField(args.inputFieldMarkdownRenderChild, args.onValueChanged);
    }
    return void 0;
  }
  static checkInputFieldMarkdownRenderChildTypeAllowed(inputFieldType, type) {
    const allowCodeBlock = _InputFieldFactory.allowCodeBlockMap[inputFieldType];
    if (type === 1 /* CODE_BLOCK */ && !allowCodeBlock.codeBlock) {
      throw new MetaBindParsingError(`'${inputFieldType}' is not allowed as code block`);
    }
    if (type === 0 /* INLINE_CODE_BLOCK */ && !allowCodeBlock.inlineCodeBlock) {
      throw new MetaBindParsingError(`'${inputFieldType}' is not allowed as inline code block`);
    }
  }
};
var InputFieldFactory = _InputFieldFactory;
InputFieldFactory.allowCodeBlockMap = {
  ["toggle" /* TOGGLE */]: { codeBlock: ToggleInputField.allowCodeBlock, inlineCodeBlock: ToggleInputField.allowInlineCodeBlock },
  ["slider" /* SLIDER */]: { codeBlock: SliderInputField.allowCodeBlock, inlineCodeBlock: SliderInputField.allowInlineCodeBlock },
  ["text" /* TEXT */]: { codeBlock: TextInputField.allowCodeBlock, inlineCodeBlock: TextInputField.allowInlineCodeBlock },
  ["text_area" /* TEXT_AREA */]: { codeBlock: TextAreaInputField.allowCodeBlock, inlineCodeBlock: TextAreaInputField.allowInlineCodeBlock },
  ["select" /* SELECT */]: { codeBlock: SelectInputField.allowCodeBlock, inlineCodeBlock: SelectInputField.allowInlineCodeBlock },
  ["multi_select" /* MULTI_SELECT */]: { codeBlock: MultiSelectInputField.allowCodeBlock, inlineCodeBlock: MultiSelectInputField.allowInlineCodeBlock },
  ["date" /* DATE */]: { codeBlock: DateInputField.allowCodeBlock, inlineCodeBlock: DateInputField.allowInlineCodeBlock },
  ["time" /* TIME */]: { codeBlock: TimeInputField.allowCodeBlock, inlineCodeBlock: TimeInputField.allowInlineCodeBlock },
  ["date_picker" /* DATE_PICKER */]: { codeBlock: DatePickerInputField.allowCodeBlock, inlineCodeBlock: DatePickerInputField.allowInlineCodeBlock }
};

// src/InputFieldMarkdownRenderChild.ts
var InputFieldMarkdownRenderChild2 = class extends import_obsidian12.MarkdownRenderChild {
  constructor(containerEl, type, fullDeclaration, plugin, filePath, uid) {
    super(containerEl);
    this.error = "";
    this.filePath = filePath;
    this.uid = uid;
    this.plugin = plugin;
    this.valueQueue = [];
    this.intervalCounter = 0;
    try {
      this.inputFieldDeclaration = InputFieldDeclarationParser.parse(fullDeclaration);
      if (this.inputFieldDeclaration.isBound) {
        this.parseBindTarget();
        this.metaData = this.plugin.getMetaDataForFile(this.bindTargetFile);
      }
      this.inputField = InputFieldFactory.createInputField(this.inputFieldDeclaration.inputFieldType, {
        type,
        inputFieldMarkdownRenderChild: this,
        onValueChanged: this.pushToValueQueue.bind(this)
      });
      this.limitInterval = window.setInterval(() => this.applyValueQueueToMetadata(), this.plugin.settings.syncInterval);
    } catch (e) {
      this.error = e.message;
      Logger.logWarning(e);
    }
  }
  parseBindTarget() {
    if (!this.inputFieldDeclaration) {
      throw new MetaBindInternalError("inputFieldDeclaration is undefined, can not parse bind target");
    }
    const bindTargetParts = this.inputFieldDeclaration.bindTarget.split("#");
    if (bindTargetParts.length === 1) {
      this.bindTargetMetadataField = this.inputFieldDeclaration.bindTarget;
      const files = this.plugin.getFilesByName(this.filePath);
      if (files.length === 0) {
        throw new MetaBindBindTargetError("bind target file not found");
      } else if (files.length === 1) {
        this.bindTargetFile = files[0];
      } else {
        throw new MetaBindBindTargetError("bind target resolves to multiple files, please also specify the file path");
      }
    } else if (bindTargetParts.length === 2) {
      this.bindTargetMetadataField = bindTargetParts[1];
      const files = this.plugin.getFilesByName(bindTargetParts[0]);
      if (files.length === 0) {
        throw new MetaBindBindTargetError("bind target file not found");
      } else if (files.length === 1) {
        this.bindTargetFile = files[0];
      } else {
        throw new MetaBindBindTargetError("bind target resolves to multiple files, please also specify the file path");
      }
    } else {
      throw new MetaBindBindTargetError("bind target may only contain one '#' to specify the metadata field");
    }
  }
  applyValueQueueToMetadata() {
    return __async(this, null, function* () {
      if (!this.inputFieldDeclaration) {
        throw new MetaBindInternalError("inputFieldDeclaration is undefined, can not update metadata");
      }
      if (!this.inputFieldDeclaration.isBound) {
        return;
      }
      if (!this.bindTargetMetadataField || !this.bindTargetFile) {
        throw new MetaBindInternalError("bindTargetMetadataField or bindTargetFile is undefined, can not update metadata");
      }
      if (this.valueQueue.length > 0) {
        yield this.plugin.updateMetaData(this.bindTargetMetadataField, this.valueQueue.at(-1), this.bindTargetFile);
        this.valueQueue = [];
      }
    });
  }
  pushToValueQueue(value) {
    return __async(this, null, function* () {
      var _a;
      if ((_a = this.inputFieldDeclaration) == null ? void 0 : _a.isBound) {
        this.valueQueue.push(value);
      }
    });
  }
  updateValue(value) {
    if (!this.inputField) {
      throw new MetaBindInternalError("inputField is undefined, can not update value");
    }
    if (value == null) {
      value = this.inputField.getDefaultValue();
    }
    if (!this.inputField.isEqualValue(value) && this.valueQueue.length === 0) {
      Logger.logDebug(`updating input field ${this.uid} to`, value);
      this.inputField.setValue(value);
    }
  }
  getInitialValue() {
    var _a, _b, _c, _d;
    if ((_a = this.inputFieldDeclaration) == null ? void 0 : _a.isBound) {
      return (_d = this.metaData[(_b = this.bindTargetMetadataField) != null ? _b : ""]) != null ? _d : (_c = this.inputField) == null ? void 0 : _c.getDefaultValue();
    }
  }
  getArguments(name) {
    if (!this.inputFieldDeclaration) {
      throw new MetaBindInternalError("inputFieldDeclaration is undefined, can not retrieve arguments");
    }
    return this.inputFieldDeclaration.arguments.filter((x) => x.name === name);
  }
  getArgument(name) {
    return this.getArguments(name).at(0);
  }
  onload() {
    return __async(this, null, function* () {
      Logger.logDebug("load", this);
      this.metaData = yield this.metaData;
      const container = this.containerEl.createDiv();
      container.addClass("meta-bind-plugin-input-wrapper");
      this.containerEl.addClass("meta-bind-plugin-input");
      if (this.error) {
        container.innerText = ` -> ERROR: ${this.error}`;
        container.addClass("meta-bind-plugin-error");
        this.containerEl.appendChild(container);
        return;
      }
      if (!this.inputField) {
        container.innerText = ` -> ERROR: ${new MetaBindInternalError("input field is undefined and error is empty").message}`;
        container.addClass("meta-bind-plugin-error");
        this.containerEl.appendChild(container);
        return;
      }
      this.plugin.registerInputFieldMarkdownRenderChild(this);
      this.inputField.render(container);
      const classArgument = this.getArguments("class");
      if (classArgument) {
        this.inputField.getHtmlElement().addClasses(classArgument.map((x) => x.value));
      }
      this.containerEl.empty();
      this.containerEl.appendChild(container);
    });
  }
  onunload() {
    Logger.logDebug("unload", this);
    this.plugin.unregisterInputFieldMarkdownRenderChild(this);
    super.onunload();
    window.clearInterval(this.limitInterval);
  }
};

// src/main.ts
var MetaBindPlugin = class extends import_obsidian13.Plugin {
  onload() {
    return __async(this, null, function* () {
      yield this.loadSettings();
      Logger.devMode = this.settings.devMode;
      DateParser.dateFormat = this.settings.preferredDateFormat;
      this.activeMarkdownInputFields = [];
      this.markDownInputFieldIndex = 0;
      this.registerMarkdownPostProcessor((element2, context) => {
        const codeBlocks = element2.querySelectorAll("code");
        for (let index = 0; index < codeBlocks.length; index++) {
          const codeBlock = codeBlocks.item(index);
          const text2 = codeBlock.innerText;
          const isInputField = text2.startsWith("INPUT[") && text2.endsWith("]");
          if (isInputField) {
            context.addChild(new InputFieldMarkdownRenderChild2(codeBlock, 0 /* INLINE_CODE_BLOCK */, text2, this, context.sourcePath, this.markDownInputFieldIndex));
            this.markDownInputFieldIndex += 1;
          }
        }
      });
      this.registerMarkdownCodeBlockProcessor("meta-bind", (source, el, ctx) => {
        const codeBlock = el;
        const text2 = source.replace(/\n/g, "");
        const isInputField = text2.startsWith("INPUT[") && text2.endsWith("]");
        if (isInputField) {
          ctx.addChild(new InputFieldMarkdownRenderChild2(codeBlock, 1 /* CODE_BLOCK */, text2, this, ctx.sourcePath, this.markDownInputFieldIndex));
          this.markDownInputFieldIndex += 1;
        }
      });
      this.registerEvent(this.app.vault.on("modify", (abstractFile) => __async(this, null, function* () {
        if (abstractFile instanceof import_obsidian13.TFile) {
          yield this.updateMarkdownInputFieldsOnFileChange(abstractFile);
        }
      })));
      this.addSettingTab(new MetaBindSettingTab(this.app, this));
    });
  }
  onunload() {
    for (const activeMarkdownInputField of this.activeMarkdownInputFields) {
      activeMarkdownInputField.unload();
    }
  }
  registerInputFieldMarkdownRenderChild(inputFieldMarkdownRenderChild) {
    this.activeMarkdownInputFields.push(inputFieldMarkdownRenderChild);
  }
  unregisterInputFieldMarkdownRenderChild(inputFieldMarkdownRenderChild) {
    this.activeMarkdownInputFields = this.activeMarkdownInputFields.filter((x) => x.uid !== inputFieldMarkdownRenderChild.uid);
  }
  updateMarkdownInputFieldsOnFileChange(file) {
    return __async(this, null, function* () {
      var _a;
      let metadata = void 0;
      for (const activeMarkdownInputField of this.activeMarkdownInputFields) {
        if (!((_a = activeMarkdownInputField.inputFieldDeclaration) == null ? void 0 : _a.isBound) || !activeMarkdownInputField.bindTargetFile || !activeMarkdownInputField.bindTargetMetadataField) {
          continue;
        }
        if (activeMarkdownInputField.bindTargetFile.path === file.path) {
          if (metadata === void 0) {
            metadata = yield this.getMetaDataForFile(file);
          }
          activeMarkdownInputField.updateValue(metadata[activeMarkdownInputField.bindTargetMetadataField]);
        }
      }
    });
  }
  updateMetaData(key, value, file) {
    return __async(this, null, function* () {
      Logger.logDebug(`updating `, key, `: `, value, ` in '${file.path}'`);
      if (!file) {
        console.log("no file");
        return;
      }
      let fileContent = yield this.app.vault.read(file);
      const metadata = yield this.getMetaDataForFileContent(fileContent);
      if (!metadata) {
        return;
      }
      const regExp = new RegExp("^(---)\\n[\\s\\S]*\\n---");
      fileContent = fileContent.replace(regExp, "");
      metadata[key] = value;
      fileContent = `---
${(0, import_obsidian13.stringifyYaml)(metadata)}---` + fileContent;
      yield this.app.vault.modify(file, fileContent);
    });
  }
  getFilesByName(name) {
    const fileNameIsPath = isPath(name);
    const processedFileName = fileNameIsPath ? removeFileEnding(name) : getFileName(removeFileEnding(name));
    const allFiles = this.app.vault.getMarkdownFiles();
    const files = [];
    for (const file of allFiles) {
      if (fileNameIsPath) {
        if (removeFileEnding(file.path) === processedFileName) {
          files.push(file);
        }
      } else {
        if (getFileName(removeFileEnding(file.name)) === processedFileName) {
          files.push(file);
        }
      }
    }
    return files;
  }
  getMetaDataForFile(file) {
    return __async(this, null, function* () {
      if (!file) {
        return void 0;
      }
      const fileContent = yield this.app.vault.read(file);
      return yield this.getMetaDataForFileContent(fileContent);
    });
  }
  getMetaDataForFileContent(fileContent) {
    return __async(this, null, function* () {
      Logger.logDebug(`reading metadata`);
      let metadata;
      const regExp = new RegExp("^(---)\\n[\\s\\S]*\\n---");
      const frontMatterRegExpResult = regExp.exec(fileContent);
      if (!frontMatterRegExpResult) {
        return {};
      }
      let frontMatter = frontMatterRegExpResult[0];
      if (!frontMatter) {
        return {};
      }
      frontMatter = frontMatter.substring(4);
      frontMatter = frontMatter.substring(0, frontMatter.length - 3);
      metadata = (0, import_obsidian13.parseYaml)(frontMatter);
      if (!metadata) {
        metadata = {};
      }
      return metadata;
    });
  }
  loadSettings() {
    return __async(this, null, function* () {
      this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
    });
  }
  saveSettings() {
    return __async(this, null, function* () {
      DateParser.dateFormat = this.settings.preferredDateFormat;
      Logger.devMode = this.settings.devMode;
      yield this.saveData(this.settings);
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vLi4vc3JjL21haW4udHMiLCAiLi4vLi4vLi4vLi4vc3JjL3NldHRpbmdzL1NldHRpbmdzLnRzIiwgIi4uLy4uLy4uLy4uL3NyYy9JbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZC50cyIsICIuLi8uLi8uLi8uLi9zcmMvdXRpbHMvTG9nZ2VyLnRzIiwgIi4uLy4uLy4uLy4uL3NyYy9pbnB1dEZpZWxkcy9BYnN0cmFjdElucHV0RmllbGQudHMiLCAiLi4vLi4vLi4vLi4vc3JjL2lucHV0RmllbGRzL1RvZ2dsZUlucHV0RmllbGQudHMiLCAiLi4vLi4vLi4vLi4vc3JjL3V0aWxzL1V0aWxzLnRzIiwgIi4uLy4uLy4uLy4uL3NyYy9pbnB1dEZpZWxkcy9UZXh0SW5wdXRGaWVsZC50cyIsICIuLi8uLi8uLi8uLi9zcmMvaW5wdXRGaWVsZHMvU2xpZGVySW5wdXRGaWVsZC50cyIsICIuLi8uLi8uLi8uLi9zcmMvaW5wdXRGaWVsZHMvVGV4dEFyZWFJbnB1dEZpZWxkLnRzIiwgIi4uLy4uLy4uLy4uL3NyYy9pbnB1dEZpZWxkcy9TZWxlY3RJbnB1dEZpZWxkRWxlbWVudC50cyIsICIuLi8uLi8uLi8uLi9zcmMvaW5wdXRGaWVsZHMvU2VsZWN0SW5wdXRGaWVsZC50cyIsICIuLi8uLi8uLi8uLi9zcmMvaW5wdXRGaWVsZHMvTXVsdGlTZWxlY3RJbnB1dEZpZWxkLnRzIiwgIi4uLy4uLy4uLy4uL3NyYy9pbnB1dEZpZWxkcy9EYXRlSW5wdXRGaWVsZC50cyIsICIuLi8uLi8uLi8uLi9zcmMvcGFyc2Vycy9EYXRlUGFyc2VyLnRzIiwgIi4uLy4uLy4uLy4uL3NyYy9pbnB1dEZpZWxkcy9UaW1lSW5wdXRGaWVsZC50cyIsICIuLi8uLi8uLi8uLi9zcmMvcGFyc2Vycy9UaW1lUGFyc2VyLnRzIiwgIi4uLy4uLy4uLy4uL3NyYy91dGlscy9QYXJzZXJVdGlscy50cyIsICIuLi8uLi8uLi8uLi9zcmMvcGFyc2Vycy9JbnB1dEZpZWxkRGVjbGFyYXRpb25QYXJzZXIudHMiLCAiLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3N2ZWx0ZS9pbnRlcm5hbC9pbmRleC5tanMiLCAiLi4vLi4vLi4vLi4vc3JjL2lucHV0RmllbGRzL0RhdGVQaWNrZXIvRGF0ZVBpY2tlcklucHV0U3ZlbHRlSGVscGVycy50cyIsICIuLi8uLi8uLi8uLi9zcmMvaW5wdXRGaWVsZHMvRGF0ZVBpY2tlci9DYWxlbmRlci5zdmVsdGUiLCAiLi4vLi4vLi4vLi4vc3JjL2lucHV0RmllbGRzL0RhdGVQaWNrZXIvRGF0ZVBpY2tlci5zdmVsdGUiLCAiLi4vLi4vLi4vLi4vc3JjL2lucHV0RmllbGRzL0RhdGVQaWNrZXIvRGF0ZVBpY2tlcklucHV0RmllbGQudHMiLCAiLi4vLi4vLi4vLi4vc3JjL2lucHV0RmllbGRzL0lucHV0RmllbGRGYWN0b3J5LnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQge3BhcnNlWWFtbCwgUGx1Z2luLCBzdHJpbmdpZnlZYW1sLCBURmlsZX0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHtERUZBVUxUX1NFVFRJTkdTLCBNZXRhQmluZFBsdWdpblNldHRpbmdzLCBNZXRhQmluZFNldHRpbmdUYWJ9IGZyb20gJy4vc2V0dGluZ3MvU2V0dGluZ3MnO1xuaW1wb3J0IHtJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCwgSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGRUeXBlfSBmcm9tICcuL0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkJztcbmltcG9ydCB7Z2V0RmlsZU5hbWUsIGlzUGF0aCwgcmVtb3ZlRmlsZUVuZGluZ30gZnJvbSAnLi91dGlscy9VdGlscyc7XG5pbXBvcnQge0xvZ2dlcn0gZnJvbSAnLi91dGlscy9Mb2dnZXInO1xuaW1wb3J0IHtEYXRlUGFyc2VyfSBmcm9tICcuL3BhcnNlcnMvRGF0ZVBhcnNlcic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1ldGFCaW5kUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcblx0Ly8gQHRzLWlnbm9yZSBkZWZpbmVkIGluIGBvbmxvYWRgXG5cdHNldHRpbmdzOiBNZXRhQmluZFBsdWdpblNldHRpbmdzO1xuXG5cdC8vIEB0cy1pZ25vcmUgZGVmaW5lZCBpbiBgb25sb2FkYFxuXHRhY3RpdmVNYXJrZG93bklucHV0RmllbGRzOiBJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZFtdO1xuXHQvLyBAdHMtaWdub3JlIGRlZmluZWQgaW4gYG9ubG9hZGBcblx0bWFya0Rvd25JbnB1dEZpZWxkSW5kZXg6IG51bWJlcjtcblxuXHRhc3luYyBvbmxvYWQoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuXHRcdExvZ2dlci5kZXZNb2RlID0gdGhpcy5zZXR0aW5ncy5kZXZNb2RlO1xuXHRcdERhdGVQYXJzZXIuZGF0ZUZvcm1hdCA9IHRoaXMuc2V0dGluZ3MucHJlZmVycmVkRGF0ZUZvcm1hdDtcblxuXHRcdHRoaXMuYWN0aXZlTWFya2Rvd25JbnB1dEZpZWxkcyA9IFtdO1xuXHRcdHRoaXMubWFya0Rvd25JbnB1dEZpZWxkSW5kZXggPSAwO1xuXG5cdFx0dGhpcy5yZWdpc3Rlck1hcmtkb3duUG9zdFByb2Nlc3NvcigoZWxlbWVudCwgY29udGV4dCkgPT4ge1xuXHRcdFx0Y29uc3QgY29kZUJsb2NrcyA9IGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnY29kZScpO1xuXHRcdFx0Zm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGNvZGVCbG9ja3MubGVuZ3RoOyBpbmRleCsrKSB7XG5cdFx0XHRcdGNvbnN0IGNvZGVCbG9jayA9IGNvZGVCbG9ja3MuaXRlbShpbmRleCk7XG5cdFx0XHRcdGNvbnN0IHRleHQgPSBjb2RlQmxvY2suaW5uZXJUZXh0O1xuXHRcdFx0XHRjb25zdCBpc0lucHV0RmllbGQgPSB0ZXh0LnN0YXJ0c1dpdGgoJ0lOUFVUWycpICYmIHRleHQuZW5kc1dpdGgoJ10nKTtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coY29udGV4dC5zb3VyY2VQYXRoKTtcblx0XHRcdFx0aWYgKGlzSW5wdXRGaWVsZCkge1xuXHRcdFx0XHRcdGNvbnRleHQuYWRkQ2hpbGQobmV3IElucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkKFxuXHRcdFx0XHRcdFx0Y29kZUJsb2NrLFxuXHRcdFx0XHRcdFx0SW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGRUeXBlLklOTElORV9DT0RFX0JMT0NLLFxuXHRcdFx0XHRcdFx0dGV4dCwgdGhpcyxcblx0XHRcdFx0XHRcdGNvbnRleHQuc291cmNlUGF0aCxcblx0XHRcdFx0XHRcdHRoaXMubWFya0Rvd25JbnB1dEZpZWxkSW5kZXhcblx0XHRcdFx0XHQpKTtcblx0XHRcdFx0XHR0aGlzLm1hcmtEb3duSW5wdXRGaWVsZEluZGV4ICs9IDE7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMucmVnaXN0ZXJNYXJrZG93bkNvZGVCbG9ja1Byb2Nlc3NvcignbWV0YS1iaW5kJywgKHNvdXJjZSwgZWwsIGN0eCkgPT4ge1xuXHRcdFx0Y29uc3QgY29kZUJsb2NrID0gZWw7XG5cdFx0XHRjb25zdCB0ZXh0ID0gc291cmNlLnJlcGxhY2UoL1xcbi9nLCAnJyk7XG5cdFx0XHRjb25zdCBpc0lucHV0RmllbGQgPSB0ZXh0LnN0YXJ0c1dpdGgoJ0lOUFVUWycpICYmIHRleHQuZW5kc1dpdGgoJ10nKTtcblx0XHRcdC8vIGNvbnNvbGUubG9nKGNvbnRleHQuc291cmNlUGF0aCk7XG5cdFx0XHRpZiAoaXNJbnB1dEZpZWxkKSB7XG5cdFx0XHRcdGN0eC5hZGRDaGlsZChuZXcgSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQoXG5cdFx0XHRcdFx0Y29kZUJsb2NrLFxuXHRcdFx0XHRcdElucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkVHlwZS5DT0RFX0JMT0NLLFxuXHRcdFx0XHRcdHRleHQsXG5cdFx0XHRcdFx0dGhpcyxcblx0XHRcdFx0XHRjdHguc291cmNlUGF0aCxcblx0XHRcdFx0XHR0aGlzLm1hcmtEb3duSW5wdXRGaWVsZEluZGV4KSk7XG5cdFx0XHRcdHRoaXMubWFya0Rvd25JbnB1dEZpZWxkSW5kZXggKz0gMTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudCh0aGlzLmFwcC52YXVsdC5vbignbW9kaWZ5JywgYXN5bmMgYWJzdHJhY3RGaWxlID0+IHtcblx0XHRcdGlmIChhYnN0cmFjdEZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLnVwZGF0ZU1hcmtkb3duSW5wdXRGaWVsZHNPbkZpbGVDaGFuZ2UoYWJzdHJhY3RGaWxlKTtcblx0XHRcdH1cblx0XHR9KSk7XG5cblx0XHR0aGlzLmFkZFNldHRpbmdUYWIobmV3IE1ldGFCaW5kU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXHR9XG5cblx0b251bmxvYWQoKTogdm9pZCB7XG5cdFx0Zm9yIChjb25zdCBhY3RpdmVNYXJrZG93bklucHV0RmllbGQgb2YgdGhpcy5hY3RpdmVNYXJrZG93bklucHV0RmllbGRzKSB7XG5cdFx0XHRhY3RpdmVNYXJrZG93bklucHV0RmllbGQudW5sb2FkKCk7XG5cdFx0fVxuXHR9XG5cblx0cmVnaXN0ZXJJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZChpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZDogSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQpOiB2b2lkIHtcblx0XHR0aGlzLmFjdGl2ZU1hcmtkb3duSW5wdXRGaWVsZHMucHVzaChpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCk7XG5cdH1cblxuXHR1bnJlZ2lzdGVySW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQoaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQ6IElucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkKTogdm9pZCB7XG5cdFx0dGhpcy5hY3RpdmVNYXJrZG93bklucHV0RmllbGRzID0gdGhpcy5hY3RpdmVNYXJrZG93bklucHV0RmllbGRzLmZpbHRlcih4ID0+IHgudWlkICE9PSBpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZC51aWQpO1xuXHR9XG5cblx0YXN5bmMgdXBkYXRlTWFya2Rvd25JbnB1dEZpZWxkc09uRmlsZUNoYW5nZShmaWxlOiBURmlsZSk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGxldCBtZXRhZGF0YTogYW55ID0gdW5kZWZpbmVkO1xuXG5cdFx0Zm9yIChjb25zdCBhY3RpdmVNYXJrZG93bklucHV0RmllbGQgb2YgdGhpcy5hY3RpdmVNYXJrZG93bklucHV0RmllbGRzKSB7XG5cdFx0XHRpZiAoIWFjdGl2ZU1hcmtkb3duSW5wdXRGaWVsZC5pbnB1dEZpZWxkRGVjbGFyYXRpb24/LmlzQm91bmQgfHwgIWFjdGl2ZU1hcmtkb3duSW5wdXRGaWVsZC5iaW5kVGFyZ2V0RmlsZSB8fCAhYWN0aXZlTWFya2Rvd25JbnB1dEZpZWxkLmJpbmRUYXJnZXRNZXRhZGF0YUZpZWxkKSB7XG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoYWN0aXZlTWFya2Rvd25JbnB1dEZpZWxkLmJpbmRUYXJnZXRGaWxlLnBhdGggPT09IGZpbGUucGF0aCkge1xuXHRcdFx0XHRpZiAobWV0YWRhdGEgPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdG1ldGFkYXRhID0gYXdhaXQgdGhpcy5nZXRNZXRhRGF0YUZvckZpbGUoZmlsZSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0YWN0aXZlTWFya2Rvd25JbnB1dEZpZWxkLnVwZGF0ZVZhbHVlKG1ldGFkYXRhW2FjdGl2ZU1hcmtkb3duSW5wdXRGaWVsZC5iaW5kVGFyZ2V0TWV0YWRhdGFGaWVsZF0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGFzeW5jIHVwZGF0ZU1ldGFEYXRhKGtleTogc3RyaW5nLCB2YWx1ZTogYW55LCBmaWxlOiBURmlsZSk6IFByb21pc2U8dm9pZD4ge1xuXHRcdExvZ2dlci5sb2dEZWJ1ZyhgdXBkYXRpbmcgYCwga2V5LCBgOiBgLCB2YWx1ZSwgYCBpbiAnJHtmaWxlLnBhdGh9J2ApO1xuXG5cdFx0aWYgKCFmaWxlKSB7XG5cdFx0XHRjb25zb2xlLmxvZygnbm8gZmlsZScpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGxldCBmaWxlQ29udGVudDogc3RyaW5nID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcblxuXHRcdGNvbnN0IG1ldGFkYXRhOiBhbnkgPSBhd2FpdCB0aGlzLmdldE1ldGFEYXRhRm9yRmlsZUNvbnRlbnQoZmlsZUNvbnRlbnQpO1xuXHRcdC8vIGNvbnNvbGUubG9nKG1ldGFkYXRhKTtcblx0XHRpZiAoIW1ldGFkYXRhKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29uc3QgcmVnRXhwID0gbmV3IFJlZ0V4cCgnXigtLS0pXFxcXG5bXFxcXHNcXFxcU10qXFxcXG4tLS0nKTtcblx0XHRmaWxlQ29udGVudCA9IGZpbGVDb250ZW50LnJlcGxhY2UocmVnRXhwLCAnJyk7XG5cblx0XHRtZXRhZGF0YVtrZXldID0gdmFsdWU7XG5cdFx0Ly8gY29uc29sZS5sb2cobWV0YWRhdGEpO1xuXG5cdFx0ZmlsZUNvbnRlbnQgPSBgLS0tXFxuJHtzdHJpbmdpZnlZYW1sKG1ldGFkYXRhKX0tLS1gICsgZmlsZUNvbnRlbnQ7XG5cdFx0YXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIGZpbGVDb250ZW50KTtcblx0fVxuXG5cdGdldEZpbGVzQnlOYW1lKG5hbWU6IHN0cmluZyk6IFRGaWxlW10ge1xuXHRcdC8vIGNvbnNvbGUubG9nKGdldEZpbGVOYW1lKHJlbW92ZUZpbGVFbmRpbmcobmFtZSkpKVxuXHRcdGNvbnN0IGZpbGVOYW1lSXNQYXRoID0gaXNQYXRoKG5hbWUpO1xuXHRcdGNvbnN0IHByb2Nlc3NlZEZpbGVOYW1lID0gZmlsZU5hbWVJc1BhdGggPyByZW1vdmVGaWxlRW5kaW5nKG5hbWUpIDogZ2V0RmlsZU5hbWUocmVtb3ZlRmlsZUVuZGluZyhuYW1lKSk7XG5cblx0XHRjb25zdCBhbGxGaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcblx0XHRjb25zdCBmaWxlczogVEZpbGVbXSA9IFtdO1xuXHRcdGZvciAoY29uc3QgZmlsZSBvZiBhbGxGaWxlcykge1xuXHRcdFx0Ly8gY29uc29sZS5sb2cocmVtb3ZlRmlsZUVuZGluZyhmaWxlLnBhdGgpKTtcblx0XHRcdGlmIChmaWxlTmFtZUlzUGF0aCkge1xuXHRcdFx0XHRpZiAocmVtb3ZlRmlsZUVuZGluZyhmaWxlLnBhdGgpID09PSBwcm9jZXNzZWRGaWxlTmFtZSkge1xuXHRcdFx0XHRcdGZpbGVzLnB1c2goZmlsZSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmIChnZXRGaWxlTmFtZShyZW1vdmVGaWxlRW5kaW5nKGZpbGUubmFtZSkpID09PSBwcm9jZXNzZWRGaWxlTmFtZSkge1xuXHRcdFx0XHRcdGZpbGVzLnB1c2goZmlsZSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gZmlsZXM7XG5cdH1cblxuXHRhc3luYyBnZXRNZXRhRGF0YUZvckZpbGUoZmlsZTogVEZpbGUpOiBQcm9taXNlPGFueT4ge1xuXHRcdGlmICghZmlsZSkge1xuXHRcdFx0cmV0dXJuIHVuZGVmaW5lZDtcblx0XHR9XG5cblx0XHRjb25zdCBmaWxlQ29udGVudDogc3RyaW5nID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcblx0XHRyZXR1cm4gYXdhaXQgdGhpcy5nZXRNZXRhRGF0YUZvckZpbGVDb250ZW50KGZpbGVDb250ZW50KTtcblx0fVxuXG5cdGFzeW5jIGdldE1ldGFEYXRhRm9yRmlsZUNvbnRlbnQoZmlsZUNvbnRlbnQ6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG5cdFx0TG9nZ2VyLmxvZ0RlYnVnKGByZWFkaW5nIG1ldGFkYXRhYCk7XG5cdFx0bGV0IG1ldGFkYXRhOiBhbnk7XG5cblx0XHRjb25zdCByZWdFeHAgPSBuZXcgUmVnRXhwKCdeKC0tLSlcXFxcbltcXFxcc1xcXFxTXSpcXFxcbi0tLScpO1xuXHRcdGNvbnN0IGZyb250TWF0dGVyUmVnRXhwUmVzdWx0ID0gcmVnRXhwLmV4ZWMoZmlsZUNvbnRlbnQpO1xuXHRcdGlmICghZnJvbnRNYXR0ZXJSZWdFeHBSZXN1bHQpIHtcblx0XHRcdHJldHVybiB7fTtcblx0XHR9XG5cdFx0bGV0IGZyb250TWF0dGVyID0gZnJvbnRNYXR0ZXJSZWdFeHBSZXN1bHRbMF07XG5cdFx0aWYgKCFmcm9udE1hdHRlcikge1xuXHRcdFx0cmV0dXJuIHt9O1xuXHRcdH1cblx0XHQvLyBjb25zb2xlLmxvZyhmcm9udE1hdHRlcik7XG5cdFx0ZnJvbnRNYXR0ZXIgPSBmcm9udE1hdHRlci5zdWJzdHJpbmcoNCk7XG5cdFx0ZnJvbnRNYXR0ZXIgPSBmcm9udE1hdHRlci5zdWJzdHJpbmcoMCwgZnJvbnRNYXR0ZXIubGVuZ3RoIC0gMyk7XG5cdFx0Ly8gY29uc29sZS5sb2coZnJvbnRNYXR0ZXIpO1xuXG5cdFx0bWV0YWRhdGEgPSBwYXJzZVlhbWwoZnJvbnRNYXR0ZXIpO1xuXG5cdFx0aWYgKCFtZXRhZGF0YSkge1xuXHRcdFx0bWV0YWRhdGEgPSB7fTtcblx0XHR9XG5cblx0XHQvL2NvbnNvbGUubG9nKG1ldGFkYXRhKTtcblxuXHRcdHJldHVybiBtZXRhZGF0YTtcblx0fVxuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcblx0fVxuXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHREYXRlUGFyc2VyLmRhdGVGb3JtYXQgPSB0aGlzLnNldHRpbmdzLnByZWZlcnJlZERhdGVGb3JtYXQ7XG5cdFx0TG9nZ2VyLmRldk1vZGUgPSB0aGlzLnNldHRpbmdzLmRldk1vZGU7XG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcblx0fVxufVxuIiwgImltcG9ydCB7QXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTWV0YUJpbmRQbHVnaW4gZnJvbSAnLi4vbWFpbic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWV0YUJpbmRQbHVnaW5TZXR0aW5ncyB7XG5cdGRldk1vZGU6IGJvb2xlYW47XG5cdHByZWZlcnJlZERhdGVGb3JtYXQ6IHN0cmluZztcblx0dXNlVXNEYXRlSW5wdXRPcmRlcjogYm9vbGVhbjtcblx0c3luY0ludGVydmFsOiBudW1iZXI7XG5cdG1heFN5bmNJbnRlcnZhbDogbnVtYmVyO1xuXHRtaW5TeW5jSW50ZXJ2YWw6IG51bWJlcjtcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IE1ldGFCaW5kUGx1Z2luU2V0dGluZ3MgPSB7XG5cdGRldk1vZGU6IGZhbHNlLFxuXHRwcmVmZXJyZWREYXRlRm9ybWF0OiAnWVlZWS1NTS1ERCcsXG5cdHVzZVVzRGF0ZUlucHV0T3JkZXI6IGZhbHNlLFxuXHRzeW5jSW50ZXJ2YWw6IDIwMCxcblx0bWluU3luY0ludGVydmFsOiA1MCxcblx0bWF4U3luY0ludGVydmFsOiAxMDAwLFxufTtcblxuZXhwb3J0IGNsYXNzIE1ldGFCaW5kU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuXHRwbHVnaW46IE1ldGFCaW5kUGx1Z2luO1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IE1ldGFCaW5kUGx1Z2luKSB7XG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4pO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHR9XG5cblx0ZGlzcGxheSgpOiB2b2lkIHtcblx0XHRjb25zdCB7Y29udGFpbmVyRWx9ID0gdGhpcztcblxuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cblx0XHRjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7dGV4dDogJ01ldGEgQmluZCBQbHVnaW4gU2V0dGluZ3MnfSk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdTeW5jIGludGVydmFsJylcblx0XHRcdC5zZXREZXNjKGBUaGUgaW50ZXJ2YWwgaW4gbWlsbGktc2Vjb25kcyBiZXR3ZWVuIGRpc2sgd3JpdGVzLiBDaGFuZ2luZyB0aGlzIG51bWJlciBpcyBub3QgcmVjb21tZW5kZWQgZXhjZXB0IGlmIHlvdXIgaGFyZCBkcml2ZSBpcyBleGNlcHRpb25hbGx5IHNsb3cuIFN0YW5kYXJkOiAke0RFRkFVTFRfU0VUVElOR1Muc3luY0ludGVydmFsfTsgTWluaW11bTogJHtERUZBVUxUX1NFVFRJTkdTLm1pblN5bmNJbnRlcnZhbH07IE1heGltdW06ICR7REVGQVVMVF9TRVRUSU5HUy5tYXhTeW5jSW50ZXJ2YWx9YClcblx0XHRcdC5hZGRUZXh0KGNiID0+IHtcblx0XHRcdFx0Y2Iuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc3luY0ludGVydmFsLnRvU3RyaW5nKCkpO1xuXHRcdFx0XHRjYi5vbkNoYW5nZShkYXRhID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5zeW5jSW50ZXJ2YWwgPSBOdW1iZXIucGFyc2VJbnQoZGF0YSk7XG5cdFx0XHRcdFx0aWYgKE51bWJlci5pc05hTih0aGlzLnBsdWdpbi5zZXR0aW5ncy5zeW5jSW50ZXJ2YWwpKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5zeW5jSW50ZXJ2YWwgPSBERUZBVUxUX1NFVFRJTkdTLnN5bmNJbnRlcnZhbDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnN5bmNJbnRlcnZhbCA8IERFRkFVTFRfU0VUVElOR1MubWluU3luY0ludGVydmFsKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5zeW5jSW50ZXJ2YWwgPSBERUZBVUxUX1NFVFRJTkdTLm1pblN5bmNJbnRlcnZhbDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnN5bmNJbnRlcnZhbCA+IERFRkFVTFRfU0VUVElOR1MubWF4U3luY0ludGVydmFsKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5zeW5jSW50ZXJ2YWwgPSBERUZBVUxUX1NFVFRJTkdTLm1heFN5bmNJbnRlcnZhbDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcblx0XHRcdC5zZXROYW1lKCdEYXRlIGZvcm1hdCcpXG5cdFx0XHQuc2V0RGVzYyhgVGhlIGRhdGUgZm9ybWF0IHRvIGJlIHVzZWQgYnkgdGhpcyBwbHVnaW4uIENoYW5naW5nIHRoaXMgc2V0dGluZyB3aWxsIGJyZWFrIHRoZSBwYXJzaW5nIG9mIGV4aXN0aW5nIGRhdGUgaW5wdXRzLiBIZXJlIGlzIGEgbGlzdCBvZiBhbGwgYXZhaWxhYmxlIGRhdGUgdG9rZXMgaHR0cHM6Ly9tb21lbnRqcy5jb20vZG9jcy8jL2Rpc3BsYXlpbmcvLmApXG5cdFx0XHQuYWRkVGV4dChjYiA9PiB7XG5cdFx0XHRcdGNiLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnByZWZlcnJlZERhdGVGb3JtYXQpO1xuXHRcdFx0XHRjYi5vbkNoYW5nZShkYXRhID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcmVmZXJyZWREYXRlRm9ybWF0ID0gZGF0YTtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoJ1VzZSBVUyBkYXRlIGlucHV0IGZpZWxkIG9yZGVyJylcblx0XHRcdC5zZXREZXNjKGBXaGVuIGVuYWJsZWQgdGhlIG1vbnRoIGlucHV0IGlzIGJlZm9yZSB0aGUgZGF5IGlucHV0LmApXG5cdFx0XHQuYWRkVG9nZ2xlKGNiID0+IHtcblx0XHRcdFx0Y2Iuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlVXNEYXRlSW5wdXRPcmRlcik7XG5cdFx0XHRcdGNiLm9uQ2hhbmdlKGRhdGEgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZVVzRGF0ZUlucHV0T3JkZXIgPSBkYXRhO1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZSgnRGV2IE1vZGUnKVxuXHRcdFx0LnNldERlc2MoJ0VuYWJsZSBkZXYgbW9kZS4gTm90IHJlY29tbWVuZGVkIHVubGVzcyB5b3Ugd2FudCB0byBkZWJ1ZyB0aGlzIHBsdWdpbi4nKVxuXHRcdFx0LmFkZFRvZ2dsZShjYiA9PiB7XG5cdFx0XHRcdGNiLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRldk1vZGUpO1xuXHRcdFx0XHRjYi5vbkNoYW5nZShkYXRhID0+IHtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZXZNb2RlID0gZGF0YTtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0fVxufVxuIiwgImltcG9ydCB7TWFya2Rvd25SZW5kZXJDaGlsZCwgVEZpbGV9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBNZXRhQmluZFBsdWdpbiBmcm9tICcuL21haW4nO1xuaW1wb3J0IHtMb2dnZXJ9IGZyb20gJy4vdXRpbHMvTG9nZ2VyJztcbmltcG9ydCB7QWJzdHJhY3RJbnB1dEZpZWxkfSBmcm9tICcuL2lucHV0RmllbGRzL0Fic3RyYWN0SW5wdXRGaWVsZCc7XG5pbXBvcnQge0lucHV0RmllbGRGYWN0b3J5fSBmcm9tICcuL2lucHV0RmllbGRzL0lucHV0RmllbGRGYWN0b3J5JztcbmltcG9ydCB7SW5wdXRGaWVsZEFyZ3VtZW50LCBJbnB1dEZpZWxkRGVjbGFyYXRpb24sIElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlcn0gZnJvbSAnLi9wYXJzZXJzL0lucHV0RmllbGREZWNsYXJhdGlvblBhcnNlcic7XG5pbXBvcnQge01ldGFCaW5kQmluZFRhcmdldEVycm9yLCBNZXRhQmluZEludGVybmFsRXJyb3J9IGZyb20gJy4vdXRpbHMvVXRpbHMnO1xuXG5leHBvcnQgZW51bSBJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZFR5cGUge1xuXHRJTkxJTkVfQ09ERV9CTE9DSyxcblx0Q09ERV9CTE9DSyxcbn1cblxuZXhwb3J0IGNsYXNzIElucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkIGV4dGVuZHMgTWFya2Rvd25SZW5kZXJDaGlsZCB7XG5cdHBsdWdpbjogTWV0YUJpbmRQbHVnaW47XG5cdG1ldGFEYXRhOiBhbnk7XG5cdGZpbGVQYXRoOiBzdHJpbmc7XG5cdHVpZDogbnVtYmVyO1xuXHRpbnB1dEZpZWxkOiBBYnN0cmFjdElucHV0RmllbGQgfCB1bmRlZmluZWQ7XG5cdGVycm9yOiBzdHJpbmc7XG5cblx0aW5wdXRGaWVsZERlY2xhcmF0aW9uOiBJbnB1dEZpZWxkRGVjbGFyYXRpb24gfCB1bmRlZmluZWQ7XG5cdGJpbmRUYXJnZXRGaWxlOiBURmlsZSB8IHVuZGVmaW5lZDtcblx0YmluZFRhcmdldE1ldGFkYXRhRmllbGQ6IHN0cmluZyB8IHVuZGVmaW5lZDtcblxuXHRsaW1pdEludGVydmFsOiBudW1iZXIgfCB1bmRlZmluZWQ7XG5cdGludGVydmFsQ291bnRlcjogbnVtYmVyO1xuXHR2YWx1ZVF1ZXVlOiBhbnlbXTtcblxuXHRjb25zdHJ1Y3Rvcihjb250YWluZXJFbDogSFRNTEVsZW1lbnQsIHR5cGU6IElucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkVHlwZSwgZnVsbERlY2xhcmF0aW9uOiBzdHJpbmcsIHBsdWdpbjogTWV0YUJpbmRQbHVnaW4sIGZpbGVQYXRoOiBzdHJpbmcsIHVpZDogbnVtYmVyKSB7XG5cdFx0c3VwZXIoY29udGFpbmVyRWwpO1xuXG5cdFx0dGhpcy5lcnJvciA9ICcnO1xuXHRcdHRoaXMuZmlsZVBhdGggPSBmaWxlUGF0aDtcblx0XHR0aGlzLnVpZCA9IHVpZDtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblxuXHRcdHRoaXMudmFsdWVRdWV1ZSA9IFtdO1xuXHRcdHRoaXMuaW50ZXJ2YWxDb3VudGVyID0gMDtcblxuXHRcdHRyeSB7XG5cdFx0XHR0aGlzLmlucHV0RmllbGREZWNsYXJhdGlvbiA9IElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlci5wYXJzZShmdWxsRGVjbGFyYXRpb24pO1xuXG5cdFx0XHRpZiAodGhpcy5pbnB1dEZpZWxkRGVjbGFyYXRpb24uaXNCb3VuZCkge1xuXHRcdFx0XHR0aGlzLnBhcnNlQmluZFRhcmdldCgpO1xuXHRcdFx0XHQvLyBAdHMtaWdub3JlIGBwYXJzZUJpbmRUYXJnZXRgIHNldHMgYGJpbmRUYXJnZXRGaWxlYCBhbmQgYGJpbmRUYXJnZXRNZXRhZGF0YUZpZWxkYCBvciB0aHJvd3MgYW4gZXJyb3IuXG5cdFx0XHRcdHRoaXMubWV0YURhdGEgPSB0aGlzLnBsdWdpbi5nZXRNZXRhRGF0YUZvckZpbGUodGhpcy5iaW5kVGFyZ2V0RmlsZSk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuaW5wdXRGaWVsZCA9IElucHV0RmllbGRGYWN0b3J5LmNyZWF0ZUlucHV0RmllbGQodGhpcy5pbnB1dEZpZWxkRGVjbGFyYXRpb24uaW5wdXRGaWVsZFR5cGUsIHtcblx0XHRcdFx0dHlwZTogdHlwZSxcblx0XHRcdFx0aW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQ6IHRoaXMsXG5cdFx0XHRcdG9uVmFsdWVDaGFuZ2VkOiB0aGlzLnB1c2hUb1ZhbHVlUXVldWUuYmluZCh0aGlzKSxcblx0XHRcdH0pO1xuXG5cdFx0XHR0aGlzLmxpbWl0SW50ZXJ2YWwgPSB3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4gdGhpcy5hcHBseVZhbHVlUXVldWVUb01ldGFkYXRhKCksIHRoaXMucGx1Z2luLnNldHRpbmdzLnN5bmNJbnRlcnZhbCk7XG5cdFx0fSBjYXRjaCAoZTogYW55KSB7XG5cdFx0XHR0aGlzLmVycm9yID0gZS5tZXNzYWdlO1xuXHRcdFx0TG9nZ2VyLmxvZ1dhcm5pbmcoZSk7XG5cdFx0fVxuXHR9XG5cblx0cGFyc2VCaW5kVGFyZ2V0KCk6IHZvaWQge1xuXHRcdGlmICghdGhpcy5pbnB1dEZpZWxkRGVjbGFyYXRpb24pIHtcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ2lucHV0RmllbGREZWNsYXJhdGlvbiBpcyB1bmRlZmluZWQsIGNhbiBub3QgcGFyc2UgYmluZCB0YXJnZXQnKTtcblx0XHR9XG5cblx0XHRjb25zdCBiaW5kVGFyZ2V0UGFydHMgPSB0aGlzLmlucHV0RmllbGREZWNsYXJhdGlvbi5iaW5kVGFyZ2V0LnNwbGl0KCcjJyk7XG5cblx0XHRpZiAoYmluZFRhcmdldFBhcnRzLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0Ly8gdGhlIGJpbmQgdGFyZ2V0IGlzIGluIHRoZSBzYW1lIGZpbGVcblx0XHRcdHRoaXMuYmluZFRhcmdldE1ldGFkYXRhRmllbGQgPSB0aGlzLmlucHV0RmllbGREZWNsYXJhdGlvbi5iaW5kVGFyZ2V0O1xuXG5cdFx0XHRjb25zdCBmaWxlczogVEZpbGVbXSA9IHRoaXMucGx1Z2luLmdldEZpbGVzQnlOYW1lKHRoaXMuZmlsZVBhdGgpO1xuXHRcdFx0aWYgKGZpbGVzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRCaW5kVGFyZ2V0RXJyb3IoJ2JpbmQgdGFyZ2V0IGZpbGUgbm90IGZvdW5kJyk7XG5cdFx0XHR9IGVsc2UgaWYgKGZpbGVzLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0XHR0aGlzLmJpbmRUYXJnZXRGaWxlID0gZmlsZXNbMF07XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRCaW5kVGFyZ2V0RXJyb3IoJ2JpbmQgdGFyZ2V0IHJlc29sdmVzIHRvIG11bHRpcGxlIGZpbGVzLCBwbGVhc2UgYWxzbyBzcGVjaWZ5IHRoZSBmaWxlIHBhdGgnKTtcblx0XHRcdH1cblx0XHR9IGVsc2UgaWYgKGJpbmRUYXJnZXRQYXJ0cy5sZW5ndGggPT09IDIpIHtcblx0XHRcdC8vIHRoZSBiaW5kIHRhcmdldCBpcyBpbiBhbm90aGVyIGZpbGVcblx0XHRcdHRoaXMuYmluZFRhcmdldE1ldGFkYXRhRmllbGQgPSBiaW5kVGFyZ2V0UGFydHNbMV07XG5cblx0XHRcdGNvbnN0IGZpbGVzOiBURmlsZVtdID0gdGhpcy5wbHVnaW4uZ2V0RmlsZXNCeU5hbWUoYmluZFRhcmdldFBhcnRzWzBdKTtcblx0XHRcdGlmIChmaWxlcy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kQmluZFRhcmdldEVycm9yKCdiaW5kIHRhcmdldCBmaWxlIG5vdCBmb3VuZCcpO1xuXHRcdFx0fSBlbHNlIGlmIChmaWxlcy5sZW5ndGggPT09IDEpIHtcblx0XHRcdFx0dGhpcy5iaW5kVGFyZ2V0RmlsZSA9IGZpbGVzWzBdO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kQmluZFRhcmdldEVycm9yKCdiaW5kIHRhcmdldCByZXNvbHZlcyB0byBtdWx0aXBsZSBmaWxlcywgcGxlYXNlIGFsc28gc3BlY2lmeSB0aGUgZmlsZSBwYXRoJyk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEJpbmRUYXJnZXRFcnJvcignYmluZCB0YXJnZXQgbWF5IG9ubHkgY29udGFpbiBvbmUgXFwnI1xcJyB0byBzcGVjaWZ5IHRoZSBtZXRhZGF0YSBmaWVsZCcpO1xuXHRcdH1cblx0fVxuXG5cdC8vIHVzZSB0aGlzIGludGVydmFsIHRvIHJlZHVjZSB3cml0aW5nIG9wZXJhdGlvbnNcblx0YXN5bmMgYXBwbHlWYWx1ZVF1ZXVlVG9NZXRhZGF0YSgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAoIXRoaXMuaW5wdXRGaWVsZERlY2xhcmF0aW9uKSB7XG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCdpbnB1dEZpZWxkRGVjbGFyYXRpb24gaXMgdW5kZWZpbmVkLCBjYW4gbm90IHVwZGF0ZSBtZXRhZGF0YScpO1xuXHRcdH1cblx0XHRpZiAoIXRoaXMuaW5wdXRGaWVsZERlY2xhcmF0aW9uLmlzQm91bmQpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0aWYgKCF0aGlzLmJpbmRUYXJnZXRNZXRhZGF0YUZpZWxkIHx8ICF0aGlzLmJpbmRUYXJnZXRGaWxlKSB7XG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCdiaW5kVGFyZ2V0TWV0YWRhdGFGaWVsZCBvciBiaW5kVGFyZ2V0RmlsZSBpcyB1bmRlZmluZWQsIGNhbiBub3QgdXBkYXRlIG1ldGFkYXRhJyk7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMudmFsdWVRdWV1ZS5sZW5ndGggPiAwKSB7XG5cdFx0XHQvLyBjb25zb2xlLmxvZyh0aGlzLnZhbHVlUXVldWUuYXQoLTEpKVxuXHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4udXBkYXRlTWV0YURhdGEodGhpcy5iaW5kVGFyZ2V0TWV0YWRhdGFGaWVsZCwgdGhpcy52YWx1ZVF1ZXVlLmF0KC0xKSwgdGhpcy5iaW5kVGFyZ2V0RmlsZSk7XG5cdFx0XHR0aGlzLnZhbHVlUXVldWUgPSBbXTtcblx0XHR9XG5cdH1cblxuXHRhc3luYyBwdXNoVG9WYWx1ZVF1ZXVlKHZhbHVlOiBhbnkpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAodGhpcy5pbnB1dEZpZWxkRGVjbGFyYXRpb24/LmlzQm91bmQpIHtcblx0XHRcdHRoaXMudmFsdWVRdWV1ZS5wdXNoKHZhbHVlKTtcblx0XHR9XG5cdH1cblxuXHR1cGRhdGVWYWx1ZSh2YWx1ZTogYW55KTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLmlucHV0RmllbGQpIHtcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ2lucHV0RmllbGQgaXMgdW5kZWZpbmVkLCBjYW4gbm90IHVwZGF0ZSB2YWx1ZScpO1xuXHRcdH1cblxuXHRcdGlmICh2YWx1ZSA9PSBudWxsKSB7XG5cdFx0XHR2YWx1ZSA9IHRoaXMuaW5wdXRGaWVsZC5nZXREZWZhdWx0VmFsdWUoKTtcblx0XHR9XG5cblx0XHRpZiAoIXRoaXMuaW5wdXRGaWVsZC5pc0VxdWFsVmFsdWUodmFsdWUpICYmIHRoaXMudmFsdWVRdWV1ZS5sZW5ndGggPT09IDApIHtcblx0XHRcdExvZ2dlci5sb2dEZWJ1ZyhgdXBkYXRpbmcgaW5wdXQgZmllbGQgJHt0aGlzLnVpZH0gdG9gLCB2YWx1ZSk7XG5cdFx0XHR0aGlzLmlucHV0RmllbGQuc2V0VmFsdWUodmFsdWUpO1xuXHRcdH1cblx0fVxuXG5cdGdldEluaXRpYWxWYWx1ZSgpOiBhbnkgfCB1bmRlZmluZWQge1xuXHRcdGlmICh0aGlzLmlucHV0RmllbGREZWNsYXJhdGlvbj8uaXNCb3VuZCkge1xuXHRcdFx0cmV0dXJuIHRoaXMubWV0YURhdGFbdGhpcy5iaW5kVGFyZ2V0TWV0YWRhdGFGaWVsZCA/PyAnJ10gPz8gdGhpcy5pbnB1dEZpZWxkPy5nZXREZWZhdWx0VmFsdWUoKTtcblx0XHR9XG5cdH1cblxuXHRnZXRBcmd1bWVudHMobmFtZTogc3RyaW5nKTogSW5wdXRGaWVsZEFyZ3VtZW50W10ge1xuXHRcdGlmICghdGhpcy5pbnB1dEZpZWxkRGVjbGFyYXRpb24pIHtcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ2lucHV0RmllbGREZWNsYXJhdGlvbiBpcyB1bmRlZmluZWQsIGNhbiBub3QgcmV0cmlldmUgYXJndW1lbnRzJyk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXMuaW5wdXRGaWVsZERlY2xhcmF0aW9uLmFyZ3VtZW50cy5maWx0ZXIoeCA9PiB4Lm5hbWUgPT09IG5hbWUpO1xuXHR9XG5cblx0Z2V0QXJndW1lbnQobmFtZTogc3RyaW5nKTogSW5wdXRGaWVsZEFyZ3VtZW50IHwgdW5kZWZpbmVkIHtcblx0XHRyZXR1cm4gdGhpcy5nZXRBcmd1bWVudHMobmFtZSkuYXQoMCk7XG5cdH1cblxuXHRhc3luYyBvbmxvYWQoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0TG9nZ2VyLmxvZ0RlYnVnKCdsb2FkJywgdGhpcyk7XG5cblx0XHR0aGlzLm1ldGFEYXRhID0gYXdhaXQgdGhpcy5tZXRhRGF0YTtcblxuXHRcdGNvbnN0IGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQgPSB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZURpdigpO1xuXHRcdGNvbnRhaW5lci5hZGRDbGFzcygnbWV0YS1iaW5kLXBsdWdpbi1pbnB1dC13cmFwcGVyJyk7XG5cdFx0dGhpcy5jb250YWluZXJFbC5hZGRDbGFzcygnbWV0YS1iaW5kLXBsdWdpbi1pbnB1dCcpO1xuXG5cdFx0aWYgKHRoaXMuZXJyb3IpIHtcblx0XHRcdGNvbnRhaW5lci5pbm5lclRleHQgPSBgIC0+IEVSUk9SOiAke3RoaXMuZXJyb3J9YDtcblx0XHRcdGNvbnRhaW5lci5hZGRDbGFzcygnbWV0YS1iaW5kLXBsdWdpbi1lcnJvcicpO1xuXHRcdFx0dGhpcy5jb250YWluZXJFbC5hcHBlbmRDaGlsZChjb250YWluZXIpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGlmICghdGhpcy5pbnB1dEZpZWxkKSB7XG5cdFx0XHRjb250YWluZXIuaW5uZXJUZXh0ID0gYCAtPiBFUlJPUjogJHsobmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcignaW5wdXQgZmllbGQgaXMgdW5kZWZpbmVkIGFuZCBlcnJvciBpcyBlbXB0eScpLm1lc3NhZ2UpfWA7XG5cdFx0XHRjb250YWluZXIuYWRkQ2xhc3MoJ21ldGEtYmluZC1wbHVnaW4tZXJyb3InKTtcblx0XHRcdHRoaXMuY29udGFpbmVyRWwuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlcklucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkKHRoaXMpO1xuXG5cdFx0dGhpcy5pbnB1dEZpZWxkLnJlbmRlcihjb250YWluZXIpO1xuXG5cdFx0Y29uc3QgY2xhc3NBcmd1bWVudCA9IHRoaXMuZ2V0QXJndW1lbnRzKCdjbGFzcycpO1xuXHRcdGlmIChjbGFzc0FyZ3VtZW50KSB7XG5cdFx0XHR0aGlzLmlucHV0RmllbGQuZ2V0SHRtbEVsZW1lbnQoKS5hZGRDbGFzc2VzKGNsYXNzQXJndW1lbnQubWFwKHggPT4geC52YWx1ZSkpO1xuXHRcdH1cblxuXG5cdFx0dGhpcy5jb250YWluZXJFbC5lbXB0eSgpO1xuXHRcdHRoaXMuY29udGFpbmVyRWwuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcblx0fVxuXG5cdG9udW5sb2FkKCk6IHZvaWQge1xuXHRcdExvZ2dlci5sb2dEZWJ1ZygndW5sb2FkJywgdGhpcyk7XG5cblx0XHR0aGlzLnBsdWdpbi51bnJlZ2lzdGVySW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQodGhpcyk7XG5cblx0XHRzdXBlci5vbnVubG9hZCgpO1xuXG5cdFx0Ly9jb25zb2xlLmxvZygndW5sb2FkJywgdGhpcyk7XG5cdFx0d2luZG93LmNsZWFySW50ZXJ2YWwodGhpcy5saW1pdEludGVydmFsKTtcblx0fVxufVxuIiwgImV4cG9ydCBjbGFzcyBMb2dnZXIge1xyXG5cdHN0YXRpYyBkZXZNb2RlOiBib29sZWFuO1xyXG5cdHN0YXRpYyBwcmVmaXg6IHN0cmluZyA9ICdtZXRhLWJpbmQgfCc7XHJcblxyXG5cdC8qKlxyXG5cdCAqIExvZ3MgdG8gdGhlIGNvbnNvbGUgd2l0aCB0aGUgcGx1Z2luIHByZWZpeFxyXG5cdCAqXHJcblx0ICogQHBhcmFtIGRhdGFcclxuXHQgKi9cclxuXHRzdGF0aWMgbG9nKC4uLmRhdGE6IGFueSk6IHZvaWQge1xyXG5cdFx0Y29uc29sZS5sb2codGhpcy5wcmVmaXgsIC4uLmRhdGEpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogTG9ncyB0byB0aGUgY29uc29sZSB3aXRoIHRoZSBwbHVnaW4gcHJlZml4LCBpZiBkZXYgbW9kZSBpcyB0dXJuZWQgb24gaW4gdGhlIHBsdWdpbiBzZXR0aW5nc1xyXG5cdCAqXHJcblx0ICogQHBhcmFtIGRhdGFcclxuXHQgKi9cclxuXHRzdGF0aWMgbG9nRGVidWcoLi4uZGF0YTogYW55KTogdm9pZCB7XHJcblx0XHRpZiAodGhpcy5kZXZNb2RlKSB7XHJcblx0XHRcdExvZ2dlci5sb2coLi4uZGF0YSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBMb2dzIGEgd2FybmluZyB0byB0aGUgY29uc29sZSB3aXRoIHRoZSBwbHVnaW4gcHJlZml4XHJcblx0ICpcclxuXHQgKiBAcGFyYW0gZGF0YVxyXG5cdCAqL1xyXG5cdHN0YXRpYyBsb2dXYXJuaW5nKC4uLmRhdGE6IGFueSk6IHZvaWQge1xyXG5cdFx0Y29uc29sZS53YXJuKHRoaXMucHJlZml4LCBkYXRhKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIExvZ3MgYW4gZXJyb3IgdG8gdGhlIGNvbnNvbGUgd2l0aCB0aGUgcGx1Z2luIHByZWZpeFxyXG5cdCAqXHJcblx0ICogQHBhcmFtIGRhdGFcclxuXHQgKi9cclxuXHRzdGF0aWMgbG9nRXJyb3IoLi4uZGF0YTogYW55KTogdm9pZCB7XHJcblx0XHRjb25zb2xlLmVycm9yKHRoaXMucHJlZml4LCBkYXRhKTtcclxuXHR9XHJcbn1cclxuIiwgImltcG9ydCB7SW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGR9IGZyb20gJy4uL0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkJztcclxuXHJcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdElucHV0RmllbGQge1xyXG5cdHN0YXRpYyBhbGxvd0NvZGVCbG9jazogYm9vbGVhbiA9IHRydWU7XHJcblx0c3RhdGljIGFsbG93SW5saW5lQ29kZUJsb2NrOiBib29sZWFuID0gdHJ1ZTtcclxuXHRpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZDogSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQ7XHJcblx0b25WYWx1ZUNoYW5nZTogKHZhbHVlOiBhbnkpID0+IHZvaWQgfCBQcm9taXNlPHZvaWQ+O1xyXG5cclxuXHRjb25zdHJ1Y3RvcihpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZDogSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQsIG9uVmFsdWVDaGFuZ2U6ICh2YWx1ZTogYW55KSA9PiB2b2lkIHwgUHJvbWlzZTx2b2lkPikge1xyXG5cdFx0dGhpcy5pbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCA9IGlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkO1xyXG5cdFx0dGhpcy5vblZhbHVlQ2hhbmdlID0gb25WYWx1ZUNoYW5nZTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFJldHVybnMgdGhlIGN1cnJlbnQgY29udGVudCBvZiB0aGUgaW5wdXQgZmllbGRcclxuXHQgKi9cclxuXHRhYnN0cmFjdCBnZXRWYWx1ZSgpOiBhbnk7XHJcblxyXG5cdC8qKlxyXG5cdCAqIFNldHMgdGhlIHZhbHVlIG9uIHRoaXMgaW5wdXQgZmllbGQsIG92ZXJyaWRpbmcgdGhlIGN1cnJlbnQgY29udGVudFxyXG5cdCAqXHJcblx0ICogQHBhcmFtIHZhbHVlXHJcblx0ICovXHJcblx0YWJzdHJhY3Qgc2V0VmFsdWUodmFsdWU6IGFueSk6IHZvaWQ7XHJcblxyXG5cdC8qKlxyXG5cdCAqIENoZWNrcyBpZiB0aGUgdmFsdWUgaXMgdGhlIHNhbWUgYXMgdGhlIHZhbHVlIG9mIHRoaXMgaW5wdXQgZmllbGRcclxuXHQgKlxyXG5cdCAqIEBwYXJhbSB2YWx1ZVxyXG5cdCAqL1xyXG5cdGFic3RyYWN0IGlzRXF1YWxWYWx1ZSh2YWx1ZTogYW55KTogYm9vbGVhbjtcclxuXHJcblx0LyoqXHJcblx0ICogUmV0dXJucyB0aGUgZGVmYXVsdCB2YWx1ZSBvZiB0aGlzIGlucHV0IGZpZWxkXHJcblx0ICovXHJcblx0YWJzdHJhY3QgZ2V0RGVmYXVsdFZhbHVlKCk6IGFueTtcclxuXHJcblx0LyoqXHJcblx0ICogUmV0dXJucyB0aGUgSFRNTCBlbGVtZW50IHRoaXMgaW5wdXQgZmllbGQgaXMgd3JhcHBlZCBpblxyXG5cdCAqL1xyXG5cdGFic3RyYWN0IGdldEh0bWxFbGVtZW50KCk6IEhUTUxFbGVtZW50O1xyXG5cclxuXHQvKipcclxuXHQgKiBSZW5kZXJzIHRoZSBpbnB1dCBmaWVsZCBhcyBhIGNoaWxkIG9mIHRoZSBjb250YWluZXJcclxuXHQgKlxyXG5cdCAqIEBwYXJhbSBjb250YWluZXJcclxuXHQgKi9cclxuXHRhYnN0cmFjdCByZW5kZXIoY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQ7XHJcbn1cclxuIiwgImltcG9ydCB7QWJzdHJhY3RJbnB1dEZpZWxkfSBmcm9tICcuL0Fic3RyYWN0SW5wdXRGaWVsZCc7XHJcbmltcG9ydCB7VG9nZ2xlQ29tcG9uZW50fSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7TG9nZ2VyfSBmcm9tICcuLi91dGlscy9Mb2dnZXInO1xyXG5pbXBvcnQge01ldGFCaW5kSW50ZXJuYWxFcnJvcn0gZnJvbSAnLi4vdXRpbHMvVXRpbHMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFRvZ2dsZUlucHV0RmllbGQgZXh0ZW5kcyBBYnN0cmFjdElucHV0RmllbGQge1xyXG5cdHRvZ2dsZUNvbXBvbmVudDogVG9nZ2xlQ29tcG9uZW50IHwgdW5kZWZpbmVkO1xyXG5cclxuXHRnZXRWYWx1ZSgpOiBhbnkge1xyXG5cdFx0aWYgKCF0aGlzLnRvZ2dsZUNvbXBvbmVudCkge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCd0b2dnbGUgaW5wdXQgY29tcG9uZW50IGlzIHVuZGVmaW5lZCcpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRoaXMudG9nZ2xlQ29tcG9uZW50LmdldFZhbHVlKCk7XHJcblx0fVxyXG5cclxuXHRzZXRWYWx1ZSh2YWx1ZTogYW55KTogdm9pZCB7XHJcblx0XHRpZiAoIXRoaXMudG9nZ2xlQ29tcG9uZW50KSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ3RvZ2dsZSBpbnB1dCBjb21wb25lbnQgaXMgdW5kZWZpbmVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHZhbHVlICE9IG51bGwgJiYgdHlwZW9mIHZhbHVlID09ICdib29sZWFuJykge1xyXG5cdFx0XHR0aGlzLnRvZ2dsZUNvbXBvbmVudC5zZXRWYWx1ZSh2YWx1ZSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRMb2dnZXIubG9nV2FybmluZyhgY2FuIG5vdCBzZXQgdmFsdWUgb2YgdG9nZ2xlIHRvIFxcJyR7dmFsdWV9XFwnYCk7XHJcblx0XHRcdHRoaXMudG9nZ2xlQ29tcG9uZW50LnNldFZhbHVlKGZhbHNlKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGlzRXF1YWxWYWx1ZSh2YWx1ZTogYW55KTogYm9vbGVhbiB7XHJcblx0XHRyZXR1cm4gdGhpcy5nZXRWYWx1ZSgpID09IHZhbHVlO1xyXG5cdH1cclxuXHJcblx0Z2V0RGVmYXVsdFZhbHVlKCk6IGJvb2xlYW4ge1xyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH1cclxuXHJcblx0Z2V0SHRtbEVsZW1lbnQoKTogSFRNTEVsZW1lbnQge1xyXG5cdFx0aWYgKCF0aGlzLnRvZ2dsZUNvbXBvbmVudCkge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCd0b2dnbGUgaW5wdXQgY29tcG9uZW50IGlzIHVuZGVmaW5lZCcpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzLnRvZ2dsZUNvbXBvbmVudC50b2dnbGVFbDtcclxuXHR9XHJcblxyXG5cdHJlbmRlcihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XHJcblx0XHRjb25zdCBjb21wb25lbnQgPSBuZXcgVG9nZ2xlQ29tcG9uZW50KGNvbnRhaW5lcik7XHJcblx0XHRjb21wb25lbnQuc2V0VmFsdWUodGhpcy5pbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZC5nZXRJbml0aWFsVmFsdWUoKSk7XHJcblx0XHRjb21wb25lbnQub25DaGFuZ2UodGhpcy5vblZhbHVlQ2hhbmdlKTtcclxuXHRcdHRoaXMudG9nZ2xlQ29tcG9uZW50ID0gY29tcG9uZW50O1xyXG5cdH1cclxuXHJcbn1cclxuIiwgImV4cG9ydCBjbGFzcyBNZXRhQmluZEludGVybmFsRXJyb3IgZXh0ZW5kcyBFcnJvciB7XHJcblx0Y29uc3RydWN0b3IobWVzc2FnZTogc3RyaW5nKSB7XHJcblx0XHRzdXBlcihgW01CX0lOVEVSTkFMX0VSUk9SIC0gcGxlYXNlIHJlcG9ydCB0aGlzIGVycm9yIGhlcmUgaHR0cHM6Ly9naXRodWIuY29tL21Qcm9qZWN0c0NvZGUvb2JzaWRpYW4tbWV0YS1iaW5kLXBsdWdpbi9pc3N1ZXNdICR7bWVzc2FnZX1gKTtcclxuXHR9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBNZXRhQmluZFBhcnNpbmdFcnJvciBleHRlbmRzIEVycm9yIHtcclxuXHRjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcpIHtcclxuXHRcdHN1cGVyKGBbTUJfUEFSU0lOR19FUlJPUl0gJHttZXNzYWdlfWApO1xyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIE1ldGFCaW5kQmluZFRhcmdldEVycm9yIGV4dGVuZHMgRXJyb3Ige1xyXG5cdGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZykge1xyXG5cdFx0c3VwZXIoYFtNQl9CSU5EX1RBUkdFVF9FUlJPUl0gJHttZXNzYWdlfWApO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEdldHMgdGhlIGZpbGUgbmFtZSBmcm9tIGEgcGF0aFxyXG4gKlxyXG4gKiBAcGFyYW0gcGF0aFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEZpbGVOYW1lKHBhdGg6IHN0cmluZyk6IHN0cmluZyB7XHJcblx0cmV0dXJuIHBhdGguc3BsaXQoJy8nKS5hdCgtMSkgPz8gcGF0aDtcclxufVxyXG5cclxuLyoqXHJcbiAqIENoZWNrcyBpZiBhIHBhdGggaXMgYSBwYXRoIG9yIGEgZmlsZSBuYW1lXHJcbiAqXHJcbiAqIEBwYXJhbSBwYXRoXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gaXNQYXRoKHBhdGg6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG5cdHJldHVybiBwYXRoLnNwbGl0KCcvJykubGVuZ3RoID4gMTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFJlbW92ZXMgdGhlIGZpbGUgZW5kaW5nIG9mIGEgZmlsZSBuYW1lXHJcbiAqXHJcbiAqIEBwYXJhbSBmaWxlTmFtZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUZpbGVFbmRpbmcoZmlsZU5hbWU6IHN0cmluZyk6IHN0cmluZyB7XHJcblx0Y29uc3QgZmlsZU5hbWVQYXJ0cyA9IGZpbGVOYW1lLnNwbGl0KCcuJyk7XHJcblx0aWYgKGZpbGVOYW1lUGFydHMubGVuZ3RoID09PSAxKSB7XHJcblx0XHRyZXR1cm4gZmlsZU5hbWU7XHJcblx0fSBlbHNlIHtcclxuXHRcdGxldCBuZXdGaWxlTmFtZSA9IGZpbGVOYW1lUGFydHNbMF07XHJcblx0XHRmb3IgKGxldCBpID0gMTsgaSA8IGZpbGVOYW1lUGFydHMubGVuZ3RoIC0gMTsgaSsrKSB7XHJcblx0XHRcdG5ld0ZpbGVOYW1lICs9ICcuJyArIGZpbGVOYW1lUGFydHNbaV07XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gbmV3RmlsZU5hbWU7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogQ2xhbXAsIHVudXNlZFxyXG4gKlxyXG4gKiBAcGFyYW0gbnVtXHJcbiAqIEBwYXJhbSBtaW5cclxuICogQHBhcmFtIG1heFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNsYW1wKG51bTogbnVtYmVyLCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIpOiBudW1iZXIge1xyXG5cdHJldHVybiBNYXRoLm1pbihNYXRoLm1heChudW0sIG1pbiksIG1heCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBqcyBjYW4ndCBldmVuIGltcGxlbWVudCBtb2R1bG8gY29ycmVjdGx5Li4uXHJcbiAqXHJcbiAqIEBwYXJhbSBuXHJcbiAqIEBwYXJhbSBtXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gbW9kKG46IG51bWJlciwgbTogbnVtYmVyKTogbnVtYmVyIHtcclxuXHRyZXR1cm4gKChuICUgbSkgKyBtKSAlIG07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDaGVja3MgaWYgMiBhcnJheXMgYXJlIGVxdWFsLCB0aGUgYXJyYXlzIHNob3VsZCBoYXZlIHRoZSBzYW1lIGRhdGF0eXBlXHJcbiAqXHJcbiAqIEBwYXJhbSBhcnIxXHJcbiAqIEBwYXJhbSBhcnIyXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gYXJyYXlFcXVhbHMoYXJyMTogYW55W10sIGFycjI6IGFueVtdKTogYm9vbGVhbiB7XHJcblx0aWYgKGFycjEubGVuZ3RoICE9PSBhcnIyLmxlbmd0aCkge1xyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH1cclxuXHJcblx0Zm9yIChjb25zdCBhcnIxRWxlbWVudCBvZiBhcnIxKSB7XHJcblx0XHRpZiAoIWFycjIuY29udGFpbnMoYXJyMUVsZW1lbnQpKSB7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHJldHVybiB0cnVlO1xyXG59XHJcblxyXG4vKipcclxuICogVGVtcGxhdGUgXCJlbmdpbmVcIiBmcm9tIG15IG1lZGlhIGRiIHBsdWdpblxyXG4gKlxyXG4gKiBAcGFyYW0gdGVtcGxhdGVcclxuICogQHBhcmFtIGRhdGFNb2RlbFxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHJlcGxhY2VUYWdzKHRlbXBsYXRlOiBzdHJpbmcsIGRhdGFNb2RlbDogYW55KTogc3RyaW5nIHtcclxuXHRjb25zdCByZXNvbHZlZFRlbXBsYXRlID0gdGVtcGxhdGUucmVwbGFjZShuZXcgUmVnRXhwKCd7ey4qP319JywgJ2cnKSwgKG1hdGNoOiBzdHJpbmcpID0+IHJlcGxhY2VUYWcobWF0Y2gsIGRhdGFNb2RlbCkpO1xyXG5cclxuXHRyZXR1cm4gcmVzb2x2ZWRUZW1wbGF0ZTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFRha2VzIGluIGEgdGVtcGxhdGUgbWF0Y2ggYW5kIHJldHVybnMgdGhlIHJlcGxhY2VtZW50IGRhdGFcclxuICpcclxuICogQHBhcmFtIG1hdGNoXHJcbiAqIEBwYXJhbSBkYXRhTW9kZWxcclxuICovXHJcbmZ1bmN0aW9uIHJlcGxhY2VUYWcobWF0Y2g6IHN0cmluZywgZGF0YU1vZGVsOiBhbnkpOiBzdHJpbmcge1xyXG5cdGxldCB0YWcgPSBtYXRjaDtcclxuXHR0YWcgPSB0YWcuc3Vic3RyaW5nKDIpO1xyXG5cdHRhZyA9IHRhZy5zdWJzdHJpbmcoMCwgdGFnLmxlbmd0aCAtIDIpO1xyXG5cdHRhZyA9IHRhZy50cmltKCk7XHJcblxyXG5cdGNvbnN0IHBhcnRzID0gdGFnLnNwbGl0KCc6Jyk7XHJcblx0aWYgKHBhcnRzLmxlbmd0aCA9PT0gMSkge1xyXG5cdFx0Y29uc3QgcGF0aCA9IHBhcnRzWzBdLnNwbGl0KCcuJyk7XHJcblxyXG5cdFx0Y29uc3Qgb2JqID0gdHJhdmVyc2VPYmplY3QocGF0aCwgZGF0YU1vZGVsKTtcclxuXHJcblx0XHRpZiAob2JqID09PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0cmV0dXJuICd7eyBJTlZBTElEIFRFTVBMQVRFIFRBRyAtIG9iamVjdCB1bmRlZmluZWQgfX0nO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBvYmo7XHJcblx0fSBlbHNlIGlmIChwYXJ0cy5sZW5ndGggPT09IDIpIHtcclxuXHRcdGNvbnN0IG9wZXJhdG9yID0gcGFydHNbMF07XHJcblxyXG5cdFx0Y29uc3QgcGF0aCA9IHBhcnRzWzFdLnNwbGl0KCcuJyk7XHJcblxyXG5cdFx0Y29uc3Qgb2JqID0gdHJhdmVyc2VPYmplY3QocGF0aCwgZGF0YU1vZGVsKTtcclxuXHJcblx0XHRpZiAob2JqID09PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0cmV0dXJuICd7eyBJTlZBTElEIFRFTVBMQVRFIFRBRyAtIG9iamVjdCB1bmRlZmluZWQgfX0nO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChvcGVyYXRvciA9PT0gJ0xJU1QnKSB7XHJcblx0XHRcdGlmICghQXJyYXkuaXNBcnJheShvYmopKSB7XHJcblx0XHRcdFx0cmV0dXJuICd7eyBJTlZBTElEIFRFTVBMQVRFIFRBRyAtIG9wZXJhdG9yIExJU1QgaXMgb25seSBhcHBsaWNhYmxlIG9uIGFuIGFycmF5IH19JztcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gb2JqLm1hcCgoZTogYW55KSA9PiBgLSAke2V9YCkuam9pbignXFxuJyk7XHJcblx0XHR9IGVsc2UgaWYgKG9wZXJhdG9yID09PSAnRU5VTScpIHtcclxuXHRcdFx0aWYgKCFBcnJheS5pc0FycmF5KG9iaikpIHtcclxuXHRcdFx0XHRyZXR1cm4gJ3t7IElOVkFMSUQgVEVNUExBVEUgVEFHIC0gb3BlcmF0b3IgRU5VTSBpcyBvbmx5IGFwcGxpY2FibGUgb24gYW4gYXJyYXkgfX0nO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiBvYmouam9pbignLCAnKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gYHt7IElOVkFMSUQgVEVNUExBVEUgVEFHIC0gdW5rbm93biBvcGVyYXRvciAke29wZXJhdG9yfSB9fWA7XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gJ3t7IElOVkFMSUQgVEVNUExBVEUgVEFHIH19JztcclxufVxyXG5cclxuLyoqXHJcbiAqIFRyYXZlcnNlcyB0aGUgb2JqZWN0IGFsb25nIGEgcHJvcGVydHkgcGF0aFxyXG4gKlxyXG4gKiBAcGFyYW0gcGF0aFxyXG4gKiBAcGFyYW0gb2JqXHJcbiAqL1xyXG5mdW5jdGlvbiB0cmF2ZXJzZU9iamVjdChwYXRoOiBBcnJheTxzdHJpbmc+LCBvYmo6IGFueSk6IGFueSB7XHJcblx0Zm9yIChjb25zdCBwYXJ0IG9mIHBhdGgpIHtcclxuXHRcdGlmIChvYmogIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRvYmogPSBvYmpbcGFydF07XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gb2JqO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNUcnV0aHkodmFsdWU6IGFueSk6IGJvb2xlYW4ge1xyXG5cdHJldHVybiAhIXZhbHVlO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNGYWxzeSh2YWx1ZTogYW55KTogYm9vbGVhbiB7XHJcblx0cmV0dXJuICF2YWx1ZTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGVxdWFsT3JJbmNsdWRlcyhzdHIxOiBzdHJpbmcsIHN0cjI6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG5cdHJldHVybiBzdHIxID09PSBzdHIyIHx8IHN0cjEuaW5jbHVkZXMoc3RyMikgfHwgc3RyMi5pbmNsdWRlcyhzdHIxKTtcclxufVxyXG4iLCAiaW1wb3J0IHtBYnN0cmFjdElucHV0RmllbGR9IGZyb20gJy4vQWJzdHJhY3RJbnB1dEZpZWxkJztcclxuaW1wb3J0IHtUZXh0Q29tcG9uZW50fSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7TG9nZ2VyfSBmcm9tICcuLi91dGlscy9Mb2dnZXInO1xyXG5pbXBvcnQge01ldGFCaW5kSW50ZXJuYWxFcnJvcn0gZnJvbSAnLi4vdXRpbHMvVXRpbHMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFRleHRJbnB1dEZpZWxkIGV4dGVuZHMgQWJzdHJhY3RJbnB1dEZpZWxkIHtcclxuXHR0ZXh0Q29tcG9uZW50OiBUZXh0Q29tcG9uZW50IHwgdW5kZWZpbmVkO1xyXG5cclxuXHRnZXRWYWx1ZSgpOiBhbnkge1xyXG5cdFx0aWYgKCF0aGlzLnRleHRDb21wb25lbnQpIHtcclxuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcigndGV4dCBpbnB1dCBjb21wb25lbnQgaXMgdW5kZWZpbmVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMudGV4dENvbXBvbmVudC5nZXRWYWx1ZSgpO1xyXG5cdH1cclxuXHJcblx0c2V0VmFsdWUodmFsdWU6IGFueSk6IHZvaWQge1xyXG5cdFx0aWYgKCF0aGlzLnRleHRDb21wb25lbnQpIHtcclxuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcigndGV4dCBpbnB1dCBjb21wb25lbnQgaXMgdW5kZWZpbmVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHZhbHVlICE9IG51bGwgJiYgdHlwZW9mIHZhbHVlID09ICdzdHJpbmcnKSB7XHJcblx0XHRcdHRoaXMudGV4dENvbXBvbmVudC5zZXRWYWx1ZSh2YWx1ZSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRMb2dnZXIubG9nV2FybmluZyhgY2FuIG5vdCBzZXQgdmFsdWUgb2YgdGV4dCBpbnB1dCB0byBcXCcke3ZhbHVlfVxcJ2ApO1xyXG5cdFx0XHR0aGlzLnRleHRDb21wb25lbnQuc2V0VmFsdWUoJycpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0aXNFcXVhbFZhbHVlKHZhbHVlOiBhbnkpOiBib29sZWFuIHtcclxuXHRcdHJldHVybiB0aGlzLmdldFZhbHVlKCkgPT0gdmFsdWU7XHJcblx0fVxyXG5cclxuXHRnZXREZWZhdWx0VmFsdWUoKTogYW55IHtcclxuXHRcdHJldHVybiAnJztcclxuXHR9XHJcblxyXG5cdGdldEh0bWxFbGVtZW50KCk6IEhUTUxFbGVtZW50IHtcclxuXHRcdGlmICghdGhpcy50ZXh0Q29tcG9uZW50KSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ3RleHQgaW5wdXQgY29tcG9uZW50IGlzIHVuZGVmaW5lZCcpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzLnRleHRDb21wb25lbnQuaW5wdXRFbDtcclxuXHR9XHJcblxyXG5cdHJlbmRlcihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XHJcblx0XHRjb25zdCBjb21wb25lbnQgPSBuZXcgVGV4dENvbXBvbmVudChjb250YWluZXIpO1xyXG5cdFx0Y29tcG9uZW50LnNldFZhbHVlKHRoaXMuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQuZ2V0SW5pdGlhbFZhbHVlKCkpO1xyXG5cdFx0Y29tcG9uZW50Lm9uQ2hhbmdlKHRoaXMub25WYWx1ZUNoYW5nZSk7XHJcblx0XHR0aGlzLnRleHRDb21wb25lbnQgPSBjb21wb25lbnQ7XHJcblx0fVxyXG5cclxufVxyXG4iLCAiaW1wb3J0IHtBYnN0cmFjdElucHV0RmllbGR9IGZyb20gJy4vQWJzdHJhY3RJbnB1dEZpZWxkJztcclxuaW1wb3J0IHtTbGlkZXJDb21wb25lbnR9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHtMb2dnZXJ9IGZyb20gJy4uL3V0aWxzL0xvZ2dlcic7XHJcbmltcG9ydCB7SW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGR9IGZyb20gJy4uL0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkJztcclxuaW1wb3J0IHtNZXRhQmluZEludGVybmFsRXJyb3J9IGZyb20gJy4uL3V0aWxzL1V0aWxzJztcclxuXHJcbmV4cG9ydCBjbGFzcyBTbGlkZXJJbnB1dEZpZWxkIGV4dGVuZHMgQWJzdHJhY3RJbnB1dEZpZWxkIHtcclxuXHRzbGlkZXJDb21wb25lbnQ6IFNsaWRlckNvbXBvbmVudCB8IHVuZGVmaW5lZDtcclxuXHRtaW5WYWx1ZTogbnVtYmVyO1xyXG5cdG1heFZhbHVlOiBudW1iZXI7XHJcblxyXG5cclxuXHRjb25zdHJ1Y3RvcihpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZDogSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQsIG9uVmFsdWVDaGFuZ2U6ICh2YWx1ZTogYW55KSA9PiAodm9pZCB8IFByb21pc2U8dm9pZD4pKSB7XHJcblx0XHRzdXBlcihpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCwgb25WYWx1ZUNoYW5nZSk7XHJcblx0XHR0aGlzLm1pblZhbHVlID0gaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQuZ2V0QXJndW1lbnQoJ21pblZhbHVlJyk/LnZhbHVlID8/IDA7XHJcblx0XHR0aGlzLm1heFZhbHVlID0gaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQuZ2V0QXJndW1lbnQoJ21heFZhbHVlJyk/LnZhbHVlID8/IDEwMDtcclxuXHR9XHJcblxyXG5cdGdldFZhbHVlKCk6IGFueSB7XHJcblx0XHRpZiAoIXRoaXMuc2xpZGVyQ29tcG9uZW50KSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ3NsaWRlciBpbnB1dCBjb21wb25lbnQgaXMgdW5kZWZpbmVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMuc2xpZGVyQ29tcG9uZW50LmdldFZhbHVlKCk7XHJcblx0fVxyXG5cclxuXHRzZXRWYWx1ZSh2YWx1ZTogYW55KTogdm9pZCB7XHJcblx0XHRpZiAoIXRoaXMuc2xpZGVyQ29tcG9uZW50KSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ3NsaWRlciBpbnB1dCBjb21wb25lbnQgaXMgdW5kZWZpbmVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHZhbHVlICE9IG51bGwgJiYgdHlwZW9mIHZhbHVlID09ICdudW1iZXInKSB7XHJcblx0XHRcdGlmICh2YWx1ZSA+PSB0aGlzLm1pblZhbHVlICYmIHZhbHVlIDw9IHRoaXMubWF4VmFsdWUpIHtcclxuXHRcdFx0XHR0aGlzLnNsaWRlckNvbXBvbmVudC5zZXRWYWx1ZSh2YWx1ZSk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdExvZ2dlci5sb2dXYXJuaW5nKGBjYW4gbm90IHNldCB2YWx1ZSBvZiBzbGlkZXIgdG8gXFwnJHt2YWx1ZX1cXCdgKTtcclxuXHRcdFx0dGhpcy5zbGlkZXJDb21wb25lbnQuc2V0VmFsdWUodGhpcy5nZXREZWZhdWx0VmFsdWUoKSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRpc0VxdWFsVmFsdWUodmFsdWU6IGFueSk6IGJvb2xlYW4ge1xyXG5cdFx0cmV0dXJuIHRoaXMuZ2V0VmFsdWUoKSA9PSB2YWx1ZTtcclxuXHR9XHJcblxyXG5cdGdldERlZmF1bHRWYWx1ZSgpOiBhbnkge1xyXG5cdFx0cmV0dXJuIHRoaXMubWluVmFsdWU7XHJcblx0fVxyXG5cclxuXHRnZXRIdG1sRWxlbWVudCgpOiBIVE1MRWxlbWVudCB7XHJcblx0XHRpZiAoIXRoaXMuc2xpZGVyQ29tcG9uZW50KSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ3NsaWRlciBpbnB1dCBjb21wb25lbnQgaXMgdW5kZWZpbmVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMuc2xpZGVyQ29tcG9uZW50LnNsaWRlckVsO1xyXG5cdH1cclxuXHJcblx0cmVuZGVyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcclxuXHRcdGNvbnRhaW5lci5yZW1vdmVDbGFzcygnbWV0YS1iaW5kLXBsdWdpbi1pbnB1dC13cmFwcGVyJyk7XHJcblx0XHRjb250YWluZXIuYWRkQ2xhc3MoJ21ldGEtYmluZC1wbHVnaW4tZmxleC1pbnB1dC13cmFwcGVyJyk7XHJcblxyXG5cdFx0Y29uc3QgbGFiZWxBcmd1bWVudCA9IHRoaXMuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQuZ2V0QXJndW1lbnQoJ2xhYmVscycpO1xyXG5cdFx0aWYgKGxhYmVsQXJndW1lbnQgJiYgbGFiZWxBcmd1bWVudC52YWx1ZSA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRjb250YWluZXIuY3JlYXRlU3Bhbih7dGV4dDogdGhpcy5taW5WYWx1ZS50b1N0cmluZygpLCBjbHM6ICdtZXRhLWJpbmQtcGx1Z2luLXNsaWRlci1pbnB1dC1sYWJlbCd9KTtcclxuXHRcdH1cclxuXHJcblx0XHRjb25zdCBjb21wb25lbnQgPSBuZXcgU2xpZGVyQ29tcG9uZW50KGNvbnRhaW5lcik7XHJcblx0XHRjb21wb25lbnQuc2V0VmFsdWUodGhpcy5pbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZC5nZXRJbml0aWFsVmFsdWUoKSk7XHJcblx0XHRjb21wb25lbnQub25DaGFuZ2UodGhpcy5vblZhbHVlQ2hhbmdlKTtcclxuXHRcdGNvbXBvbmVudC5zZXREeW5hbWljVG9vbHRpcCgpO1xyXG5cdFx0Y29tcG9uZW50LnNldExpbWl0cyh0aGlzLm1pblZhbHVlLCB0aGlzLm1heFZhbHVlLCAxKTtcclxuXHRcdGNvbXBvbmVudC5zbGlkZXJFbC5hZGRDbGFzcygnbWV0YS1iaW5kLXBsdWdpbi1zbGlkZXItaW5wdXQnKTtcclxuXHJcblx0XHRpZiAobGFiZWxBcmd1bWVudCAmJiBsYWJlbEFyZ3VtZW50LnZhbHVlID09PSB0cnVlKSB7XHJcblx0XHRcdGNvbnRhaW5lci5jcmVhdGVTcGFuKHt0ZXh0OiB0aGlzLm1heFZhbHVlLnRvU3RyaW5nKCksIGNsczogJ21ldGEtYmluZC1wbHVnaW4tc2xpZGVyLWlucHV0LWxhYmVsJ30pO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuc2xpZGVyQ29tcG9uZW50ID0gY29tcG9uZW50O1xyXG5cdH1cclxuXHJcbn1cclxuIiwgImltcG9ydCB7QWJzdHJhY3RJbnB1dEZpZWxkfSBmcm9tICcuL0Fic3RyYWN0SW5wdXRGaWVsZCc7XHJcbmltcG9ydCB7VGV4dEFyZWFDb21wb25lbnR9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHtMb2dnZXJ9IGZyb20gJy4uL3V0aWxzL0xvZ2dlcic7XHJcbmltcG9ydCB7TWV0YUJpbmRJbnRlcm5hbEVycm9yfSBmcm9tICcuLi91dGlscy9VdGlscyc7XHJcblxyXG5leHBvcnQgY2xhc3MgVGV4dEFyZWFJbnB1dEZpZWxkIGV4dGVuZHMgQWJzdHJhY3RJbnB1dEZpZWxkIHtcclxuXHR0ZXh0QXJlYUNvbXBvbmVudDogVGV4dEFyZWFDb21wb25lbnQgfCB1bmRlZmluZWQ7XHJcblxyXG5cdGdldFZhbHVlKCk6IGFueSB7XHJcblx0XHRpZiAoIXRoaXMudGV4dEFyZWFDb21wb25lbnQpIHtcclxuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcigndGV4dCBhcmVhIGlucHV0IGNvbXBvbmVudCBpcyB1bmRlZmluZWQnKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcy50ZXh0QXJlYUNvbXBvbmVudC5nZXRWYWx1ZSgpO1xyXG5cdH1cclxuXHJcblx0c2V0VmFsdWUodmFsdWU6IGFueSk6IHZvaWQge1xyXG5cdFx0aWYgKCF0aGlzLnRleHRBcmVhQ29tcG9uZW50KSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ3RleHQgYXJlYSBpbnB1dCBjb21wb25lbnQgaXMgdW5kZWZpbmVkJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHZhbHVlICE9IG51bGwgJiYgdHlwZW9mIHZhbHVlID09ICdzdHJpbmcnKSB7XHJcblx0XHRcdHRoaXMudGV4dEFyZWFDb21wb25lbnQuc2V0VmFsdWUodmFsdWUpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0TG9nZ2VyLmxvZ1dhcm5pbmcoYGNhbiBub3Qgc2V0IHZhbHVlIG9mIHRleHQgYXJlYSBpbnB1dCB0byBcXCcke3ZhbHVlfVxcJ2ApO1xyXG5cdFx0XHR0aGlzLnRleHRBcmVhQ29tcG9uZW50LnNldFZhbHVlKCcnKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGlzRXF1YWxWYWx1ZSh2YWx1ZTogYW55KTogYm9vbGVhbiB7XHJcblx0XHRyZXR1cm4gdGhpcy5nZXRWYWx1ZSgpID09IHZhbHVlO1xyXG5cdH1cclxuXHJcblx0Z2V0RGVmYXVsdFZhbHVlKCk6IGFueSB7XHJcblx0XHRyZXR1cm4gJyc7XHJcblx0fVxyXG5cclxuXHRnZXRIdG1sRWxlbWVudCgpOiBIVE1MRWxlbWVudCB7XHJcblx0XHRpZiAoIXRoaXMudGV4dEFyZWFDb21wb25lbnQpIHtcclxuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcigndGV4dCBhcmVhIGlucHV0IGNvbXBvbmVudCBpcyB1bmRlZmluZWQnKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcy50ZXh0QXJlYUNvbXBvbmVudC5pbnB1dEVsO1xyXG5cdH1cclxuXHJcblx0cmVuZGVyKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcclxuXHRcdGNvbnN0IGNvbXBvbmVudCA9IG5ldyBUZXh0QXJlYUNvbXBvbmVudChjb250YWluZXIpO1xyXG5cdFx0Y29tcG9uZW50LnNldFZhbHVlKHRoaXMuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQuZ2V0SW5pdGlhbFZhbHVlKCkpO1xyXG5cdFx0Y29tcG9uZW50Lm9uQ2hhbmdlKHRoaXMub25WYWx1ZUNoYW5nZSk7XHJcblx0XHR0aGlzLnRleHRBcmVhQ29tcG9uZW50ID0gY29tcG9uZW50O1xyXG5cdH1cclxuXHJcbn1cclxuIiwgImltcG9ydCB7U2VsZWN0SW5wdXRGaWVsZH0gZnJvbSAnLi9TZWxlY3RJbnB1dEZpZWxkJztcclxuXHJcbmV4cG9ydCBjbGFzcyBTZWxlY3RJbnB1dEZpZWxkRWxlbWVudCB7XHJcblx0dmFsdWU6IHN0cmluZztcclxuXHRzZWxlY3RJbnB1dEZpZWxkOiBTZWxlY3RJbnB1dEZpZWxkO1xyXG5cdHJlYWRvbmx5IGlkOiBudW1iZXI7XHJcblx0ZWxlbWVudDogSFRNTERpdkVsZW1lbnQ7XHJcblxyXG5cdGNzc0NsYXNzOiBzdHJpbmc7XHJcblx0YWN0aXZlQ2xhc3M6IHN0cmluZztcclxuXHRob3ZlckNsYXNzOiBzdHJpbmc7XHJcblxyXG5cdHByaXZhdGUgYWN0aXZlOiBib29sZWFuO1xyXG5cdHByaXZhdGUgaGlnaGxpZ2h0ZWQ6IGJvb2xlYW47XHJcblxyXG5cdGNvbnN0cnVjdG9yKHZhbHVlOiBzdHJpbmcsIHBhcmVudEVsZW1lbnQ6IEhUTUxFbGVtZW50LCBpZDogbnVtYmVyLCBtdWx0aVNlbGVjdElucHV0RmllbGQ6IFNlbGVjdElucHV0RmllbGQsIGFjdGl2ZTogYm9vbGVhbiA9IGZhbHNlKSB7XHJcblx0XHR0aGlzLnZhbHVlID0gdmFsdWU7XHJcblx0XHR0aGlzLmlkID0gaWQ7XHJcblx0XHR0aGlzLmFjdGl2ZSA9IGFjdGl2ZTtcclxuXHRcdHRoaXMuaGlnaGxpZ2h0ZWQgPSBmYWxzZTtcclxuXHRcdHRoaXMuc2VsZWN0SW5wdXRGaWVsZCA9IG11bHRpU2VsZWN0SW5wdXRGaWVsZDtcclxuXHJcblx0XHR0aGlzLmNzc0NsYXNzID0gJ21ldGEtYmluZC1wbHVnaW4tc2VsZWN0LWlucHV0LWVsZW1lbnQnO1xyXG5cdFx0dGhpcy5hY3RpdmVDbGFzcyA9ICdtZXRhLWJpbmQtcGx1Z2luLXNlbGVjdC1pbnB1dC1lbGVtZW50LXNlbGVjdGVkJztcclxuXHRcdHRoaXMuaG92ZXJDbGFzcyA9ICdtZXRhLWJpbmQtcGx1Z2luLXNlbGVjdC1pbnB1dC1lbGVtZW50LWhvdmVyJztcclxuXHJcblx0XHR0aGlzLmVsZW1lbnQgPSBwYXJlbnRFbGVtZW50LmNyZWF0ZURpdih7Y2xzOiB0aGlzLmNzc0NsYXNzfSk7XHJcblx0XHR0aGlzLmVsZW1lbnQuaWQgPSB0aGlzLmdldEhUTUxJZCgpO1xyXG5cdFx0dGhpcy5lbGVtZW50Lm9uKCdjbGljaycsICcjJyArIHRoaXMuZ2V0SFRNTElkKCksICgpID0+IHtcclxuXHRcdFx0dGhpcy5zZXRBY3RpdmUoIXRoaXMuYWN0aXZlKTtcclxuXHRcdFx0aWYgKCF0aGlzLnNlbGVjdElucHV0RmllbGQuYWxsb3dNdWx0aVNlbGVjdCkge1xyXG5cdFx0XHRcdHRoaXMuc2VsZWN0SW5wdXRGaWVsZC5kaXNhYmxlQWxsT3RoZXJFbGVtZW50cyh0aGlzLmlkKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHR0aGlzLmVsZW1lbnQub24oJ21vdXNlZW50ZXInLCAnIycgKyB0aGlzLmdldEhUTUxJZCgpLCAoKSA9PiB7XHJcblx0XHRcdHRoaXMuc2V0SGlnaGxpZ2h0ZWQodHJ1ZSk7XHJcblx0XHR9KTtcclxuXHRcdHRoaXMuZWxlbWVudC5vbignbW91c2VsZWF2ZScsICcjJyArIHRoaXMuZ2V0SFRNTElkKCksICgpID0+IHtcclxuXHRcdFx0dGhpcy5zZXRIaWdobGlnaHRlZChmYWxzZSk7XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdGdldEhUTUxJZCgpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIGBtZXRhLWJpbmQtc2VsZWN0LWlucHV0LWVsZW1lbnQtJHt0aGlzLnNlbGVjdElucHV0RmllbGQuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQudWlkfS0ke3RoaXMuaWR9YDtcclxuXHR9XHJcblxyXG5cdGlzSGlnaGxpZ2h0ZWQoKTogYm9vbGVhbiB7XHJcblx0XHRyZXR1cm4gdGhpcy5oaWdobGlnaHRlZDtcclxuXHR9XHJcblxyXG5cdHNldEhpZ2hsaWdodGVkKHZhbHVlOiBib29sZWFuKTogdm9pZCB7XHJcblx0XHR0aGlzLmhpZ2hsaWdodGVkID0gdmFsdWU7XHJcblx0XHRpZiAodGhpcy5oaWdobGlnaHRlZCkge1xyXG5cdFx0XHR0aGlzLmFkZENsYXNzKHRoaXMuaG92ZXJDbGFzcyk7XHJcblx0XHRcdHRoaXMuc2VsZWN0SW5wdXRGaWVsZC5kZUhpZ2hsaWdodEFsbE90aGVyRWxlbWVudHModGhpcy5pZCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLnJlbW92ZUNsYXNzKHRoaXMuaG92ZXJDbGFzcyk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRpc0FjdGl2ZSgpOiBib29sZWFuIHtcclxuXHRcdHJldHVybiB0aGlzLmFjdGl2ZTtcclxuXHR9XHJcblxyXG5cdHNldEFjdGl2ZShhY3RpdmU6IGJvb2xlYW4sIHVwZGF0ZVBhcmVudDogYm9vbGVhbiA9IHRydWUpOiB2b2lkIHtcclxuXHRcdHRoaXMuYWN0aXZlID0gYWN0aXZlO1xyXG5cdFx0dGhpcy51cGRhdGUodXBkYXRlUGFyZW50KTtcclxuXHR9XHJcblxyXG5cdHVwZGF0ZSh1cGRhdGVQYXJlbnQ6IGJvb2xlYW4pOiB2b2lkIHtcclxuXHRcdGlmICh0aGlzLmFjdGl2ZSkge1xyXG5cdFx0XHR0aGlzLmFkZENsYXNzKHRoaXMuYWN0aXZlQ2xhc3MpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhpcy5yZW1vdmVDbGFzcyh0aGlzLmFjdGl2ZUNsYXNzKTtcclxuXHRcdH1cclxuXHRcdGlmICh1cGRhdGVQYXJlbnQpIHtcclxuXHRcdFx0dGhpcy5zZWxlY3RJbnB1dEZpZWxkLm9uQ2hhbmdlKCk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRhZGRDbGFzcyhjc3NDbGFzczogc3RyaW5nKTogdm9pZCB7XHJcblx0XHRpZiAoIXRoaXMuZWxlbWVudC5oYXNDbGFzcyhjc3NDbGFzcykpIHtcclxuXHRcdFx0dGhpcy5lbGVtZW50LmFkZENsYXNzKGNzc0NsYXNzKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHJlbW92ZUNsYXNzKGNzc0NsYXNzOiBzdHJpbmcpOiB2b2lkIHtcclxuXHRcdGlmICh0aGlzLmVsZW1lbnQuaGFzQ2xhc3MoY3NzQ2xhc3MpKSB7XHJcblx0XHRcdHRoaXMuZWxlbWVudC5yZW1vdmVDbGFzcyhjc3NDbGFzcyk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRyZW5kZXIoKTogdm9pZCB7XHJcblx0XHR0aGlzLmVsZW1lbnQuY3JlYXRlRWwoJ2RpdicsIHt0ZXh0OiB0aGlzLnZhbHVlfSk7XHJcblx0fVxyXG59XHJcbiIsICJpbXBvcnQge0Fic3RyYWN0SW5wdXRGaWVsZH0gZnJvbSAnLi9BYnN0cmFjdElucHV0RmllbGQnO1xyXG5pbXBvcnQge1NlbGVjdElucHV0RmllbGRFbGVtZW50fSBmcm9tICcuL1NlbGVjdElucHV0RmllbGRFbGVtZW50JztcclxuaW1wb3J0IHtNZXRhQmluZEludGVybmFsRXJyb3IsIG1vZH0gZnJvbSAnLi4vdXRpbHMvVXRpbHMnO1xyXG5pbXBvcnQge0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkfSBmcm9tICcuLi9JbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCc7XHJcblxyXG5leHBvcnQgY2xhc3MgU2VsZWN0SW5wdXRGaWVsZCBleHRlbmRzIEFic3RyYWN0SW5wdXRGaWVsZCB7XHJcblx0c3RhdGljIGFsbG93SW5saW5lQ29kZUJsb2NrOiBib29sZWFuID0gZmFsc2U7XHJcblx0ZWxlbWVudHM6IFNlbGVjdElucHV0RmllbGRFbGVtZW50W107XHJcblx0YWxsb3dNdWx0aVNlbGVjdDogYm9vbGVhbjtcclxuXHRjb250YWluZXI6IEhUTUxEaXZFbGVtZW50IHwgdW5kZWZpbmVkO1xyXG5cclxuXHRjb25zdHJ1Y3RvcihpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZDogSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQsIG9uVmFsdWVDaGFuZ2U6ICh2YWx1ZTogYW55KSA9PiAodm9pZCB8IFByb21pc2U8dm9pZD4pKSB7XHJcblx0XHRzdXBlcihpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCwgb25WYWx1ZUNoYW5nZSk7XHJcblx0XHR0aGlzLmVsZW1lbnRzID0gW107XHJcblx0XHR0aGlzLmFsbG93TXVsdGlTZWxlY3QgPSBmYWxzZTtcclxuXHR9XHJcblxyXG5cdGdldEh0bWxFbGVtZW50KCk6IEhUTUxFbGVtZW50IHtcclxuXHRcdGlmICghdGhpcy5jb250YWluZXIpIHtcclxuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcignc2VsZWN0IGlucHV0IGNvbnRhaW5lciBpcyB1bmRlZmluZWQnKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcy5jb250YWluZXI7XHJcblx0fVxyXG5cclxuXHRnZXRWYWx1ZSgpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIHRoaXMuZWxlbWVudHMuZmlsdGVyKHggPT4geC5pc0FjdGl2ZSgpKS5maXJzdCgpPy52YWx1ZSA/PyAnJztcclxuXHR9XHJcblxyXG5cdHNldFZhbHVlKHZhbHVlOiBhbnkpOiB2b2lkIHtcclxuXHRcdGZvciAoY29uc3QgZWxlbWVudCBvZiB0aGlzLmVsZW1lbnRzKSB7XHJcblx0XHRcdGlmICh2YWx1ZSA9PT0gZWxlbWVudC52YWx1ZSkge1xyXG5cdFx0XHRcdGVsZW1lbnQuc2V0QWN0aXZlKHRydWUsIGZhbHNlKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRlbGVtZW50LnNldEFjdGl2ZShmYWxzZSwgZmFsc2UpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRpc0VxdWFsVmFsdWUodmFsdWU6IGFueSk6IGJvb2xlYW4ge1xyXG5cdFx0cmV0dXJuIHRoaXMuZ2V0VmFsdWUoKSA9PSB2YWx1ZTtcclxuXHR9XHJcblxyXG5cdGdldERlZmF1bHRWYWx1ZSgpOiBhbnkge1xyXG5cdFx0cmV0dXJuICcnO1xyXG5cdH1cclxuXHJcblx0b25DaGFuZ2UoKTogdm9pZCB7XHJcblx0XHR0aGlzLm9uVmFsdWVDaGFuZ2UodGhpcy5nZXRWYWx1ZSgpKTtcclxuXHR9XHJcblxyXG5cdHJlbmRlcihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XHJcblx0XHRjb250YWluZXIuYWRkQ2xhc3MoJ21ldGEtYmluZC1wbHVnaW4tc2VsZWN0LWlucHV0LWJnJyk7XHJcblx0XHR0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcclxuXHJcblx0XHRjb25zdCBlbGVtZW50V3JhcHBlciA9IGNvbnRhaW5lci5jcmVhdGVEaXYoe2NsczogJ21ldGEtYmluZC1wbHVnaW4tc2VsZWN0LWlucHV0LXdyYXBwZXInfSk7XHJcblxyXG5cdFx0Y29uc3QgdGl0bGVBcmd1bWVudCA9IHRoaXMuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQuZ2V0QXJndW1lbnQoJ3RpdGxlJyk7XHJcblx0XHRpZiAodGl0bGVBcmd1bWVudCkge1xyXG5cdFx0XHRlbGVtZW50V3JhcHBlci5jcmVhdGVFbCgnZGl2Jywge3RleHQ6IHRpdGxlQXJndW1lbnQudmFsdWUsIGNsczogJ21ldGEtYmluZC1wbHVnaW4tc2VsZWN0LWlucHV0LWhlYWRlcid9KTtcclxuXHRcdH1cclxuXHJcblx0XHRjb25zdCBlbGVtZW50QXJndW1lbnRzOiB7IG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZyB9W10gPSB0aGlzLmlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLmdldEFyZ3VtZW50cygnb3B0aW9uJyk7XHJcblxyXG5cdFx0bGV0IGkgPSAwO1xyXG5cdFx0Zm9yIChjb25zdCBlbGVtZW50QXJndW1lbnQgb2YgZWxlbWVudEFyZ3VtZW50cykge1xyXG5cdFx0XHRjb25zdCBzZWxlY3RJbnB1dEZpZWxkRWxlbWVudCA9IG5ldyBTZWxlY3RJbnB1dEZpZWxkRWxlbWVudChlbGVtZW50QXJndW1lbnQudmFsdWUsIGVsZW1lbnRXcmFwcGVyLCBpLCB0aGlzLCBmYWxzZSk7XHJcblxyXG5cdFx0XHR0aGlzLmVsZW1lbnRzLnB1c2goc2VsZWN0SW5wdXRGaWVsZEVsZW1lbnQpO1xyXG5cclxuXHRcdFx0c2VsZWN0SW5wdXRGaWVsZEVsZW1lbnQucmVuZGVyKCk7XHJcblxyXG5cdFx0XHRpICs9IDE7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5zZXRWYWx1ZSh0aGlzLmlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLmdldEluaXRpYWxWYWx1ZSgpKTtcclxuXHR9XHJcblxyXG5cdGRpc2FibGVBbGxPdGhlckVsZW1lbnRzKGVsZW1lbnRJZDogbnVtYmVyKTogdm9pZCB7XHJcblx0XHRmb3IgKGNvbnN0IHNlbGVjdE1vZGFsRWxlbWVudCBvZiB0aGlzLmVsZW1lbnRzKSB7XHJcblx0XHRcdGlmIChzZWxlY3RNb2RhbEVsZW1lbnQuaWQgIT09IGVsZW1lbnRJZCkge1xyXG5cdFx0XHRcdHNlbGVjdE1vZGFsRWxlbWVudC5zZXRBY3RpdmUoZmFsc2UpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRkZUhpZ2hsaWdodEFsbE90aGVyRWxlbWVudHMoZWxlbWVudElkOiBudW1iZXIpOiB2b2lkIHtcclxuXHRcdGZvciAoY29uc3Qgc2VsZWN0TW9kYWxFbGVtZW50IG9mIHRoaXMuZWxlbWVudHMpIHtcclxuXHRcdFx0aWYgKHNlbGVjdE1vZGFsRWxlbWVudC5pZCAhPT0gZWxlbWVudElkKSB7XHJcblx0XHRcdFx0c2VsZWN0TW9kYWxFbGVtZW50LnNldEhpZ2hsaWdodGVkKGZhbHNlKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0YWN0aXZhdGVIaWdobGlnaHRlZCgpOiB2b2lkIHtcclxuXHRcdGZvciAoY29uc3Qgc2VsZWN0TW9kYWxFbGVtZW50IG9mIHRoaXMuZWxlbWVudHMpIHtcclxuXHRcdFx0aWYgKHNlbGVjdE1vZGFsRWxlbWVudC5pc0hpZ2hsaWdodGVkKCkpIHtcclxuXHRcdFx0XHRzZWxlY3RNb2RhbEVsZW1lbnQuc2V0QWN0aXZlKCFzZWxlY3RNb2RhbEVsZW1lbnQuaXNBY3RpdmUoKSk7XHJcblx0XHRcdFx0aWYgKCF0aGlzLmFsbG93TXVsdGlTZWxlY3QpIHtcclxuXHRcdFx0XHRcdHRoaXMuZGlzYWJsZUFsbE90aGVyRWxlbWVudHMoc2VsZWN0TW9kYWxFbGVtZW50LmlkKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGhpZ2hsaWdodFVwKCk6IHZvaWQge1xyXG5cdFx0Zm9yIChjb25zdCBzZWxlY3RNb2RhbEVsZW1lbnQgb2YgdGhpcy5lbGVtZW50cykge1xyXG5cdFx0XHRpZiAoc2VsZWN0TW9kYWxFbGVtZW50LmlzSGlnaGxpZ2h0ZWQoKSkge1xyXG5cdFx0XHRcdHRoaXMuZ2V0UHJldmlvdXNTZWxlY3RNb2RhbEVsZW1lbnQoc2VsZWN0TW9kYWxFbGVtZW50KT8uc2V0SGlnaGxpZ2h0ZWQodHJ1ZSk7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gbm90aGluZyBpcyBoaWdobGlnaHRlZFxyXG5cdFx0dGhpcy5lbGVtZW50cy5hdCgtMSk/LnNldEhpZ2hsaWdodGVkKHRydWUpO1xyXG5cdH1cclxuXHJcblx0aGlnaGxpZ2h0RG93bigpOiB2b2lkIHtcclxuXHRcdGZvciAoY29uc3Qgc2VsZWN0TW9kYWxFbGVtZW50IG9mIHRoaXMuZWxlbWVudHMpIHtcclxuXHRcdFx0aWYgKHNlbGVjdE1vZGFsRWxlbWVudC5pc0hpZ2hsaWdodGVkKCkpIHtcclxuXHRcdFx0XHR0aGlzLmdldE5leHRTZWxlY3RNb2RhbEVsZW1lbnQoc2VsZWN0TW9kYWxFbGVtZW50KT8uc2V0SGlnaGxpZ2h0ZWQodHJ1ZSk7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gbm90aGluZyBpcyBoaWdobGlnaHRlZFxyXG5cdFx0dGhpcy5lbGVtZW50cy5hdCgwKT8uc2V0SGlnaGxpZ2h0ZWQodHJ1ZSk7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIGdldE5leHRTZWxlY3RNb2RhbEVsZW1lbnQoZWxlbWVudDogU2VsZWN0SW5wdXRGaWVsZEVsZW1lbnQpOiBTZWxlY3RJbnB1dEZpZWxkRWxlbWVudCB8IHVuZGVmaW5lZCB7XHJcblx0XHRsZXQgbmV4dElkID0gZWxlbWVudC5pZCArIDE7XHJcblx0XHRuZXh0SWQgPSBtb2QobmV4dElkLCB0aGlzLmVsZW1lbnRzLmxlbmd0aCk7XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMuZWxlbWVudHMuZmlsdGVyKHggPT4geC5pZCA9PT0gbmV4dElkKS5hdCgwKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgZ2V0UHJldmlvdXNTZWxlY3RNb2RhbEVsZW1lbnQoZWxlbWVudDogU2VsZWN0SW5wdXRGaWVsZEVsZW1lbnQpOiBTZWxlY3RJbnB1dEZpZWxkRWxlbWVudCB8IHVuZGVmaW5lZCB7XHJcblx0XHRsZXQgbmV4dElkID0gZWxlbWVudC5pZCAtIDE7XHJcblx0XHRuZXh0SWQgPSBtb2QobmV4dElkLCB0aGlzLmVsZW1lbnRzLmxlbmd0aCk7XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMuZWxlbWVudHMuZmlsdGVyKHggPT4geC5pZCA9PT0gbmV4dElkKS5hdCgwKTtcclxuXHR9XHJcbn1cclxuIiwgImltcG9ydCB7U2VsZWN0SW5wdXRGaWVsZH0gZnJvbSAnLi9TZWxlY3RJbnB1dEZpZWxkJztcclxuaW1wb3J0IHtJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZH0gZnJvbSAnLi4vSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQnO1xyXG5pbXBvcnQge2FycmF5RXF1YWxzfSBmcm9tICcuLi91dGlscy9VdGlscyc7XHJcblxyXG5leHBvcnQgY2xhc3MgTXVsdGlTZWxlY3RJbnB1dEZpZWxkIGV4dGVuZHMgU2VsZWN0SW5wdXRGaWVsZCB7XHJcblxyXG5cdGNvbnN0cnVjdG9yKGlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkOiBJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCwgb25WYWx1ZUNoYW5nZTogKHZhbHVlOiBhbnkpID0+ICh2b2lkIHwgUHJvbWlzZTx2b2lkPikpIHtcclxuXHRcdHN1cGVyKGlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLCBvblZhbHVlQ2hhbmdlKTtcclxuXHRcdHRoaXMuYWxsb3dNdWx0aVNlbGVjdCA9IHRydWU7XHJcblx0fVxyXG5cclxuXHRnZXRWYWx1ZSgpOiBhbnkge1xyXG5cdFx0cmV0dXJuIHRoaXMuZWxlbWVudHMuZmlsdGVyKHggPT4geC5pc0FjdGl2ZSgpKS5tYXAoeCA9PiB4LnZhbHVlKTtcclxuXHR9XHJcblxyXG5cdHNldFZhbHVlKHZhbHVlOiBzdHJpbmdbXSk6IHZvaWQge1xyXG5cdFx0aWYgKHZhbHVlLmxlbmd0aCA9PT0gMCkge1xyXG5cdFx0XHRmb3IgKGNvbnN0IGVsZW1lbnQgb2YgdGhpcy5lbGVtZW50cykge1xyXG5cdFx0XHRcdGVsZW1lbnQuc2V0QWN0aXZlKGZhbHNlLCBmYWxzZSk7XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdGVsZW1lbnRMb29wIDogZm9yIChjb25zdCBlbGVtZW50IG9mIHRoaXMuZWxlbWVudHMpIHtcclxuXHRcdFx0Zm9yIChjb25zdCB2YWx1ZUVsZW1lbnQgb2YgdmFsdWUpIHtcclxuXHRcdFx0XHRpZiAodmFsdWVFbGVtZW50ID09PSBlbGVtZW50LnZhbHVlKSB7XHJcblx0XHRcdFx0XHRlbGVtZW50LnNldEFjdGl2ZSh0cnVlLCBmYWxzZSk7XHJcblx0XHRcdFx0XHRjb250aW51ZSBlbGVtZW50TG9vcDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxlbWVudC5zZXRBY3RpdmUoZmFsc2UsIGZhbHNlKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGlzRXF1YWxWYWx1ZSh2YWx1ZTogYW55KTogYm9vbGVhbiB7XHJcblx0XHRpZiAoIUFycmF5LmlzQXJyYXkodmFsdWUpKSB7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gYXJyYXlFcXVhbHModGhpcy5nZXRWYWx1ZSgpLCB2YWx1ZSk7XHJcblx0fVxyXG5cclxuXHRnZXREZWZhdWx0VmFsdWUoKTogc3RyaW5nW10ge1xyXG5cdFx0cmV0dXJuIFtdO1xyXG5cdH1cclxufVxyXG4iLCAiaW1wb3J0IHtBYnN0cmFjdElucHV0RmllbGR9IGZyb20gJy4vQWJzdHJhY3RJbnB1dEZpZWxkJztcclxuaW1wb3J0IHtEcm9wZG93bkNvbXBvbmVudCwgVGV4dENvbXBvbmVudH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQge0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkfSBmcm9tICcuLi9JbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCc7XHJcbmltcG9ydCB7RGF0ZVBhcnNlcn0gZnJvbSAnLi4vcGFyc2Vycy9EYXRlUGFyc2VyJztcclxuaW1wb3J0IHtNZXRhQmluZEludGVybmFsRXJyb3J9IGZyb20gJy4uL3V0aWxzL1V0aWxzJztcclxuaW1wb3J0IHttb21lbnR9IGZyb20gJ29ic2lkaWFuJztcclxuXHJcbmV4cG9ydCBjbGFzcyBEYXRlSW5wdXRGaWVsZCBleHRlbmRzIEFic3RyYWN0SW5wdXRGaWVsZCB7XHJcblx0Y29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCB8IHVuZGVmaW5lZDtcclxuXHRkYXRlOiBtb21lbnQuTW9tZW50O1xyXG5cclxuXHRtb250aHM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XHJcblx0XHQnMCc6ICdKYW51YXJ5JyxcclxuXHRcdCcxJzogJ0ZlYnJ1YXJ5JyxcclxuXHRcdCcyJzogJ01hcmNoJyxcclxuXHRcdCczJzogJ0FwcmlsJyxcclxuXHRcdCc0JzogJ01heScsXHJcblx0XHQnNSc6ICdKdW5lJyxcclxuXHRcdCc2JzogJ0p1bHknLFxyXG5cdFx0JzcnOiAnQXVndXN0JyxcclxuXHRcdCc4JzogJ1NlcHRlbWJlcicsXHJcblx0XHQnOSc6ICdPY3RvYmVyJyxcclxuXHRcdCcxMCc6ICdOb3ZlbWJlcicsXHJcblx0XHQnMTEnOiAnRGVjZW1iZXInLFxyXG5cdH07XHJcblx0ZGF5czogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcclxuXHJcblx0bW9udGhDb21wb25lbnQ6IERyb3Bkb3duQ29tcG9uZW50IHwgdW5kZWZpbmVkO1xyXG5cdGRheUNvbXBvbmVudDogRHJvcGRvd25Db21wb25lbnQgfCB1bmRlZmluZWQ7XHJcblx0eWVhckNvbXBvbmVudDogVGV4dENvbXBvbmVudCB8IHVuZGVmaW5lZDtcclxuXHJcblxyXG5cdGNvbnN0cnVjdG9yKGlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkOiBJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCwgb25WYWx1ZUNoYW5nZTogKHZhbHVlOiBhbnkpID0+ICh2b2lkIHwgUHJvbWlzZTx2b2lkPikpIHtcclxuXHRcdHN1cGVyKGlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLCBvblZhbHVlQ2hhbmdlKTtcclxuXHJcblx0XHR0aGlzLmRhdGUgPSBEYXRlUGFyc2VyLmdldERlZmF1bHREYXRlKCk7XHJcblxyXG5cdFx0dGhpcy5kYXlzID0ge307XHJcblx0XHRmb3IgKGxldCBpID0gMTsgaSA8PSAzMTsgaSsrKSB7XHJcblx0XHRcdHRoaXMuZGF5c1tpLnRvU3RyaW5nKCldID0gaS50b1N0cmluZygpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cHVibGljIGdldEh0bWxFbGVtZW50KCk6IEhUTUxFbGVtZW50IHtcclxuXHRcdGlmICghdGhpcy5jb250YWluZXIpIHtcclxuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcigndG9nZ2xlIGlucHV0IGNvbnRhaW5lciBpcyB1bmRlZmluZWQnKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcy5jb250YWluZXI7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0VmFsdWUoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiBEYXRlUGFyc2VyLnN0cmluZ2lmeSh0aGlzLmRhdGUpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHNldFZhbHVlKHZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcclxuXHRcdGlmICghdGhpcy5tb250aENvbXBvbmVudCkge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCdkYXRlIGlucHV0IG1vbnRoIGNvbXBvbmVudCBpcyB1bmRlZmluZWQnKTtcclxuXHRcdH1cclxuXHRcdGlmICghdGhpcy5kYXlDb21wb25lbnQpIHtcclxuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcignZGF0ZSBpbnB1dCBkYXkgY29tcG9uZW50IGlzIHVuZGVmaW5lZCcpO1xyXG5cdFx0fVxyXG5cdFx0aWYgKCF0aGlzLnllYXJDb21wb25lbnQpIHtcclxuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcignZGF0ZSBpbnB1dCBob3VyIGNvbXBvbmVudCBpcyB1bmRlZmluZWQnKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmRhdGUgPSBEYXRlUGFyc2VyLnBhcnNlKHZhbHVlKSA/PyBEYXRlUGFyc2VyLmdldERlZmF1bHREYXRlKCk7XHJcblx0XHQvLyBjb25zb2xlLmxvZyh0aGlzLmRhdGUpO1xyXG5cdFx0dGhpcy5tb250aENvbXBvbmVudC5zZXRWYWx1ZSh0aGlzLmRhdGUubW9udGgoKS50b1N0cmluZygpKTtcclxuXHRcdHRoaXMuZGF5Q29tcG9uZW50LnNldFZhbHVlKHRoaXMuZGF0ZS5kYXRlKCkudG9TdHJpbmcoKSk7XHJcblx0XHR0aGlzLnllYXJDb21wb25lbnQuc2V0VmFsdWUodGhpcy5kYXRlLnllYXIoKS50b1N0cmluZygpKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBpc0VxdWFsVmFsdWUodmFsdWU6IGFueSk6IGJvb2xlYW4ge1xyXG5cdFx0cmV0dXJuIHZhbHVlID09IHRoaXMuZ2V0VmFsdWUoKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXREZWZhdWx0VmFsdWUoKTogYW55IHtcclxuXHRcdHJldHVybiBEYXRlUGFyc2VyLnN0cmluZ2lmeShEYXRlUGFyc2VyLmdldERlZmF1bHREYXRlKCkpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHJlbmRlcihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XHJcblx0XHR0aGlzLmRhdGUgPSBEYXRlUGFyc2VyLnBhcnNlKHRoaXMuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQuZ2V0SW5pdGlhbFZhbHVlKCkpID8/IERhdGVQYXJzZXIuZ2V0RGVmYXVsdERhdGUoKTtcclxuXHRcdGxldCB1c2VVc0lucHV0T3JkZXIgPSB0aGlzLmlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLnBsdWdpbi5zZXR0aW5ncy51c2VVc0RhdGVJbnB1dE9yZGVyO1xyXG5cclxuXHRcdGNvbnRhaW5lci5yZW1vdmVDbGFzcygnbWV0YS1iaW5kLXBsdWdpbi1pbnB1dC13cmFwcGVyJyk7XHJcblx0XHRjb250YWluZXIuYWRkQ2xhc3MoJ21ldGEtYmluZC1wbHVnaW4tZmxleC1pbnB1dC13cmFwcGVyJywgJ21ldGEtYmluZC1wbHVnaW4taW5wdXQtZWxlbWVudC1ncm91cCcpO1xyXG5cclxuXHRcdGlmICghdXNlVXNJbnB1dE9yZGVyKSB7XHJcblx0XHRcdHRoaXMuZGF5Q29tcG9uZW50ID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KGNvbnRhaW5lcik7XHJcblx0XHRcdHRoaXMuZGF5Q29tcG9uZW50LmFkZE9wdGlvbnModGhpcy5kYXlzKTtcclxuXHRcdFx0dGhpcy5kYXlDb21wb25lbnQuc2V0VmFsdWUodGhpcy5kYXRlLmRhdGUoKS50b1N0cmluZygpKTtcclxuXHRcdFx0dGhpcy5kYXlDb21wb25lbnQub25DaGFuZ2UodGhpcy5vbkRheUNoYW5nZS5iaW5kKHRoaXMpKTtcclxuXHJcblx0XHRcdHRoaXMubW9udGhDb21wb25lbnQgPSBuZXcgRHJvcGRvd25Db21wb25lbnQoY29udGFpbmVyKTtcclxuXHRcdFx0dGhpcy5tb250aENvbXBvbmVudC5hZGRPcHRpb25zKHRoaXMubW9udGhzKTtcclxuXHRcdFx0dGhpcy5tb250aENvbXBvbmVudC5zZXRWYWx1ZSh0aGlzLmRhdGUubW9udGgoKS50b1N0cmluZygpKTtcclxuXHRcdFx0dGhpcy5tb250aENvbXBvbmVudC5vbkNoYW5nZSh0aGlzLm9uTW9udGhDaGFuZ2UuYmluZCh0aGlzKSk7XHJcblxyXG5cdFx0XHR0aGlzLmRheUNvbXBvbmVudC5zZWxlY3RFbC5hZGRDbGFzcygnbWV0YS1iaW5kLXBsdWdpbi1pbnB1dC1lbGVtZW50LWdyb3VwLWVsZW1lbnQnKTtcclxuXHRcdFx0dGhpcy5tb250aENvbXBvbmVudC5zZWxlY3RFbC5hZGRDbGFzcygnbWV0YS1iaW5kLXBsdWdpbi1pbnB1dC1lbGVtZW50LWdyb3VwLWVsZW1lbnQnKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRoaXMubW9udGhDb21wb25lbnQgPSBuZXcgRHJvcGRvd25Db21wb25lbnQoY29udGFpbmVyKTtcclxuXHRcdFx0dGhpcy5tb250aENvbXBvbmVudC5hZGRPcHRpb25zKHRoaXMubW9udGhzKTtcclxuXHRcdFx0dGhpcy5tb250aENvbXBvbmVudC5zZXRWYWx1ZSh0aGlzLmRhdGUubW9udGgoKS50b1N0cmluZygpKTtcclxuXHRcdFx0dGhpcy5tb250aENvbXBvbmVudC5vbkNoYW5nZSh0aGlzLm9uTW9udGhDaGFuZ2UuYmluZCh0aGlzKSk7XHJcblxyXG5cdFx0XHR0aGlzLmRheUNvbXBvbmVudCA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChjb250YWluZXIpO1xyXG5cdFx0XHR0aGlzLmRheUNvbXBvbmVudC5hZGRPcHRpb25zKHRoaXMuZGF5cyk7XHJcblx0XHRcdHRoaXMuZGF5Q29tcG9uZW50LnNldFZhbHVlKHRoaXMuZGF0ZS5kYXRlKCkudG9TdHJpbmcoKSk7XHJcblx0XHRcdHRoaXMuZGF5Q29tcG9uZW50Lm9uQ2hhbmdlKHRoaXMub25EYXlDaGFuZ2UuYmluZCh0aGlzKSk7XHJcblxyXG5cdFx0XHR0aGlzLmRheUNvbXBvbmVudC5zZWxlY3RFbC5hZGRDbGFzcygnbWV0YS1iaW5kLXBsdWdpbi1pbnB1dC1lbGVtZW50LWdyb3VwLWVsZW1lbnQnKTtcclxuXHRcdFx0dGhpcy5tb250aENvbXBvbmVudC5zZWxlY3RFbC5hZGRDbGFzcygnbWV0YS1iaW5kLXBsdWdpbi1pbnB1dC1lbGVtZW50LWdyb3VwLWVsZW1lbnQnKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLnllYXJDb21wb25lbnQgPSBuZXcgVGV4dENvbXBvbmVudChjb250YWluZXIpO1xyXG5cdFx0dGhpcy55ZWFyQ29tcG9uZW50LnNldFZhbHVlKHRoaXMuZGF0ZS55ZWFyKCkudG9TdHJpbmcoKSk7XHJcblx0XHR0aGlzLnllYXJDb21wb25lbnQub25DaGFuZ2UodGhpcy5vblllYXJDaGFuZ2UuYmluZCh0aGlzKSk7XHJcblxyXG5cdFx0dGhpcy55ZWFyQ29tcG9uZW50LmlucHV0RWwuYWRkQ2xhc3MoJ21ldGEtYmluZC1wbHVnaW4tZGF0ZS1pbnB1dC15ZWFyLWlucHV0Jyk7XHJcblx0XHR0aGlzLnllYXJDb21wb25lbnQuaW5wdXRFbC5hZGRDbGFzcygnbWV0YS1iaW5kLXBsdWdpbi1pbnB1dC1lbGVtZW50LWdyb3VwLWVsZW1lbnQnKTtcclxuXHRcdHRoaXMueWVhckNvbXBvbmVudC5pbnB1dEVsLnR5cGUgPSAnbnVtYmVyJztcclxuXHRcdHRoaXMueWVhckNvbXBvbmVudC5pbnB1dEVsLm1heCA9ICc5OTk5JztcclxuXHJcblx0XHR0aGlzLmNvbnRhaW5lciA9IGNvbnRhaW5lcjtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgb25Nb250aENoYW5nZSh2YWx1ZTogc3RyaW5nKTogdm9pZCB7XHJcblx0XHR0aGlzLmRhdGUubW9udGgodmFsdWUpO1xyXG5cclxuXHRcdGNvbnN0IGNsYW1wZWREYXkgPSB0aGlzLmNsYW1wRGF5KHRoaXMuZGF0ZS5kYXRlKCkpO1xyXG5cdFx0dGhpcy5kYXlDb21wb25lbnQ/LnNldFZhbHVlKGNsYW1wZWREYXkudG9TdHJpbmcoKSk7XHJcblx0XHR0aGlzLmRhdGUuZGF0ZShjbGFtcGVkRGF5KTtcclxuXHJcblx0XHR0aGlzLm9uVmFsdWVDaGFuZ2UodGhpcy5nZXRWYWx1ZSgpKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgb25EYXlDaGFuZ2UodmFsdWU6IHN0cmluZyk6IHZvaWQge1xyXG5cdFx0Y29uc3QgZGF5ID0gTnVtYmVyLnBhcnNlSW50KHZhbHVlKTtcclxuXHRcdGNvbnN0IGNsYW1wZWREYXkgPSB0aGlzLmNsYW1wRGF5KGRheSk7XHJcblx0XHRpZiAoY2xhbXBlZERheSAhPT0gZGF5KSB7XHJcblx0XHRcdHRoaXMuZGF5Q29tcG9uZW50Py5zZXRWYWx1ZShjbGFtcGVkRGF5LnRvU3RyaW5nKCkpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuZGF0ZS5kYXRlKGNsYW1wZWREYXkpO1xyXG5cdFx0dGhpcy5vblZhbHVlQ2hhbmdlKHRoaXMuZ2V0VmFsdWUoKSk7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIG9uWWVhckNoYW5nZSh2YWx1ZTogc3RyaW5nKTogdm9pZCB7XHJcblx0XHRjb25zdCB5ZWFyID0gTnVtYmVyLnBhcnNlSW50KHZhbHVlKTtcclxuXHRcdHRoaXMuZGF0ZS55ZWFyKE51bWJlci5pc05hTih5ZWFyKSA/IERhdGVQYXJzZXIuZ2V0RGVmYXVsdFllYXIoKSA6IHllYXIpO1xyXG5cdFx0dGhpcy5vblZhbHVlQ2hhbmdlKHRoaXMuZ2V0VmFsdWUoKSk7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIGNsYW1wRGF5KGRheTogbnVtYmVyKTogbnVtYmVyIHtcclxuXHRcdGlmIChOdW1iZXIuaXNOYU4oZGF5KSkge1xyXG5cdFx0XHRyZXR1cm4gRGF0ZVBhcnNlci5nZXREZWZhdWx0RGF5KCk7XHJcblx0XHR9IGVsc2UgaWYgKGRheSA8IDEpIHtcclxuXHRcdFx0cmV0dXJuIDE7XHJcblx0XHR9IGVsc2UgaWYgKGRheSA+IHRoaXMuZGF0ZS5kYXlzSW5Nb250aCgpKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLmRhdGUuZGF5c0luTW9udGgoKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiBkYXk7XHJcblx0fVxyXG5cclxufVxyXG4iLCAiaW1wb3J0IHttb21lbnR9IGZyb20gJ29ic2lkaWFuJztcclxuXHJcbmV4cG9ydCBjbGFzcyBEYXRlUGFyc2VyIHtcclxuXHRwdWJsaWMgc3RhdGljIGRhdGVGb3JtYXQ6IHN0cmluZztcclxuXHJcblx0cHVibGljIHN0YXRpYyBzdHJpbmdpZnkoZGF0ZTogbW9tZW50Lk1vbWVudCk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gZGF0ZS5mb3JtYXQodGhpcy5kYXRlRm9ybWF0KTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzdGF0aWMgcGFyc2UoZGF0ZVN0cmluZzogc3RyaW5nKTogbW9tZW50Lk1vbWVudCB7XHJcblx0XHRyZXR1cm4gbW9tZW50KGRhdGVTdHJpbmcsIERhdGVQYXJzZXIuZGF0ZUZvcm1hdCk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc3RhdGljIGdldERlZmF1bHREYXRlKCk6IG1vbWVudC5Nb21lbnQge1xyXG5cdFx0cmV0dXJuIG1vbWVudChgJHtEYXRlUGFyc2VyLmdldERlZmF1bHRZZWFyfS0ke0RhdGVQYXJzZXIuZ2V0RGVmYXVsdE1vbnRoKCl9LSR7RGF0ZVBhcnNlci5nZXREZWZhdWx0RGF5KCl9YCk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc3RhdGljIGdldERlZmF1bHREYXkoKTogbnVtYmVyIHtcclxuXHRcdHJldHVybiAxO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHN0YXRpYyBnZXREZWZhdWx0TW9udGgoKTogbnVtYmVyIHtcclxuXHRcdHJldHVybiAxO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHN0YXRpYyBnZXREZWZhdWx0WWVhcigpOiBudW1iZXIge1xyXG5cdFx0cmV0dXJuIDIwMjI7XHJcblx0fVxyXG59XHJcbiIsICJpbXBvcnQge0Fic3RyYWN0SW5wdXRGaWVsZH0gZnJvbSAnLi9BYnN0cmFjdElucHV0RmllbGQnO1xyXG5pbXBvcnQge0Ryb3Bkb3duQ29tcG9uZW50fSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7SW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGR9IGZyb20gJy4uL0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkJztcclxuaW1wb3J0IHtUaW1lLCBUaW1lUGFyc2VyfSBmcm9tICcuLi9wYXJzZXJzL1RpbWVQYXJzZXInO1xyXG5pbXBvcnQge01ldGFCaW5kSW50ZXJuYWxFcnJvcn0gZnJvbSAnLi4vdXRpbHMvVXRpbHMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFRpbWVJbnB1dEZpZWxkIGV4dGVuZHMgQWJzdHJhY3RJbnB1dEZpZWxkIHtcclxuXHRjb250YWluZXI6IEhUTUxEaXZFbGVtZW50IHwgdW5kZWZpbmVkO1xyXG5cdHRpbWU6IFRpbWU7XHJcblxyXG5cdGhvdXJzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xyXG5cdG1pbnV0ZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XHJcblxyXG5cdGhvdXJDb21wb25lbnQ6IERyb3Bkb3duQ29tcG9uZW50IHwgdW5kZWZpbmVkO1xyXG5cdG1pbnV0ZUNvbXBvbmVudDogRHJvcGRvd25Db21wb25lbnQgfCB1bmRlZmluZWQ7XHJcblxyXG5cclxuXHRjb25zdHJ1Y3RvcihpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZDogSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQsIG9uVmFsdWVDaGFuZ2U6ICh2YWx1ZTogYW55KSA9PiAodm9pZCB8IFByb21pc2U8dm9pZD4pKSB7XHJcblx0XHRzdXBlcihpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCwgb25WYWx1ZUNoYW5nZSk7XHJcblxyXG5cdFx0dGhpcy50aW1lID0gVGltZVBhcnNlci5nZXREZWZhdWx0VGltZSgpO1xyXG5cclxuXHRcdHRoaXMuaG91cnMgPSB7fTtcclxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDw9IDI0OyBpKyspIHtcclxuXHRcdFx0dGhpcy5ob3Vyc1tpLnRvU3RyaW5nKCldID0gaS50b1N0cmluZygpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMubWludXRlcyA9IHt9O1xyXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPD0gNTk7IGkrKykge1xyXG5cdFx0XHR0aGlzLm1pbnV0ZXNbaS50b1N0cmluZygpXSA9IGkudG9TdHJpbmcoKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRIdG1sRWxlbWVudCgpOiBIVE1MRWxlbWVudCB7XHJcblx0XHRpZiAoIXRoaXMuY29udGFpbmVyKSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ3RpbWUgaW5wdXQgY29udGFpbmVyIGlzIHVuZGVmaW5lZCcpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzLmNvbnRhaW5lcjtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRWYWx1ZSgpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIFRpbWVQYXJzZXIuc3RyaW5naWZ5KHRoaXMudGltZSk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc2V0VmFsdWUodmFsdWU6IHN0cmluZyk6IHZvaWQge1xyXG5cdFx0aWYgKCF0aGlzLmhvdXJDb21wb25lbnQpIHtcclxuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcigndGltZSBpbnB1dCBob3VyIGNvbXBvbmVudCBpcyB1bmRlZmluZWQnKTtcclxuXHRcdH1cclxuXHRcdGlmICghdGhpcy5taW51dGVDb21wb25lbnQpIHtcclxuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcigndGltZSBpbnB1dCBtaW51dGUgY29tcG9uZW50IGlzIHVuZGVmaW5lZCcpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMudGltZSA9IFRpbWVQYXJzZXIucGFyc2UodmFsdWUpID8/IFRpbWVQYXJzZXIuZ2V0RGVmYXVsdFRpbWUoKTtcclxuXHRcdC8vIGNvbnNvbGUubG9nKHRoaXMudGltZSk7XHJcblx0XHR0aGlzLmhvdXJDb21wb25lbnQuc2V0VmFsdWUodGhpcy50aW1lLmdldEhvdXIoKS50b1N0cmluZygpKTtcclxuXHRcdHRoaXMubWludXRlQ29tcG9uZW50LnNldFZhbHVlKHRoaXMudGltZS5nZXRNaW51dGUoKS50b1N0cmluZygpKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBpc0VxdWFsVmFsdWUodmFsdWU6IGFueSk6IGJvb2xlYW4ge1xyXG5cdFx0cmV0dXJuIHZhbHVlID09IHRoaXMuZ2V0VmFsdWUoKTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXREZWZhdWx0VmFsdWUoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiBUaW1lUGFyc2VyLnN0cmluZ2lmeShUaW1lUGFyc2VyLmdldERlZmF1bHRUaW1lKCkpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHJlbmRlcihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XHJcblx0XHR0aGlzLnRpbWUgPSBUaW1lUGFyc2VyLnBhcnNlKHRoaXMuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQuZ2V0SW5pdGlhbFZhbHVlKCkpID8/IFRpbWVQYXJzZXIuZ2V0RGVmYXVsdFRpbWUoKTtcclxuXHJcblx0XHRjb250YWluZXIucmVtb3ZlQ2xhc3MoJ21ldGEtYmluZC1wbHVnaW4taW5wdXQtd3JhcHBlcicpO1xyXG5cdFx0Y29udGFpbmVyLmFkZENsYXNzKCdtZXRhLWJpbmQtcGx1Z2luLWZsZXgtaW5wdXQtd3JhcHBlcicsICdtZXRhLWJpbmQtcGx1Z2luLWlucHV0LWVsZW1lbnQtZ3JvdXAnKTtcclxuXHJcblx0XHR0aGlzLmhvdXJDb21wb25lbnQgPSBuZXcgRHJvcGRvd25Db21wb25lbnQoY29udGFpbmVyKTtcclxuXHRcdHRoaXMuaG91ckNvbXBvbmVudC5hZGRPcHRpb25zKHRoaXMuaG91cnMpO1xyXG5cdFx0dGhpcy5ob3VyQ29tcG9uZW50LnNldFZhbHVlKHRoaXMudGltZS5nZXRIb3VyKCkudG9TdHJpbmcoKSk7XHJcblx0XHR0aGlzLmhvdXJDb21wb25lbnQub25DaGFuZ2UodGhpcy5vbkhvdXJDaGFuZ2UuYmluZCh0aGlzKSk7XHJcblxyXG5cdFx0dGhpcy5taW51dGVDb21wb25lbnQgPSBuZXcgRHJvcGRvd25Db21wb25lbnQoY29udGFpbmVyKTtcclxuXHRcdHRoaXMubWludXRlQ29tcG9uZW50LmFkZE9wdGlvbnModGhpcy5taW51dGVzKTtcclxuXHRcdHRoaXMubWludXRlQ29tcG9uZW50LnNldFZhbHVlKHRoaXMudGltZS5nZXRNaW51dGUoKS50b1N0cmluZygpKTtcclxuXHRcdHRoaXMubWludXRlQ29tcG9uZW50Lm9uQ2hhbmdlKHRoaXMub25NaW51dGVDaGFuZ2UuYmluZCh0aGlzKSk7XHJcblxyXG5cdFx0dGhpcy5ob3VyQ29tcG9uZW50LnNlbGVjdEVsLmFkZENsYXNzKCdtZXRhLWJpbmQtcGx1Z2luLWlucHV0LWVsZW1lbnQtZ3JvdXAtZWxlbWVudCcpO1xyXG5cdFx0dGhpcy5taW51dGVDb21wb25lbnQuc2VsZWN0RWwuYWRkQ2xhc3MoJ21ldGEtYmluZC1wbHVnaW4taW5wdXQtZWxlbWVudC1ncm91cC1lbGVtZW50Jyk7XHJcblxyXG5cdFx0dGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIG9uSG91ckNoYW5nZSh2YWx1ZTogc3RyaW5nKTogdm9pZCB7XHJcblx0XHR0aGlzLnRpbWUuc2V0SG91ckZyb21TdHJpbmcodmFsdWUpO1xyXG5cdFx0dGhpcy5vblZhbHVlQ2hhbmdlKHRoaXMuZ2V0VmFsdWUoKSk7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIG9uTWludXRlQ2hhbmdlKHZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcclxuXHRcdHRoaXMudGltZS5zZXRNaW51dGVGcm9tU3RyaW5nKHZhbHVlKTtcclxuXHRcdHRoaXMub25WYWx1ZUNoYW5nZSh0aGlzLmdldFZhbHVlKCkpO1xyXG5cdH1cclxufVxyXG4iLCAiZXhwb3J0IGNsYXNzIFRpbWUge1xyXG5cdHByaXZhdGUgX2hvdXI6IG51bWJlcjtcclxuXHRwcml2YXRlIF9taW51dGU6IG51bWJlcjtcclxuXHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHR0aGlzLl9ob3VyID0gVGltZVBhcnNlci5nZXREZWZhdWx0SG91cigpO1xyXG5cdFx0dGhpcy5fbWludXRlID0gVGltZVBhcnNlci5nZXREZWZhdWx0SG91cigpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldEhvdXIoKTogbnVtYmVyIHtcclxuXHRcdHJldHVybiB0aGlzLl9ob3VyO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHNldEhvdXIodmFsdWU6IG51bWJlcik6IHZvaWQge1xyXG5cdFx0aWYgKHZhbHVlIDwgMCB8fCB2YWx1ZSA+IDI0KSB7XHJcblx0XHRcdHRoaXMuX2hvdXIgPSBUaW1lUGFyc2VyLmdldERlZmF1bHRIb3VyKCk7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdHRoaXMuX2hvdXIgPSB2YWx1ZTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXRNaW51dGUoKTogbnVtYmVyIHtcclxuXHRcdHJldHVybiB0aGlzLl9taW51dGU7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc2V0TWludXRlKHZhbHVlOiBudW1iZXIpOiB2b2lkICB7XHJcblx0XHRpZiAodmFsdWUgPCAwIHx8IHZhbHVlID4gNTkpIHtcclxuXHRcdFx0dGhpcy5fbWludXRlID0gVGltZVBhcnNlci5nZXREZWZhdWx0TWludXRlKCk7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdHRoaXMuX21pbnV0ZSA9IHZhbHVlO1xyXG5cdH1cclxuXHJcblx0cHVibGljIGdldFVuaWZvcm1Ib3VyKCk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gKCcwMCcgKyB0aGlzLmdldEhvdXIoKS50b1N0cmluZygpKS5zbGljZSgtMik7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0VW5pZm9ybU1pbnV0ZSgpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuICgnMDAnICsgdGhpcy5nZXRNaW51dGUoKS50b1N0cmluZygpKS5zbGljZSgtMik7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc2V0SG91ckZyb21TdHJpbmcoc3RyOiBzdHJpbmcpOiB2b2lkICB7XHJcblx0XHRjb25zdCB2ID0gTnVtYmVyLnBhcnNlSW50KHN0cik7XHJcblx0XHR0aGlzLnNldEhvdXIoTnVtYmVyLmlzTmFOKHYpID8gVGltZVBhcnNlci5nZXREZWZhdWx0SG91cigpIDogdik7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc2V0TWludXRlRnJvbVN0cmluZyhzdHI6IHN0cmluZyk6IHZvaWQgIHtcclxuXHRcdGNvbnN0IHYgPSBOdW1iZXIucGFyc2VJbnQoc3RyKTtcclxuXHRcdHRoaXMuc2V0TWludXRlKE51bWJlci5pc05hTih2KSA/IFRpbWVQYXJzZXIuZ2V0RGVmYXVsdE1pbnV0ZSgpIDogdik7XHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgVGltZVBhcnNlciB7XHJcblx0cHVibGljIHN0YXRpYyBwYXJzZSh0aW1lU3RyaW5nOiBzdHJpbmcpOiBUaW1lIHwgdW5kZWZpbmVkIHtcclxuXHRcdGNvbnN0IHRpbWU6IFRpbWUgPSBUaW1lUGFyc2VyLmdldERlZmF1bHRUaW1lKCk7XHJcblxyXG5cdFx0Y29uc3QgdGltZVBhcnRzID0gdGltZVN0cmluZy5zcGxpdCgnOicpO1xyXG5cdFx0aWYgKHRpbWVQYXJ0cy5sZW5ndGggIT09IDIpIHtcclxuXHRcdFx0cmV0dXJuIHVuZGVmaW5lZDtcclxuXHRcdH1cclxuXHJcblx0XHR0aW1lLnNldEhvdXJGcm9tU3RyaW5nKHRpbWVQYXJ0c1swXSk7XHJcblx0XHR0aW1lLnNldE1pbnV0ZUZyb21TdHJpbmcodGltZVBhcnRzWzFdKTtcclxuXHJcblx0XHRyZXR1cm4gdGltZTtcclxuXHR9XHJcblxyXG5cdHB1YmxpYyBzdGF0aWMgc3RyaW5naWZ5KHRpbWU6IFRpbWUpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIGAke3RpbWUuZ2V0VW5pZm9ybUhvdXIoKX06JHt0aW1lLmdldFVuaWZvcm1NaW51dGUoKX1gO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHN0YXRpYyBnZXREZWZhdWx0VGltZSgpOiBUaW1lIHtcclxuXHRcdHJldHVybiBuZXcgVGltZSgpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHN0YXRpYyBnZXREZWZhdWx0SG91cigpOiBudW1iZXIge1xyXG5cdFx0cmV0dXJuIDA7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc3RhdGljIGdldERlZmF1bHRNaW51dGUoKTogbnVtYmVyIHtcclxuXHRcdHJldHVybiAwO1xyXG5cdH1cclxufVxyXG4iLCAiaW1wb3J0IHtlcXVhbE9ySW5jbHVkZXMsIGlzRmFsc3ksIE1ldGFCaW5kSW50ZXJuYWxFcnJvcn0gZnJvbSAnLi9VdGlscyc7XHJcblxyXG5cclxuZXhwb3J0IGNsYXNzIEVuY2xvc2luZ1BhaXIge1xyXG5cdHJlYWRvbmx5IG9wZW5pbmdFcXVhbHNDbG9zaW5nOiBib29sZWFuO1xyXG5cdHByaXZhdGUgcmVhZG9ubHkgX29wZW5pbmdTdHJpbmc6IHN0cmluZztcclxuXHRwcml2YXRlIHJlYWRvbmx5IF9jbG9zaW5nU3RyaW5nOiBzdHJpbmc7XHJcblxyXG5cdGNvbnN0cnVjdG9yKG9wZW5pbmdTdHJpbmc6IHN0cmluZywgY2xvc2luZ1N0cmluZz86IHN0cmluZykge1xyXG5cdFx0aWYgKGlzRmFsc3kob3BlbmluZ1N0cmluZykpIHtcclxuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcignb3BlbmluZyBzdHJpbmcgbXVzdCBub3QgYmUgZW1wdHknKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLm9wZW5pbmdFcXVhbHNDbG9zaW5nID0gaXNGYWxzeShjbG9zaW5nU3RyaW5nKSB8fCBvcGVuaW5nU3RyaW5nID09PSBjbG9zaW5nU3RyaW5nO1xyXG5cclxuXHRcdGlmICh0aGlzLm9wZW5pbmdFcXVhbHNDbG9zaW5nKSB7XHJcblx0XHRcdHRoaXMuX29wZW5pbmdTdHJpbmcgPSBvcGVuaW5nU3RyaW5nO1xyXG5cdFx0XHR0aGlzLl9jbG9zaW5nU3RyaW5nID0gb3BlbmluZ1N0cmluZztcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRoaXMuX29wZW5pbmdTdHJpbmcgPSBvcGVuaW5nU3RyaW5nO1xyXG5cdFx0XHQvLyBAdHMtaWdub3JlIHRoaXMgY2FuIG5vdCBiZSB1bmRlZmluZWQgaGVyZVxyXG5cdFx0XHR0aGlzLl9jbG9zaW5nU3RyaW5nID0gY2xvc2luZ1N0cmluZztcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHB1YmxpYyBnZXQgb3BlbmluZ1N0cmluZygpOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIHRoaXMuX29wZW5pbmdTdHJpbmc7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgZ2V0IGNsb3NpbmdTdHJpbmcoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiB0aGlzLm9wZW5pbmdFcXVhbHNDbG9zaW5nID8gdGhpcy5fb3BlbmluZ1N0cmluZyA6IHRoaXMuX2Nsb3NpbmdTdHJpbmc7XHJcblx0fVxyXG5cclxuXHRvdmVybGFwcyhvdGhlcjogRW5jbG9zaW5nUGFpcik6IGJvb2xlYW4ge1xyXG5cdFx0cmV0dXJuIGVxdWFsT3JJbmNsdWRlcyh0aGlzLm9wZW5pbmdTdHJpbmcsIG90aGVyLm9wZW5pbmdTdHJpbmcpIHx8XHJcblx0XHRcdGVxdWFsT3JJbmNsdWRlcyh0aGlzLm9wZW5pbmdTdHJpbmcsIG90aGVyLmNsb3NpbmdTdHJpbmcpIHx8XHJcblx0XHRcdGVxdWFsT3JJbmNsdWRlcyh0aGlzLmNsb3NpbmdTdHJpbmcsIG90aGVyLm9wZW5pbmdTdHJpbmcpIHx8XHJcblx0XHRcdGVxdWFsT3JJbmNsdWRlcyh0aGlzLmNsb3NpbmdTdHJpbmcsIG90aGVyLmNsb3NpbmdTdHJpbmcpO1xyXG5cdH1cclxuXHJcblx0ZXF1YWxzKG90aGVyOiBFbmNsb3NpbmdQYWlyKTogYm9vbGVhbiB7XHJcblx0XHRpZiAoaXNGYWxzeShvdGhlcikpIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuICh0aGlzLm9wZW5pbmdTdHJpbmcgPT09IG90aGVyLm9wZW5pbmdTdHJpbmcpICYmICh0aGlzLmNsb3NpbmdTdHJpbmcgPT09IG90aGVyLmNsb3NpbmdTdHJpbmcpO1xyXG5cdH1cclxuXHJcblx0dG9TdHJpbmcoKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzKTtcclxuXHR9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBQYXJzZXJVdGlscyB7XHJcblxyXG5cdC8vIFRPRE86IHJlbmFtZSBzdHVmZlxyXG5cdHN0YXRpYyBzcGxpdChzdHI6IHN0cmluZywgc2VwYXJhdG9yOiBzdHJpbmcsIGlnbm9yZT86IEVuY2xvc2luZ1BhaXIpOiBzdHJpbmdbXSB7XHJcblx0XHRpZiAoIXN0cikge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCdzdHJpbmcgbXVzdCBub3QgYmUgZW1wdHknKTtcclxuXHRcdH1cclxuXHRcdGlmICghc2VwYXJhdG9yKSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ3NlcGFyYXRvciBtdXN0IG5vdCBiZSBlbXB0eScpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGxldCBzdWJTdHI6IHN0cmluZyA9ICcnO1xyXG5cdFx0Y29uc3Qgc3ViU3RyaW5nczogc3RyaW5nW10gPSBbXTtcclxuXHJcblx0XHRpZiAoaWdub3JlKSB7XHJcblx0XHRcdGxldCByZW1haW5pbmdPcGVuaW5nU3RyaW5nQ291bnQgPSBQYXJzZXJVdGlscy5udW1iZXJPZk9jY3VycmVuY2VzKHN0ciwgaWdub3JlLm9wZW5pbmdTdHJpbmcpO1xyXG5cdFx0XHRsZXQgcmVtYWluaW5nQ2xvc2luZ1N0cmluZ0NvdW50ID0gUGFyc2VyVXRpbHMubnVtYmVyT2ZPY2N1cnJlbmNlcyhzdHIsIGlnbm9yZS5jbG9zaW5nU3RyaW5nKTtcclxuXHJcblx0XHRcdGxldCBlbmNsb3NpbmdMZXZlbDogbnVtYmVyID0gMDtcclxuXHJcblx0XHRcdHN0ckxvb3AgOiBmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdC8vIGlnbm9yZSBzcGVjaWZpZWRcclxuXHRcdFx0XHRpZiAoZW5jbG9zaW5nTGV2ZWwgPT09IDAgJiYgUGFyc2VyVXRpbHMuaXNTdHJpbmdBdChzdHIsIHNlcGFyYXRvciwgaSkpIHtcclxuXHRcdFx0XHRcdHN1YlN0cmluZ3MucHVzaChzdWJTdHIpO1xyXG5cdFx0XHRcdFx0c3ViU3RyID0gJyc7XHJcblx0XHRcdFx0XHRpICs9IHNlcGFyYXRvci5sZW5ndGggLSAxO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRzdWJTdHIgKz0gc3RyW2ldO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0aWYgKGlnbm9yZS5vcGVuaW5nRXF1YWxzQ2xvc2luZykge1xyXG5cdFx0XHRcdFx0aWYgKFBhcnNlclV0aWxzLmlzU3RyaW5nQXQoc3RyLCBpZ25vcmUub3BlbmluZ1N0cmluZywgaSkpIHtcclxuXHRcdFx0XHRcdFx0aWYgKGVuY2xvc2luZ0xldmVsICUgMiA9PT0gMCAmJiByZW1haW5pbmdPcGVuaW5nU3RyaW5nQ291bnQgPT09IDEpIHtcclxuXHRcdFx0XHRcdFx0XHQvLyBub3QgaW4gYSBwYXJ0IHRoYXQgc2hvdWxkIGJlIHJlbW92ZWQgYW5kIHRoZXJlIGlzIHN0aWxsIGFuIG9wZW5pbmcgc3RyaW5nIGxlZnQsIHNvIHdlIGlnbm9yZSBpdFxyXG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGVuY2xvc2luZ0xldmVsICUgMiA9PT0gMCkge1xyXG5cdFx0XHRcdFx0XHRcdC8vIG9wZW5pbmcgc3RyaW5nXHJcblx0XHRcdFx0XHRcdFx0ZW5jbG9zaW5nTGV2ZWwgKz0gMTtcclxuXHJcblx0XHRcdFx0XHRcdFx0Ly8gY29weSB0aGUgb3BlbmluZyBzdHJpbmdcclxuXHRcdFx0XHRcdFx0XHRmb3IgKGxldCBqID0gMTsgaiA8IGlnbm9yZS5vcGVuaW5nU3RyaW5nLmxlbmd0aDsgaisrKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRpICs9IDE7XHJcblx0XHRcdFx0XHRcdFx0XHRzdWJTdHIgKz0gc3RyW2ldO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdGlmIChpID49IHN0ci5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0YnJlYWsgc3RyTG9vcDtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0Ly8gY2xvc2luZyBzdHJpbmdcclxuXHRcdFx0XHRcdFx0XHRlbmNsb3NpbmdMZXZlbCAtPSAxO1xyXG5cclxuXHRcdFx0XHRcdFx0XHQvLyBjb3B5IHRoZSBjbG9zaW5nIHN0cmluZ1xyXG5cdFx0XHRcdFx0XHRcdGZvciAobGV0IGogPSAxOyBqIDwgaWdub3JlLmNsb3NpbmdTdHJpbmcubGVuZ3RoOyBqKyspIHsgLy8gKG9wZW5pbmcgYW5kIGNsb3Npbmcgc3RyaW5nIGFyZSB0aGUgc2FtZSlcclxuXHRcdFx0XHRcdFx0XHRcdGkgKz0gMTtcclxuXHRcdFx0XHRcdFx0XHRcdHN1YlN0ciArPSBzdHJbaV07XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKGkgPj0gc3RyLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRicmVhayBzdHJMb29wO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRyZW1haW5pbmdPcGVuaW5nU3RyaW5nQ291bnQgLT0gMTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0aWYgKFBhcnNlclV0aWxzLmlzU3RyaW5nQXQoc3RyLCBpZ25vcmUub3BlbmluZ1N0cmluZywgaSkpIHtcclxuXHRcdFx0XHRcdFx0Ly8gb3BlbmluZyBzdHJpbmdcclxuXHRcdFx0XHRcdFx0aWYgKHJlbWFpbmluZ09wZW5pbmdTdHJpbmdDb3VudCA8PSByZW1haW5pbmdDbG9zaW5nU3RyaW5nQ291bnQpIHtcclxuXHRcdFx0XHRcdFx0XHQvLyBzdHIgc3RpbGwgaGFzIHN1ZmZpY2llbnQgY2xvc2luZyBzdHJpbmcgdG8gZmluZCB0aGlzIGEgcGFydG5lclxyXG5cdFx0XHRcdFx0XHRcdGVuY2xvc2luZ0xldmVsICs9IDE7XHJcblxyXG5cdFx0XHRcdFx0XHRcdC8vIGNvcHkgdGhlIG9wZW5pbmcgc3RyaW5nXHJcblx0XHRcdFx0XHRcdFx0Zm9yIChsZXQgaiA9IDE7IGogPCBpZ25vcmUub3BlbmluZ1N0cmluZy5sZW5ndGg7IGorKykge1xyXG5cdFx0XHRcdFx0XHRcdFx0aSArPSAxO1xyXG5cdFx0XHRcdFx0XHRcdFx0c3ViU3RyICs9IHN0cltpXTtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRpZiAoaSA+PSBzdHIubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrIHN0ckxvb3A7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdHJlbWFpbmluZ09wZW5pbmdTdHJpbmdDb3VudCAtPSAxO1xyXG5cdFx0XHRcdFx0fSBlbHNlIGlmIChQYXJzZXJVdGlscy5pc1N0cmluZ0F0KHN0ciwgaWdub3JlLmNsb3NpbmdTdHJpbmcsIGkpKSB7XHJcblx0XHRcdFx0XHRcdC8vIGNsb3Npbmcgc3RyaW5nXHJcblx0XHRcdFx0XHRcdGlmIChlbmNsb3NpbmdMZXZlbCA+IDApIHtcclxuXHRcdFx0XHRcdFx0XHQvLyB0aGVyZSB3YXMgYW4gb3BlbmluZyBzdHJpbmcgYmVmb3JlIHRoaXNcclxuXHRcdFx0XHRcdFx0XHRlbmNsb3NpbmdMZXZlbCAtPSAxO1xyXG5cclxuXHRcdFx0XHRcdFx0XHQvLyBjb3B5IHRoZSBjbG9zaW5nIHN0cmluZ1xyXG5cdFx0XHRcdFx0XHRcdGZvciAobGV0IGogPSAxOyBqIDwgaWdub3JlLmNsb3NpbmdTdHJpbmcubGVuZ3RoOyBqKyspIHtcclxuXHRcdFx0XHRcdFx0XHRcdGkgKz0gMTtcclxuXHRcdFx0XHRcdFx0XHRcdHN1YlN0ciArPSBzdHJbaV07XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKGkgPj0gc3RyLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRicmVhayBzdHJMb29wO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRyZW1haW5pbmdDbG9zaW5nU3RyaW5nQ291bnQgLT0gMTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8vIG5vIGlnbm9yZSBzcGVjaWZpZWRcclxuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcclxuXHJcblx0XHRcdFx0aWYgKFBhcnNlclV0aWxzLmlzU3RyaW5nQXQoc3RyLCBzZXBhcmF0b3IsIGkpKSB7XHJcblx0XHRcdFx0XHRzdWJTdHJpbmdzLnB1c2goc3ViU3RyKTtcclxuXHRcdFx0XHRcdHN1YlN0ciA9ICcnO1xyXG5cdFx0XHRcdFx0aSArPSBzZXBhcmF0b3IubGVuZ3RoIC0gMTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0c3ViU3RyICs9IHN0cltpXTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRzdWJTdHJpbmdzLnB1c2goc3ViU3RyKTtcclxuXHJcblx0XHRyZXR1cm4gc3ViU3RyaW5ncztcclxuXHR9XHJcblxyXG5cdHN0YXRpYyByZW1vdmVJbkJldHdlZW4oc3RyOiBzdHJpbmcsIGVuY2xvc2luZ1BhaXI6IEVuY2xvc2luZ1BhaXIpOiBzdHJpbmcge1xyXG5cdFx0aWYgKCFzdHIpIHtcclxuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcignc3RyaW5nIG11c3Qgbm90IGJlIGVtcHR5Jyk7XHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IHJlbWFpbmluZ09wZW5pbmdTdHJpbmdDb3VudCA9IFBhcnNlclV0aWxzLm51bWJlck9mT2NjdXJyZW5jZXMoc3RyLCBlbmNsb3NpbmdQYWlyLm9wZW5pbmdTdHJpbmcpO1xyXG5cdFx0bGV0IHJlbWFpbmluZ0Nsb3NpbmdTdHJpbmdDb3VudCA9IFBhcnNlclV0aWxzLm51bWJlck9mT2NjdXJyZW5jZXMoc3RyLCBlbmNsb3NpbmdQYWlyLmNsb3NpbmdTdHJpbmcpO1xyXG5cclxuXHRcdGxldCBlbmNsb3NpbmdMZXZlbDogbnVtYmVyID0gMDtcclxuXHJcblx0XHRsZXQgc3ViU3RyOiBzdHJpbmcgPSAnJztcclxuXHJcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRpZiAoZW5jbG9zaW5nUGFpci5vcGVuaW5nRXF1YWxzQ2xvc2luZykge1xyXG5cdFx0XHRcdGlmIChQYXJzZXJVdGlscy5pc1N0cmluZ0F0KHN0ciwgZW5jbG9zaW5nUGFpci5vcGVuaW5nU3RyaW5nLCBpKSkge1xyXG5cdFx0XHRcdFx0aWYgKGVuY2xvc2luZ0xldmVsICUgMiA9PT0gMCAmJiByZW1haW5pbmdPcGVuaW5nU3RyaW5nQ291bnQgPT09IDEpIHtcclxuXHRcdFx0XHRcdFx0Ly8gbm90IGluIGEgcGFydCB0aGF0IHNob3VsZCBiZSByZW1vdmVkIGFuZCB0aGVyZSBpcyBzdGlsbCBhbiBvcGVuaW5nIHN0cmluZyBsZWZ0LCBzbyB3ZSBpZ25vcmUgaXRcclxuXHRcdFx0XHRcdH0gZWxzZSBpZiAoZW5jbG9zaW5nTGV2ZWwgJSAyID09PSAwKSB7XHJcblx0XHRcdFx0XHRcdC8vIG9wZW5pbmcgc3RyaW5nXHJcblx0XHRcdFx0XHRcdGVuY2xvc2luZ0xldmVsICs9IDE7XHJcblxyXG5cdFx0XHRcdFx0XHQvLyBza2lwIHRoZSBvcGVuaW5nIHN0cmluZ1xyXG5cdFx0XHRcdFx0XHRpICs9IGVuY2xvc2luZ1BhaXIub3BlbmluZ1N0cmluZy5sZW5ndGg7XHJcblx0XHRcdFx0XHRcdGlmIChpID49IHN0ci5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0Ly8gY2xvc2luZyBzdHJpbmdcclxuXHRcdFx0XHRcdFx0ZW5jbG9zaW5nTGV2ZWwgLT0gMTtcclxuXHJcblx0XHRcdFx0XHRcdC8vIHNraXAgdGhlIGNsb3Npbmcgc3RyaW5nXHJcblx0XHRcdFx0XHRcdGkgKz0gZW5jbG9zaW5nUGFpci5jbG9zaW5nU3RyaW5nLmxlbmd0aDsgLy8gKG9wZW5pbmcgYW5kIGNsb3Npbmcgc3RyaW5nIGFyZSB0aGUgc2FtZSlcclxuXHRcdFx0XHRcdFx0aWYgKGkgPj0gc3RyLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRyZW1haW5pbmdPcGVuaW5nU3RyaW5nQ291bnQgLT0gMTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0aWYgKFBhcnNlclV0aWxzLmlzU3RyaW5nQXQoc3RyLCBlbmNsb3NpbmdQYWlyLm9wZW5pbmdTdHJpbmcsIGkpKSB7XHJcblx0XHRcdFx0XHQvLyBvcGVuaW5nIHN0cmluZ1xyXG5cdFx0XHRcdFx0aWYgKHJlbWFpbmluZ09wZW5pbmdTdHJpbmdDb3VudCA8PSByZW1haW5pbmdDbG9zaW5nU3RyaW5nQ291bnQpIHtcclxuXHRcdFx0XHRcdFx0Ly8gc3RyIHN0aWxsIGhhcyBzdWZmaWNpZW50IGNsb3Npbmcgc3RyaW5nIHRvIGZpbmQgdGhpcyBhIHBhcnRuZXJcclxuXHRcdFx0XHRcdFx0ZW5jbG9zaW5nTGV2ZWwgKz0gMTtcclxuXHJcblx0XHRcdFx0XHRcdC8vIHNraXAgdGhlIG9wZW5pbmcgc3RyaW5nXHJcblx0XHRcdFx0XHRcdGkgKz0gZW5jbG9zaW5nUGFpci5vcGVuaW5nU3RyaW5nLmxlbmd0aDtcclxuXHRcdFx0XHRcdFx0aWYgKGkgPj0gc3RyLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRyZW1haW5pbmdPcGVuaW5nU3RyaW5nQ291bnQgLT0gMTtcclxuXHRcdFx0XHR9IGVsc2UgaWYgKFBhcnNlclV0aWxzLmlzU3RyaW5nQXQoc3RyLCBlbmNsb3NpbmdQYWlyLmNsb3NpbmdTdHJpbmcsIGkpKSB7XHJcblx0XHRcdFx0XHQvLyBjbG9zaW5nIHN0cmluZ1xyXG5cdFx0XHRcdFx0aWYgKGVuY2xvc2luZ0xldmVsID4gMCkge1xyXG5cdFx0XHRcdFx0XHQvLyB0aGVyZSB3YXMgYW4gb3BlbmluZyBzdHJpbmcgYmVmb3JlIHRoaXNcclxuXHRcdFx0XHRcdFx0ZW5jbG9zaW5nTGV2ZWwgLT0gMTtcclxuXHJcblx0XHRcdFx0XHRcdC8vIHNraXAgdGhlIGNsb3Npbmcgc3RyaW5nXHJcblx0XHRcdFx0XHRcdGkgKz0gZW5jbG9zaW5nUGFpci5jbG9zaW5nU3RyaW5nLmxlbmd0aDtcclxuXHRcdFx0XHRcdFx0aWYgKGkgPj0gc3RyLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRyZW1haW5pbmdDbG9zaW5nU3RyaW5nQ291bnQgLT0gMTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmIChlbmNsb3NpbmdMZXZlbCA9PT0gMCkge1xyXG5cdFx0XHRcdHN1YlN0ciArPSBzdHJbaV07XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gc3ViU3RyO1xyXG5cdH1cclxuXHJcblx0c3RhdGljIGdldEluQmV0d2VlbihzdHI6IHN0cmluZywgZW5jbG9zaW5nUGFpcjogRW5jbG9zaW5nUGFpcik6IHN0cmluZyB8IHN0cmluZ1tdIHtcclxuXHRcdGlmICghc3RyKSB7XHJcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJ3N0cmluZyBtdXN0IG5vdCBiZSBlbXB0eScpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGxldCByZW1haW5pbmdPcGVuaW5nU3RyaW5nQ291bnQgPSBQYXJzZXJVdGlscy5udW1iZXJPZk9jY3VycmVuY2VzKHN0ciwgZW5jbG9zaW5nUGFpci5vcGVuaW5nU3RyaW5nKTtcclxuXHRcdGxldCByZW1haW5pbmdDbG9zaW5nU3RyaW5nQ291bnQgPSBQYXJzZXJVdGlscy5udW1iZXJPZk9jY3VycmVuY2VzKHN0ciwgZW5jbG9zaW5nUGFpci5jbG9zaW5nU3RyaW5nKTtcclxuXHJcblx0XHRsZXQgZW5jbG9zaW5nTGV2ZWw6IG51bWJlciA9IDA7XHJcblxyXG5cdFx0bGV0IHN1YlN0cjogc3RyaW5nID0gJyc7XHJcblx0XHRjb25zdCBzdWJTdHJpbmdzOiBzdHJpbmdbXSA9IFtdO1xyXG5cclxuXHRcdHN0ckxvb3AgOiBmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRpZiAoZW5jbG9zaW5nUGFpci5vcGVuaW5nRXF1YWxzQ2xvc2luZykge1xyXG5cdFx0XHRcdGlmIChQYXJzZXJVdGlscy5pc1N0cmluZ0F0KHN0ciwgZW5jbG9zaW5nUGFpci5vcGVuaW5nU3RyaW5nLCBpKSkge1xyXG5cdFx0XHRcdFx0aWYgKGVuY2xvc2luZ0xldmVsICUgMiA9PT0gMCAmJiByZW1haW5pbmdPcGVuaW5nU3RyaW5nQ291bnQgPT09IDEpIHtcclxuXHRcdFx0XHRcdFx0Ly8gbm90IGluIGEgcGFydCB0aGF0IHNob3VsZCBiZSByZW1vdmVkIGFuZCB0aGVyZSBpcyBzdGlsbCBhbiBvcGVuaW5nIHN0cmluZyBsZWZ0LCBzbyB3ZSBpZ25vcmUgaXRcclxuXHRcdFx0XHRcdH0gZWxzZSBpZiAoZW5jbG9zaW5nTGV2ZWwgJSAyID09PSAwKSB7XHJcblx0XHRcdFx0XHRcdC8vIG9wZW5pbmcgc3RyaW5nXHJcblx0XHRcdFx0XHRcdGVuY2xvc2luZ0xldmVsICs9IDE7XHJcblxyXG5cdFx0XHRcdFx0XHQvLyBza2lwIHRoZSBvcGVuaW5nIHN0cmluZ1xyXG5cdFx0XHRcdFx0XHRzdWJTdHIgKz0gc3RyW2ldO1xyXG5cdFx0XHRcdFx0XHRmb3IgKGxldCBqID0gMTsgaiA8IGVuY2xvc2luZ1BhaXIub3BlbmluZ1N0cmluZy5sZW5ndGg7IGorKykge1xyXG5cdFx0XHRcdFx0XHRcdGkgKz0gMTtcclxuXHRcdFx0XHRcdFx0XHRzdWJTdHIgKz0gc3RyW2ldO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRpZiAoaSA+PSBzdHIubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRicmVhayBzdHJMb29wO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0Ly8gY2xvc2luZyBzdHJpbmdcclxuXHRcdFx0XHRcdFx0ZW5jbG9zaW5nTGV2ZWwgLT0gMTtcclxuXHJcblx0XHRcdFx0XHRcdC8vIHNraXAgdGhlIGNsb3Npbmcgc3RyaW5nXHJcblx0XHRcdFx0XHRcdHN1YlN0ciArPSBzdHJbaV07XHJcblx0XHRcdFx0XHRcdGZvciAobGV0IGogPSAxOyBqIDwgZW5jbG9zaW5nUGFpci5jbG9zaW5nU3RyaW5nLmxlbmd0aDsgaisrKSB7IC8vIChvcGVuaW5nIGFuZCBjbG9zaW5nIHN0cmluZyBhcmUgdGhlIHNhbWUpXHJcblx0XHRcdFx0XHRcdFx0aSArPSAxO1xyXG5cdFx0XHRcdFx0XHRcdHN1YlN0ciArPSBzdHJbaV07XHJcblxyXG5cdFx0XHRcdFx0XHRcdGlmIChpID4gc3RyLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0YnJlYWsgc3RyTG9vcDtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0c3ViU3RyaW5ncy5wdXNoKHN1YlN0cik7XHJcblx0XHRcdFx0XHRcdHN1YlN0ciA9ICcnO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0cmVtYWluaW5nT3BlbmluZ1N0cmluZ0NvdW50IC09IDE7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGlmIChlbmNsb3NpbmdMZXZlbCA+PSAxKSB7XHJcblx0XHRcdFx0XHRcdHN1YlN0ciArPSBzdHJbaV07XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGlmIChQYXJzZXJVdGlscy5pc1N0cmluZ0F0KHN0ciwgZW5jbG9zaW5nUGFpci5vcGVuaW5nU3RyaW5nLCBpKSkge1xyXG5cdFx0XHRcdFx0Ly8gb3BlbmluZyBzdHJpbmdcclxuXHRcdFx0XHRcdGlmIChyZW1haW5pbmdPcGVuaW5nU3RyaW5nQ291bnQgPD0gcmVtYWluaW5nQ2xvc2luZ1N0cmluZ0NvdW50KSB7XHJcblx0XHRcdFx0XHRcdC8vIHN0ciBzdGlsbCBoYXMgc3VmZmljaWVudCBjbG9zaW5nIHN0cmluZyB0byBmaW5kIHRoaXMgYSBwYXJ0bmVyXHJcblx0XHRcdFx0XHRcdGVuY2xvc2luZ0xldmVsICs9IDE7XHJcblxyXG5cdFx0XHRcdFx0XHQvLyBjb3B5IHRoZSBvcGVuaW5nIHN0cmluZ1xyXG5cdFx0XHRcdFx0XHRzdWJTdHIgKz0gc3RyW2ldO1xyXG5cdFx0XHRcdFx0XHRmb3IgKGxldCBqID0gMTsgaiA8IGVuY2xvc2luZ1BhaXIub3BlbmluZ1N0cmluZy5sZW5ndGg7IGorKykge1xyXG5cdFx0XHRcdFx0XHRcdGkgKz0gMTtcclxuXHRcdFx0XHRcdFx0XHRzdWJTdHIgKz0gc3RyW2ldO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRpZiAoaSA+PSBzdHIubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRicmVhayBzdHJMb29wO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0cmVtYWluaW5nT3BlbmluZ1N0cmluZ0NvdW50IC09IDE7XHJcblx0XHRcdFx0fSBlbHNlIGlmIChQYXJzZXJVdGlscy5pc1N0cmluZ0F0KHN0ciwgZW5jbG9zaW5nUGFpci5jbG9zaW5nU3RyaW5nLCBpKSkge1xyXG5cdFx0XHRcdFx0Ly8gY2xvc2luZyBzdHJpbmdcclxuXHRcdFx0XHRcdGlmIChlbmNsb3NpbmdMZXZlbCA+IDApIHtcclxuXHRcdFx0XHRcdFx0Ly8gdGhlcmUgd2FzIGFuIG9wZW5pbmcgc3RyaW5nIGJlZm9yZSB0aGlzXHJcblx0XHRcdFx0XHRcdGVuY2xvc2luZ0xldmVsIC09IDE7XHJcblxyXG5cdFx0XHRcdFx0XHQvLyBjb3B5IHRoZSBjbG9zaW5nIHN0cmluZ1xyXG5cdFx0XHRcdFx0XHRzdWJTdHIgKz0gc3RyW2ldO1xyXG5cdFx0XHRcdFx0XHRmb3IgKGxldCBqID0gMTsgaiA8IGVuY2xvc2luZ1BhaXIuY2xvc2luZ1N0cmluZy5sZW5ndGg7IGorKykge1xyXG5cdFx0XHRcdFx0XHRcdGkgKz0gMTtcclxuXHRcdFx0XHRcdFx0XHRzdWJTdHIgKz0gc3RyW2ldO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRpZiAoaSA+IHN0ci5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGJyZWFrIHN0ckxvb3A7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0XHRpZiAoZW5jbG9zaW5nTGV2ZWwgPT09IDApIHtcclxuXHRcdFx0XHRcdFx0XHRzdWJTdHJpbmdzLnB1c2goc3ViU3RyKTtcclxuXHRcdFx0XHRcdFx0XHRzdWJTdHIgPSAnJztcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0cmVtYWluaW5nQ2xvc2luZ1N0cmluZ0NvdW50IC09IDE7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdGlmIChlbmNsb3NpbmdMZXZlbCA+PSAxKSB7XHJcblx0XHRcdFx0XHRcdHN1YlN0ciArPSBzdHJbaV07XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHN1YlN0cmluZ3MubGVuZ3RoID09PSAwKSB7XHJcblx0XHRcdHJldHVybiAnJztcclxuXHRcdH0gZWxzZSBpZiAoc3ViU3RyaW5ncy5sZW5ndGggPT09IDEpIHtcclxuXHRcdFx0cmV0dXJuIHN1YlN0cmluZ3NbMF0uc3Vic3RyaW5nKGVuY2xvc2luZ1BhaXIub3BlbmluZ1N0cmluZy5sZW5ndGgsIHN1YlN0cmluZ3NbMF0ubGVuZ3RoIC0gZW5jbG9zaW5nUGFpci5jbG9zaW5nU3RyaW5nLmxlbmd0aCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRyZXR1cm4gc3ViU3RyaW5ncy5tYXAoeCA9PiB4LnN1YnN0cmluZyhlbmNsb3NpbmdQYWlyLm9wZW5pbmdTdHJpbmcubGVuZ3RoLCB4Lmxlbmd0aCAtIGVuY2xvc2luZ1BhaXIuY2xvc2luZ1N0cmluZy5sZW5ndGgpKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHN0YXRpYyBpc1N0cmluZ0F0KHN0cjogc3RyaW5nLCBzdWJTdHI6IHN0cmluZywgaW5kZXg6IG51bWJlcik6IGJvb2xlYW4ge1xyXG5cdFx0aWYgKGluZGV4IDwgMCkge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCdpbmRleCBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwJyk7XHJcblx0XHR9XHJcblx0XHRpZiAoaW5kZXggPj0gc3RyLmxlbmd0aCkge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCdpbmRleCBvdXQgb2YgYm91bmRzIG9mIHN0cmluZycpO1xyXG5cdFx0fVxyXG5cdFx0aWYgKCFzdHIpIHtcclxuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcignc3RyaW5nIG11c3Qgbm90IGJlIGVtcHR5Jyk7XHJcblx0XHR9XHJcblx0XHRpZiAoIXN1YlN0cikge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCdzdWIgc3RyaW5nIG11c3Qgbm90IGJlIGVtcHR5Jyk7XHJcblx0XHR9XHJcblxyXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBzdWJTdHIubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0aWYgKHN0cltpICsgaW5kZXhdICE9PSBzdWJTdHJbaV0pIHtcclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdHJ1ZTtcclxuXHR9XHJcblxyXG5cdHN0YXRpYyBjb250YWlucyhzdHI6IHN0cmluZywgc3ViU3RyOiBzdHJpbmcpOiBib29sZWFuIHtcclxuXHRcdHJldHVybiBQYXJzZXJVdGlscy5udW1iZXJPZk9jY3VycmVuY2VzKHN0ciwgc3ViU3RyKSA+IDA7XHJcblx0fVxyXG5cclxuXHRzdGF0aWMgbnVtYmVyT2ZPY2N1cnJlbmNlcyhzdHI6IHN0cmluZywgc3ViU3RyOiBzdHJpbmcpOiBudW1iZXIge1xyXG5cdFx0aWYgKCFzdHIpIHtcclxuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kSW50ZXJuYWxFcnJvcignc3RyaW5nIG11c3Qgbm90IGJlIGVtcHR5Jyk7XHJcblx0XHR9XHJcblx0XHRpZiAoIXN1YlN0cikge1xyXG5cdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRJbnRlcm5hbEVycm9yKCdzdWIgc3RyaW5nIG11c3Qgbm90IGJlIGVtcHR5Jyk7XHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IG9jY3VycmVuY2VzID0gMDtcclxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdGlmIChQYXJzZXJVdGlscy5pc1N0cmluZ0F0KHN0ciwgc3ViU3RyLCBpKSkge1xyXG5cdFx0XHRcdG9jY3VycmVuY2VzICs9IDE7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gb2NjdXJyZW5jZXM7XHJcblx0fVxyXG59XHJcbiIsICJpbXBvcnQge0VuY2xvc2luZ1BhaXIsIFBhcnNlclV0aWxzfSBmcm9tICcuLi91dGlscy9QYXJzZXJVdGlscyc7XG5pbXBvcnQge2lzVHJ1dGh5LCBNZXRhQmluZFBhcnNpbmdFcnJvcn0gZnJvbSAnLi4vdXRpbHMvVXRpbHMnO1xuXG5leHBvcnQgZW51bSBJbnB1dEZpZWxkVHlwZSB7XG5cdFRPR0dMRSA9ICd0b2dnbGUnLFxuXHRTTElERVIgPSAnc2xpZGVyJyxcblx0VEVYVCA9ICd0ZXh0Jyxcblx0VEVYVF9BUkVBID0gJ3RleHRfYXJlYScsXG5cdFNFTEVDVCA9ICdzZWxlY3QnLFxuXHRNVUxUSV9TRUxFQ1QgPSAnbXVsdGlfc2VsZWN0Jyxcblx0REFURSA9ICdkYXRlJyxcblx0VElNRSA9ICd0aW1lJyxcblx0REFURV9QSUNLRVIgPSAnZGF0ZV9waWNrZXInLFxuXHRJTlZBTElEID0gJ2ludmFsaWQnLFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIElucHV0RmllbGREZWNsYXJhdGlvbiB7XG5cdGZ1bGxEZWNsYXJhdGlvbjogc3RyaW5nO1xuXHRkZWNsYXJhdGlvbjogc3RyaW5nO1xuXHRpbnB1dEZpZWxkVHlwZTogSW5wdXRGaWVsZFR5cGU7XG5cdGlzQm91bmQ6IGJvb2xlYW47XG5cdGJpbmRUYXJnZXQ6IHN0cmluZztcblxuXHRhcmd1bWVudHM6IElucHV0RmllbGRBcmd1bWVudFtdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElucHV0RmllbGRBcmd1bWVudCB7XG5cdG5hbWU6IHN0cmluZztcblx0dmFsdWU6IGFueTtcbn1cblxuZXhwb3J0IGNsYXNzIElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlciB7XG5cdHN0YXRpYyByb3VuZEJyYWNlc1BhaXI6IEVuY2xvc2luZ1BhaXIgPSBuZXcgRW5jbG9zaW5nUGFpcignKCcsICcpJyk7XG5cdHN0YXRpYyBzcXVhcmVCcmFjZXNQYWlyOiBFbmNsb3NpbmdQYWlyID0gbmV3IEVuY2xvc2luZ1BhaXIoJ1snLCAnXScpO1xuXHRzdGF0aWMgY3VybHlCcmFjZXNQYWlyOiBFbmNsb3NpbmdQYWlyID0gbmV3IEVuY2xvc2luZ1BhaXIoJ3snLCAnfScpO1xuXHRzdGF0aWMgYWxsQnJhY2VzUGFpcnM6IEVuY2xvc2luZ1BhaXJbXSA9IFtcblx0XHRJbnB1dEZpZWxkRGVjbGFyYXRpb25QYXJzZXIucm91bmRCcmFjZXNQYWlyLFxuXHRcdElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlci5zcXVhcmVCcmFjZXNQYWlyLFxuXHRcdElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlci5jdXJseUJyYWNlc1BhaXIsXG5cdF07XG5cblxuXHRzdGF0aWMgcGFyc2UoZnVsbERlY2xhcmF0aW9uOiBzdHJpbmcpOiBJbnB1dEZpZWxkRGVjbGFyYXRpb24ge1xuXHRcdGNvbnN0IGlucHV0RmllbGREZWNsYXJhdGlvbjogSW5wdXRGaWVsZERlY2xhcmF0aW9uID0ge30gYXMgSW5wdXRGaWVsZERlY2xhcmF0aW9uO1xuXG5cdFx0Ly8gZGVjbGFyYXRpb25cblx0XHRpbnB1dEZpZWxkRGVjbGFyYXRpb24uZnVsbERlY2xhcmF0aW9uID0gZnVsbERlY2xhcmF0aW9uO1xuXHRcdGlucHV0RmllbGREZWNsYXJhdGlvbi5kZWNsYXJhdGlvbiA9IFBhcnNlclV0aWxzLmdldEluQmV0d2VlbihmdWxsRGVjbGFyYXRpb24sIElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlci5zcXVhcmVCcmFjZXNQYWlyKSBhcyBzdHJpbmc7XG5cblx0XHQvLyBkZWNsYXJhdGlvbiBwYXJ0c1xuXHRcdGNvbnN0IGRlY2xhcmF0aW9uUGFydHM6IHN0cmluZ1tdID0gUGFyc2VyVXRpbHMuc3BsaXQoaW5wdXRGaWVsZERlY2xhcmF0aW9uLmRlY2xhcmF0aW9uLCAnOicsIElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlci5zcXVhcmVCcmFjZXNQYWlyKTtcblxuXHRcdC8vIGJpbmQgdGFyZ2V0XG5cdFx0aW5wdXRGaWVsZERlY2xhcmF0aW9uLmJpbmRUYXJnZXQgPSBkZWNsYXJhdGlvblBhcnRzWzFdID8/ICcnO1xuXHRcdGlucHV0RmllbGREZWNsYXJhdGlvbi5pc0JvdW5kID0gaXNUcnV0aHkoaW5wdXRGaWVsZERlY2xhcmF0aW9uLmJpbmRUYXJnZXQpO1xuXG5cdFx0Ly8gaW5wdXQgZmllbGQgdHlwZSBhbmQgYXJndW1lbnRzXG5cdFx0Y29uc3QgaW5wdXRGaWVsZFR5cGVXaXRoQXJndW1lbnRzOiBzdHJpbmcgPSBkZWNsYXJhdGlvblBhcnRzWzBdO1xuXHRcdC8vIGlucHV0IGZpZWxkIHR5cGVcblx0XHRjb25zdCBpbnB1dEZpZWxkVHlwZVN0cmluZyA9IFBhcnNlclV0aWxzLnJlbW92ZUluQmV0d2VlbihpbnB1dEZpZWxkVHlwZVdpdGhBcmd1bWVudHMsIElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlci5yb3VuZEJyYWNlc1BhaXIpO1xuXHRcdGlucHV0RmllbGREZWNsYXJhdGlvbi5pbnB1dEZpZWxkVHlwZSA9IElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlci5nZXRJbnB1dEZpZWxkVHlwZShpbnB1dEZpZWxkVHlwZVN0cmluZyk7XG5cdFx0aWYgKGlucHV0RmllbGREZWNsYXJhdGlvbi5pbnB1dEZpZWxkVHlwZSA9PT0gSW5wdXRGaWVsZFR5cGUuSU5WQUxJRCkge1xuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kUGFyc2luZ0Vycm9yKGB1bmtub3duIGlucHV0IGZpZWxkIHR5cGUgXFwnJHtpbnB1dEZpZWxkVHlwZVN0cmluZ31cXCdgKTtcblx0XHR9XG5cdFx0Ly8gYXJndW1lbnRzXG5cdFx0Y29uc3QgaW5wdXRGaWVsZEFyZ3VtZW50c1N0cmluZzogc3RyaW5nID0gUGFyc2VyVXRpbHMuZ2V0SW5CZXR3ZWVuKGlucHV0RmllbGRUeXBlV2l0aEFyZ3VtZW50cywgSW5wdXRGaWVsZERlY2xhcmF0aW9uUGFyc2VyLnJvdW5kQnJhY2VzUGFpcikgYXMgc3RyaW5nO1xuXHRcdC8vIGNvbnNvbGUubG9nKGlucHV0RmllbGRBcmd1bWVudHNTdHJpbmcpO1xuXHRcdGlmIChpbnB1dEZpZWxkQXJndW1lbnRzU3RyaW5nKSB7XG5cdFx0XHRpbnB1dEZpZWxkRGVjbGFyYXRpb24uYXJndW1lbnRzID0gSW5wdXRGaWVsZERlY2xhcmF0aW9uUGFyc2VyLnBhcnNlQXJndW1lbnRzKGlucHV0RmllbGRBcmd1bWVudHNTdHJpbmcsIGlucHV0RmllbGREZWNsYXJhdGlvbi5pbnB1dEZpZWxkVHlwZSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlucHV0RmllbGREZWNsYXJhdGlvbi5hcmd1bWVudHMgPSBbXTtcblx0XHR9XG5cdFx0Ly8gY29uc29sZS5sb2coaW5wdXRGaWVsZERlY2xhcmF0aW9uLmFyZ3VtZW50cyk7XG5cblx0XHRyZXR1cm4gaW5wdXRGaWVsZERlY2xhcmF0aW9uO1xuXHR9XG5cblx0c3RhdGljIHBhcnNlQXJndW1lbnRzKGlucHV0RmllbGRBcmd1bWVudHNTdHJpbmc6IHN0cmluZywgaW5wdXRGaWVsZFR5cGU6IElucHV0RmllbGRUeXBlKTogSW5wdXRGaWVsZEFyZ3VtZW50W10ge1xuXHRcdC8vIGNvbnNvbGUubG9nKCdpbnB1dEZpZWxkQXJndW1lbnRzU3RyaW5nJywgaW5wdXRGaWVsZEFyZ3VtZW50c1N0cmluZyk7XG5cdFx0bGV0IGlucHV0RmllbGRBcmd1bWVudFN0cmluZ3M6IHN0cmluZ1tdID0gUGFyc2VyVXRpbHMuc3BsaXQoaW5wdXRGaWVsZEFyZ3VtZW50c1N0cmluZywgJywnLCBJbnB1dEZpZWxkRGVjbGFyYXRpb25QYXJzZXIucm91bmRCcmFjZXNQYWlyKTtcblx0XHRpbnB1dEZpZWxkQXJndW1lbnRTdHJpbmdzID0gaW5wdXRGaWVsZEFyZ3VtZW50U3RyaW5ncy5tYXAoeCA9PiB4LnRyaW0oKSk7XG5cblx0XHRjb25zdCBpbnB1dEZpZWxkQXJndW1lbnRzOiBJbnB1dEZpZWxkQXJndW1lbnRbXSA9IFtdO1xuXG5cdFx0Zm9yIChjb25zdCBpbnB1dEZpZWxkQXJndW1lbnRTdHJpbmcgb2YgaW5wdXRGaWVsZEFyZ3VtZW50U3RyaW5ncykge1xuXHRcdFx0Y29uc3QgaW5wdXRGaWVsZEFyZ3VtZW50TmFtZTogc3RyaW5nID0gSW5wdXRGaWVsZERlY2xhcmF0aW9uUGFyc2VyLmV4dHJhY3RJbnB1dEZpZWxkQXJndW1lbnROYW1lKGlucHV0RmllbGRBcmd1bWVudFN0cmluZyk7XG5cdFx0XHQvLyBjb25zb2xlLmxvZyhpbnB1dEZpZWxkQXJndW1lbnROYW1lKTtcblxuXHRcdFx0aWYgKGlucHV0RmllbGRBcmd1bWVudE5hbWUgPT09ICdjbGFzcycpIHtcblx0XHRcdFx0Y29uc3QgaW5wdXRGaWVsZEFyZ3VtZW50VmFsdWU6IHN0cmluZyA9IElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlci5leHRyYWN0SW5wdXRGaWVsZEFyZ3VtZW50VmFsdWUoaW5wdXRGaWVsZEFyZ3VtZW50U3RyaW5nKTtcblxuXHRcdFx0XHRjb25zdCBpbnB1dEZpZWxkQ2xhc3NBcmd1bWVudDogSW5wdXRGaWVsZEFyZ3VtZW50ID0ge25hbWU6IGlucHV0RmllbGRBcmd1bWVudE5hbWUsIHZhbHVlOiBpbnB1dEZpZWxkQXJndW1lbnRWYWx1ZX07XG5cdFx0XHRcdGlucHV0RmllbGRBcmd1bWVudHMucHVzaChpbnB1dEZpZWxkQ2xhc3NBcmd1bWVudCk7XG5cdFx0XHR9XG5cblx0XHRcdGVsc2UgaWYgKGlucHV0RmllbGRBcmd1bWVudE5hbWUgPT09ICdhZGRMYWJlbHMnKSB7XG5cdFx0XHRcdGlmIChpbnB1dEZpZWxkVHlwZSAhPT0gSW5wdXRGaWVsZFR5cGUuU0xJREVSKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kUGFyc2luZ0Vycm9yKGBhcmd1bWVudCBcXCcke2lucHV0RmllbGRBcmd1bWVudE5hbWV9XFwnIGlzIG9ubHkgYXBwbGljYWJsZSB0byBzbGlkZXIgaW5wdXQgZmllbGRzYCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpbnB1dEZpZWxkQXJndW1lbnRzLnB1c2goe25hbWU6ICdsYWJlbHMnLCB2YWx1ZTogdHJ1ZX0pO1xuXHRcdFx0fVxuXG5cdFx0XHRlbHNlIGlmIChpbnB1dEZpZWxkQXJndW1lbnROYW1lID09PSAnbWluVmFsdWUnKSB7XG5cdFx0XHRcdGlmIChpbnB1dEZpZWxkVHlwZSAhPT0gSW5wdXRGaWVsZFR5cGUuU0xJREVSKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kUGFyc2luZ0Vycm9yKGBhcmd1bWVudCBcXCcke2lucHV0RmllbGRBcmd1bWVudE5hbWV9XFwnIGlzIG9ubHkgYXBwbGljYWJsZSB0byBzbGlkZXIgaW5wdXQgZmllbGRzYCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjb25zdCBpbnB1dEZpZWxkQXJndW1lbnRWYWx1ZTogc3RyaW5nID0gSW5wdXRGaWVsZERlY2xhcmF0aW9uUGFyc2VyLmV4dHJhY3RJbnB1dEZpZWxkQXJndW1lbnRWYWx1ZShpbnB1dEZpZWxkQXJndW1lbnRTdHJpbmcpO1xuXHRcdFx0XHRjb25zdCBpbnB1dEZpZWxkQXJndW1lbnRWYWx1ZUFzTnVtYmVyOiBudW1iZXIgPSBOdW1iZXIucGFyc2VJbnQoaW5wdXRGaWVsZEFyZ3VtZW50VmFsdWUpO1xuXG5cdFx0XHRcdGlmIChOdW1iZXIuaXNOYU4oaW5wdXRGaWVsZEFyZ3VtZW50VmFsdWVBc051bWJlcikpIHtcblx0XHRcdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRQYXJzaW5nRXJyb3IoYGFyZ3VtZW50IFxcJyR7aW5wdXRGaWVsZEFyZ3VtZW50TmFtZX1cXCcgdmFsdWUgbXVzdCBiZSBvZiB0eXBlIG51bWJlcmApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y29uc3QgaW5wdXRGaWVsZEFyZ3VtZW50T2JqZWN0OiBJbnB1dEZpZWxkQXJndW1lbnQgPSB7bmFtZTogaW5wdXRGaWVsZEFyZ3VtZW50TmFtZSwgdmFsdWU6IGlucHV0RmllbGRBcmd1bWVudFZhbHVlQXNOdW1iZXJ9O1xuXHRcdFx0XHRpbnB1dEZpZWxkQXJndW1lbnRzLnB1c2goaW5wdXRGaWVsZEFyZ3VtZW50T2JqZWN0KTtcblx0XHRcdH1cblxuXHRcdFx0ZWxzZSBpZiAoaW5wdXRGaWVsZEFyZ3VtZW50TmFtZSA9PT0gJ21heFZhbHVlJykge1xuXHRcdFx0XHRpZiAoaW5wdXRGaWVsZFR5cGUgIT09IElucHV0RmllbGRUeXBlLlNMSURFUikge1xuXHRcdFx0XHRcdHRocm93IG5ldyBNZXRhQmluZFBhcnNpbmdFcnJvcihgYXJndW1lbnQgXFwnJHtpbnB1dEZpZWxkQXJndW1lbnROYW1lfVxcJyBpcyBvbmx5IGFwcGxpY2FibGUgdG8gc2xpZGVyIGlucHV0IGZpZWxkc2ApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y29uc3QgaW5wdXRGaWVsZEFyZ3VtZW50VmFsdWU6IHN0cmluZyA9IElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlci5leHRyYWN0SW5wdXRGaWVsZEFyZ3VtZW50VmFsdWUoaW5wdXRGaWVsZEFyZ3VtZW50U3RyaW5nKTtcblx0XHRcdFx0Y29uc3QgaW5wdXRGaWVsZEFyZ3VtZW50VmFsdWVBc051bWJlcjogbnVtYmVyID0gTnVtYmVyLnBhcnNlSW50KGlucHV0RmllbGRBcmd1bWVudFZhbHVlKTtcblxuXHRcdFx0XHRpZiAoTnVtYmVyLmlzTmFOKGlucHV0RmllbGRBcmd1bWVudFZhbHVlQXNOdW1iZXIpKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kUGFyc2luZ0Vycm9yKGBhcmd1bWVudCBcXCcke2lucHV0RmllbGRBcmd1bWVudE5hbWV9XFwnIHZhbHVlIG11c3QgYmUgb2YgdHlwZSBudW1iZXJgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGNvbnN0IGlucHV0RmllbGRBcmd1bWVudE9iamVjdDogSW5wdXRGaWVsZEFyZ3VtZW50ID0ge25hbWU6IGlucHV0RmllbGRBcmd1bWVudE5hbWUsIHZhbHVlOiBpbnB1dEZpZWxkQXJndW1lbnRWYWx1ZUFzTnVtYmVyfTtcblx0XHRcdFx0aW5wdXRGaWVsZEFyZ3VtZW50cy5wdXNoKGlucHV0RmllbGRBcmd1bWVudE9iamVjdCk7XG5cdFx0XHR9XG5cblx0XHRcdGVsc2UgaWYgKGlucHV0RmllbGRBcmd1bWVudE5hbWUgPT09ICdvcHRpb24nKSB7XG5cdFx0XHRcdGlmIChpbnB1dEZpZWxkVHlwZSAhPT0gSW5wdXRGaWVsZFR5cGUuU0VMRUNUICYmIGlucHV0RmllbGRUeXBlICE9PSBJbnB1dEZpZWxkVHlwZS5NVUxUSV9TRUxFQ1QpIHtcblx0XHRcdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRQYXJzaW5nRXJyb3IoYGFyZ3VtZW50IFxcJyR7aW5wdXRGaWVsZEFyZ3VtZW50TmFtZX1cXCcgaXMgb25seSBhcHBsaWNhYmxlIHRvIHNlbGVjdCBhbmQgbXVsdGktc2VsZWN0IGlucHV0IGZpZWxkc2ApO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y29uc3QgaW5wdXRGaWVsZEFyZ3VtZW50VmFsdWU6IHN0cmluZyA9IElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlci5leHRyYWN0SW5wdXRGaWVsZEFyZ3VtZW50VmFsdWUoaW5wdXRGaWVsZEFyZ3VtZW50U3RyaW5nKTtcblxuXHRcdFx0XHRjb25zdCBpbnB1dEZpZWxkQXJndW1lbnRPYmplY3Q6IElucHV0RmllbGRBcmd1bWVudCA9IHtuYW1lOiBpbnB1dEZpZWxkQXJndW1lbnROYW1lLCB2YWx1ZTogaW5wdXRGaWVsZEFyZ3VtZW50VmFsdWV9O1xuXHRcdFx0XHRpbnB1dEZpZWxkQXJndW1lbnRzLnB1c2goaW5wdXRGaWVsZEFyZ3VtZW50T2JqZWN0KTtcblx0XHRcdH1cblxuXHRcdFx0ZWxzZSBpZiAoaW5wdXRGaWVsZEFyZ3VtZW50TmFtZSA9PT0gJ3RpdGxlJykge1xuXHRcdFx0XHRpZiAoaW5wdXRGaWVsZFR5cGUgIT09IElucHV0RmllbGRUeXBlLlNFTEVDVCAmJiBpbnB1dEZpZWxkVHlwZSAhPT0gSW5wdXRGaWVsZFR5cGUuTVVMVElfU0VMRUNUKSB7XG5cdFx0XHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kUGFyc2luZ0Vycm9yKGBhcmd1bWVudCBcXCcke2lucHV0RmllbGRBcmd1bWVudE5hbWV9XFwnIGlzIG9ubHkgYXBwbGljYWJsZSB0byBzZWxlY3QgYW5kIG11bHRpLXNlbGVjdCBpbnB1dCBmaWVsZHNgKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGNvbnN0IGlucHV0RmllbGRBcmd1bWVudFZhbHVlOiBzdHJpbmcgPSBJbnB1dEZpZWxkRGVjbGFyYXRpb25QYXJzZXIuZXh0cmFjdElucHV0RmllbGRBcmd1bWVudFZhbHVlKGlucHV0RmllbGRBcmd1bWVudFN0cmluZyk7XG5cblx0XHRcdFx0Y29uc3QgaW5wdXRGaWVsZEFyZ3VtZW50T2JqZWN0OiBJbnB1dEZpZWxkQXJndW1lbnQgPSB7bmFtZTogaW5wdXRGaWVsZEFyZ3VtZW50TmFtZSwgdmFsdWU6IGlucHV0RmllbGRBcmd1bWVudFZhbHVlfTtcblx0XHRcdFx0aW5wdXRGaWVsZEFyZ3VtZW50cy5wdXNoKGlucHV0RmllbGRBcmd1bWVudE9iamVjdCk7XG5cdFx0XHR9XG5cblx0XHRcdGVsc2Uge1xuXHRcdFx0XHR0aHJvdyBuZXcgTWV0YUJpbmRQYXJzaW5nRXJyb3IoYHVua25vd24gYXJndW1lbnQgXFwnJHtpbnB1dEZpZWxkQXJndW1lbnROYW1lfVxcJ2ApO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBpbnB1dEZpZWxkQXJndW1lbnRzO1xuXHR9XG5cblx0c3RhdGljIGV4dHJhY3RJbnB1dEZpZWxkQXJndW1lbnROYW1lKGFyZ3VtZW50U3RyaW5nOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdHJldHVybiBQYXJzZXJVdGlscy5yZW1vdmVJbkJldHdlZW4oYXJndW1lbnRTdHJpbmcsIElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlci5yb3VuZEJyYWNlc1BhaXIpO1xuXHR9XG5cblx0c3RhdGljIGV4dHJhY3RJbnB1dEZpZWxkQXJndW1lbnRWYWx1ZShhcmd1bWVudFN0cmluZzogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBhcmd1bWVudE5hbWUgPSB0aGlzLmV4dHJhY3RJbnB1dEZpZWxkQXJndW1lbnROYW1lKGFyZ3VtZW50U3RyaW5nKTtcblxuXHRcdGNvbnN0IGFyZ3VtZW50VmFsdWUgPSBQYXJzZXJVdGlscy5nZXRJbkJldHdlZW4oYXJndW1lbnRTdHJpbmcsIElucHV0RmllbGREZWNsYXJhdGlvblBhcnNlci5yb3VuZEJyYWNlc1BhaXIpIGFzIHN0cmluZztcblx0XHRpZiAoIWFyZ3VtZW50VmFsdWUpIHtcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZFBhcnNpbmdFcnJvcihgYXJndW1lbnQgXFwnJHthcmd1bWVudE5hbWV9XFwnIHJlcXVpcmVzIGEgbm9uIGVtcHR5IHZhbHVlYCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGFyZ3VtZW50VmFsdWU7XG5cdH1cblxuXHRzdGF0aWMgZ2V0SW5wdXRGaWVsZFR5cGUoc3RyOiBzdHJpbmcpOiBJbnB1dEZpZWxkVHlwZSB7XG5cdFx0Zm9yIChjb25zdCBlbnRyeSBvZiBPYmplY3QuZW50cmllcyhJbnB1dEZpZWxkVHlwZSkpIHtcblx0XHRcdGlmIChlbnRyeVsxXSA9PT0gc3RyKSB7XG5cdFx0XHRcdHJldHVybiBlbnRyeVsxXTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gSW5wdXRGaWVsZFR5cGUuSU5WQUxJRDtcblx0fVxuXG59XG4iLCAiZnVuY3Rpb24gbm9vcCgpIHsgfVxuY29uc3QgaWRlbnRpdHkgPSB4ID0+IHg7XG5mdW5jdGlvbiBhc3NpZ24odGFyLCBzcmMpIHtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgZm9yIChjb25zdCBrIGluIHNyYylcbiAgICAgICAgdGFyW2tdID0gc3JjW2tdO1xuICAgIHJldHVybiB0YXI7XG59XG5mdW5jdGlvbiBpc19wcm9taXNlKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIHZhbHVlLnRoZW4gPT09ICdmdW5jdGlvbic7XG59XG5mdW5jdGlvbiBhZGRfbG9jYXRpb24oZWxlbWVudCwgZmlsZSwgbGluZSwgY29sdW1uLCBjaGFyKSB7XG4gICAgZWxlbWVudC5fX3N2ZWx0ZV9tZXRhID0ge1xuICAgICAgICBsb2M6IHsgZmlsZSwgbGluZSwgY29sdW1uLCBjaGFyIH1cbiAgICB9O1xufVxuZnVuY3Rpb24gcnVuKGZuKSB7XG4gICAgcmV0dXJuIGZuKCk7XG59XG5mdW5jdGlvbiBibGFua19vYmplY3QoKSB7XG4gICAgcmV0dXJuIE9iamVjdC5jcmVhdGUobnVsbCk7XG59XG5mdW5jdGlvbiBydW5fYWxsKGZucykge1xuICAgIGZucy5mb3JFYWNoKHJ1bik7XG59XG5mdW5jdGlvbiBpc19mdW5jdGlvbih0aGluZykge1xuICAgIHJldHVybiB0eXBlb2YgdGhpbmcgPT09ICdmdW5jdGlvbic7XG59XG5mdW5jdGlvbiBzYWZlX25vdF9lcXVhbChhLCBiKSB7XG4gICAgcmV0dXJuIGEgIT0gYSA/IGIgPT0gYiA6IGEgIT09IGIgfHwgKChhICYmIHR5cGVvZiBhID09PSAnb2JqZWN0JykgfHwgdHlwZW9mIGEgPT09ICdmdW5jdGlvbicpO1xufVxubGV0IHNyY191cmxfZXF1YWxfYW5jaG9yO1xuZnVuY3Rpb24gc3JjX3VybF9lcXVhbChlbGVtZW50X3NyYywgdXJsKSB7XG4gICAgaWYgKCFzcmNfdXJsX2VxdWFsX2FuY2hvcikge1xuICAgICAgICBzcmNfdXJsX2VxdWFsX2FuY2hvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICB9XG4gICAgc3JjX3VybF9lcXVhbF9hbmNob3IuaHJlZiA9IHVybDtcbiAgICByZXR1cm4gZWxlbWVudF9zcmMgPT09IHNyY191cmxfZXF1YWxfYW5jaG9yLmhyZWY7XG59XG5mdW5jdGlvbiBub3RfZXF1YWwoYSwgYikge1xuICAgIHJldHVybiBhICE9IGEgPyBiID09IGIgOiBhICE9PSBiO1xufVxuZnVuY3Rpb24gaXNfZW1wdHkob2JqKSB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKG9iaikubGVuZ3RoID09PSAwO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVfc3RvcmUoc3RvcmUsIG5hbWUpIHtcbiAgICBpZiAoc3RvcmUgIT0gbnVsbCAmJiB0eXBlb2Ygc3RvcmUuc3Vic2NyaWJlICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgJyR7bmFtZX0nIGlzIG5vdCBhIHN0b3JlIHdpdGggYSAnc3Vic2NyaWJlJyBtZXRob2RgKTtcbiAgICB9XG59XG5mdW5jdGlvbiBzdWJzY3JpYmUoc3RvcmUsIC4uLmNhbGxiYWNrcykge1xuICAgIGlmIChzdG9yZSA9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBub29wO1xuICAgIH1cbiAgICBjb25zdCB1bnN1YiA9IHN0b3JlLnN1YnNjcmliZSguLi5jYWxsYmFja3MpO1xuICAgIHJldHVybiB1bnN1Yi51bnN1YnNjcmliZSA/ICgpID0+IHVuc3ViLnVuc3Vic2NyaWJlKCkgOiB1bnN1Yjtcbn1cbmZ1bmN0aW9uIGdldF9zdG9yZV92YWx1ZShzdG9yZSkge1xuICAgIGxldCB2YWx1ZTtcbiAgICBzdWJzY3JpYmUoc3RvcmUsIF8gPT4gdmFsdWUgPSBfKSgpO1xuICAgIHJldHVybiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIGNvbXBvbmVudF9zdWJzY3JpYmUoY29tcG9uZW50LCBzdG9yZSwgY2FsbGJhY2spIHtcbiAgICBjb21wb25lbnQuJCQub25fZGVzdHJveS5wdXNoKHN1YnNjcmliZShzdG9yZSwgY2FsbGJhY2spKTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZV9zbG90KGRlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZm4pIHtcbiAgICBpZiAoZGVmaW5pdGlvbikge1xuICAgICAgICBjb25zdCBzbG90X2N0eCA9IGdldF9zbG90X2NvbnRleHQoZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBmbik7XG4gICAgICAgIHJldHVybiBkZWZpbml0aW9uWzBdKHNsb3RfY3R4KTtcbiAgICB9XG59XG5mdW5jdGlvbiBnZXRfc2xvdF9jb250ZXh0KGRlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgZm4pIHtcbiAgICByZXR1cm4gZGVmaW5pdGlvblsxXSAmJiBmblxuICAgICAgICA/IGFzc2lnbigkJHNjb3BlLmN0eC5zbGljZSgpLCBkZWZpbml0aW9uWzFdKGZuKGN0eCkpKVxuICAgICAgICA6ICQkc2NvcGUuY3R4O1xufVxuZnVuY3Rpb24gZ2V0X3Nsb3RfY2hhbmdlcyhkZWZpbml0aW9uLCAkJHNjb3BlLCBkaXJ0eSwgZm4pIHtcbiAgICBpZiAoZGVmaW5pdGlvblsyXSAmJiBmbikge1xuICAgICAgICBjb25zdCBsZXRzID0gZGVmaW5pdGlvblsyXShmbihkaXJ0eSkpO1xuICAgICAgICBpZiAoJCRzY29wZS5kaXJ0eSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gbGV0cztcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGxldHMgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBjb25zdCBtZXJnZWQgPSBbXTtcbiAgICAgICAgICAgIGNvbnN0IGxlbiA9IE1hdGgubWF4KCQkc2NvcGUuZGlydHkubGVuZ3RoLCBsZXRzLmxlbmd0aCk7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSArPSAxKSB7XG4gICAgICAgICAgICAgICAgbWVyZ2VkW2ldID0gJCRzY29wZS5kaXJ0eVtpXSB8IGxldHNbaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbWVyZ2VkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAkJHNjb3BlLmRpcnR5IHwgbGV0cztcbiAgICB9XG4gICAgcmV0dXJuICQkc2NvcGUuZGlydHk7XG59XG5mdW5jdGlvbiB1cGRhdGVfc2xvdF9iYXNlKHNsb3QsIHNsb3RfZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBzbG90X2NoYW5nZXMsIGdldF9zbG90X2NvbnRleHRfZm4pIHtcbiAgICBpZiAoc2xvdF9jaGFuZ2VzKSB7XG4gICAgICAgIGNvbnN0IHNsb3RfY29udGV4dCA9IGdldF9zbG90X2NvbnRleHQoc2xvdF9kZWZpbml0aW9uLCBjdHgsICQkc2NvcGUsIGdldF9zbG90X2NvbnRleHRfZm4pO1xuICAgICAgICBzbG90LnAoc2xvdF9jb250ZXh0LCBzbG90X2NoYW5nZXMpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHVwZGF0ZV9zbG90KHNsb3QsIHNsb3RfZGVmaW5pdGlvbiwgY3R4LCAkJHNjb3BlLCBkaXJ0eSwgZ2V0X3Nsb3RfY2hhbmdlc19mbiwgZ2V0X3Nsb3RfY29udGV4dF9mbikge1xuICAgIGNvbnN0IHNsb3RfY2hhbmdlcyA9IGdldF9zbG90X2NoYW5nZXMoc2xvdF9kZWZpbml0aW9uLCAkJHNjb3BlLCBkaXJ0eSwgZ2V0X3Nsb3RfY2hhbmdlc19mbik7XG4gICAgdXBkYXRlX3Nsb3RfYmFzZShzbG90LCBzbG90X2RlZmluaXRpb24sIGN0eCwgJCRzY29wZSwgc2xvdF9jaGFuZ2VzLCBnZXRfc2xvdF9jb250ZXh0X2ZuKTtcbn1cbmZ1bmN0aW9uIGdldF9hbGxfZGlydHlfZnJvbV9zY29wZSgkJHNjb3BlKSB7XG4gICAgaWYgKCQkc2NvcGUuY3R4Lmxlbmd0aCA+IDMyKSB7XG4gICAgICAgIGNvbnN0IGRpcnR5ID0gW107XG4gICAgICAgIGNvbnN0IGxlbmd0aCA9ICQkc2NvcGUuY3R4Lmxlbmd0aCAvIDMyO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBkaXJ0eVtpXSA9IC0xO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkaXJ0eTtcbiAgICB9XG4gICAgcmV0dXJuIC0xO1xufVxuZnVuY3Rpb24gZXhjbHVkZV9pbnRlcm5hbF9wcm9wcyhwcm9wcykge1xuICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgIGZvciAoY29uc3QgayBpbiBwcm9wcylcbiAgICAgICAgaWYgKGtbMF0gIT09ICckJylcbiAgICAgICAgICAgIHJlc3VsdFtrXSA9IHByb3BzW2tdO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBjb21wdXRlX3Jlc3RfcHJvcHMocHJvcHMsIGtleXMpIHtcbiAgICBjb25zdCByZXN0ID0ge307XG4gICAga2V5cyA9IG5ldyBTZXQoa2V5cyk7XG4gICAgZm9yIChjb25zdCBrIGluIHByb3BzKVxuICAgICAgICBpZiAoIWtleXMuaGFzKGspICYmIGtbMF0gIT09ICckJylcbiAgICAgICAgICAgIHJlc3Rba10gPSBwcm9wc1trXTtcbiAgICByZXR1cm4gcmVzdDtcbn1cbmZ1bmN0aW9uIGNvbXB1dGVfc2xvdHMoc2xvdHMpIHtcbiAgICBjb25zdCByZXN1bHQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBzbG90cykge1xuICAgICAgICByZXN1bHRba2V5XSA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBvbmNlKGZuKSB7XG4gICAgbGV0IHJhbiA9IGZhbHNlO1xuICAgIHJldHVybiBmdW5jdGlvbiAoLi4uYXJncykge1xuICAgICAgICBpZiAocmFuKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICByYW4gPSB0cnVlO1xuICAgICAgICBmbi5jYWxsKHRoaXMsIC4uLmFyZ3MpO1xuICAgIH07XG59XG5mdW5jdGlvbiBudWxsX3RvX2VtcHR5KHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlID09IG51bGwgPyAnJyA6IHZhbHVlO1xufVxuZnVuY3Rpb24gc2V0X3N0b3JlX3ZhbHVlKHN0b3JlLCByZXQsIHZhbHVlKSB7XG4gICAgc3RvcmUuc2V0KHZhbHVlKTtcbiAgICByZXR1cm4gcmV0O1xufVxuY29uc3QgaGFzX3Byb3AgPSAob2JqLCBwcm9wKSA9PiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTtcbmZ1bmN0aW9uIGFjdGlvbl9kZXN0cm95ZXIoYWN0aW9uX3Jlc3VsdCkge1xuICAgIHJldHVybiBhY3Rpb25fcmVzdWx0ICYmIGlzX2Z1bmN0aW9uKGFjdGlvbl9yZXN1bHQuZGVzdHJveSkgPyBhY3Rpb25fcmVzdWx0LmRlc3Ryb3kgOiBub29wO1xufVxuXG5jb25zdCBpc19jbGllbnQgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJztcbmxldCBub3cgPSBpc19jbGllbnRcbiAgICA/ICgpID0+IHdpbmRvdy5wZXJmb3JtYW5jZS5ub3coKVxuICAgIDogKCkgPT4gRGF0ZS5ub3coKTtcbmxldCByYWYgPSBpc19jbGllbnQgPyBjYiA9PiByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoY2IpIDogbm9vcDtcbi8vIHVzZWQgaW50ZXJuYWxseSBmb3IgdGVzdGluZ1xuZnVuY3Rpb24gc2V0X25vdyhmbikge1xuICAgIG5vdyA9IGZuO1xufVxuZnVuY3Rpb24gc2V0X3JhZihmbikge1xuICAgIHJhZiA9IGZuO1xufVxuXG5jb25zdCB0YXNrcyA9IG5ldyBTZXQoKTtcbmZ1bmN0aW9uIHJ1bl90YXNrcyhub3cpIHtcbiAgICB0YXNrcy5mb3JFYWNoKHRhc2sgPT4ge1xuICAgICAgICBpZiAoIXRhc2suYyhub3cpKSB7XG4gICAgICAgICAgICB0YXNrcy5kZWxldGUodGFzayk7XG4gICAgICAgICAgICB0YXNrLmYoKTtcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGlmICh0YXNrcy5zaXplICE9PSAwKVxuICAgICAgICByYWYocnVuX3Rhc2tzKTtcbn1cbi8qKlxuICogRm9yIHRlc3RpbmcgcHVycG9zZXMgb25seSFcbiAqL1xuZnVuY3Rpb24gY2xlYXJfbG9vcHMoKSB7XG4gICAgdGFza3MuY2xlYXIoKTtcbn1cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyB0YXNrIHRoYXQgcnVucyBvbiBlYWNoIHJhZiBmcmFtZVxuICogdW50aWwgaXQgcmV0dXJucyBhIGZhbHN5IHZhbHVlIG9yIGlzIGFib3J0ZWRcbiAqL1xuZnVuY3Rpb24gbG9vcChjYWxsYmFjaykge1xuICAgIGxldCB0YXNrO1xuICAgIGlmICh0YXNrcy5zaXplID09PSAwKVxuICAgICAgICByYWYocnVuX3Rhc2tzKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBwcm9taXNlOiBuZXcgUHJvbWlzZShmdWxmaWxsID0+IHtcbiAgICAgICAgICAgIHRhc2tzLmFkZCh0YXNrID0geyBjOiBjYWxsYmFjaywgZjogZnVsZmlsbCB9KTtcbiAgICAgICAgfSksXG4gICAgICAgIGFib3J0KCkge1xuICAgICAgICAgICAgdGFza3MuZGVsZXRlKHRhc2spO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuLy8gVHJhY2sgd2hpY2ggbm9kZXMgYXJlIGNsYWltZWQgZHVyaW5nIGh5ZHJhdGlvbi4gVW5jbGFpbWVkIG5vZGVzIGNhbiB0aGVuIGJlIHJlbW92ZWQgZnJvbSB0aGUgRE9NXG4vLyBhdCB0aGUgZW5kIG9mIGh5ZHJhdGlvbiB3aXRob3V0IHRvdWNoaW5nIHRoZSByZW1haW5pbmcgbm9kZXMuXG5sZXQgaXNfaHlkcmF0aW5nID0gZmFsc2U7XG5mdW5jdGlvbiBzdGFydF9oeWRyYXRpbmcoKSB7XG4gICAgaXNfaHlkcmF0aW5nID0gdHJ1ZTtcbn1cbmZ1bmN0aW9uIGVuZF9oeWRyYXRpbmcoKSB7XG4gICAgaXNfaHlkcmF0aW5nID0gZmFsc2U7XG59XG5mdW5jdGlvbiB1cHBlcl9ib3VuZChsb3csIGhpZ2gsIGtleSwgdmFsdWUpIHtcbiAgICAvLyBSZXR1cm4gZmlyc3QgaW5kZXggb2YgdmFsdWUgbGFyZ2VyIHRoYW4gaW5wdXQgdmFsdWUgaW4gdGhlIHJhbmdlIFtsb3csIGhpZ2gpXG4gICAgd2hpbGUgKGxvdyA8IGhpZ2gpIHtcbiAgICAgICAgY29uc3QgbWlkID0gbG93ICsgKChoaWdoIC0gbG93KSA+PiAxKTtcbiAgICAgICAgaWYgKGtleShtaWQpIDw9IHZhbHVlKSB7XG4gICAgICAgICAgICBsb3cgPSBtaWQgKyAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaGlnaCA9IG1pZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbG93O1xufVxuZnVuY3Rpb24gaW5pdF9oeWRyYXRlKHRhcmdldCkge1xuICAgIGlmICh0YXJnZXQuaHlkcmF0ZV9pbml0KVxuICAgICAgICByZXR1cm47XG4gICAgdGFyZ2V0Lmh5ZHJhdGVfaW5pdCA9IHRydWU7XG4gICAgLy8gV2Uga25vdyB0aGF0IGFsbCBjaGlsZHJlbiBoYXZlIGNsYWltX29yZGVyIHZhbHVlcyBzaW5jZSB0aGUgdW5jbGFpbWVkIGhhdmUgYmVlbiBkZXRhY2hlZCBpZiB0YXJnZXQgaXMgbm90IDxoZWFkPlxuICAgIGxldCBjaGlsZHJlbiA9IHRhcmdldC5jaGlsZE5vZGVzO1xuICAgIC8vIElmIHRhcmdldCBpcyA8aGVhZD4sIHRoZXJlIG1heSBiZSBjaGlsZHJlbiB3aXRob3V0IGNsYWltX29yZGVyXG4gICAgaWYgKHRhcmdldC5ub2RlTmFtZSA9PT0gJ0hFQUQnKSB7XG4gICAgICAgIGNvbnN0IG15Q2hpbGRyZW4gPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3Qgbm9kZSA9IGNoaWxkcmVuW2ldO1xuICAgICAgICAgICAgaWYgKG5vZGUuY2xhaW1fb3JkZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIG15Q2hpbGRyZW4ucHVzaChub2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjaGlsZHJlbiA9IG15Q2hpbGRyZW47XG4gICAgfVxuICAgIC8qXG4gICAgKiBSZW9yZGVyIGNsYWltZWQgY2hpbGRyZW4gb3B0aW1hbGx5LlxuICAgICogV2UgY2FuIHJlb3JkZXIgY2xhaW1lZCBjaGlsZHJlbiBvcHRpbWFsbHkgYnkgZmluZGluZyB0aGUgbG9uZ2VzdCBzdWJzZXF1ZW5jZSBvZlxuICAgICogbm9kZXMgdGhhdCBhcmUgYWxyZWFkeSBjbGFpbWVkIGluIG9yZGVyIGFuZCBvbmx5IG1vdmluZyB0aGUgcmVzdC4gVGhlIGxvbmdlc3RcbiAgICAqIHN1YnNlcXVlbmNlIHN1YnNlcXVlbmNlIG9mIG5vZGVzIHRoYXQgYXJlIGNsYWltZWQgaW4gb3JkZXIgY2FuIGJlIGZvdW5kIGJ5XG4gICAgKiBjb21wdXRpbmcgdGhlIGxvbmdlc3QgaW5jcmVhc2luZyBzdWJzZXF1ZW5jZSBvZiAuY2xhaW1fb3JkZXIgdmFsdWVzLlxuICAgICpcbiAgICAqIFRoaXMgYWxnb3JpdGhtIGlzIG9wdGltYWwgaW4gZ2VuZXJhdGluZyB0aGUgbGVhc3QgYW1vdW50IG9mIHJlb3JkZXIgb3BlcmF0aW9uc1xuICAgICogcG9zc2libGUuXG4gICAgKlxuICAgICogUHJvb2Y6XG4gICAgKiBXZSBrbm93IHRoYXQsIGdpdmVuIGEgc2V0IG9mIHJlb3JkZXJpbmcgb3BlcmF0aW9ucywgdGhlIG5vZGVzIHRoYXQgZG8gbm90IG1vdmVcbiAgICAqIGFsd2F5cyBmb3JtIGFuIGluY3JlYXNpbmcgc3Vic2VxdWVuY2UsIHNpbmNlIHRoZXkgZG8gbm90IG1vdmUgYW1vbmcgZWFjaCBvdGhlclxuICAgICogbWVhbmluZyB0aGF0IHRoZXkgbXVzdCBiZSBhbHJlYWR5IG9yZGVyZWQgYW1vbmcgZWFjaCBvdGhlci4gVGh1cywgdGhlIG1heGltYWxcbiAgICAqIHNldCBvZiBub2RlcyB0aGF0IGRvIG5vdCBtb3ZlIGZvcm0gYSBsb25nZXN0IGluY3JlYXNpbmcgc3Vic2VxdWVuY2UuXG4gICAgKi9cbiAgICAvLyBDb21wdXRlIGxvbmdlc3QgaW5jcmVhc2luZyBzdWJzZXF1ZW5jZVxuICAgIC8vIG06IHN1YnNlcXVlbmNlIGxlbmd0aCBqID0+IGluZGV4IGsgb2Ygc21hbGxlc3QgdmFsdWUgdGhhdCBlbmRzIGFuIGluY3JlYXNpbmcgc3Vic2VxdWVuY2Ugb2YgbGVuZ3RoIGpcbiAgICBjb25zdCBtID0gbmV3IEludDMyQXJyYXkoY2hpbGRyZW4ubGVuZ3RoICsgMSk7XG4gICAgLy8gUHJlZGVjZXNzb3IgaW5kaWNlcyArIDFcbiAgICBjb25zdCBwID0gbmV3IEludDMyQXJyYXkoY2hpbGRyZW4ubGVuZ3RoKTtcbiAgICBtWzBdID0gLTE7XG4gICAgbGV0IGxvbmdlc3QgPSAwO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgY3VycmVudCA9IGNoaWxkcmVuW2ldLmNsYWltX29yZGVyO1xuICAgICAgICAvLyBGaW5kIHRoZSBsYXJnZXN0IHN1YnNlcXVlbmNlIGxlbmd0aCBzdWNoIHRoYXQgaXQgZW5kcyBpbiBhIHZhbHVlIGxlc3MgdGhhbiBvdXIgY3VycmVudCB2YWx1ZVxuICAgICAgICAvLyB1cHBlcl9ib3VuZCByZXR1cm5zIGZpcnN0IGdyZWF0ZXIgdmFsdWUsIHNvIHdlIHN1YnRyYWN0IG9uZVxuICAgICAgICAvLyB3aXRoIGZhc3QgcGF0aCBmb3Igd2hlbiB3ZSBhcmUgb24gdGhlIGN1cnJlbnQgbG9uZ2VzdCBzdWJzZXF1ZW5jZVxuICAgICAgICBjb25zdCBzZXFMZW4gPSAoKGxvbmdlc3QgPiAwICYmIGNoaWxkcmVuW21bbG9uZ2VzdF1dLmNsYWltX29yZGVyIDw9IGN1cnJlbnQpID8gbG9uZ2VzdCArIDEgOiB1cHBlcl9ib3VuZCgxLCBsb25nZXN0LCBpZHggPT4gY2hpbGRyZW5bbVtpZHhdXS5jbGFpbV9vcmRlciwgY3VycmVudCkpIC0gMTtcbiAgICAgICAgcFtpXSA9IG1bc2VxTGVuXSArIDE7XG4gICAgICAgIGNvbnN0IG5ld0xlbiA9IHNlcUxlbiArIDE7XG4gICAgICAgIC8vIFdlIGNhbiBndWFyYW50ZWUgdGhhdCBjdXJyZW50IGlzIHRoZSBzbWFsbGVzdCB2YWx1ZS4gT3RoZXJ3aXNlLCB3ZSB3b3VsZCBoYXZlIGdlbmVyYXRlZCBhIGxvbmdlciBzZXF1ZW5jZS5cbiAgICAgICAgbVtuZXdMZW5dID0gaTtcbiAgICAgICAgbG9uZ2VzdCA9IE1hdGgubWF4KG5ld0xlbiwgbG9uZ2VzdCk7XG4gICAgfVxuICAgIC8vIFRoZSBsb25nZXN0IGluY3JlYXNpbmcgc3Vic2VxdWVuY2Ugb2Ygbm9kZXMgKGluaXRpYWxseSByZXZlcnNlZClcbiAgICBjb25zdCBsaXMgPSBbXTtcbiAgICAvLyBUaGUgcmVzdCBvZiB0aGUgbm9kZXMsIG5vZGVzIHRoYXQgd2lsbCBiZSBtb3ZlZFxuICAgIGNvbnN0IHRvTW92ZSA9IFtdO1xuICAgIGxldCBsYXN0ID0gY2hpbGRyZW4ubGVuZ3RoIC0gMTtcbiAgICBmb3IgKGxldCBjdXIgPSBtW2xvbmdlc3RdICsgMTsgY3VyICE9IDA7IGN1ciA9IHBbY3VyIC0gMV0pIHtcbiAgICAgICAgbGlzLnB1c2goY2hpbGRyZW5bY3VyIC0gMV0pO1xuICAgICAgICBmb3IgKDsgbGFzdCA+PSBjdXI7IGxhc3QtLSkge1xuICAgICAgICAgICAgdG9Nb3ZlLnB1c2goY2hpbGRyZW5bbGFzdF0pO1xuICAgICAgICB9XG4gICAgICAgIGxhc3QtLTtcbiAgICB9XG4gICAgZm9yICg7IGxhc3QgPj0gMDsgbGFzdC0tKSB7XG4gICAgICAgIHRvTW92ZS5wdXNoKGNoaWxkcmVuW2xhc3RdKTtcbiAgICB9XG4gICAgbGlzLnJldmVyc2UoKTtcbiAgICAvLyBXZSBzb3J0IHRoZSBub2RlcyBiZWluZyBtb3ZlZCB0byBndWFyYW50ZWUgdGhhdCB0aGVpciBpbnNlcnRpb24gb3JkZXIgbWF0Y2hlcyB0aGUgY2xhaW0gb3JkZXJcbiAgICB0b01vdmUuc29ydCgoYSwgYikgPT4gYS5jbGFpbV9vcmRlciAtIGIuY2xhaW1fb3JkZXIpO1xuICAgIC8vIEZpbmFsbHksIHdlIG1vdmUgdGhlIG5vZGVzXG4gICAgZm9yIChsZXQgaSA9IDAsIGogPSAwOyBpIDwgdG9Nb3ZlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHdoaWxlIChqIDwgbGlzLmxlbmd0aCAmJiB0b01vdmVbaV0uY2xhaW1fb3JkZXIgPj0gbGlzW2pdLmNsYWltX29yZGVyKSB7XG4gICAgICAgICAgICBqKys7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYW5jaG9yID0gaiA8IGxpcy5sZW5ndGggPyBsaXNbal0gOiBudWxsO1xuICAgICAgICB0YXJnZXQuaW5zZXJ0QmVmb3JlKHRvTW92ZVtpXSwgYW5jaG9yKTtcbiAgICB9XG59XG5mdW5jdGlvbiBhcHBlbmQodGFyZ2V0LCBub2RlKSB7XG4gICAgdGFyZ2V0LmFwcGVuZENoaWxkKG5vZGUpO1xufVxuZnVuY3Rpb24gYXBwZW5kX3N0eWxlcyh0YXJnZXQsIHN0eWxlX3NoZWV0X2lkLCBzdHlsZXMpIHtcbiAgICBjb25zdCBhcHBlbmRfc3R5bGVzX3RvID0gZ2V0X3Jvb3RfZm9yX3N0eWxlKHRhcmdldCk7XG4gICAgaWYgKCFhcHBlbmRfc3R5bGVzX3RvLmdldEVsZW1lbnRCeUlkKHN0eWxlX3NoZWV0X2lkKSkge1xuICAgICAgICBjb25zdCBzdHlsZSA9IGVsZW1lbnQoJ3N0eWxlJyk7XG4gICAgICAgIHN0eWxlLmlkID0gc3R5bGVfc2hlZXRfaWQ7XG4gICAgICAgIHN0eWxlLnRleHRDb250ZW50ID0gc3R5bGVzO1xuICAgICAgICBhcHBlbmRfc3R5bGVzaGVldChhcHBlbmRfc3R5bGVzX3RvLCBzdHlsZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gZ2V0X3Jvb3RfZm9yX3N0eWxlKG5vZGUpIHtcbiAgICBpZiAoIW5vZGUpXG4gICAgICAgIHJldHVybiBkb2N1bWVudDtcbiAgICBjb25zdCByb290ID0gbm9kZS5nZXRSb290Tm9kZSA/IG5vZGUuZ2V0Um9vdE5vZGUoKSA6IG5vZGUub3duZXJEb2N1bWVudDtcbiAgICBpZiAocm9vdCAmJiByb290Lmhvc3QpIHtcbiAgICAgICAgcmV0dXJuIHJvb3Q7XG4gICAgfVxuICAgIHJldHVybiBub2RlLm93bmVyRG9jdW1lbnQ7XG59XG5mdW5jdGlvbiBhcHBlbmRfZW1wdHlfc3R5bGVzaGVldChub2RlKSB7XG4gICAgY29uc3Qgc3R5bGVfZWxlbWVudCA9IGVsZW1lbnQoJ3N0eWxlJyk7XG4gICAgYXBwZW5kX3N0eWxlc2hlZXQoZ2V0X3Jvb3RfZm9yX3N0eWxlKG5vZGUpLCBzdHlsZV9lbGVtZW50KTtcbiAgICByZXR1cm4gc3R5bGVfZWxlbWVudC5zaGVldDtcbn1cbmZ1bmN0aW9uIGFwcGVuZF9zdHlsZXNoZWV0KG5vZGUsIHN0eWxlKSB7XG4gICAgYXBwZW5kKG5vZGUuaGVhZCB8fCBub2RlLCBzdHlsZSk7XG59XG5mdW5jdGlvbiBhcHBlbmRfaHlkcmF0aW9uKHRhcmdldCwgbm9kZSkge1xuICAgIGlmIChpc19oeWRyYXRpbmcpIHtcbiAgICAgICAgaW5pdF9oeWRyYXRlKHRhcmdldCk7XG4gICAgICAgIGlmICgodGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQgPT09IHVuZGVmaW5lZCkgfHwgKCh0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZCAhPT0gbnVsbCkgJiYgKHRhcmdldC5hY3R1YWxfZW5kX2NoaWxkLnBhcmVudEVsZW1lbnQgIT09IHRhcmdldCkpKSB7XG4gICAgICAgICAgICB0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZCA9IHRhcmdldC5maXJzdENoaWxkO1xuICAgICAgICB9XG4gICAgICAgIC8vIFNraXAgbm9kZXMgb2YgdW5kZWZpbmVkIG9yZGVyaW5nXG4gICAgICAgIHdoaWxlICgodGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQgIT09IG51bGwpICYmICh0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZC5jbGFpbV9vcmRlciA9PT0gdW5kZWZpbmVkKSkge1xuICAgICAgICAgICAgdGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQgPSB0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZC5uZXh0U2libGluZztcbiAgICAgICAgfVxuICAgICAgICBpZiAobm9kZSAhPT0gdGFyZ2V0LmFjdHVhbF9lbmRfY2hpbGQpIHtcbiAgICAgICAgICAgIC8vIFdlIG9ubHkgaW5zZXJ0IGlmIHRoZSBvcmRlcmluZyBvZiB0aGlzIG5vZGUgc2hvdWxkIGJlIG1vZGlmaWVkIG9yIHRoZSBwYXJlbnQgbm9kZSBpcyBub3QgdGFyZ2V0XG4gICAgICAgICAgICBpZiAobm9kZS5jbGFpbV9vcmRlciAhPT0gdW5kZWZpbmVkIHx8IG5vZGUucGFyZW50Tm9kZSAhPT0gdGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0Lmluc2VydEJlZm9yZShub2RlLCB0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0YXJnZXQuYWN0dWFsX2VuZF9jaGlsZCA9IG5vZGUubmV4dFNpYmxpbmc7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAobm9kZS5wYXJlbnROb2RlICE9PSB0YXJnZXQgfHwgbm9kZS5uZXh0U2libGluZyAhPT0gbnVsbCkge1xuICAgICAgICB0YXJnZXQuYXBwZW5kQ2hpbGQobm9kZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gaW5zZXJ0KHRhcmdldCwgbm9kZSwgYW5jaG9yKSB7XG4gICAgdGFyZ2V0Lmluc2VydEJlZm9yZShub2RlLCBhbmNob3IgfHwgbnVsbCk7XG59XG5mdW5jdGlvbiBpbnNlcnRfaHlkcmF0aW9uKHRhcmdldCwgbm9kZSwgYW5jaG9yKSB7XG4gICAgaWYgKGlzX2h5ZHJhdGluZyAmJiAhYW5jaG9yKSB7XG4gICAgICAgIGFwcGVuZF9oeWRyYXRpb24odGFyZ2V0LCBub2RlKTtcbiAgICB9XG4gICAgZWxzZSBpZiAobm9kZS5wYXJlbnROb2RlICE9PSB0YXJnZXQgfHwgbm9kZS5uZXh0U2libGluZyAhPSBhbmNob3IpIHtcbiAgICAgICAgdGFyZ2V0Lmluc2VydEJlZm9yZShub2RlLCBhbmNob3IgfHwgbnVsbCk7XG4gICAgfVxufVxuZnVuY3Rpb24gZGV0YWNoKG5vZGUpIHtcbiAgICBub2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobm9kZSk7XG59XG5mdW5jdGlvbiBkZXN0cm95X2VhY2goaXRlcmF0aW9ucywgZGV0YWNoaW5nKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVyYXRpb25zLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGlmIChpdGVyYXRpb25zW2ldKVxuICAgICAgICAgICAgaXRlcmF0aW9uc1tpXS5kKGRldGFjaGluZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gZWxlbWVudChuYW1lKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQobmFtZSk7XG59XG5mdW5jdGlvbiBlbGVtZW50X2lzKG5hbWUsIGlzKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQobmFtZSwgeyBpcyB9KTtcbn1cbmZ1bmN0aW9uIG9iamVjdF93aXRob3V0X3Byb3BlcnRpZXMob2JqLCBleGNsdWRlKSB7XG4gICAgY29uc3QgdGFyZ2V0ID0ge307XG4gICAgZm9yIChjb25zdCBrIGluIG9iaikge1xuICAgICAgICBpZiAoaGFzX3Byb3Aob2JqLCBrKVxuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgJiYgZXhjbHVkZS5pbmRleE9mKGspID09PSAtMSkge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgdGFyZ2V0W2tdID0gb2JqW2tdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0YXJnZXQ7XG59XG5mdW5jdGlvbiBzdmdfZWxlbWVudChuYW1lKSB7XG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCBuYW1lKTtcbn1cbmZ1bmN0aW9uIHRleHQoZGF0YSkge1xuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShkYXRhKTtcbn1cbmZ1bmN0aW9uIHNwYWNlKCkge1xuICAgIHJldHVybiB0ZXh0KCcgJyk7XG59XG5mdW5jdGlvbiBlbXB0eSgpIHtcbiAgICByZXR1cm4gdGV4dCgnJyk7XG59XG5mdW5jdGlvbiBsaXN0ZW4obm9kZSwgZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpIHtcbiAgICBub2RlLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpO1xuICAgIHJldHVybiAoKSA9PiBub2RlLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpO1xufVxuZnVuY3Rpb24gcHJldmVudF9kZWZhdWx0KGZuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHJldHVybiBmbi5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICB9O1xufVxuZnVuY3Rpb24gc3RvcF9wcm9wYWdhdGlvbihmbikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgcmV0dXJuIGZuLmNhbGwodGhpcywgZXZlbnQpO1xuICAgIH07XG59XG5mdW5jdGlvbiBzZWxmKGZuKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGlmIChldmVudC50YXJnZXQgPT09IHRoaXMpXG4gICAgICAgICAgICBmbi5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICB9O1xufVxuZnVuY3Rpb24gdHJ1c3RlZChmbikge1xuICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBpZiAoZXZlbnQuaXNUcnVzdGVkKVxuICAgICAgICAgICAgZm4uY2FsbCh0aGlzLCBldmVudCk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIGF0dHIobm9kZSwgYXR0cmlidXRlLCB2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSA9PSBudWxsKVxuICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZShhdHRyaWJ1dGUpO1xuICAgIGVsc2UgaWYgKG5vZGUuZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZSkgIT09IHZhbHVlKVxuICAgICAgICBub2RlLnNldEF0dHJpYnV0ZShhdHRyaWJ1dGUsIHZhbHVlKTtcbn1cbmZ1bmN0aW9uIHNldF9hdHRyaWJ1dGVzKG5vZGUsIGF0dHJpYnV0ZXMpIHtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgY29uc3QgZGVzY3JpcHRvcnMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhub2RlLl9fcHJvdG9fXyk7XG4gICAgZm9yIChjb25zdCBrZXkgaW4gYXR0cmlidXRlcykge1xuICAgICAgICBpZiAoYXR0cmlidXRlc1trZXldID09IG51bGwpIHtcbiAgICAgICAgICAgIG5vZGUucmVtb3ZlQXR0cmlidXRlKGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoa2V5ID09PSAnc3R5bGUnKSB7XG4gICAgICAgICAgICBub2RlLnN0eWxlLmNzc1RleHQgPSBhdHRyaWJ1dGVzW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoa2V5ID09PSAnX192YWx1ZScpIHtcbiAgICAgICAgICAgIG5vZGUudmFsdWUgPSBub2RlW2tleV0gPSBhdHRyaWJ1dGVzW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZGVzY3JpcHRvcnNba2V5XSAmJiBkZXNjcmlwdG9yc1trZXldLnNldCkge1xuICAgICAgICAgICAgbm9kZVtrZXldID0gYXR0cmlidXRlc1trZXldO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgYXR0cihub2RlLCBrZXksIGF0dHJpYnV0ZXNba2V5XSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBzZXRfc3ZnX2F0dHJpYnV0ZXMobm9kZSwgYXR0cmlidXRlcykge1xuICAgIGZvciAoY29uc3Qga2V5IGluIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgYXR0cihub2RlLCBrZXksIGF0dHJpYnV0ZXNba2V5XSk7XG4gICAgfVxufVxuZnVuY3Rpb24gc2V0X2N1c3RvbV9lbGVtZW50X2RhdGEobm9kZSwgcHJvcCwgdmFsdWUpIHtcbiAgICBpZiAocHJvcCBpbiBub2RlKSB7XG4gICAgICAgIG5vZGVbcHJvcF0gPSB0eXBlb2Ygbm9kZVtwcm9wXSA9PT0gJ2Jvb2xlYW4nICYmIHZhbHVlID09PSAnJyA/IHRydWUgOiB2YWx1ZTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGF0dHIobm9kZSwgcHJvcCwgdmFsdWUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHhsaW5rX2F0dHIobm9kZSwgYXR0cmlidXRlLCB2YWx1ZSkge1xuICAgIG5vZGUuc2V0QXR0cmlidXRlTlMoJ2h0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsnLCBhdHRyaWJ1dGUsIHZhbHVlKTtcbn1cbmZ1bmN0aW9uIGdldF9iaW5kaW5nX2dyb3VwX3ZhbHVlKGdyb3VwLCBfX3ZhbHVlLCBjaGVja2VkKSB7XG4gICAgY29uc3QgdmFsdWUgPSBuZXcgU2V0KCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBncm91cC5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBpZiAoZ3JvdXBbaV0uY2hlY2tlZClcbiAgICAgICAgICAgIHZhbHVlLmFkZChncm91cFtpXS5fX3ZhbHVlKTtcbiAgICB9XG4gICAgaWYgKCFjaGVja2VkKSB7XG4gICAgICAgIHZhbHVlLmRlbGV0ZShfX3ZhbHVlKTtcbiAgICB9XG4gICAgcmV0dXJuIEFycmF5LmZyb20odmFsdWUpO1xufVxuZnVuY3Rpb24gdG9fbnVtYmVyKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlID09PSAnJyA/IG51bGwgOiArdmFsdWU7XG59XG5mdW5jdGlvbiB0aW1lX3Jhbmdlc190b19hcnJheShyYW5nZXMpIHtcbiAgICBjb25zdCBhcnJheSA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmFuZ2VzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGFycmF5LnB1c2goeyBzdGFydDogcmFuZ2VzLnN0YXJ0KGkpLCBlbmQ6IHJhbmdlcy5lbmQoaSkgfSk7XG4gICAgfVxuICAgIHJldHVybiBhcnJheTtcbn1cbmZ1bmN0aW9uIGNoaWxkcmVuKGVsZW1lbnQpIHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbShlbGVtZW50LmNoaWxkTm9kZXMpO1xufVxuZnVuY3Rpb24gaW5pdF9jbGFpbV9pbmZvKG5vZGVzKSB7XG4gICAgaWYgKG5vZGVzLmNsYWltX2luZm8gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBub2Rlcy5jbGFpbV9pbmZvID0geyBsYXN0X2luZGV4OiAwLCB0b3RhbF9jbGFpbWVkOiAwIH07XG4gICAgfVxufVxuZnVuY3Rpb24gY2xhaW1fbm9kZShub2RlcywgcHJlZGljYXRlLCBwcm9jZXNzTm9kZSwgY3JlYXRlTm9kZSwgZG9udFVwZGF0ZUxhc3RJbmRleCA9IGZhbHNlKSB7XG4gICAgLy8gVHJ5IHRvIGZpbmQgbm9kZXMgaW4gYW4gb3JkZXIgc3VjaCB0aGF0IHdlIGxlbmd0aGVuIHRoZSBsb25nZXN0IGluY3JlYXNpbmcgc3Vic2VxdWVuY2VcbiAgICBpbml0X2NsYWltX2luZm8obm9kZXMpO1xuICAgIGNvbnN0IHJlc3VsdE5vZGUgPSAoKCkgPT4ge1xuICAgICAgICAvLyBXZSBmaXJzdCB0cnkgdG8gZmluZCBhbiBlbGVtZW50IGFmdGVyIHRoZSBwcmV2aW91cyBvbmVcbiAgICAgICAgZm9yIChsZXQgaSA9IG5vZGVzLmNsYWltX2luZm8ubGFzdF9pbmRleDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBub2RlID0gbm9kZXNbaV07XG4gICAgICAgICAgICBpZiAocHJlZGljYXRlKG5vZGUpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVwbGFjZW1lbnQgPSBwcm9jZXNzTm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICBpZiAocmVwbGFjZW1lbnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBub2Rlcy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBub2Rlc1tpXSA9IHJlcGxhY2VtZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIWRvbnRVcGRhdGVMYXN0SW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgbm9kZXMuY2xhaW1faW5mby5sYXN0X2luZGV4ID0gaTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gT3RoZXJ3aXNlLCB3ZSB0cnkgdG8gZmluZCBvbmUgYmVmb3JlXG4gICAgICAgIC8vIFdlIGl0ZXJhdGUgaW4gcmV2ZXJzZSBzbyB0aGF0IHdlIGRvbid0IGdvIHRvbyBmYXIgYmFja1xuICAgICAgICBmb3IgKGxldCBpID0gbm9kZXMuY2xhaW1faW5mby5sYXN0X2luZGV4IC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIGNvbnN0IG5vZGUgPSBub2Rlc1tpXTtcbiAgICAgICAgICAgIGlmIChwcmVkaWNhdGUobm9kZSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXBsYWNlbWVudCA9IHByb2Nlc3NOb2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgIGlmIChyZXBsYWNlbWVudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVzW2ldID0gcmVwbGFjZW1lbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghZG9udFVwZGF0ZUxhc3RJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBub2Rlcy5jbGFpbV9pbmZvLmxhc3RfaW5kZXggPSBpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChyZXBsYWNlbWVudCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFNpbmNlIHdlIHNwbGljZWQgYmVmb3JlIHRoZSBsYXN0X2luZGV4LCB3ZSBkZWNyZWFzZSBpdFxuICAgICAgICAgICAgICAgICAgICBub2Rlcy5jbGFpbV9pbmZvLmxhc3RfaW5kZXgtLTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgd2UgY2FuJ3QgZmluZCBhbnkgbWF0Y2hpbmcgbm9kZSwgd2UgY3JlYXRlIGEgbmV3IG9uZVxuICAgICAgICByZXR1cm4gY3JlYXRlTm9kZSgpO1xuICAgIH0pKCk7XG4gICAgcmVzdWx0Tm9kZS5jbGFpbV9vcmRlciA9IG5vZGVzLmNsYWltX2luZm8udG90YWxfY2xhaW1lZDtcbiAgICBub2Rlcy5jbGFpbV9pbmZvLnRvdGFsX2NsYWltZWQgKz0gMTtcbiAgICByZXR1cm4gcmVzdWx0Tm9kZTtcbn1cbmZ1bmN0aW9uIGNsYWltX2VsZW1lbnRfYmFzZShub2RlcywgbmFtZSwgYXR0cmlidXRlcywgY3JlYXRlX2VsZW1lbnQpIHtcbiAgICByZXR1cm4gY2xhaW1fbm9kZShub2RlcywgKG5vZGUpID0+IG5vZGUubm9kZU5hbWUgPT09IG5hbWUsIChub2RlKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlbW92ZSA9IFtdO1xuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IG5vZGUuYXR0cmlidXRlcy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlID0gbm9kZS5hdHRyaWJ1dGVzW2pdO1xuICAgICAgICAgICAgaWYgKCFhdHRyaWJ1dGVzW2F0dHJpYnV0ZS5uYW1lXSkge1xuICAgICAgICAgICAgICAgIHJlbW92ZS5wdXNoKGF0dHJpYnV0ZS5uYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZW1vdmUuZm9yRWFjaCh2ID0+IG5vZGUucmVtb3ZlQXR0cmlidXRlKHYpKTtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9LCAoKSA9PiBjcmVhdGVfZWxlbWVudChuYW1lKSk7XG59XG5mdW5jdGlvbiBjbGFpbV9lbGVtZW50KG5vZGVzLCBuYW1lLCBhdHRyaWJ1dGVzKSB7XG4gICAgcmV0dXJuIGNsYWltX2VsZW1lbnRfYmFzZShub2RlcywgbmFtZSwgYXR0cmlidXRlcywgZWxlbWVudCk7XG59XG5mdW5jdGlvbiBjbGFpbV9zdmdfZWxlbWVudChub2RlcywgbmFtZSwgYXR0cmlidXRlcykge1xuICAgIHJldHVybiBjbGFpbV9lbGVtZW50X2Jhc2Uobm9kZXMsIG5hbWUsIGF0dHJpYnV0ZXMsIHN2Z19lbGVtZW50KTtcbn1cbmZ1bmN0aW9uIGNsYWltX3RleHQobm9kZXMsIGRhdGEpIHtcbiAgICByZXR1cm4gY2xhaW1fbm9kZShub2RlcywgKG5vZGUpID0+IG5vZGUubm9kZVR5cGUgPT09IDMsIChub2RlKSA9PiB7XG4gICAgICAgIGNvbnN0IGRhdGFTdHIgPSAnJyArIGRhdGE7XG4gICAgICAgIGlmIChub2RlLmRhdGEuc3RhcnRzV2l0aChkYXRhU3RyKSkge1xuICAgICAgICAgICAgaWYgKG5vZGUuZGF0YS5sZW5ndGggIT09IGRhdGFTdHIubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vZGUuc3BsaXRUZXh0KGRhdGFTdHIubGVuZ3RoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG5vZGUuZGF0YSA9IGRhdGFTdHI7XG4gICAgICAgIH1cbiAgICB9LCAoKSA9PiB0ZXh0KGRhdGEpLCB0cnVlIC8vIFRleHQgbm9kZXMgc2hvdWxkIG5vdCB1cGRhdGUgbGFzdCBpbmRleCBzaW5jZSBpdCBpcyBsaWtlbHkgbm90IHdvcnRoIGl0IHRvIGVsaW1pbmF0ZSBhbiBpbmNyZWFzaW5nIHN1YnNlcXVlbmNlIG9mIGFjdHVhbCBlbGVtZW50c1xuICAgICk7XG59XG5mdW5jdGlvbiBjbGFpbV9zcGFjZShub2Rlcykge1xuICAgIHJldHVybiBjbGFpbV90ZXh0KG5vZGVzLCAnICcpO1xufVxuZnVuY3Rpb24gZmluZF9jb21tZW50KG5vZGVzLCB0ZXh0LCBzdGFydCkge1xuICAgIGZvciAobGV0IGkgPSBzdGFydDsgaSA8IG5vZGVzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGNvbnN0IG5vZGUgPSBub2Rlc1tpXTtcbiAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IDggLyogY29tbWVudCBub2RlICovICYmIG5vZGUudGV4dENvbnRlbnQudHJpbSgpID09PSB0ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbm9kZXMubGVuZ3RoO1xufVxuZnVuY3Rpb24gY2xhaW1faHRtbF90YWcobm9kZXMsIGlzX3N2Zykge1xuICAgIC8vIGZpbmQgaHRtbCBvcGVuaW5nIHRhZ1xuICAgIGNvbnN0IHN0YXJ0X2luZGV4ID0gZmluZF9jb21tZW50KG5vZGVzLCAnSFRNTF9UQUdfU1RBUlQnLCAwKTtcbiAgICBjb25zdCBlbmRfaW5kZXggPSBmaW5kX2NvbW1lbnQobm9kZXMsICdIVE1MX1RBR19FTkQnLCBzdGFydF9pbmRleCk7XG4gICAgaWYgKHN0YXJ0X2luZGV4ID09PSBlbmRfaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBIdG1sVGFnSHlkcmF0aW9uKHVuZGVmaW5lZCwgaXNfc3ZnKTtcbiAgICB9XG4gICAgaW5pdF9jbGFpbV9pbmZvKG5vZGVzKTtcbiAgICBjb25zdCBodG1sX3RhZ19ub2RlcyA9IG5vZGVzLnNwbGljZShzdGFydF9pbmRleCwgZW5kX2luZGV4IC0gc3RhcnRfaW5kZXggKyAxKTtcbiAgICBkZXRhY2goaHRtbF90YWdfbm9kZXNbMF0pO1xuICAgIGRldGFjaChodG1sX3RhZ19ub2Rlc1todG1sX3RhZ19ub2Rlcy5sZW5ndGggLSAxXSk7XG4gICAgY29uc3QgY2xhaW1lZF9ub2RlcyA9IGh0bWxfdGFnX25vZGVzLnNsaWNlKDEsIGh0bWxfdGFnX25vZGVzLmxlbmd0aCAtIDEpO1xuICAgIGZvciAoY29uc3QgbiBvZiBjbGFpbWVkX25vZGVzKSB7XG4gICAgICAgIG4uY2xhaW1fb3JkZXIgPSBub2Rlcy5jbGFpbV9pbmZvLnRvdGFsX2NsYWltZWQ7XG4gICAgICAgIG5vZGVzLmNsYWltX2luZm8udG90YWxfY2xhaW1lZCArPSAxO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IEh0bWxUYWdIeWRyYXRpb24oY2xhaW1lZF9ub2RlcywgaXNfc3ZnKTtcbn1cbmZ1bmN0aW9uIHNldF9kYXRhKHRleHQsIGRhdGEpIHtcbiAgICBkYXRhID0gJycgKyBkYXRhO1xuICAgIGlmICh0ZXh0Lndob2xlVGV4dCAhPT0gZGF0YSlcbiAgICAgICAgdGV4dC5kYXRhID0gZGF0YTtcbn1cbmZ1bmN0aW9uIHNldF9pbnB1dF92YWx1ZShpbnB1dCwgdmFsdWUpIHtcbiAgICBpbnB1dC52YWx1ZSA9IHZhbHVlID09IG51bGwgPyAnJyA6IHZhbHVlO1xufVxuZnVuY3Rpb24gc2V0X2lucHV0X3R5cGUoaW5wdXQsIHR5cGUpIHtcbiAgICB0cnkge1xuICAgICAgICBpbnB1dC50eXBlID0gdHlwZTtcbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8gZG8gbm90aGluZ1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNldF9zdHlsZShub2RlLCBrZXksIHZhbHVlLCBpbXBvcnRhbnQpIHtcbiAgICBpZiAodmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgbm9kZS5zdHlsZS5yZW1vdmVQcm9wZXJ0eShrZXkpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgbm9kZS5zdHlsZS5zZXRQcm9wZXJ0eShrZXksIHZhbHVlLCBpbXBvcnRhbnQgPyAnaW1wb3J0YW50JyA6ICcnKTtcbiAgICB9XG59XG5mdW5jdGlvbiBzZWxlY3Rfb3B0aW9uKHNlbGVjdCwgdmFsdWUpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlbGVjdC5vcHRpb25zLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGNvbnN0IG9wdGlvbiA9IHNlbGVjdC5vcHRpb25zW2ldO1xuICAgICAgICBpZiAob3B0aW9uLl9fdmFsdWUgPT09IHZhbHVlKSB7XG4gICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNlbGVjdC5zZWxlY3RlZEluZGV4ID0gLTE7IC8vIG5vIG9wdGlvbiBzaG91bGQgYmUgc2VsZWN0ZWRcbn1cbmZ1bmN0aW9uIHNlbGVjdF9vcHRpb25zKHNlbGVjdCwgdmFsdWUpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlbGVjdC5vcHRpb25zLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGNvbnN0IG9wdGlvbiA9IHNlbGVjdC5vcHRpb25zW2ldO1xuICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSB+dmFsdWUuaW5kZXhPZihvcHRpb24uX192YWx1ZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gc2VsZWN0X3ZhbHVlKHNlbGVjdCkge1xuICAgIGNvbnN0IHNlbGVjdGVkX29wdGlvbiA9IHNlbGVjdC5xdWVyeVNlbGVjdG9yKCc6Y2hlY2tlZCcpIHx8IHNlbGVjdC5vcHRpb25zWzBdO1xuICAgIHJldHVybiBzZWxlY3RlZF9vcHRpb24gJiYgc2VsZWN0ZWRfb3B0aW9uLl9fdmFsdWU7XG59XG5mdW5jdGlvbiBzZWxlY3RfbXVsdGlwbGVfdmFsdWUoc2VsZWN0KSB7XG4gICAgcmV0dXJuIFtdLm1hcC5jYWxsKHNlbGVjdC5xdWVyeVNlbGVjdG9yQWxsKCc6Y2hlY2tlZCcpLCBvcHRpb24gPT4gb3B0aW9uLl9fdmFsdWUpO1xufVxuLy8gdW5mb3J0dW5hdGVseSB0aGlzIGNhbid0IGJlIGEgY29uc3RhbnQgYXMgdGhhdCB3b3VsZG4ndCBiZSB0cmVlLXNoYWtlYWJsZVxuLy8gc28gd2UgY2FjaGUgdGhlIHJlc3VsdCBpbnN0ZWFkXG5sZXQgY3Jvc3NvcmlnaW47XG5mdW5jdGlvbiBpc19jcm9zc29yaWdpbigpIHtcbiAgICBpZiAoY3Jvc3NvcmlnaW4gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjcm9zc29yaWdpbiA9IGZhbHNlO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICB2b2lkIHdpbmRvdy5wYXJlbnQuZG9jdW1lbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjcm9zc29yaWdpbiA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGNyb3Nzb3JpZ2luO1xufVxuZnVuY3Rpb24gYWRkX3Jlc2l6ZV9saXN0ZW5lcihub2RlLCBmbikge1xuICAgIGNvbnN0IGNvbXB1dGVkX3N0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShub2RlKTtcbiAgICBpZiAoY29tcHV0ZWRfc3R5bGUucG9zaXRpb24gPT09ICdzdGF0aWMnKSB7XG4gICAgICAgIG5vZGUuc3R5bGUucG9zaXRpb24gPSAncmVsYXRpdmUnO1xuICAgIH1cbiAgICBjb25zdCBpZnJhbWUgPSBlbGVtZW50KCdpZnJhbWUnKTtcbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKCdzdHlsZScsICdkaXNwbGF5OiBibG9jazsgcG9zaXRpb246IGFic29sdXRlOyB0b3A6IDA7IGxlZnQ6IDA7IHdpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMCU7ICcgK1xuICAgICAgICAnb3ZlcmZsb3c6IGhpZGRlbjsgYm9yZGVyOiAwOyBvcGFjaXR5OiAwOyBwb2ludGVyLWV2ZW50czogbm9uZTsgei1pbmRleDogLTE7Jyk7XG4gICAgaWZyYW1lLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAndHJ1ZScpO1xuICAgIGlmcmFtZS50YWJJbmRleCA9IC0xO1xuICAgIGNvbnN0IGNyb3Nzb3JpZ2luID0gaXNfY3Jvc3NvcmlnaW4oKTtcbiAgICBsZXQgdW5zdWJzY3JpYmU7XG4gICAgaWYgKGNyb3Nzb3JpZ2luKSB7XG4gICAgICAgIGlmcmFtZS5zcmMgPSBcImRhdGE6dGV4dC9odG1sLDxzY3JpcHQ+b25yZXNpemU9ZnVuY3Rpb24oKXtwYXJlbnQucG9zdE1lc3NhZ2UoMCwnKicpfTwvc2NyaXB0PlwiO1xuICAgICAgICB1bnN1YnNjcmliZSA9IGxpc3Rlbih3aW5kb3csICdtZXNzYWdlJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBpZiAoZXZlbnQuc291cmNlID09PSBpZnJhbWUuY29udGVudFdpbmRvdylcbiAgICAgICAgICAgICAgICBmbigpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmcmFtZS5zcmMgPSAnYWJvdXQ6YmxhbmsnO1xuICAgICAgICBpZnJhbWUub25sb2FkID0gKCkgPT4ge1xuICAgICAgICAgICAgdW5zdWJzY3JpYmUgPSBsaXN0ZW4oaWZyYW1lLmNvbnRlbnRXaW5kb3csICdyZXNpemUnLCBmbik7XG4gICAgICAgIH07XG4gICAgfVxuICAgIGFwcGVuZChub2RlLCBpZnJhbWUpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIGlmIChjcm9zc29yaWdpbikge1xuICAgICAgICAgICAgdW5zdWJzY3JpYmUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh1bnN1YnNjcmliZSAmJiBpZnJhbWUuY29udGVudFdpbmRvdykge1xuICAgICAgICAgICAgdW5zdWJzY3JpYmUoKTtcbiAgICAgICAgfVxuICAgICAgICBkZXRhY2goaWZyYW1lKTtcbiAgICB9O1xufVxuZnVuY3Rpb24gdG9nZ2xlX2NsYXNzKGVsZW1lbnQsIG5hbWUsIHRvZ2dsZSkge1xuICAgIGVsZW1lbnQuY2xhc3NMaXN0W3RvZ2dsZSA/ICdhZGQnIDogJ3JlbW92ZSddKG5hbWUpO1xufVxuZnVuY3Rpb24gY3VzdG9tX2V2ZW50KHR5cGUsIGRldGFpbCwgeyBidWJibGVzID0gZmFsc2UsIGNhbmNlbGFibGUgPSBmYWxzZSB9ID0ge30pIHtcbiAgICBjb25zdCBlID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0N1c3RvbUV2ZW50Jyk7XG4gICAgZS5pbml0Q3VzdG9tRXZlbnQodHlwZSwgYnViYmxlcywgY2FuY2VsYWJsZSwgZGV0YWlsKTtcbiAgICByZXR1cm4gZTtcbn1cbmZ1bmN0aW9uIHF1ZXJ5X3NlbGVjdG9yX2FsbChzZWxlY3RvciwgcGFyZW50ID0gZG9jdW1lbnQuYm9keSkge1xuICAgIHJldHVybiBBcnJheS5mcm9tKHBhcmVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKSk7XG59XG5jbGFzcyBIdG1sVGFnIHtcbiAgICBjb25zdHJ1Y3Rvcihpc19zdmcgPSBmYWxzZSkge1xuICAgICAgICB0aGlzLmlzX3N2ZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzX3N2ZyA9IGlzX3N2ZztcbiAgICAgICAgdGhpcy5lID0gdGhpcy5uID0gbnVsbDtcbiAgICB9XG4gICAgYyhodG1sKSB7XG4gICAgICAgIHRoaXMuaChodG1sKTtcbiAgICB9XG4gICAgbShodG1sLCB0YXJnZXQsIGFuY2hvciA9IG51bGwpIHtcbiAgICAgICAgaWYgKCF0aGlzLmUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzX3N2ZylcbiAgICAgICAgICAgICAgICB0aGlzLmUgPSBzdmdfZWxlbWVudCh0YXJnZXQubm9kZU5hbWUpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHRoaXMuZSA9IGVsZW1lbnQodGFyZ2V0Lm5vZGVOYW1lKTtcbiAgICAgICAgICAgIHRoaXMudCA9IHRhcmdldDtcbiAgICAgICAgICAgIHRoaXMuYyhodG1sKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmkoYW5jaG9yKTtcbiAgICB9XG4gICAgaChodG1sKSB7XG4gICAgICAgIHRoaXMuZS5pbm5lckhUTUwgPSBodG1sO1xuICAgICAgICB0aGlzLm4gPSBBcnJheS5mcm9tKHRoaXMuZS5jaGlsZE5vZGVzKTtcbiAgICB9XG4gICAgaShhbmNob3IpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm4ubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgICAgIGluc2VydCh0aGlzLnQsIHRoaXMubltpXSwgYW5jaG9yKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwKGh0bWwpIHtcbiAgICAgICAgdGhpcy5kKCk7XG4gICAgICAgIHRoaXMuaChodG1sKTtcbiAgICAgICAgdGhpcy5pKHRoaXMuYSk7XG4gICAgfVxuICAgIGQoKSB7XG4gICAgICAgIHRoaXMubi5mb3JFYWNoKGRldGFjaCk7XG4gICAgfVxufVxuY2xhc3MgSHRtbFRhZ0h5ZHJhdGlvbiBleHRlbmRzIEh0bWxUYWcge1xuICAgIGNvbnN0cnVjdG9yKGNsYWltZWRfbm9kZXMsIGlzX3N2ZyA9IGZhbHNlKSB7XG4gICAgICAgIHN1cGVyKGlzX3N2Zyk7XG4gICAgICAgIHRoaXMuZSA9IHRoaXMubiA9IG51bGw7XG4gICAgICAgIHRoaXMubCA9IGNsYWltZWRfbm9kZXM7XG4gICAgfVxuICAgIGMoaHRtbCkge1xuICAgICAgICBpZiAodGhpcy5sKSB7XG4gICAgICAgICAgICB0aGlzLm4gPSB0aGlzLmw7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzdXBlci5jKGh0bWwpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGkoYW5jaG9yKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICBpbnNlcnRfaHlkcmF0aW9uKHRoaXMudCwgdGhpcy5uW2ldLCBhbmNob3IpO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gYXR0cmlidXRlX3RvX29iamVjdChhdHRyaWJ1dGVzKSB7XG4gICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgZm9yIChjb25zdCBhdHRyaWJ1dGUgb2YgYXR0cmlidXRlcykge1xuICAgICAgICByZXN1bHRbYXR0cmlidXRlLm5hbWVdID0gYXR0cmlidXRlLnZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gZ2V0X2N1c3RvbV9lbGVtZW50c19zbG90cyhlbGVtZW50KSB7XG4gICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgZWxlbWVudC5jaGlsZE5vZGVzLmZvckVhY2goKG5vZGUpID0+IHtcbiAgICAgICAgcmVzdWx0W25vZGUuc2xvdCB8fCAnZGVmYXVsdCddID0gdHJ1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuXG4vLyB3ZSBuZWVkIHRvIHN0b3JlIHRoZSBpbmZvcm1hdGlvbiBmb3IgbXVsdGlwbGUgZG9jdW1lbnRzIGJlY2F1c2UgYSBTdmVsdGUgYXBwbGljYXRpb24gY291bGQgYWxzbyBjb250YWluIGlmcmFtZXNcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9zdmVsdGVqcy9zdmVsdGUvaXNzdWVzLzM2MjRcbmNvbnN0IG1hbmFnZWRfc3R5bGVzID0gbmV3IE1hcCgpO1xubGV0IGFjdGl2ZSA9IDA7XG4vLyBodHRwczovL2dpdGh1Yi5jb20vZGFya3NreWFwcC9zdHJpbmctaGFzaC9ibG9iL21hc3Rlci9pbmRleC5qc1xuZnVuY3Rpb24gaGFzaChzdHIpIHtcbiAgICBsZXQgaGFzaCA9IDUzODE7XG4gICAgbGV0IGkgPSBzdHIubGVuZ3RoO1xuICAgIHdoaWxlIChpLS0pXG4gICAgICAgIGhhc2ggPSAoKGhhc2ggPDwgNSkgLSBoYXNoKSBeIHN0ci5jaGFyQ29kZUF0KGkpO1xuICAgIHJldHVybiBoYXNoID4+PiAwO1xufVxuZnVuY3Rpb24gY3JlYXRlX3N0eWxlX2luZm9ybWF0aW9uKGRvYywgbm9kZSkge1xuICAgIGNvbnN0IGluZm8gPSB7IHN0eWxlc2hlZXQ6IGFwcGVuZF9lbXB0eV9zdHlsZXNoZWV0KG5vZGUpLCBydWxlczoge30gfTtcbiAgICBtYW5hZ2VkX3N0eWxlcy5zZXQoZG9jLCBpbmZvKTtcbiAgICByZXR1cm4gaW5mbztcbn1cbmZ1bmN0aW9uIGNyZWF0ZV9ydWxlKG5vZGUsIGEsIGIsIGR1cmF0aW9uLCBkZWxheSwgZWFzZSwgZm4sIHVpZCA9IDApIHtcbiAgICBjb25zdCBzdGVwID0gMTYuNjY2IC8gZHVyYXRpb247XG4gICAgbGV0IGtleWZyYW1lcyA9ICd7XFxuJztcbiAgICBmb3IgKGxldCBwID0gMDsgcCA8PSAxOyBwICs9IHN0ZXApIHtcbiAgICAgICAgY29uc3QgdCA9IGEgKyAoYiAtIGEpICogZWFzZShwKTtcbiAgICAgICAga2V5ZnJhbWVzICs9IHAgKiAxMDAgKyBgJXske2ZuKHQsIDEgLSB0KX19XFxuYDtcbiAgICB9XG4gICAgY29uc3QgcnVsZSA9IGtleWZyYW1lcyArIGAxMDAlIHske2ZuKGIsIDEgLSBiKX19XFxufWA7XG4gICAgY29uc3QgbmFtZSA9IGBfX3N2ZWx0ZV8ke2hhc2gocnVsZSl9XyR7dWlkfWA7XG4gICAgY29uc3QgZG9jID0gZ2V0X3Jvb3RfZm9yX3N0eWxlKG5vZGUpO1xuICAgIGNvbnN0IHsgc3R5bGVzaGVldCwgcnVsZXMgfSA9IG1hbmFnZWRfc3R5bGVzLmdldChkb2MpIHx8IGNyZWF0ZV9zdHlsZV9pbmZvcm1hdGlvbihkb2MsIG5vZGUpO1xuICAgIGlmICghcnVsZXNbbmFtZV0pIHtcbiAgICAgICAgcnVsZXNbbmFtZV0gPSB0cnVlO1xuICAgICAgICBzdHlsZXNoZWV0Lmluc2VydFJ1bGUoYEBrZXlmcmFtZXMgJHtuYW1lfSAke3J1bGV9YCwgc3R5bGVzaGVldC5jc3NSdWxlcy5sZW5ndGgpO1xuICAgIH1cbiAgICBjb25zdCBhbmltYXRpb24gPSBub2RlLnN0eWxlLmFuaW1hdGlvbiB8fCAnJztcbiAgICBub2RlLnN0eWxlLmFuaW1hdGlvbiA9IGAke2FuaW1hdGlvbiA/IGAke2FuaW1hdGlvbn0sIGAgOiAnJ30ke25hbWV9ICR7ZHVyYXRpb259bXMgbGluZWFyICR7ZGVsYXl9bXMgMSBib3RoYDtcbiAgICBhY3RpdmUgKz0gMTtcbiAgICByZXR1cm4gbmFtZTtcbn1cbmZ1bmN0aW9uIGRlbGV0ZV9ydWxlKG5vZGUsIG5hbWUpIHtcbiAgICBjb25zdCBwcmV2aW91cyA9IChub2RlLnN0eWxlLmFuaW1hdGlvbiB8fCAnJykuc3BsaXQoJywgJyk7XG4gICAgY29uc3QgbmV4dCA9IHByZXZpb3VzLmZpbHRlcihuYW1lXG4gICAgICAgID8gYW5pbSA9PiBhbmltLmluZGV4T2YobmFtZSkgPCAwIC8vIHJlbW92ZSBzcGVjaWZpYyBhbmltYXRpb25cbiAgICAgICAgOiBhbmltID0+IGFuaW0uaW5kZXhPZignX19zdmVsdGUnKSA9PT0gLTEgLy8gcmVtb3ZlIGFsbCBTdmVsdGUgYW5pbWF0aW9uc1xuICAgICk7XG4gICAgY29uc3QgZGVsZXRlZCA9IHByZXZpb3VzLmxlbmd0aCAtIG5leHQubGVuZ3RoO1xuICAgIGlmIChkZWxldGVkKSB7XG4gICAgICAgIG5vZGUuc3R5bGUuYW5pbWF0aW9uID0gbmV4dC5qb2luKCcsICcpO1xuICAgICAgICBhY3RpdmUgLT0gZGVsZXRlZDtcbiAgICAgICAgaWYgKCFhY3RpdmUpXG4gICAgICAgICAgICBjbGVhcl9ydWxlcygpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNsZWFyX3J1bGVzKCkge1xuICAgIHJhZigoKSA9PiB7XG4gICAgICAgIGlmIChhY3RpdmUpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIG1hbmFnZWRfc3R5bGVzLmZvckVhY2goaW5mbyA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IHN0eWxlc2hlZXQgfSA9IGluZm87XG4gICAgICAgICAgICBsZXQgaSA9IHN0eWxlc2hlZXQuY3NzUnVsZXMubGVuZ3RoO1xuICAgICAgICAgICAgd2hpbGUgKGktLSlcbiAgICAgICAgICAgICAgICBzdHlsZXNoZWV0LmRlbGV0ZVJ1bGUoaSk7XG4gICAgICAgICAgICBpbmZvLnJ1bGVzID0ge307XG4gICAgICAgIH0pO1xuICAgICAgICBtYW5hZ2VkX3N0eWxlcy5jbGVhcigpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVfYW5pbWF0aW9uKG5vZGUsIGZyb20sIGZuLCBwYXJhbXMpIHtcbiAgICBpZiAoIWZyb20pXG4gICAgICAgIHJldHVybiBub29wO1xuICAgIGNvbnN0IHRvID0gbm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBpZiAoZnJvbS5sZWZ0ID09PSB0by5sZWZ0ICYmIGZyb20ucmlnaHQgPT09IHRvLnJpZ2h0ICYmIGZyb20udG9wID09PSB0by50b3AgJiYgZnJvbS5ib3R0b20gPT09IHRvLmJvdHRvbSlcbiAgICAgICAgcmV0dXJuIG5vb3A7XG4gICAgY29uc3QgeyBkZWxheSA9IDAsIGR1cmF0aW9uID0gMzAwLCBlYXNpbmcgPSBpZGVudGl0eSwgXG4gICAgLy8gQHRzLWlnbm9yZSB0b2RvOiBzaG91bGQgdGhpcyBiZSBzZXBhcmF0ZWQgZnJvbSBkZXN0cnVjdHVyaW5nPyBPciBzdGFydC9lbmQgYWRkZWQgdG8gcHVibGljIGFwaSBhbmQgZG9jdW1lbnRhdGlvbj9cbiAgICBzdGFydDogc3RhcnRfdGltZSA9IG5vdygpICsgZGVsYXksIFxuICAgIC8vIEB0cy1pZ25vcmUgdG9kbzpcbiAgICBlbmQgPSBzdGFydF90aW1lICsgZHVyYXRpb24sIHRpY2sgPSBub29wLCBjc3MgfSA9IGZuKG5vZGUsIHsgZnJvbSwgdG8gfSwgcGFyYW1zKTtcbiAgICBsZXQgcnVubmluZyA9IHRydWU7XG4gICAgbGV0IHN0YXJ0ZWQgPSBmYWxzZTtcbiAgICBsZXQgbmFtZTtcbiAgICBmdW5jdGlvbiBzdGFydCgpIHtcbiAgICAgICAgaWYgKGNzcykge1xuICAgICAgICAgICAgbmFtZSA9IGNyZWF0ZV9ydWxlKG5vZGUsIDAsIDEsIGR1cmF0aW9uLCBkZWxheSwgZWFzaW5nLCBjc3MpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZGVsYXkpIHtcbiAgICAgICAgICAgIHN0YXJ0ZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgICAgIGlmIChjc3MpXG4gICAgICAgICAgICBkZWxldGVfcnVsZShub2RlLCBuYW1lKTtcbiAgICAgICAgcnVubmluZyA9IGZhbHNlO1xuICAgIH1cbiAgICBsb29wKG5vdyA9PiB7XG4gICAgICAgIGlmICghc3RhcnRlZCAmJiBub3cgPj0gc3RhcnRfdGltZSkge1xuICAgICAgICAgICAgc3RhcnRlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0YXJ0ZWQgJiYgbm93ID49IGVuZCkge1xuICAgICAgICAgICAgdGljaygxLCAwKTtcbiAgICAgICAgICAgIHN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXJ1bm5pbmcpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RhcnRlZCkge1xuICAgICAgICAgICAgY29uc3QgcCA9IG5vdyAtIHN0YXJ0X3RpbWU7XG4gICAgICAgICAgICBjb25zdCB0ID0gMCArIDEgKiBlYXNpbmcocCAvIGR1cmF0aW9uKTtcbiAgICAgICAgICAgIHRpY2sodCwgMSAtIHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0pO1xuICAgIHN0YXJ0KCk7XG4gICAgdGljaygwLCAxKTtcbiAgICByZXR1cm4gc3RvcDtcbn1cbmZ1bmN0aW9uIGZpeF9wb3NpdGlvbihub2RlKSB7XG4gICAgY29uc3Qgc3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKG5vZGUpO1xuICAgIGlmIChzdHlsZS5wb3NpdGlvbiAhPT0gJ2Fic29sdXRlJyAmJiBzdHlsZS5wb3NpdGlvbiAhPT0gJ2ZpeGVkJykge1xuICAgICAgICBjb25zdCB7IHdpZHRoLCBoZWlnaHQgfSA9IHN0eWxlO1xuICAgICAgICBjb25zdCBhID0gbm9kZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgbm9kZS5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICAgIG5vZGUuc3R5bGUud2lkdGggPSB3aWR0aDtcbiAgICAgICAgbm9kZS5zdHlsZS5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgIGFkZF90cmFuc2Zvcm0obm9kZSwgYSk7XG4gICAgfVxufVxuZnVuY3Rpb24gYWRkX3RyYW5zZm9ybShub2RlLCBhKSB7XG4gICAgY29uc3QgYiA9IG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgaWYgKGEubGVmdCAhPT0gYi5sZWZ0IHx8IGEudG9wICE9PSBiLnRvcCkge1xuICAgICAgICBjb25zdCBzdHlsZSA9IGdldENvbXB1dGVkU3R5bGUobm9kZSk7XG4gICAgICAgIGNvbnN0IHRyYW5zZm9ybSA9IHN0eWxlLnRyYW5zZm9ybSA9PT0gJ25vbmUnID8gJycgOiBzdHlsZS50cmFuc2Zvcm07XG4gICAgICAgIG5vZGUuc3R5bGUudHJhbnNmb3JtID0gYCR7dHJhbnNmb3JtfSB0cmFuc2xhdGUoJHthLmxlZnQgLSBiLmxlZnR9cHgsICR7YS50b3AgLSBiLnRvcH1weClgO1xuICAgIH1cbn1cblxubGV0IGN1cnJlbnRfY29tcG9uZW50O1xuZnVuY3Rpb24gc2V0X2N1cnJlbnRfY29tcG9uZW50KGNvbXBvbmVudCkge1xuICAgIGN1cnJlbnRfY29tcG9uZW50ID0gY29tcG9uZW50O1xufVxuZnVuY3Rpb24gZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkge1xuICAgIGlmICghY3VycmVudF9jb21wb25lbnQpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRnVuY3Rpb24gY2FsbGVkIG91dHNpZGUgY29tcG9uZW50IGluaXRpYWxpemF0aW9uJyk7XG4gICAgcmV0dXJuIGN1cnJlbnRfY29tcG9uZW50O1xufVxuZnVuY3Rpb24gYmVmb3JlVXBkYXRlKGZuKSB7XG4gICAgZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQuYmVmb3JlX3VwZGF0ZS5wdXNoKGZuKTtcbn1cbmZ1bmN0aW9uIG9uTW91bnQoZm4pIHtcbiAgICBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5vbl9tb3VudC5wdXNoKGZuKTtcbn1cbmZ1bmN0aW9uIGFmdGVyVXBkYXRlKGZuKSB7XG4gICAgZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQuYWZ0ZXJfdXBkYXRlLnB1c2goZm4pO1xufVxuZnVuY3Rpb24gb25EZXN0cm95KGZuKSB7XG4gICAgZ2V0X2N1cnJlbnRfY29tcG9uZW50KCkuJCQub25fZGVzdHJveS5wdXNoKGZuKTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZUV2ZW50RGlzcGF0Y2hlcigpIHtcbiAgICBjb25zdCBjb21wb25lbnQgPSBnZXRfY3VycmVudF9jb21wb25lbnQoKTtcbiAgICByZXR1cm4gKHR5cGUsIGRldGFpbCwgeyBjYW5jZWxhYmxlID0gZmFsc2UgfSA9IHt9KSA9PiB7XG4gICAgICAgIGNvbnN0IGNhbGxiYWNrcyA9IGNvbXBvbmVudC4kJC5jYWxsYmFja3NbdHlwZV07XG4gICAgICAgIGlmIChjYWxsYmFja3MpIHtcbiAgICAgICAgICAgIC8vIFRPRE8gYXJlIHRoZXJlIHNpdHVhdGlvbnMgd2hlcmUgZXZlbnRzIGNvdWxkIGJlIGRpc3BhdGNoZWRcbiAgICAgICAgICAgIC8vIGluIGEgc2VydmVyIChub24tRE9NKSBlbnZpcm9ubWVudD9cbiAgICAgICAgICAgIGNvbnN0IGV2ZW50ID0gY3VzdG9tX2V2ZW50KHR5cGUsIGRldGFpbCwgeyBjYW5jZWxhYmxlIH0pO1xuICAgICAgICAgICAgY2FsbGJhY2tzLnNsaWNlKCkuZm9yRWFjaChmbiA9PiB7XG4gICAgICAgICAgICAgICAgZm4uY2FsbChjb21wb25lbnQsIGV2ZW50KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuICFldmVudC5kZWZhdWx0UHJldmVudGVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG59XG5mdW5jdGlvbiBzZXRDb250ZXh0KGtleSwgY29udGV4dCkge1xuICAgIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmNvbnRleHQuc2V0KGtleSwgY29udGV4dCk7XG4gICAgcmV0dXJuIGNvbnRleHQ7XG59XG5mdW5jdGlvbiBnZXRDb250ZXh0KGtleSkge1xuICAgIHJldHVybiBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5jb250ZXh0LmdldChrZXkpO1xufVxuZnVuY3Rpb24gZ2V0QWxsQ29udGV4dHMoKSB7XG4gICAgcmV0dXJuIGdldF9jdXJyZW50X2NvbXBvbmVudCgpLiQkLmNvbnRleHQ7XG59XG5mdW5jdGlvbiBoYXNDb250ZXh0KGtleSkge1xuICAgIHJldHVybiBnZXRfY3VycmVudF9jb21wb25lbnQoKS4kJC5jb250ZXh0LmhhcyhrZXkpO1xufVxuLy8gVE9ETyBmaWd1cmUgb3V0IGlmIHdlIHN0aWxsIHdhbnQgdG8gc3VwcG9ydFxuLy8gc2hvcnRoYW5kIGV2ZW50cywgb3IgaWYgd2Ugd2FudCB0byBpbXBsZW1lbnRcbi8vIGEgcmVhbCBidWJibGluZyBtZWNoYW5pc21cbmZ1bmN0aW9uIGJ1YmJsZShjb21wb25lbnQsIGV2ZW50KSB7XG4gICAgY29uc3QgY2FsbGJhY2tzID0gY29tcG9uZW50LiQkLmNhbGxiYWNrc1tldmVudC50eXBlXTtcbiAgICBpZiAoY2FsbGJhY2tzKSB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgY2FsbGJhY2tzLnNsaWNlKCkuZm9yRWFjaChmbiA9PiBmbi5jYWxsKHRoaXMsIGV2ZW50KSk7XG4gICAgfVxufVxuXG5jb25zdCBkaXJ0eV9jb21wb25lbnRzID0gW107XG5jb25zdCBpbnRyb3MgPSB7IGVuYWJsZWQ6IGZhbHNlIH07XG5jb25zdCBiaW5kaW5nX2NhbGxiYWNrcyA9IFtdO1xuY29uc3QgcmVuZGVyX2NhbGxiYWNrcyA9IFtdO1xuY29uc3QgZmx1c2hfY2FsbGJhY2tzID0gW107XG5jb25zdCByZXNvbHZlZF9wcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKCk7XG5sZXQgdXBkYXRlX3NjaGVkdWxlZCA9IGZhbHNlO1xuZnVuY3Rpb24gc2NoZWR1bGVfdXBkYXRlKCkge1xuICAgIGlmICghdXBkYXRlX3NjaGVkdWxlZCkge1xuICAgICAgICB1cGRhdGVfc2NoZWR1bGVkID0gdHJ1ZTtcbiAgICAgICAgcmVzb2x2ZWRfcHJvbWlzZS50aGVuKGZsdXNoKTtcbiAgICB9XG59XG5mdW5jdGlvbiB0aWNrKCkge1xuICAgIHNjaGVkdWxlX3VwZGF0ZSgpO1xuICAgIHJldHVybiByZXNvbHZlZF9wcm9taXNlO1xufVxuZnVuY3Rpb24gYWRkX3JlbmRlcl9jYWxsYmFjayhmbikge1xuICAgIHJlbmRlcl9jYWxsYmFja3MucHVzaChmbik7XG59XG5mdW5jdGlvbiBhZGRfZmx1c2hfY2FsbGJhY2soZm4pIHtcbiAgICBmbHVzaF9jYWxsYmFja3MucHVzaChmbik7XG59XG4vLyBmbHVzaCgpIGNhbGxzIGNhbGxiYWNrcyBpbiB0aGlzIG9yZGVyOlxuLy8gMS4gQWxsIGJlZm9yZVVwZGF0ZSBjYWxsYmFja3MsIGluIG9yZGVyOiBwYXJlbnRzIGJlZm9yZSBjaGlsZHJlblxuLy8gMi4gQWxsIGJpbmQ6dGhpcyBjYWxsYmFja3MsIGluIHJldmVyc2Ugb3JkZXI6IGNoaWxkcmVuIGJlZm9yZSBwYXJlbnRzLlxuLy8gMy4gQWxsIGFmdGVyVXBkYXRlIGNhbGxiYWNrcywgaW4gb3JkZXI6IHBhcmVudHMgYmVmb3JlIGNoaWxkcmVuLiBFWENFUFRcbi8vICAgIGZvciBhZnRlclVwZGF0ZXMgY2FsbGVkIGR1cmluZyB0aGUgaW5pdGlhbCBvbk1vdW50LCB3aGljaCBhcmUgY2FsbGVkIGluXG4vLyAgICByZXZlcnNlIG9yZGVyOiBjaGlsZHJlbiBiZWZvcmUgcGFyZW50cy5cbi8vIFNpbmNlIGNhbGxiYWNrcyBtaWdodCB1cGRhdGUgY29tcG9uZW50IHZhbHVlcywgd2hpY2ggY291bGQgdHJpZ2dlciBhbm90aGVyXG4vLyBjYWxsIHRvIGZsdXNoKCksIHRoZSBmb2xsb3dpbmcgc3RlcHMgZ3VhcmQgYWdhaW5zdCB0aGlzOlxuLy8gMS4gRHVyaW5nIGJlZm9yZVVwZGF0ZSwgYW55IHVwZGF0ZWQgY29tcG9uZW50cyB3aWxsIGJlIGFkZGVkIHRvIHRoZVxuLy8gICAgZGlydHlfY29tcG9uZW50cyBhcnJheSBhbmQgd2lsbCBjYXVzZSBhIHJlZW50cmFudCBjYWxsIHRvIGZsdXNoKCkuIEJlY2F1c2Vcbi8vICAgIHRoZSBmbHVzaCBpbmRleCBpcyBrZXB0IG91dHNpZGUgdGhlIGZ1bmN0aW9uLCB0aGUgcmVlbnRyYW50IGNhbGwgd2lsbCBwaWNrXG4vLyAgICB1cCB3aGVyZSB0aGUgZWFybGllciBjYWxsIGxlZnQgb2ZmIGFuZCBnbyB0aHJvdWdoIGFsbCBkaXJ0eSBjb21wb25lbnRzLiBUaGVcbi8vICAgIGN1cnJlbnRfY29tcG9uZW50IHZhbHVlIGlzIHNhdmVkIGFuZCByZXN0b3JlZCBzbyB0aGF0IHRoZSByZWVudHJhbnQgY2FsbCB3aWxsXG4vLyAgICBub3QgaW50ZXJmZXJlIHdpdGggdGhlIFwicGFyZW50XCIgZmx1c2goKSBjYWxsLlxuLy8gMi4gYmluZDp0aGlzIGNhbGxiYWNrcyBjYW5ub3QgdHJpZ2dlciBuZXcgZmx1c2goKSBjYWxscy5cbi8vIDMuIER1cmluZyBhZnRlclVwZGF0ZSwgYW55IHVwZGF0ZWQgY29tcG9uZW50cyB3aWxsIE5PVCBoYXZlIHRoZWlyIGFmdGVyVXBkYXRlXG4vLyAgICBjYWxsYmFjayBjYWxsZWQgYSBzZWNvbmQgdGltZTsgdGhlIHNlZW5fY2FsbGJhY2tzIHNldCwgb3V0c2lkZSB0aGUgZmx1c2goKVxuLy8gICAgZnVuY3Rpb24sIGd1YXJhbnRlZXMgdGhpcyBiZWhhdmlvci5cbmNvbnN0IHNlZW5fY2FsbGJhY2tzID0gbmV3IFNldCgpO1xubGV0IGZsdXNoaWR4ID0gMDsgLy8gRG8gKm5vdCogbW92ZSB0aGlzIGluc2lkZSB0aGUgZmx1c2goKSBmdW5jdGlvblxuZnVuY3Rpb24gZmx1c2goKSB7XG4gICAgY29uc3Qgc2F2ZWRfY29tcG9uZW50ID0gY3VycmVudF9jb21wb25lbnQ7XG4gICAgZG8ge1xuICAgICAgICAvLyBmaXJzdCwgY2FsbCBiZWZvcmVVcGRhdGUgZnVuY3Rpb25zXG4gICAgICAgIC8vIGFuZCB1cGRhdGUgY29tcG9uZW50c1xuICAgICAgICB3aGlsZSAoZmx1c2hpZHggPCBkaXJ0eV9jb21wb25lbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgY29tcG9uZW50ID0gZGlydHlfY29tcG9uZW50c1tmbHVzaGlkeF07XG4gICAgICAgICAgICBmbHVzaGlkeCsrO1xuICAgICAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KGNvbXBvbmVudCk7XG4gICAgICAgICAgICB1cGRhdGUoY29tcG9uZW50LiQkKTtcbiAgICAgICAgfVxuICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQobnVsbCk7XG4gICAgICAgIGRpcnR5X2NvbXBvbmVudHMubGVuZ3RoID0gMDtcbiAgICAgICAgZmx1c2hpZHggPSAwO1xuICAgICAgICB3aGlsZSAoYmluZGluZ19jYWxsYmFja3MubGVuZ3RoKVxuICAgICAgICAgICAgYmluZGluZ19jYWxsYmFja3MucG9wKCkoKTtcbiAgICAgICAgLy8gdGhlbiwgb25jZSBjb21wb25lbnRzIGFyZSB1cGRhdGVkLCBjYWxsXG4gICAgICAgIC8vIGFmdGVyVXBkYXRlIGZ1bmN0aW9ucy4gVGhpcyBtYXkgY2F1c2VcbiAgICAgICAgLy8gc3Vic2VxdWVudCB1cGRhdGVzLi4uXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVuZGVyX2NhbGxiYWNrcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgY29uc3QgY2FsbGJhY2sgPSByZW5kZXJfY2FsbGJhY2tzW2ldO1xuICAgICAgICAgICAgaWYgKCFzZWVuX2NhbGxiYWNrcy5oYXMoY2FsbGJhY2spKSB7XG4gICAgICAgICAgICAgICAgLy8gLi4uc28gZ3VhcmQgYWdhaW5zdCBpbmZpbml0ZSBsb29wc1xuICAgICAgICAgICAgICAgIHNlZW5fY2FsbGJhY2tzLmFkZChjYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZW5kZXJfY2FsbGJhY2tzLmxlbmd0aCA9IDA7XG4gICAgfSB3aGlsZSAoZGlydHlfY29tcG9uZW50cy5sZW5ndGgpO1xuICAgIHdoaWxlIChmbHVzaF9jYWxsYmFja3MubGVuZ3RoKSB7XG4gICAgICAgIGZsdXNoX2NhbGxiYWNrcy5wb3AoKSgpO1xuICAgIH1cbiAgICB1cGRhdGVfc2NoZWR1bGVkID0gZmFsc2U7XG4gICAgc2Vlbl9jYWxsYmFja3MuY2xlYXIoKTtcbiAgICBzZXRfY3VycmVudF9jb21wb25lbnQoc2F2ZWRfY29tcG9uZW50KTtcbn1cbmZ1bmN0aW9uIHVwZGF0ZSgkJCkge1xuICAgIGlmICgkJC5mcmFnbWVudCAhPT0gbnVsbCkge1xuICAgICAgICAkJC51cGRhdGUoKTtcbiAgICAgICAgcnVuX2FsbCgkJC5iZWZvcmVfdXBkYXRlKTtcbiAgICAgICAgY29uc3QgZGlydHkgPSAkJC5kaXJ0eTtcbiAgICAgICAgJCQuZGlydHkgPSBbLTFdO1xuICAgICAgICAkJC5mcmFnbWVudCAmJiAkJC5mcmFnbWVudC5wKCQkLmN0eCwgZGlydHkpO1xuICAgICAgICAkJC5hZnRlcl91cGRhdGUuZm9yRWFjaChhZGRfcmVuZGVyX2NhbGxiYWNrKTtcbiAgICB9XG59XG5cbmxldCBwcm9taXNlO1xuZnVuY3Rpb24gd2FpdCgpIHtcbiAgICBpZiAoIXByb21pc2UpIHtcbiAgICAgICAgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICBwcm9taXNlLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgcHJvbWlzZSA9IG51bGw7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcHJvbWlzZTtcbn1cbmZ1bmN0aW9uIGRpc3BhdGNoKG5vZGUsIGRpcmVjdGlvbiwga2luZCkge1xuICAgIG5vZGUuZGlzcGF0Y2hFdmVudChjdXN0b21fZXZlbnQoYCR7ZGlyZWN0aW9uID8gJ2ludHJvJyA6ICdvdXRybyd9JHtraW5kfWApKTtcbn1cbmNvbnN0IG91dHJvaW5nID0gbmV3IFNldCgpO1xubGV0IG91dHJvcztcbmZ1bmN0aW9uIGdyb3VwX291dHJvcygpIHtcbiAgICBvdXRyb3MgPSB7XG4gICAgICAgIHI6IDAsXG4gICAgICAgIGM6IFtdLFxuICAgICAgICBwOiBvdXRyb3MgLy8gcGFyZW50IGdyb3VwXG4gICAgfTtcbn1cbmZ1bmN0aW9uIGNoZWNrX291dHJvcygpIHtcbiAgICBpZiAoIW91dHJvcy5yKSB7XG4gICAgICAgIHJ1bl9hbGwob3V0cm9zLmMpO1xuICAgIH1cbiAgICBvdXRyb3MgPSBvdXRyb3MucDtcbn1cbmZ1bmN0aW9uIHRyYW5zaXRpb25faW4oYmxvY2ssIGxvY2FsKSB7XG4gICAgaWYgKGJsb2NrICYmIGJsb2NrLmkpIHtcbiAgICAgICAgb3V0cm9pbmcuZGVsZXRlKGJsb2NrKTtcbiAgICAgICAgYmxvY2suaShsb2NhbCk7XG4gICAgfVxufVxuZnVuY3Rpb24gdHJhbnNpdGlvbl9vdXQoYmxvY2ssIGxvY2FsLCBkZXRhY2gsIGNhbGxiYWNrKSB7XG4gICAgaWYgKGJsb2NrICYmIGJsb2NrLm8pIHtcbiAgICAgICAgaWYgKG91dHJvaW5nLmhhcyhibG9jaykpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIG91dHJvaW5nLmFkZChibG9jayk7XG4gICAgICAgIG91dHJvcy5jLnB1c2goKCkgPT4ge1xuICAgICAgICAgICAgb3V0cm9pbmcuZGVsZXRlKGJsb2NrKTtcbiAgICAgICAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGlmIChkZXRhY2gpXG4gICAgICAgICAgICAgICAgICAgIGJsb2NrLmQoMSk7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGJsb2NrLm8obG9jYWwpO1xuICAgIH1cbn1cbmNvbnN0IG51bGxfdHJhbnNpdGlvbiA9IHsgZHVyYXRpb246IDAgfTtcbmZ1bmN0aW9uIGNyZWF0ZV9pbl90cmFuc2l0aW9uKG5vZGUsIGZuLCBwYXJhbXMpIHtcbiAgICBsZXQgY29uZmlnID0gZm4obm9kZSwgcGFyYW1zKTtcbiAgICBsZXQgcnVubmluZyA9IGZhbHNlO1xuICAgIGxldCBhbmltYXRpb25fbmFtZTtcbiAgICBsZXQgdGFzaztcbiAgICBsZXQgdWlkID0gMDtcbiAgICBmdW5jdGlvbiBjbGVhbnVwKCkge1xuICAgICAgICBpZiAoYW5pbWF0aW9uX25hbWUpXG4gICAgICAgICAgICBkZWxldGVfcnVsZShub2RlLCBhbmltYXRpb25fbmFtZSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdvKCkge1xuICAgICAgICBjb25zdCB7IGRlbGF5ID0gMCwgZHVyYXRpb24gPSAzMDAsIGVhc2luZyA9IGlkZW50aXR5LCB0aWNrID0gbm9vcCwgY3NzIH0gPSBjb25maWcgfHwgbnVsbF90cmFuc2l0aW9uO1xuICAgICAgICBpZiAoY3NzKVxuICAgICAgICAgICAgYW5pbWF0aW9uX25hbWUgPSBjcmVhdGVfcnVsZShub2RlLCAwLCAxLCBkdXJhdGlvbiwgZGVsYXksIGVhc2luZywgY3NzLCB1aWQrKyk7XG4gICAgICAgIHRpY2soMCwgMSk7XG4gICAgICAgIGNvbnN0IHN0YXJ0X3RpbWUgPSBub3coKSArIGRlbGF5O1xuICAgICAgICBjb25zdCBlbmRfdGltZSA9IHN0YXJ0X3RpbWUgKyBkdXJhdGlvbjtcbiAgICAgICAgaWYgKHRhc2spXG4gICAgICAgICAgICB0YXNrLmFib3J0KCk7XG4gICAgICAgIHJ1bm5pbmcgPSB0cnVlO1xuICAgICAgICBhZGRfcmVuZGVyX2NhbGxiYWNrKCgpID0+IGRpc3BhdGNoKG5vZGUsIHRydWUsICdzdGFydCcpKTtcbiAgICAgICAgdGFzayA9IGxvb3Aobm93ID0+IHtcbiAgICAgICAgICAgIGlmIChydW5uaW5nKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vdyA+PSBlbmRfdGltZSkge1xuICAgICAgICAgICAgICAgICAgICB0aWNrKDEsIDApO1xuICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaChub2RlLCB0cnVlLCAnZW5kJyk7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5vdyA+PSBzdGFydF90aW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBlYXNpbmcoKG5vdyAtIHN0YXJ0X3RpbWUpIC8gZHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB0aWNrKHQsIDEgLSB0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcnVubmluZztcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGxldCBzdGFydGVkID0gZmFsc2U7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc3RhcnQoKSB7XG4gICAgICAgICAgICBpZiAoc3RhcnRlZClcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBzdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGRlbGV0ZV9ydWxlKG5vZGUpO1xuICAgICAgICAgICAgaWYgKGlzX2Z1bmN0aW9uKGNvbmZpZykpIHtcbiAgICAgICAgICAgICAgICBjb25maWcgPSBjb25maWcoKTtcbiAgICAgICAgICAgICAgICB3YWl0KCkudGhlbihnbyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBnbygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBpbnZhbGlkYXRlKCkge1xuICAgICAgICAgICAgc3RhcnRlZCA9IGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBlbmQoKSB7XG4gICAgICAgICAgICBpZiAocnVubmluZykge1xuICAgICAgICAgICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgICAgICAgICBydW5uaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufVxuZnVuY3Rpb24gY3JlYXRlX291dF90cmFuc2l0aW9uKG5vZGUsIGZuLCBwYXJhbXMpIHtcbiAgICBsZXQgY29uZmlnID0gZm4obm9kZSwgcGFyYW1zKTtcbiAgICBsZXQgcnVubmluZyA9IHRydWU7XG4gICAgbGV0IGFuaW1hdGlvbl9uYW1lO1xuICAgIGNvbnN0IGdyb3VwID0gb3V0cm9zO1xuICAgIGdyb3VwLnIgKz0gMTtcbiAgICBmdW5jdGlvbiBnbygpIHtcbiAgICAgICAgY29uc3QgeyBkZWxheSA9IDAsIGR1cmF0aW9uID0gMzAwLCBlYXNpbmcgPSBpZGVudGl0eSwgdGljayA9IG5vb3AsIGNzcyB9ID0gY29uZmlnIHx8IG51bGxfdHJhbnNpdGlvbjtcbiAgICAgICAgaWYgKGNzcylcbiAgICAgICAgICAgIGFuaW1hdGlvbl9uYW1lID0gY3JlYXRlX3J1bGUobm9kZSwgMSwgMCwgZHVyYXRpb24sIGRlbGF5LCBlYXNpbmcsIGNzcyk7XG4gICAgICAgIGNvbnN0IHN0YXJ0X3RpbWUgPSBub3coKSArIGRlbGF5O1xuICAgICAgICBjb25zdCBlbmRfdGltZSA9IHN0YXJ0X3RpbWUgKyBkdXJhdGlvbjtcbiAgICAgICAgYWRkX3JlbmRlcl9jYWxsYmFjaygoKSA9PiBkaXNwYXRjaChub2RlLCBmYWxzZSwgJ3N0YXJ0JykpO1xuICAgICAgICBsb29wKG5vdyA9PiB7XG4gICAgICAgICAgICBpZiAocnVubmluZykge1xuICAgICAgICAgICAgICAgIGlmIChub3cgPj0gZW5kX3RpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGljaygwLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2gobm9kZSwgZmFsc2UsICdlbmQnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEtLWdyb3VwLnIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgd2lsbCByZXN1bHQgaW4gYGVuZCgpYCBiZWluZyBjYWxsZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzbyB3ZSBkb24ndCBuZWVkIHRvIGNsZWFuIHVwIGhlcmVcbiAgICAgICAgICAgICAgICAgICAgICAgIHJ1bl9hbGwoZ3JvdXAuYyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobm93ID49IHN0YXJ0X3RpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGVhc2luZygobm93IC0gc3RhcnRfdGltZSkgLyBkdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHRpY2soMSAtIHQsIHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBydW5uaW5nO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGlzX2Z1bmN0aW9uKGNvbmZpZykpIHtcbiAgICAgICAgd2FpdCgpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgY29uZmlnID0gY29uZmlnKCk7XG4gICAgICAgICAgICBnbygpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGdvKCk7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGVuZChyZXNldCkge1xuICAgICAgICAgICAgaWYgKHJlc2V0ICYmIGNvbmZpZy50aWNrKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnLnRpY2soMSwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocnVubmluZykge1xuICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb25fbmFtZSlcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlX3J1bGUobm9kZSwgYW5pbWF0aW9uX25hbWUpO1xuICAgICAgICAgICAgICAgIHJ1bm5pbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG59XG5mdW5jdGlvbiBjcmVhdGVfYmlkaXJlY3Rpb25hbF90cmFuc2l0aW9uKG5vZGUsIGZuLCBwYXJhbXMsIGludHJvKSB7XG4gICAgbGV0IGNvbmZpZyA9IGZuKG5vZGUsIHBhcmFtcyk7XG4gICAgbGV0IHQgPSBpbnRybyA/IDAgOiAxO1xuICAgIGxldCBydW5uaW5nX3Byb2dyYW0gPSBudWxsO1xuICAgIGxldCBwZW5kaW5nX3Byb2dyYW0gPSBudWxsO1xuICAgIGxldCBhbmltYXRpb25fbmFtZSA9IG51bGw7XG4gICAgZnVuY3Rpb24gY2xlYXJfYW5pbWF0aW9uKCkge1xuICAgICAgICBpZiAoYW5pbWF0aW9uX25hbWUpXG4gICAgICAgICAgICBkZWxldGVfcnVsZShub2RlLCBhbmltYXRpb25fbmFtZSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGluaXQocHJvZ3JhbSwgZHVyYXRpb24pIHtcbiAgICAgICAgY29uc3QgZCA9IChwcm9ncmFtLmIgLSB0KTtcbiAgICAgICAgZHVyYXRpb24gKj0gTWF0aC5hYnMoZCk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhOiB0LFxuICAgICAgICAgICAgYjogcHJvZ3JhbS5iLFxuICAgICAgICAgICAgZCxcbiAgICAgICAgICAgIGR1cmF0aW9uLFxuICAgICAgICAgICAgc3RhcnQ6IHByb2dyYW0uc3RhcnQsXG4gICAgICAgICAgICBlbmQ6IHByb2dyYW0uc3RhcnQgKyBkdXJhdGlvbixcbiAgICAgICAgICAgIGdyb3VwOiBwcm9ncmFtLmdyb3VwXG4gICAgICAgIH07XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdvKGIpIHtcbiAgICAgICAgY29uc3QgeyBkZWxheSA9IDAsIGR1cmF0aW9uID0gMzAwLCBlYXNpbmcgPSBpZGVudGl0eSwgdGljayA9IG5vb3AsIGNzcyB9ID0gY29uZmlnIHx8IG51bGxfdHJhbnNpdGlvbjtcbiAgICAgICAgY29uc3QgcHJvZ3JhbSA9IHtcbiAgICAgICAgICAgIHN0YXJ0OiBub3coKSArIGRlbGF5LFxuICAgICAgICAgICAgYlxuICAgICAgICB9O1xuICAgICAgICBpZiAoIWIpIHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgdG9kbzogaW1wcm92ZSB0eXBpbmdzXG4gICAgICAgICAgICBwcm9ncmFtLmdyb3VwID0gb3V0cm9zO1xuICAgICAgICAgICAgb3V0cm9zLnIgKz0gMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocnVubmluZ19wcm9ncmFtIHx8IHBlbmRpbmdfcHJvZ3JhbSkge1xuICAgICAgICAgICAgcGVuZGluZ19wcm9ncmFtID0gcHJvZ3JhbTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIGlmIHRoaXMgaXMgYW4gaW50cm8sIGFuZCB0aGVyZSdzIGEgZGVsYXksIHdlIG5lZWQgdG8gZG9cbiAgICAgICAgICAgIC8vIGFuIGluaXRpYWwgdGljayBhbmQvb3IgYXBwbHkgQ1NTIGFuaW1hdGlvbiBpbW1lZGlhdGVseVxuICAgICAgICAgICAgaWYgKGNzcykge1xuICAgICAgICAgICAgICAgIGNsZWFyX2FuaW1hdGlvbigpO1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9uYW1lID0gY3JlYXRlX3J1bGUobm9kZSwgdCwgYiwgZHVyYXRpb24sIGRlbGF5LCBlYXNpbmcsIGNzcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYilcbiAgICAgICAgICAgICAgICB0aWNrKDAsIDEpO1xuICAgICAgICAgICAgcnVubmluZ19wcm9ncmFtID0gaW5pdChwcm9ncmFtLCBkdXJhdGlvbik7XG4gICAgICAgICAgICBhZGRfcmVuZGVyX2NhbGxiYWNrKCgpID0+IGRpc3BhdGNoKG5vZGUsIGIsICdzdGFydCcpKTtcbiAgICAgICAgICAgIGxvb3Aobm93ID0+IHtcbiAgICAgICAgICAgICAgICBpZiAocGVuZGluZ19wcm9ncmFtICYmIG5vdyA+IHBlbmRpbmdfcHJvZ3JhbS5zdGFydCkge1xuICAgICAgICAgICAgICAgICAgICBydW5uaW5nX3Byb2dyYW0gPSBpbml0KHBlbmRpbmdfcHJvZ3JhbSwgZHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBwZW5kaW5nX3Byb2dyYW0gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBkaXNwYXRjaChub2RlLCBydW5uaW5nX3Byb2dyYW0uYiwgJ3N0YXJ0Jyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFyX2FuaW1hdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uX25hbWUgPSBjcmVhdGVfcnVsZShub2RlLCB0LCBydW5uaW5nX3Byb2dyYW0uYiwgcnVubmluZ19wcm9ncmFtLmR1cmF0aW9uLCAwLCBlYXNpbmcsIGNvbmZpZy5jc3MpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChydW5uaW5nX3Byb2dyYW0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vdyA+PSBydW5uaW5nX3Byb2dyYW0uZW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aWNrKHQgPSBydW5uaW5nX3Byb2dyYW0uYiwgMSAtIHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGF0Y2gobm9kZSwgcnVubmluZ19wcm9ncmFtLmIsICdlbmQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcGVuZGluZ19wcm9ncmFtKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2UncmUgZG9uZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChydW5uaW5nX3Byb2dyYW0uYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpbnRybyBcdTIwMTQgd2UgY2FuIHRpZHkgdXAgaW1tZWRpYXRlbHlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJfYW5pbWF0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBvdXRybyBcdTIwMTQgbmVlZHMgdG8gYmUgY29vcmRpbmF0ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEtLXJ1bm5pbmdfcHJvZ3JhbS5ncm91cC5yKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVuX2FsbChydW5uaW5nX3Byb2dyYW0uZ3JvdXAuYyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcnVubmluZ19wcm9ncmFtID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChub3cgPj0gcnVubmluZ19wcm9ncmFtLnN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwID0gbm93IC0gcnVubmluZ19wcm9ncmFtLnN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdCA9IHJ1bm5pbmdfcHJvZ3JhbS5hICsgcnVubmluZ19wcm9ncmFtLmQgKiBlYXNpbmcocCAvIHJ1bm5pbmdfcHJvZ3JhbS5kdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aWNrKHQsIDEgLSB0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gISEocnVubmluZ19wcm9ncmFtIHx8IHBlbmRpbmdfcHJvZ3JhbSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBydW4oYikge1xuICAgICAgICAgICAgaWYgKGlzX2Z1bmN0aW9uKGNvbmZpZykpIHtcbiAgICAgICAgICAgICAgICB3YWl0KCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgY29uZmlnID0gY29uZmlnKCk7XG4gICAgICAgICAgICAgICAgICAgIGdvKGIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZ28oYik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVuZCgpIHtcbiAgICAgICAgICAgIGNsZWFyX2FuaW1hdGlvbigpO1xuICAgICAgICAgICAgcnVubmluZ19wcm9ncmFtID0gcGVuZGluZ19wcm9ncmFtID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIGhhbmRsZV9wcm9taXNlKHByb21pc2UsIGluZm8pIHtcbiAgICBjb25zdCB0b2tlbiA9IGluZm8udG9rZW4gPSB7fTtcbiAgICBmdW5jdGlvbiB1cGRhdGUodHlwZSwgaW5kZXgsIGtleSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKGluZm8udG9rZW4gIT09IHRva2VuKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpbmZvLnJlc29sdmVkID0gdmFsdWU7XG4gICAgICAgIGxldCBjaGlsZF9jdHggPSBpbmZvLmN0eDtcbiAgICAgICAgaWYgKGtleSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjaGlsZF9jdHggPSBjaGlsZF9jdHguc2xpY2UoKTtcbiAgICAgICAgICAgIGNoaWxkX2N0eFtrZXldID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgYmxvY2sgPSB0eXBlICYmIChpbmZvLmN1cnJlbnQgPSB0eXBlKShjaGlsZF9jdHgpO1xuICAgICAgICBsZXQgbmVlZHNfZmx1c2ggPSBmYWxzZTtcbiAgICAgICAgaWYgKGluZm8uYmxvY2spIHtcbiAgICAgICAgICAgIGlmIChpbmZvLmJsb2Nrcykge1xuICAgICAgICAgICAgICAgIGluZm8uYmxvY2tzLmZvckVhY2goKGJsb2NrLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpICE9PSBpbmRleCAmJiBibG9jaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3JvdXBfb3V0cm9zKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uX291dChibG9jaywgMSwgMSwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmZvLmJsb2Nrc1tpXSA9PT0gYmxvY2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mby5ibG9ja3NbaV0gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tfb3V0cm9zKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGluZm8uYmxvY2suZCgxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJsb2NrLmMoKTtcbiAgICAgICAgICAgIHRyYW5zaXRpb25faW4oYmxvY2ssIDEpO1xuICAgICAgICAgICAgYmxvY2subShpbmZvLm1vdW50KCksIGluZm8uYW5jaG9yKTtcbiAgICAgICAgICAgIG5lZWRzX2ZsdXNoID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpbmZvLmJsb2NrID0gYmxvY2s7XG4gICAgICAgIGlmIChpbmZvLmJsb2NrcylcbiAgICAgICAgICAgIGluZm8uYmxvY2tzW2luZGV4XSA9IGJsb2NrO1xuICAgICAgICBpZiAobmVlZHNfZmx1c2gpIHtcbiAgICAgICAgICAgIGZsdXNoKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKGlzX3Byb21pc2UocHJvbWlzZSkpIHtcbiAgICAgICAgY29uc3QgY3VycmVudF9jb21wb25lbnQgPSBnZXRfY3VycmVudF9jb21wb25lbnQoKTtcbiAgICAgICAgcHJvbWlzZS50aGVuKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChjdXJyZW50X2NvbXBvbmVudCk7XG4gICAgICAgICAgICB1cGRhdGUoaW5mby50aGVuLCAxLCBpbmZvLnZhbHVlLCB2YWx1ZSk7XG4gICAgICAgICAgICBzZXRfY3VycmVudF9jb21wb25lbnQobnVsbCk7XG4gICAgICAgIH0sIGVycm9yID0+IHtcbiAgICAgICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChjdXJyZW50X2NvbXBvbmVudCk7XG4gICAgICAgICAgICB1cGRhdGUoaW5mby5jYXRjaCwgMiwgaW5mby5lcnJvciwgZXJyb3IpO1xuICAgICAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KG51bGwpO1xuICAgICAgICAgICAgaWYgKCFpbmZvLmhhc0NhdGNoKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBpZiB3ZSBwcmV2aW91c2x5IGhhZCBhIHRoZW4vY2F0Y2ggYmxvY2ssIGRlc3Ryb3kgaXRcbiAgICAgICAgaWYgKGluZm8uY3VycmVudCAhPT0gaW5mby5wZW5kaW5nKSB7XG4gICAgICAgICAgICB1cGRhdGUoaW5mby5wZW5kaW5nLCAwKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpZiAoaW5mby5jdXJyZW50ICE9PSBpbmZvLnRoZW4pIHtcbiAgICAgICAgICAgIHVwZGF0ZShpbmZvLnRoZW4sIDEsIGluZm8udmFsdWUsIHByb21pc2UpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaW5mby5yZXNvbHZlZCA9IHByb21pc2U7XG4gICAgfVxufVxuZnVuY3Rpb24gdXBkYXRlX2F3YWl0X2Jsb2NrX2JyYW5jaChpbmZvLCBjdHgsIGRpcnR5KSB7XG4gICAgY29uc3QgY2hpbGRfY3R4ID0gY3R4LnNsaWNlKCk7XG4gICAgY29uc3QgeyByZXNvbHZlZCB9ID0gaW5mbztcbiAgICBpZiAoaW5mby5jdXJyZW50ID09PSBpbmZvLnRoZW4pIHtcbiAgICAgICAgY2hpbGRfY3R4W2luZm8udmFsdWVdID0gcmVzb2x2ZWQ7XG4gICAgfVxuICAgIGlmIChpbmZvLmN1cnJlbnQgPT09IGluZm8uY2F0Y2gpIHtcbiAgICAgICAgY2hpbGRfY3R4W2luZm8uZXJyb3JdID0gcmVzb2x2ZWQ7XG4gICAgfVxuICAgIGluZm8uYmxvY2sucChjaGlsZF9jdHgsIGRpcnR5KTtcbn1cblxuY29uc3QgZ2xvYmFscyA9ICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJ1xuICAgID8gd2luZG93XG4gICAgOiB0eXBlb2YgZ2xvYmFsVGhpcyAhPT0gJ3VuZGVmaW5lZCdcbiAgICAgICAgPyBnbG9iYWxUaGlzXG4gICAgICAgIDogZ2xvYmFsKTtcblxuZnVuY3Rpb24gZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKSB7XG4gICAgYmxvY2suZCgxKTtcbiAgICBsb29rdXAuZGVsZXRlKGJsb2NrLmtleSk7XG59XG5mdW5jdGlvbiBvdXRyb19hbmRfZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKSB7XG4gICAgdHJhbnNpdGlvbl9vdXQoYmxvY2ssIDEsIDEsICgpID0+IHtcbiAgICAgICAgbG9va3VwLmRlbGV0ZShibG9jay5rZXkpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gZml4X2FuZF9kZXN0cm95X2Jsb2NrKGJsb2NrLCBsb29rdXApIHtcbiAgICBibG9jay5mKCk7XG4gICAgZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKTtcbn1cbmZ1bmN0aW9uIGZpeF9hbmRfb3V0cm9fYW5kX2Rlc3Ryb3lfYmxvY2soYmxvY2ssIGxvb2t1cCkge1xuICAgIGJsb2NrLmYoKTtcbiAgICBvdXRyb19hbmRfZGVzdHJveV9ibG9jayhibG9jaywgbG9va3VwKTtcbn1cbmZ1bmN0aW9uIHVwZGF0ZV9rZXllZF9lYWNoKG9sZF9ibG9ja3MsIGRpcnR5LCBnZXRfa2V5LCBkeW5hbWljLCBjdHgsIGxpc3QsIGxvb2t1cCwgbm9kZSwgZGVzdHJveSwgY3JlYXRlX2VhY2hfYmxvY2ssIG5leHQsIGdldF9jb250ZXh0KSB7XG4gICAgbGV0IG8gPSBvbGRfYmxvY2tzLmxlbmd0aDtcbiAgICBsZXQgbiA9IGxpc3QubGVuZ3RoO1xuICAgIGxldCBpID0gbztcbiAgICBjb25zdCBvbGRfaW5kZXhlcyA9IHt9O1xuICAgIHdoaWxlIChpLS0pXG4gICAgICAgIG9sZF9pbmRleGVzW29sZF9ibG9ja3NbaV0ua2V5XSA9IGk7XG4gICAgY29uc3QgbmV3X2Jsb2NrcyA9IFtdO1xuICAgIGNvbnN0IG5ld19sb29rdXAgPSBuZXcgTWFwKCk7XG4gICAgY29uc3QgZGVsdGFzID0gbmV3IE1hcCgpO1xuICAgIGkgPSBuO1xuICAgIHdoaWxlIChpLS0pIHtcbiAgICAgICAgY29uc3QgY2hpbGRfY3R4ID0gZ2V0X2NvbnRleHQoY3R4LCBsaXN0LCBpKTtcbiAgICAgICAgY29uc3Qga2V5ID0gZ2V0X2tleShjaGlsZF9jdHgpO1xuICAgICAgICBsZXQgYmxvY2sgPSBsb29rdXAuZ2V0KGtleSk7XG4gICAgICAgIGlmICghYmxvY2spIHtcbiAgICAgICAgICAgIGJsb2NrID0gY3JlYXRlX2VhY2hfYmxvY2soa2V5LCBjaGlsZF9jdHgpO1xuICAgICAgICAgICAgYmxvY2suYygpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGR5bmFtaWMpIHtcbiAgICAgICAgICAgIGJsb2NrLnAoY2hpbGRfY3R4LCBkaXJ0eSk7XG4gICAgICAgIH1cbiAgICAgICAgbmV3X2xvb2t1cC5zZXQoa2V5LCBuZXdfYmxvY2tzW2ldID0gYmxvY2spO1xuICAgICAgICBpZiAoa2V5IGluIG9sZF9pbmRleGVzKVxuICAgICAgICAgICAgZGVsdGFzLnNldChrZXksIE1hdGguYWJzKGkgLSBvbGRfaW5kZXhlc1trZXldKSk7XG4gICAgfVxuICAgIGNvbnN0IHdpbGxfbW92ZSA9IG5ldyBTZXQoKTtcbiAgICBjb25zdCBkaWRfbW92ZSA9IG5ldyBTZXQoKTtcbiAgICBmdW5jdGlvbiBpbnNlcnQoYmxvY2spIHtcbiAgICAgICAgdHJhbnNpdGlvbl9pbihibG9jaywgMSk7XG4gICAgICAgIGJsb2NrLm0obm9kZSwgbmV4dCk7XG4gICAgICAgIGxvb2t1cC5zZXQoYmxvY2sua2V5LCBibG9jayk7XG4gICAgICAgIG5leHQgPSBibG9jay5maXJzdDtcbiAgICAgICAgbi0tO1xuICAgIH1cbiAgICB3aGlsZSAobyAmJiBuKSB7XG4gICAgICAgIGNvbnN0IG5ld19ibG9jayA9IG5ld19ibG9ja3NbbiAtIDFdO1xuICAgICAgICBjb25zdCBvbGRfYmxvY2sgPSBvbGRfYmxvY2tzW28gLSAxXTtcbiAgICAgICAgY29uc3QgbmV3X2tleSA9IG5ld19ibG9jay5rZXk7XG4gICAgICAgIGNvbnN0IG9sZF9rZXkgPSBvbGRfYmxvY2sua2V5O1xuICAgICAgICBpZiAobmV3X2Jsb2NrID09PSBvbGRfYmxvY2spIHtcbiAgICAgICAgICAgIC8vIGRvIG5vdGhpbmdcbiAgICAgICAgICAgIG5leHQgPSBuZXdfYmxvY2suZmlyc3Q7XG4gICAgICAgICAgICBvLS07XG4gICAgICAgICAgICBuLS07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIW5ld19sb29rdXAuaGFzKG9sZF9rZXkpKSB7XG4gICAgICAgICAgICAvLyByZW1vdmUgb2xkIGJsb2NrXG4gICAgICAgICAgICBkZXN0cm95KG9sZF9ibG9jaywgbG9va3VwKTtcbiAgICAgICAgICAgIG8tLTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghbG9va3VwLmhhcyhuZXdfa2V5KSB8fCB3aWxsX21vdmUuaGFzKG5ld19rZXkpKSB7XG4gICAgICAgICAgICBpbnNlcnQobmV3X2Jsb2NrKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkaWRfbW92ZS5oYXMob2xkX2tleSkpIHtcbiAgICAgICAgICAgIG8tLTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChkZWx0YXMuZ2V0KG5ld19rZXkpID4gZGVsdGFzLmdldChvbGRfa2V5KSkge1xuICAgICAgICAgICAgZGlkX21vdmUuYWRkKG5ld19rZXkpO1xuICAgICAgICAgICAgaW5zZXJ0KG5ld19ibG9jayk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB3aWxsX21vdmUuYWRkKG9sZF9rZXkpO1xuICAgICAgICAgICAgby0tO1xuICAgICAgICB9XG4gICAgfVxuICAgIHdoaWxlIChvLS0pIHtcbiAgICAgICAgY29uc3Qgb2xkX2Jsb2NrID0gb2xkX2Jsb2Nrc1tvXTtcbiAgICAgICAgaWYgKCFuZXdfbG9va3VwLmhhcyhvbGRfYmxvY2sua2V5KSlcbiAgICAgICAgICAgIGRlc3Ryb3kob2xkX2Jsb2NrLCBsb29rdXApO1xuICAgIH1cbiAgICB3aGlsZSAobilcbiAgICAgICAgaW5zZXJ0KG5ld19ibG9ja3NbbiAtIDFdKTtcbiAgICByZXR1cm4gbmV3X2Jsb2Nrcztcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlX2VhY2hfa2V5cyhjdHgsIGxpc3QsIGdldF9jb250ZXh0LCBnZXRfa2V5KSB7XG4gICAgY29uc3Qga2V5cyA9IG5ldyBTZXQoKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3Qga2V5ID0gZ2V0X2tleShnZXRfY29udGV4dChjdHgsIGxpc3QsIGkpKTtcbiAgICAgICAgaWYgKGtleXMuaGFzKGtleSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGhhdmUgZHVwbGljYXRlIGtleXMgaW4gYSBrZXllZCBlYWNoJyk7XG4gICAgICAgIH1cbiAgICAgICAga2V5cy5hZGQoa2V5KTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGdldF9zcHJlYWRfdXBkYXRlKGxldmVscywgdXBkYXRlcykge1xuICAgIGNvbnN0IHVwZGF0ZSA9IHt9O1xuICAgIGNvbnN0IHRvX251bGxfb3V0ID0ge307XG4gICAgY29uc3QgYWNjb3VudGVkX2ZvciA9IHsgJCRzY29wZTogMSB9O1xuICAgIGxldCBpID0gbGV2ZWxzLmxlbmd0aDtcbiAgICB3aGlsZSAoaS0tKSB7XG4gICAgICAgIGNvbnN0IG8gPSBsZXZlbHNbaV07XG4gICAgICAgIGNvbnN0IG4gPSB1cGRhdGVzW2ldO1xuICAgICAgICBpZiAobikge1xuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gbykge1xuICAgICAgICAgICAgICAgIGlmICghKGtleSBpbiBuKSlcbiAgICAgICAgICAgICAgICAgICAgdG9fbnVsbF9vdXRba2V5XSA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBuKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFhY2NvdW50ZWRfZm9yW2tleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlW2tleV0gPSBuW2tleV07XG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRlZF9mb3Jba2V5XSA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV2ZWxzW2ldID0gbjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIG8pIHtcbiAgICAgICAgICAgICAgICBhY2NvdW50ZWRfZm9yW2tleV0gPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGZvciAoY29uc3Qga2V5IGluIHRvX251bGxfb3V0KSB7XG4gICAgICAgIGlmICghKGtleSBpbiB1cGRhdGUpKVxuICAgICAgICAgICAgdXBkYXRlW2tleV0gPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHJldHVybiB1cGRhdGU7XG59XG5mdW5jdGlvbiBnZXRfc3ByZWFkX29iamVjdChzcHJlYWRfcHJvcHMpIHtcbiAgICByZXR1cm4gdHlwZW9mIHNwcmVhZF9wcm9wcyA9PT0gJ29iamVjdCcgJiYgc3ByZWFkX3Byb3BzICE9PSBudWxsID8gc3ByZWFkX3Byb3BzIDoge307XG59XG5cbi8vIHNvdXJjZTogaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2UvaW5kaWNlcy5odG1sXG5jb25zdCBib29sZWFuX2F0dHJpYnV0ZXMgPSBuZXcgU2V0KFtcbiAgICAnYWxsb3dmdWxsc2NyZWVuJyxcbiAgICAnYWxsb3dwYXltZW50cmVxdWVzdCcsXG4gICAgJ2FzeW5jJyxcbiAgICAnYXV0b2ZvY3VzJyxcbiAgICAnYXV0b3BsYXknLFxuICAgICdjaGVja2VkJyxcbiAgICAnY29udHJvbHMnLFxuICAgICdkZWZhdWx0JyxcbiAgICAnZGVmZXInLFxuICAgICdkaXNhYmxlZCcsXG4gICAgJ2Zvcm1ub3ZhbGlkYXRlJyxcbiAgICAnaGlkZGVuJyxcbiAgICAnaXNtYXAnLFxuICAgICdsb29wJyxcbiAgICAnbXVsdGlwbGUnLFxuICAgICdtdXRlZCcsXG4gICAgJ25vbW9kdWxlJyxcbiAgICAnbm92YWxpZGF0ZScsXG4gICAgJ29wZW4nLFxuICAgICdwbGF5c2lubGluZScsXG4gICAgJ3JlYWRvbmx5JyxcbiAgICAncmVxdWlyZWQnLFxuICAgICdyZXZlcnNlZCcsXG4gICAgJ3NlbGVjdGVkJ1xuXSk7XG5cbmNvbnN0IHZvaWRfZWxlbWVudF9uYW1lcyA9IC9eKD86YXJlYXxiYXNlfGJyfGNvbHxjb21tYW5kfGVtYmVkfGhyfGltZ3xpbnB1dHxrZXlnZW58bGlua3xtZXRhfHBhcmFtfHNvdXJjZXx0cmFja3x3YnIpJC87XG5mdW5jdGlvbiBpc192b2lkKG5hbWUpIHtcbiAgICByZXR1cm4gdm9pZF9lbGVtZW50X25hbWVzLnRlc3QobmFtZSkgfHwgbmFtZS50b0xvd2VyQ2FzZSgpID09PSAnIWRvY3R5cGUnO1xufVxuXG5jb25zdCBpbnZhbGlkX2F0dHJpYnV0ZV9uYW1lX2NoYXJhY3RlciA9IC9bXFxzJ1wiPi89XFx1e0ZERDB9LVxcdXtGREVGfVxcdXtGRkZFfVxcdXtGRkZGfVxcdXsxRkZGRX1cXHV7MUZGRkZ9XFx1ezJGRkZFfVxcdXsyRkZGRn1cXHV7M0ZGRkV9XFx1ezNGRkZGfVxcdXs0RkZGRX1cXHV7NEZGRkZ9XFx1ezVGRkZFfVxcdXs1RkZGRn1cXHV7NkZGRkV9XFx1ezZGRkZGfVxcdXs3RkZGRX1cXHV7N0ZGRkZ9XFx1ezhGRkZFfVxcdXs4RkZGRn1cXHV7OUZGRkV9XFx1ezlGRkZGfVxcdXtBRkZGRX1cXHV7QUZGRkZ9XFx1e0JGRkZFfVxcdXtCRkZGRn1cXHV7Q0ZGRkV9XFx1e0NGRkZGfVxcdXtERkZGRX1cXHV7REZGRkZ9XFx1e0VGRkZFfVxcdXtFRkZGRn1cXHV7RkZGRkV9XFx1e0ZGRkZGfVxcdXsxMEZGRkV9XFx1ezEwRkZGRn1dL3U7XG4vLyBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9zeW50YXguaHRtbCNhdHRyaWJ1dGVzLTJcbi8vIGh0dHBzOi8vaW5mcmEuc3BlYy53aGF0d2cub3JnLyNub25jaGFyYWN0ZXJcbmZ1bmN0aW9uIHNwcmVhZChhcmdzLCBhdHRyc190b19hZGQpIHtcbiAgICBjb25zdCBhdHRyaWJ1dGVzID0gT2JqZWN0LmFzc2lnbih7fSwgLi4uYXJncyk7XG4gICAgaWYgKGF0dHJzX3RvX2FkZCkge1xuICAgICAgICBjb25zdCBjbGFzc2VzX3RvX2FkZCA9IGF0dHJzX3RvX2FkZC5jbGFzc2VzO1xuICAgICAgICBjb25zdCBzdHlsZXNfdG9fYWRkID0gYXR0cnNfdG9fYWRkLnN0eWxlcztcbiAgICAgICAgaWYgKGNsYXNzZXNfdG9fYWRkKSB7XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlcy5jbGFzcyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcy5jbGFzcyA9IGNsYXNzZXNfdG9fYWRkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcy5jbGFzcyArPSAnICcgKyBjbGFzc2VzX3RvX2FkZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoc3R5bGVzX3RvX2FkZCkge1xuICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZXMuc3R5bGUgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMuc3R5bGUgPSBzdHlsZV9vYmplY3RfdG9fc3RyaW5nKHN0eWxlc190b19hZGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcy5zdHlsZSA9IHN0eWxlX29iamVjdF90b19zdHJpbmcobWVyZ2Vfc3NyX3N0eWxlcyhhdHRyaWJ1dGVzLnN0eWxlLCBzdHlsZXNfdG9fYWRkKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgbGV0IHN0ciA9ICcnO1xuICAgIE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmZvckVhY2gobmFtZSA9PiB7XG4gICAgICAgIGlmIChpbnZhbGlkX2F0dHJpYnV0ZV9uYW1lX2NoYXJhY3Rlci50ZXN0KG5hbWUpKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGF0dHJpYnV0ZXNbbmFtZV07XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gdHJ1ZSlcbiAgICAgICAgICAgIHN0ciArPSAnICcgKyBuYW1lO1xuICAgICAgICBlbHNlIGlmIChib29sZWFuX2F0dHJpYnV0ZXMuaGFzKG5hbWUudG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSlcbiAgICAgICAgICAgICAgICBzdHIgKz0gJyAnICsgbmFtZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWx1ZSAhPSBudWxsKSB7XG4gICAgICAgICAgICBzdHIgKz0gYCAke25hbWV9PVwiJHt2YWx1ZX1cImA7XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gc3RyO1xufVxuZnVuY3Rpb24gbWVyZ2Vfc3NyX3N0eWxlcyhzdHlsZV9hdHRyaWJ1dGUsIHN0eWxlX2RpcmVjdGl2ZSkge1xuICAgIGNvbnN0IHN0eWxlX29iamVjdCA9IHt9O1xuICAgIGZvciAoY29uc3QgaW5kaXZpZHVhbF9zdHlsZSBvZiBzdHlsZV9hdHRyaWJ1dGUuc3BsaXQoJzsnKSkge1xuICAgICAgICBjb25zdCBjb2xvbl9pbmRleCA9IGluZGl2aWR1YWxfc3R5bGUuaW5kZXhPZignOicpO1xuICAgICAgICBjb25zdCBuYW1lID0gaW5kaXZpZHVhbF9zdHlsZS5zbGljZSgwLCBjb2xvbl9pbmRleCkudHJpbSgpO1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGluZGl2aWR1YWxfc3R5bGUuc2xpY2UoY29sb25faW5kZXggKyAxKS50cmltKCk7XG4gICAgICAgIGlmICghbmFtZSlcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICBzdHlsZV9vYmplY3RbbmFtZV0gPSB2YWx1ZTtcbiAgICB9XG4gICAgZm9yIChjb25zdCBuYW1lIGluIHN0eWxlX2RpcmVjdGl2ZSkge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IHN0eWxlX2RpcmVjdGl2ZVtuYW1lXTtcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICBzdHlsZV9vYmplY3RbbmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGRlbGV0ZSBzdHlsZV9vYmplY3RbbmFtZV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHN0eWxlX29iamVjdDtcbn1cbmNvbnN0IGVzY2FwZWQgPSB7XG4gICAgJ1wiJzogJyZxdW90OycsXG4gICAgXCInXCI6ICcmIzM5OycsXG4gICAgJyYnOiAnJmFtcDsnLFxuICAgICc8JzogJyZsdDsnLFxuICAgICc+JzogJyZndDsnXG59O1xuZnVuY3Rpb24gZXNjYXBlKGh0bWwpIHtcbiAgICByZXR1cm4gU3RyaW5nKGh0bWwpLnJlcGxhY2UoL1tcIicmPD5dL2csIG1hdGNoID0+IGVzY2FwZWRbbWF0Y2hdKTtcbn1cbmZ1bmN0aW9uIGVzY2FwZV9hdHRyaWJ1dGVfdmFsdWUodmFsdWUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyA/IGVzY2FwZSh2YWx1ZSkgOiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIGVzY2FwZV9vYmplY3Qob2JqKSB7XG4gICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgZm9yIChjb25zdCBrZXkgaW4gb2JqKSB7XG4gICAgICAgIHJlc3VsdFtrZXldID0gZXNjYXBlX2F0dHJpYnV0ZV92YWx1ZShvYmpba2V5XSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBlYWNoKGl0ZW1zLCBmbikge1xuICAgIGxldCBzdHIgPSAnJztcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIHN0ciArPSBmbihpdGVtc1tpXSwgaSk7XG4gICAgfVxuICAgIHJldHVybiBzdHI7XG59XG5jb25zdCBtaXNzaW5nX2NvbXBvbmVudCA9IHtcbiAgICAkJHJlbmRlcjogKCkgPT4gJydcbn07XG5mdW5jdGlvbiB2YWxpZGF0ZV9jb21wb25lbnQoY29tcG9uZW50LCBuYW1lKSB7XG4gICAgaWYgKCFjb21wb25lbnQgfHwgIWNvbXBvbmVudC4kJHJlbmRlcikge1xuICAgICAgICBpZiAobmFtZSA9PT0gJ3N2ZWx0ZTpjb21wb25lbnQnKVxuICAgICAgICAgICAgbmFtZSArPSAnIHRoaXM9ey4uLn0nO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYDwke25hbWV9PiBpcyBub3QgYSB2YWxpZCBTU1IgY29tcG9uZW50LiBZb3UgbWF5IG5lZWQgdG8gcmV2aWV3IHlvdXIgYnVpbGQgY29uZmlnIHRvIGVuc3VyZSB0aGF0IGRlcGVuZGVuY2llcyBhcmUgY29tcGlsZWQsIHJhdGhlciB0aGFuIGltcG9ydGVkIGFzIHByZS1jb21waWxlZCBtb2R1bGVzYCk7XG4gICAgfVxuICAgIHJldHVybiBjb21wb25lbnQ7XG59XG5mdW5jdGlvbiBkZWJ1ZyhmaWxlLCBsaW5lLCBjb2x1bW4sIHZhbHVlcykge1xuICAgIGNvbnNvbGUubG9nKGB7QGRlYnVnfSAke2ZpbGUgPyBmaWxlICsgJyAnIDogJyd9KCR7bGluZX06JHtjb2x1bW59KWApOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgICBjb25zb2xlLmxvZyh2YWx1ZXMpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgICByZXR1cm4gJyc7XG59XG5sZXQgb25fZGVzdHJveTtcbmZ1bmN0aW9uIGNyZWF0ZV9zc3JfY29tcG9uZW50KGZuKSB7XG4gICAgZnVuY3Rpb24gJCRyZW5kZXIocmVzdWx0LCBwcm9wcywgYmluZGluZ3MsIHNsb3RzLCBjb250ZXh0KSB7XG4gICAgICAgIGNvbnN0IHBhcmVudF9jb21wb25lbnQgPSBjdXJyZW50X2NvbXBvbmVudDtcbiAgICAgICAgY29uc3QgJCQgPSB7XG4gICAgICAgICAgICBvbl9kZXN0cm95LFxuICAgICAgICAgICAgY29udGV4dDogbmV3IE1hcChjb250ZXh0IHx8IChwYXJlbnRfY29tcG9uZW50ID8gcGFyZW50X2NvbXBvbmVudC4kJC5jb250ZXh0IDogW10pKSxcbiAgICAgICAgICAgIC8vIHRoZXNlIHdpbGwgYmUgaW1tZWRpYXRlbHkgZGlzY2FyZGVkXG4gICAgICAgICAgICBvbl9tb3VudDogW10sXG4gICAgICAgICAgICBiZWZvcmVfdXBkYXRlOiBbXSxcbiAgICAgICAgICAgIGFmdGVyX3VwZGF0ZTogW10sXG4gICAgICAgICAgICBjYWxsYmFja3M6IGJsYW5rX29iamVjdCgpXG4gICAgICAgIH07XG4gICAgICAgIHNldF9jdXJyZW50X2NvbXBvbmVudCh7ICQkIH0pO1xuICAgICAgICBjb25zdCBodG1sID0gZm4ocmVzdWx0LCBwcm9wcywgYmluZGluZ3MsIHNsb3RzKTtcbiAgICAgICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KHBhcmVudF9jb21wb25lbnQpO1xuICAgICAgICByZXR1cm4gaHRtbDtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVuZGVyOiAocHJvcHMgPSB7fSwgeyAkJHNsb3RzID0ge30sIGNvbnRleHQgPSBuZXcgTWFwKCkgfSA9IHt9KSA9PiB7XG4gICAgICAgICAgICBvbl9kZXN0cm95ID0gW107XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSB7IHRpdGxlOiAnJywgaGVhZDogJycsIGNzczogbmV3IFNldCgpIH07XG4gICAgICAgICAgICBjb25zdCBodG1sID0gJCRyZW5kZXIocmVzdWx0LCBwcm9wcywge30sICQkc2xvdHMsIGNvbnRleHQpO1xuICAgICAgICAgICAgcnVuX2FsbChvbl9kZXN0cm95KTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaHRtbCxcbiAgICAgICAgICAgICAgICBjc3M6IHtcbiAgICAgICAgICAgICAgICAgICAgY29kZTogQXJyYXkuZnJvbShyZXN1bHQuY3NzKS5tYXAoY3NzID0+IGNzcy5jb2RlKS5qb2luKCdcXG4nKSxcbiAgICAgICAgICAgICAgICAgICAgbWFwOiBudWxsIC8vIFRPRE9cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGhlYWQ6IHJlc3VsdC50aXRsZSArIHJlc3VsdC5oZWFkXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICAkJHJlbmRlclxuICAgIH07XG59XG5mdW5jdGlvbiBhZGRfYXR0cmlidXRlKG5hbWUsIHZhbHVlLCBib29sZWFuKSB7XG4gICAgaWYgKHZhbHVlID09IG51bGwgfHwgKGJvb2xlYW4gJiYgIXZhbHVlKSlcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIGNvbnN0IGFzc2lnbm1lbnQgPSAoYm9vbGVhbiAmJiB2YWx1ZSA9PT0gdHJ1ZSkgPyAnJyA6IGA9XCIke2VzY2FwZV9hdHRyaWJ1dGVfdmFsdWUodmFsdWUudG9TdHJpbmcoKSl9XCJgO1xuICAgIHJldHVybiBgICR7bmFtZX0ke2Fzc2lnbm1lbnR9YDtcbn1cbmZ1bmN0aW9uIGFkZF9jbGFzc2VzKGNsYXNzZXMpIHtcbiAgICByZXR1cm4gY2xhc3NlcyA/IGAgY2xhc3M9XCIke2NsYXNzZXN9XCJgIDogJyc7XG59XG5mdW5jdGlvbiBzdHlsZV9vYmplY3RfdG9fc3RyaW5nKHN0eWxlX29iamVjdCkge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhzdHlsZV9vYmplY3QpXG4gICAgICAgIC5maWx0ZXIoa2V5ID0+IHN0eWxlX29iamVjdFtrZXldKVxuICAgICAgICAubWFwKGtleSA9PiBgJHtrZXl9OiAke3N0eWxlX29iamVjdFtrZXldfTtgKVxuICAgICAgICAuam9pbignICcpO1xufVxuZnVuY3Rpb24gYWRkX3N0eWxlcyhzdHlsZV9vYmplY3QpIHtcbiAgICBjb25zdCBzdHlsZXMgPSBzdHlsZV9vYmplY3RfdG9fc3RyaW5nKHN0eWxlX29iamVjdCk7XG4gICAgcmV0dXJuIHN0eWxlcyA/IGAgc3R5bGU9XCIke3N0eWxlc31cImAgOiAnJztcbn1cblxuZnVuY3Rpb24gYmluZChjb21wb25lbnQsIG5hbWUsIGNhbGxiYWNrKSB7XG4gICAgY29uc3QgaW5kZXggPSBjb21wb25lbnQuJCQucHJvcHNbbmFtZV07XG4gICAgaWYgKGluZGV4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY29tcG9uZW50LiQkLmJvdW5kW2luZGV4XSA9IGNhbGxiYWNrO1xuICAgICAgICBjYWxsYmFjayhjb21wb25lbnQuJCQuY3R4W2luZGV4XSk7XG4gICAgfVxufVxuZnVuY3Rpb24gY3JlYXRlX2NvbXBvbmVudChibG9jaykge1xuICAgIGJsb2NrICYmIGJsb2NrLmMoKTtcbn1cbmZ1bmN0aW9uIGNsYWltX2NvbXBvbmVudChibG9jaywgcGFyZW50X25vZGVzKSB7XG4gICAgYmxvY2sgJiYgYmxvY2subChwYXJlbnRfbm9kZXMpO1xufVxuZnVuY3Rpb24gbW91bnRfY29tcG9uZW50KGNvbXBvbmVudCwgdGFyZ2V0LCBhbmNob3IsIGN1c3RvbUVsZW1lbnQpIHtcbiAgICBjb25zdCB7IGZyYWdtZW50LCBvbl9tb3VudCwgb25fZGVzdHJveSwgYWZ0ZXJfdXBkYXRlIH0gPSBjb21wb25lbnQuJCQ7XG4gICAgZnJhZ21lbnQgJiYgZnJhZ21lbnQubSh0YXJnZXQsIGFuY2hvcik7XG4gICAgaWYgKCFjdXN0b21FbGVtZW50KSB7XG4gICAgICAgIC8vIG9uTW91bnQgaGFwcGVucyBiZWZvcmUgdGhlIGluaXRpYWwgYWZ0ZXJVcGRhdGVcbiAgICAgICAgYWRkX3JlbmRlcl9jYWxsYmFjaygoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuZXdfb25fZGVzdHJveSA9IG9uX21vdW50Lm1hcChydW4pLmZpbHRlcihpc19mdW5jdGlvbik7XG4gICAgICAgICAgICBpZiAob25fZGVzdHJveSkge1xuICAgICAgICAgICAgICAgIG9uX2Rlc3Ryb3kucHVzaCguLi5uZXdfb25fZGVzdHJveSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBFZGdlIGNhc2UgLSBjb21wb25lbnQgd2FzIGRlc3Ryb3llZCBpbW1lZGlhdGVseSxcbiAgICAgICAgICAgICAgICAvLyBtb3N0IGxpa2VseSBhcyBhIHJlc3VsdCBvZiBhIGJpbmRpbmcgaW5pdGlhbGlzaW5nXG4gICAgICAgICAgICAgICAgcnVuX2FsbChuZXdfb25fZGVzdHJveSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb21wb25lbnQuJCQub25fbW91bnQgPSBbXTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGFmdGVyX3VwZGF0ZS5mb3JFYWNoKGFkZF9yZW5kZXJfY2FsbGJhY2spO1xufVxuZnVuY3Rpb24gZGVzdHJveV9jb21wb25lbnQoY29tcG9uZW50LCBkZXRhY2hpbmcpIHtcbiAgICBjb25zdCAkJCA9IGNvbXBvbmVudC4kJDtcbiAgICBpZiAoJCQuZnJhZ21lbnQgIT09IG51bGwpIHtcbiAgICAgICAgcnVuX2FsbCgkJC5vbl9kZXN0cm95KTtcbiAgICAgICAgJCQuZnJhZ21lbnQgJiYgJCQuZnJhZ21lbnQuZChkZXRhY2hpbmcpO1xuICAgICAgICAvLyBUT0RPIG51bGwgb3V0IG90aGVyIHJlZnMsIGluY2x1ZGluZyBjb21wb25lbnQuJCQgKGJ1dCBuZWVkIHRvXG4gICAgICAgIC8vIHByZXNlcnZlIGZpbmFsIHN0YXRlPylcbiAgICAgICAgJCQub25fZGVzdHJveSA9ICQkLmZyYWdtZW50ID0gbnVsbDtcbiAgICAgICAgJCQuY3R4ID0gW107XG4gICAgfVxufVxuZnVuY3Rpb24gbWFrZV9kaXJ0eShjb21wb25lbnQsIGkpIHtcbiAgICBpZiAoY29tcG9uZW50LiQkLmRpcnR5WzBdID09PSAtMSkge1xuICAgICAgICBkaXJ0eV9jb21wb25lbnRzLnB1c2goY29tcG9uZW50KTtcbiAgICAgICAgc2NoZWR1bGVfdXBkYXRlKCk7XG4gICAgICAgIGNvbXBvbmVudC4kJC5kaXJ0eS5maWxsKDApO1xuICAgIH1cbiAgICBjb21wb25lbnQuJCQuZGlydHlbKGkgLyAzMSkgfCAwXSB8PSAoMSA8PCAoaSAlIDMxKSk7XG59XG5mdW5jdGlvbiBpbml0KGNvbXBvbmVudCwgb3B0aW9ucywgaW5zdGFuY2UsIGNyZWF0ZV9mcmFnbWVudCwgbm90X2VxdWFsLCBwcm9wcywgYXBwZW5kX3N0eWxlcywgZGlydHkgPSBbLTFdKSB7XG4gICAgY29uc3QgcGFyZW50X2NvbXBvbmVudCA9IGN1cnJlbnRfY29tcG9uZW50O1xuICAgIHNldF9jdXJyZW50X2NvbXBvbmVudChjb21wb25lbnQpO1xuICAgIGNvbnN0ICQkID0gY29tcG9uZW50LiQkID0ge1xuICAgICAgICBmcmFnbWVudDogbnVsbCxcbiAgICAgICAgY3R4OiBudWxsLFxuICAgICAgICAvLyBzdGF0ZVxuICAgICAgICBwcm9wcyxcbiAgICAgICAgdXBkYXRlOiBub29wLFxuICAgICAgICBub3RfZXF1YWwsXG4gICAgICAgIGJvdW5kOiBibGFua19vYmplY3QoKSxcbiAgICAgICAgLy8gbGlmZWN5Y2xlXG4gICAgICAgIG9uX21vdW50OiBbXSxcbiAgICAgICAgb25fZGVzdHJveTogW10sXG4gICAgICAgIG9uX2Rpc2Nvbm5lY3Q6IFtdLFxuICAgICAgICBiZWZvcmVfdXBkYXRlOiBbXSxcbiAgICAgICAgYWZ0ZXJfdXBkYXRlOiBbXSxcbiAgICAgICAgY29udGV4dDogbmV3IE1hcChvcHRpb25zLmNvbnRleHQgfHwgKHBhcmVudF9jb21wb25lbnQgPyBwYXJlbnRfY29tcG9uZW50LiQkLmNvbnRleHQgOiBbXSkpLFxuICAgICAgICAvLyBldmVyeXRoaW5nIGVsc2VcbiAgICAgICAgY2FsbGJhY2tzOiBibGFua19vYmplY3QoKSxcbiAgICAgICAgZGlydHksXG4gICAgICAgIHNraXBfYm91bmQ6IGZhbHNlLFxuICAgICAgICByb290OiBvcHRpb25zLnRhcmdldCB8fCBwYXJlbnRfY29tcG9uZW50LiQkLnJvb3RcbiAgICB9O1xuICAgIGFwcGVuZF9zdHlsZXMgJiYgYXBwZW5kX3N0eWxlcygkJC5yb290KTtcbiAgICBsZXQgcmVhZHkgPSBmYWxzZTtcbiAgICAkJC5jdHggPSBpbnN0YW5jZVxuICAgICAgICA/IGluc3RhbmNlKGNvbXBvbmVudCwgb3B0aW9ucy5wcm9wcyB8fCB7fSwgKGksIHJldCwgLi4ucmVzdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSByZXN0Lmxlbmd0aCA/IHJlc3RbMF0gOiByZXQ7XG4gICAgICAgICAgICBpZiAoJCQuY3R4ICYmIG5vdF9lcXVhbCgkJC5jdHhbaV0sICQkLmN0eFtpXSA9IHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIGlmICghJCQuc2tpcF9ib3VuZCAmJiAkJC5ib3VuZFtpXSlcbiAgICAgICAgICAgICAgICAgICAgJCQuYm91bmRbaV0odmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmIChyZWFkeSlcbiAgICAgICAgICAgICAgICAgICAgbWFrZV9kaXJ0eShjb21wb25lbnQsIGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgfSlcbiAgICAgICAgOiBbXTtcbiAgICAkJC51cGRhdGUoKTtcbiAgICByZWFkeSA9IHRydWU7XG4gICAgcnVuX2FsbCgkJC5iZWZvcmVfdXBkYXRlKTtcbiAgICAvLyBgZmFsc2VgIGFzIGEgc3BlY2lhbCBjYXNlIG9mIG5vIERPTSBjb21wb25lbnRcbiAgICAkJC5mcmFnbWVudCA9IGNyZWF0ZV9mcmFnbWVudCA/IGNyZWF0ZV9mcmFnbWVudCgkJC5jdHgpIDogZmFsc2U7XG4gICAgaWYgKG9wdGlvbnMudGFyZ2V0KSB7XG4gICAgICAgIGlmIChvcHRpb25zLmh5ZHJhdGUpIHtcbiAgICAgICAgICAgIHN0YXJ0X2h5ZHJhdGluZygpO1xuICAgICAgICAgICAgY29uc3Qgbm9kZXMgPSBjaGlsZHJlbihvcHRpb25zLnRhcmdldCk7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLW5vbi1udWxsLWFzc2VydGlvblxuICAgICAgICAgICAgJCQuZnJhZ21lbnQgJiYgJCQuZnJhZ21lbnQubChub2Rlcyk7XG4gICAgICAgICAgICBub2Rlcy5mb3JFYWNoKGRldGFjaCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLW5vbi1udWxsLWFzc2VydGlvblxuICAgICAgICAgICAgJCQuZnJhZ21lbnQgJiYgJCQuZnJhZ21lbnQuYygpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcHRpb25zLmludHJvKVxuICAgICAgICAgICAgdHJhbnNpdGlvbl9pbihjb21wb25lbnQuJCQuZnJhZ21lbnQpO1xuICAgICAgICBtb3VudF9jb21wb25lbnQoY29tcG9uZW50LCBvcHRpb25zLnRhcmdldCwgb3B0aW9ucy5hbmNob3IsIG9wdGlvbnMuY3VzdG9tRWxlbWVudCk7XG4gICAgICAgIGVuZF9oeWRyYXRpbmcoKTtcbiAgICAgICAgZmx1c2goKTtcbiAgICB9XG4gICAgc2V0X2N1cnJlbnRfY29tcG9uZW50KHBhcmVudF9jb21wb25lbnQpO1xufVxubGV0IFN2ZWx0ZUVsZW1lbnQ7XG5pZiAodHlwZW9mIEhUTUxFbGVtZW50ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgU3ZlbHRlRWxlbWVudCA9IGNsYXNzIGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuICAgICAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgICAgIHN1cGVyKCk7XG4gICAgICAgICAgICB0aGlzLmF0dGFjaFNoYWRvdyh7IG1vZGU6ICdvcGVuJyB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgb25fbW91bnQgfSA9IHRoaXMuJCQ7XG4gICAgICAgICAgICB0aGlzLiQkLm9uX2Rpc2Nvbm5lY3QgPSBvbl9tb3VudC5tYXAocnVuKS5maWx0ZXIoaXNfZnVuY3Rpb24pO1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZSB0b2RvOiBpbXByb3ZlIHR5cGluZ3NcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMuJCQuc2xvdHRlZCkge1xuICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgdG9kbzogaW1wcm92ZSB0eXBpbmdzXG4gICAgICAgICAgICAgICAgdGhpcy5hcHBlbmRDaGlsZCh0aGlzLiQkLnNsb3R0ZWRba2V5XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYXR0cmlidXRlQ2hhbmdlZENhbGxiYWNrKGF0dHIsIF9vbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXNbYXR0cl0gPSBuZXdWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICAgICAgICAgIHJ1bl9hbGwodGhpcy4kJC5vbl9kaXNjb25uZWN0KTtcbiAgICAgICAgfVxuICAgICAgICAkZGVzdHJveSgpIHtcbiAgICAgICAgICAgIGRlc3Ryb3lfY29tcG9uZW50KHRoaXMsIDEpO1xuICAgICAgICAgICAgdGhpcy4kZGVzdHJveSA9IG5vb3A7XG4gICAgICAgIH1cbiAgICAgICAgJG9uKHR5cGUsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAvLyBUT0RPIHNob3VsZCB0aGlzIGRlbGVnYXRlIHRvIGFkZEV2ZW50TGlzdGVuZXI/XG4gICAgICAgICAgICBjb25zdCBjYWxsYmFja3MgPSAodGhpcy4kJC5jYWxsYmFja3NbdHlwZV0gfHwgKHRoaXMuJCQuY2FsbGJhY2tzW3R5cGVdID0gW10pKTtcbiAgICAgICAgICAgIGNhbGxiYWNrcy5wdXNoKGNhbGxiYWNrKTtcbiAgICAgICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSBjYWxsYmFja3MuaW5kZXhPZihjYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ICE9PSAtMSlcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2tzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgICRzZXQoJCRwcm9wcykge1xuICAgICAgICAgICAgaWYgKHRoaXMuJCRzZXQgJiYgIWlzX2VtcHR5KCQkcHJvcHMpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy4kJC5za2lwX2JvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLiQkc2V0KCQkcHJvcHMpO1xuICAgICAgICAgICAgICAgIHRoaXMuJCQuc2tpcF9ib3VuZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbn1cbi8qKlxuICogQmFzZSBjbGFzcyBmb3IgU3ZlbHRlIGNvbXBvbmVudHMuIFVzZWQgd2hlbiBkZXY9ZmFsc2UuXG4gKi9cbmNsYXNzIFN2ZWx0ZUNvbXBvbmVudCB7XG4gICAgJGRlc3Ryb3koKSB7XG4gICAgICAgIGRlc3Ryb3lfY29tcG9uZW50KHRoaXMsIDEpO1xuICAgICAgICB0aGlzLiRkZXN0cm95ID0gbm9vcDtcbiAgICB9XG4gICAgJG9uKHR5cGUsIGNhbGxiYWNrKSB7XG4gICAgICAgIGNvbnN0IGNhbGxiYWNrcyA9ICh0aGlzLiQkLmNhbGxiYWNrc1t0eXBlXSB8fCAodGhpcy4kJC5jYWxsYmFja3NbdHlwZV0gPSBbXSkpO1xuICAgICAgICBjYWxsYmFja3MucHVzaChjYWxsYmFjayk7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IGNhbGxiYWNrcy5pbmRleE9mKGNhbGxiYWNrKTtcbiAgICAgICAgICAgIGlmIChpbmRleCAhPT0gLTEpXG4gICAgICAgICAgICAgICAgY2FsbGJhY2tzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH07XG4gICAgfVxuICAgICRzZXQoJCRwcm9wcykge1xuICAgICAgICBpZiAodGhpcy4kJHNldCAmJiAhaXNfZW1wdHkoJCRwcm9wcykpIHtcbiAgICAgICAgICAgIHRoaXMuJCQuc2tpcF9ib3VuZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLiQkc2V0KCQkcHJvcHMpO1xuICAgICAgICAgICAgdGhpcy4kJC5za2lwX2JvdW5kID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRpc3BhdGNoX2Rldih0eXBlLCBkZXRhaWwpIHtcbiAgICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KGN1c3RvbV9ldmVudCh0eXBlLCBPYmplY3QuYXNzaWduKHsgdmVyc2lvbjogJzMuNDguMCcgfSwgZGV0YWlsKSwgeyBidWJibGVzOiB0cnVlIH0pKTtcbn1cbmZ1bmN0aW9uIGFwcGVuZF9kZXYodGFyZ2V0LCBub2RlKSB7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01JbnNlcnQnLCB7IHRhcmdldCwgbm9kZSB9KTtcbiAgICBhcHBlbmQodGFyZ2V0LCBub2RlKTtcbn1cbmZ1bmN0aW9uIGFwcGVuZF9oeWRyYXRpb25fZGV2KHRhcmdldCwgbm9kZSkge1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NSW5zZXJ0JywgeyB0YXJnZXQsIG5vZGUgfSk7XG4gICAgYXBwZW5kX2h5ZHJhdGlvbih0YXJnZXQsIG5vZGUpO1xufVxuZnVuY3Rpb24gaW5zZXJ0X2Rldih0YXJnZXQsIG5vZGUsIGFuY2hvcikge1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NSW5zZXJ0JywgeyB0YXJnZXQsIG5vZGUsIGFuY2hvciB9KTtcbiAgICBpbnNlcnQodGFyZ2V0LCBub2RlLCBhbmNob3IpO1xufVxuZnVuY3Rpb24gaW5zZXJ0X2h5ZHJhdGlvbl9kZXYodGFyZ2V0LCBub2RlLCBhbmNob3IpIHtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTUluc2VydCcsIHsgdGFyZ2V0LCBub2RlLCBhbmNob3IgfSk7XG4gICAgaW5zZXJ0X2h5ZHJhdGlvbih0YXJnZXQsIG5vZGUsIGFuY2hvcik7XG59XG5mdW5jdGlvbiBkZXRhY2hfZGV2KG5vZGUpIHtcbiAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTVJlbW92ZScsIHsgbm9kZSB9KTtcbiAgICBkZXRhY2gobm9kZSk7XG59XG5mdW5jdGlvbiBkZXRhY2hfYmV0d2Vlbl9kZXYoYmVmb3JlLCBhZnRlcikge1xuICAgIHdoaWxlIChiZWZvcmUubmV4dFNpYmxpbmcgJiYgYmVmb3JlLm5leHRTaWJsaW5nICE9PSBhZnRlcikge1xuICAgICAgICBkZXRhY2hfZGV2KGJlZm9yZS5uZXh0U2libGluZyk7XG4gICAgfVxufVxuZnVuY3Rpb24gZGV0YWNoX2JlZm9yZV9kZXYoYWZ0ZXIpIHtcbiAgICB3aGlsZSAoYWZ0ZXIucHJldmlvdXNTaWJsaW5nKSB7XG4gICAgICAgIGRldGFjaF9kZXYoYWZ0ZXIucHJldmlvdXNTaWJsaW5nKTtcbiAgICB9XG59XG5mdW5jdGlvbiBkZXRhY2hfYWZ0ZXJfZGV2KGJlZm9yZSkge1xuICAgIHdoaWxlIChiZWZvcmUubmV4dFNpYmxpbmcpIHtcbiAgICAgICAgZGV0YWNoX2RldihiZWZvcmUubmV4dFNpYmxpbmcpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGxpc3Rlbl9kZXYobm9kZSwgZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMsIGhhc19wcmV2ZW50X2RlZmF1bHQsIGhhc19zdG9wX3Byb3BhZ2F0aW9uKSB7XG4gICAgY29uc3QgbW9kaWZpZXJzID0gb3B0aW9ucyA9PT0gdHJ1ZSA/IFsnY2FwdHVyZSddIDogb3B0aW9ucyA/IEFycmF5LmZyb20oT2JqZWN0LmtleXMob3B0aW9ucykpIDogW107XG4gICAgaWYgKGhhc19wcmV2ZW50X2RlZmF1bHQpXG4gICAgICAgIG1vZGlmaWVycy5wdXNoKCdwcmV2ZW50RGVmYXVsdCcpO1xuICAgIGlmIChoYXNfc3RvcF9wcm9wYWdhdGlvbilcbiAgICAgICAgbW9kaWZpZXJzLnB1c2goJ3N0b3BQcm9wYWdhdGlvbicpO1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NQWRkRXZlbnRMaXN0ZW5lcicsIHsgbm9kZSwgZXZlbnQsIGhhbmRsZXIsIG1vZGlmaWVycyB9KTtcbiAgICBjb25zdCBkaXNwb3NlID0gbGlzdGVuKG5vZGUsIGV2ZW50LCBoYW5kbGVyLCBvcHRpb25zKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTVJlbW92ZUV2ZW50TGlzdGVuZXInLCB7IG5vZGUsIGV2ZW50LCBoYW5kbGVyLCBtb2RpZmllcnMgfSk7XG4gICAgICAgIGRpc3Bvc2UoKTtcbiAgICB9O1xufVxuZnVuY3Rpb24gYXR0cl9kZXYobm9kZSwgYXR0cmlidXRlLCB2YWx1ZSkge1xuICAgIGF0dHIobm9kZSwgYXR0cmlidXRlLCB2YWx1ZSk7XG4gICAgaWYgKHZhbHVlID09IG51bGwpXG4gICAgICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NUmVtb3ZlQXR0cmlidXRlJywgeyBub2RlLCBhdHRyaWJ1dGUgfSk7XG4gICAgZWxzZVxuICAgICAgICBkaXNwYXRjaF9kZXYoJ1N2ZWx0ZURPTVNldEF0dHJpYnV0ZScsIHsgbm9kZSwgYXR0cmlidXRlLCB2YWx1ZSB9KTtcbn1cbmZ1bmN0aW9uIHByb3BfZGV2KG5vZGUsIHByb3BlcnR5LCB2YWx1ZSkge1xuICAgIG5vZGVbcHJvcGVydHldID0gdmFsdWU7XG4gICAgZGlzcGF0Y2hfZGV2KCdTdmVsdGVET01TZXRQcm9wZXJ0eScsIHsgbm9kZSwgcHJvcGVydHksIHZhbHVlIH0pO1xufVxuZnVuY3Rpb24gZGF0YXNldF9kZXYobm9kZSwgcHJvcGVydHksIHZhbHVlKSB7XG4gICAgbm9kZS5kYXRhc2V0W3Byb3BlcnR5XSA9IHZhbHVlO1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NU2V0RGF0YXNldCcsIHsgbm9kZSwgcHJvcGVydHksIHZhbHVlIH0pO1xufVxuZnVuY3Rpb24gc2V0X2RhdGFfZGV2KHRleHQsIGRhdGEpIHtcbiAgICBkYXRhID0gJycgKyBkYXRhO1xuICAgIGlmICh0ZXh0Lndob2xlVGV4dCA9PT0gZGF0YSlcbiAgICAgICAgcmV0dXJuO1xuICAgIGRpc3BhdGNoX2RldignU3ZlbHRlRE9NU2V0RGF0YScsIHsgbm9kZTogdGV4dCwgZGF0YSB9KTtcbiAgICB0ZXh0LmRhdGEgPSBkYXRhO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVfZWFjaF9hcmd1bWVudChhcmcpIHtcbiAgICBpZiAodHlwZW9mIGFyZyAhPT0gJ3N0cmluZycgJiYgIShhcmcgJiYgdHlwZW9mIGFyZyA9PT0gJ29iamVjdCcgJiYgJ2xlbmd0aCcgaW4gYXJnKSkge1xuICAgICAgICBsZXQgbXNnID0gJ3sjZWFjaH0gb25seSBpdGVyYXRlcyBvdmVyIGFycmF5LWxpa2Ugb2JqZWN0cy4nO1xuICAgICAgICBpZiAodHlwZW9mIFN5bWJvbCA9PT0gJ2Z1bmN0aW9uJyAmJiBhcmcgJiYgU3ltYm9sLml0ZXJhdG9yIGluIGFyZykge1xuICAgICAgICAgICAgbXNnICs9ICcgWW91IGNhbiB1c2UgYSBzcHJlYWQgdG8gY29udmVydCB0aGlzIGl0ZXJhYmxlIGludG8gYW4gYXJyYXkuJztcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IobXNnKTtcbiAgICB9XG59XG5mdW5jdGlvbiB2YWxpZGF0ZV9zbG90cyhuYW1lLCBzbG90LCBrZXlzKSB7XG4gICAgZm9yIChjb25zdCBzbG90X2tleSBvZiBPYmplY3Qua2V5cyhzbG90KSkge1xuICAgICAgICBpZiAoIX5rZXlzLmluZGV4T2Yoc2xvdF9rZXkpKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYDwke25hbWV9PiByZWNlaXZlZCBhbiB1bmV4cGVjdGVkIHNsb3QgXCIke3Nsb3Rfa2V5fVwiLmApO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gdmFsaWRhdGVfZHluYW1pY19lbGVtZW50KHRhZykge1xuICAgIGNvbnN0IGlzX3N0cmluZyA9IHR5cGVvZiB0YWcgPT09ICdzdHJpbmcnO1xuICAgIGlmICh0YWcgJiYgIWlzX3N0cmluZykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJzxzdmVsdGU6ZWxlbWVudD4gZXhwZWN0cyBcInRoaXNcIiBhdHRyaWJ1dGUgdG8gYmUgYSBzdHJpbmcuJyk7XG4gICAgfVxufVxuZnVuY3Rpb24gdmFsaWRhdGVfdm9pZF9keW5hbWljX2VsZW1lbnQodGFnKSB7XG4gICAgaWYgKHRhZyAmJiBpc192b2lkKHRhZykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGA8c3ZlbHRlOmVsZW1lbnQgdGhpcz1cIiR7dGFnfVwiPiBpcyBzZWxmLWNsb3NpbmcgYW5kIGNhbm5vdCBoYXZlIGNvbnRlbnQuYCk7XG4gICAgfVxufVxuLyoqXG4gKiBCYXNlIGNsYXNzIGZvciBTdmVsdGUgY29tcG9uZW50cyB3aXRoIHNvbWUgbWlub3IgZGV2LWVuaGFuY2VtZW50cy4gVXNlZCB3aGVuIGRldj10cnVlLlxuICovXG5jbGFzcyBTdmVsdGVDb21wb25lbnREZXYgZXh0ZW5kcyBTdmVsdGVDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICAgICAgaWYgKCFvcHRpb25zIHx8ICghb3B0aW9ucy50YXJnZXQgJiYgIW9wdGlvbnMuJCRpbmxpbmUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCIndGFyZ2V0JyBpcyBhIHJlcXVpcmVkIG9wdGlvblwiKTtcbiAgICAgICAgfVxuICAgICAgICBzdXBlcigpO1xuICAgIH1cbiAgICAkZGVzdHJveSgpIHtcbiAgICAgICAgc3VwZXIuJGRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy4kZGVzdHJveSA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignQ29tcG9uZW50IHdhcyBhbHJlYWR5IGRlc3Ryb3llZCcpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgfTtcbiAgICB9XG4gICAgJGNhcHR1cmVfc3RhdGUoKSB7IH1cbiAgICAkaW5qZWN0X3N0YXRlKCkgeyB9XG59XG4vKipcbiAqIEJhc2UgY2xhc3MgdG8gY3JlYXRlIHN0cm9uZ2x5IHR5cGVkIFN2ZWx0ZSBjb21wb25lbnRzLlxuICogVGhpcyBvbmx5IGV4aXN0cyBmb3IgdHlwaW5nIHB1cnBvc2VzIGFuZCBzaG91bGQgYmUgdXNlZCBpbiBgLmQudHNgIGZpbGVzLlxuICpcbiAqICMjIyBFeGFtcGxlOlxuICpcbiAqIFlvdSBoYXZlIGNvbXBvbmVudCBsaWJyYXJ5IG9uIG5wbSBjYWxsZWQgYGNvbXBvbmVudC1saWJyYXJ5YCwgZnJvbSB3aGljaFxuICogeW91IGV4cG9ydCBhIGNvbXBvbmVudCBjYWxsZWQgYE15Q29tcG9uZW50YC4gRm9yIFN2ZWx0ZStUeXBlU2NyaXB0IHVzZXJzLFxuICogeW91IHdhbnQgdG8gcHJvdmlkZSB0eXBpbmdzLiBUaGVyZWZvcmUgeW91IGNyZWF0ZSBhIGBpbmRleC5kLnRzYDpcbiAqIGBgYHRzXG4gKiBpbXBvcnQgeyBTdmVsdGVDb21wb25lbnRUeXBlZCB9IGZyb20gXCJzdmVsdGVcIjtcbiAqIGV4cG9ydCBjbGFzcyBNeUNvbXBvbmVudCBleHRlbmRzIFN2ZWx0ZUNvbXBvbmVudFR5cGVkPHtmb286IHN0cmluZ30+IHt9XG4gKiBgYGBcbiAqIFR5cGluZyB0aGlzIG1ha2VzIGl0IHBvc3NpYmxlIGZvciBJREVzIGxpa2UgVlMgQ29kZSB3aXRoIHRoZSBTdmVsdGUgZXh0ZW5zaW9uXG4gKiB0byBwcm92aWRlIGludGVsbGlzZW5zZSBhbmQgdG8gdXNlIHRoZSBjb21wb25lbnQgbGlrZSB0aGlzIGluIGEgU3ZlbHRlIGZpbGVcbiAqIHdpdGggVHlwZVNjcmlwdDpcbiAqIGBgYHN2ZWx0ZVxuICogPHNjcmlwdCBsYW5nPVwidHNcIj5cbiAqIFx0aW1wb3J0IHsgTXlDb21wb25lbnQgfSBmcm9tIFwiY29tcG9uZW50LWxpYnJhcnlcIjtcbiAqIDwvc2NyaXB0PlxuICogPE15Q29tcG9uZW50IGZvbz17J2Jhcid9IC8+XG4gKiBgYGBcbiAqXG4gKiAjIyMjIFdoeSBub3QgbWFrZSB0aGlzIHBhcnQgb2YgYFN2ZWx0ZUNvbXBvbmVudChEZXYpYD9cbiAqIEJlY2F1c2VcbiAqIGBgYHRzXG4gKiBjbGFzcyBBU3ViY2xhc3NPZlN2ZWx0ZUNvbXBvbmVudCBleHRlbmRzIFN2ZWx0ZUNvbXBvbmVudDx7Zm9vOiBzdHJpbmd9PiB7fVxuICogY29uc3QgY29tcG9uZW50OiB0eXBlb2YgU3ZlbHRlQ29tcG9uZW50ID0gQVN1YmNsYXNzT2ZTdmVsdGVDb21wb25lbnQ7XG4gKiBgYGBcbiAqIHdpbGwgdGhyb3cgYSB0eXBlIGVycm9yLCBzbyB3ZSBuZWVkIHRvIHNlcGFyYXRlIHRoZSBtb3JlIHN0cmljdGx5IHR5cGVkIGNsYXNzLlxuICovXG5jbGFzcyBTdmVsdGVDb21wb25lbnRUeXBlZCBleHRlbmRzIFN2ZWx0ZUNvbXBvbmVudERldiB7XG4gICAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgICAgICBzdXBlcihvcHRpb25zKTtcbiAgICB9XG59XG5mdW5jdGlvbiBsb29wX2d1YXJkKHRpbWVvdXQpIHtcbiAgICBjb25zdCBzdGFydCA9IERhdGUubm93KCk7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgaWYgKERhdGUubm93KCkgLSBzdGFydCA+IHRpbWVvdXQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW5maW5pdGUgbG9vcCBkZXRlY3RlZCcpO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuZXhwb3J0IHsgSHRtbFRhZywgSHRtbFRhZ0h5ZHJhdGlvbiwgU3ZlbHRlQ29tcG9uZW50LCBTdmVsdGVDb21wb25lbnREZXYsIFN2ZWx0ZUNvbXBvbmVudFR5cGVkLCBTdmVsdGVFbGVtZW50LCBhY3Rpb25fZGVzdHJveWVyLCBhZGRfYXR0cmlidXRlLCBhZGRfY2xhc3NlcywgYWRkX2ZsdXNoX2NhbGxiYWNrLCBhZGRfbG9jYXRpb24sIGFkZF9yZW5kZXJfY2FsbGJhY2ssIGFkZF9yZXNpemVfbGlzdGVuZXIsIGFkZF9zdHlsZXMsIGFkZF90cmFuc2Zvcm0sIGFmdGVyVXBkYXRlLCBhcHBlbmQsIGFwcGVuZF9kZXYsIGFwcGVuZF9lbXB0eV9zdHlsZXNoZWV0LCBhcHBlbmRfaHlkcmF0aW9uLCBhcHBlbmRfaHlkcmF0aW9uX2RldiwgYXBwZW5kX3N0eWxlcywgYXNzaWduLCBhdHRyLCBhdHRyX2RldiwgYXR0cmlidXRlX3RvX29iamVjdCwgYmVmb3JlVXBkYXRlLCBiaW5kLCBiaW5kaW5nX2NhbGxiYWNrcywgYmxhbmtfb2JqZWN0LCBidWJibGUsIGNoZWNrX291dHJvcywgY2hpbGRyZW4sIGNsYWltX2NvbXBvbmVudCwgY2xhaW1fZWxlbWVudCwgY2xhaW1faHRtbF90YWcsIGNsYWltX3NwYWNlLCBjbGFpbV9zdmdfZWxlbWVudCwgY2xhaW1fdGV4dCwgY2xlYXJfbG9vcHMsIGNvbXBvbmVudF9zdWJzY3JpYmUsIGNvbXB1dGVfcmVzdF9wcm9wcywgY29tcHV0ZV9zbG90cywgY3JlYXRlRXZlbnREaXNwYXRjaGVyLCBjcmVhdGVfYW5pbWF0aW9uLCBjcmVhdGVfYmlkaXJlY3Rpb25hbF90cmFuc2l0aW9uLCBjcmVhdGVfY29tcG9uZW50LCBjcmVhdGVfaW5fdHJhbnNpdGlvbiwgY3JlYXRlX291dF90cmFuc2l0aW9uLCBjcmVhdGVfc2xvdCwgY3JlYXRlX3Nzcl9jb21wb25lbnQsIGN1cnJlbnRfY29tcG9uZW50LCBjdXN0b21fZXZlbnQsIGRhdGFzZXRfZGV2LCBkZWJ1ZywgZGVzdHJveV9ibG9jaywgZGVzdHJveV9jb21wb25lbnQsIGRlc3Ryb3lfZWFjaCwgZGV0YWNoLCBkZXRhY2hfYWZ0ZXJfZGV2LCBkZXRhY2hfYmVmb3JlX2RldiwgZGV0YWNoX2JldHdlZW5fZGV2LCBkZXRhY2hfZGV2LCBkaXJ0eV9jb21wb25lbnRzLCBkaXNwYXRjaF9kZXYsIGVhY2gsIGVsZW1lbnQsIGVsZW1lbnRfaXMsIGVtcHR5LCBlbmRfaHlkcmF0aW5nLCBlc2NhcGUsIGVzY2FwZV9hdHRyaWJ1dGVfdmFsdWUsIGVzY2FwZV9vYmplY3QsIGVzY2FwZWQsIGV4Y2x1ZGVfaW50ZXJuYWxfcHJvcHMsIGZpeF9hbmRfZGVzdHJveV9ibG9jaywgZml4X2FuZF9vdXRyb19hbmRfZGVzdHJveV9ibG9jaywgZml4X3Bvc2l0aW9uLCBmbHVzaCwgZ2V0QWxsQ29udGV4dHMsIGdldENvbnRleHQsIGdldF9hbGxfZGlydHlfZnJvbV9zY29wZSwgZ2V0X2JpbmRpbmdfZ3JvdXBfdmFsdWUsIGdldF9jdXJyZW50X2NvbXBvbmVudCwgZ2V0X2N1c3RvbV9lbGVtZW50c19zbG90cywgZ2V0X3Jvb3RfZm9yX3N0eWxlLCBnZXRfc2xvdF9jaGFuZ2VzLCBnZXRfc3ByZWFkX29iamVjdCwgZ2V0X3NwcmVhZF91cGRhdGUsIGdldF9zdG9yZV92YWx1ZSwgZ2xvYmFscywgZ3JvdXBfb3V0cm9zLCBoYW5kbGVfcHJvbWlzZSwgaGFzQ29udGV4dCwgaGFzX3Byb3AsIGlkZW50aXR5LCBpbml0LCBpbnNlcnQsIGluc2VydF9kZXYsIGluc2VydF9oeWRyYXRpb24sIGluc2VydF9oeWRyYXRpb25fZGV2LCBpbnRyb3MsIGludmFsaWRfYXR0cmlidXRlX25hbWVfY2hhcmFjdGVyLCBpc19jbGllbnQsIGlzX2Nyb3Nzb3JpZ2luLCBpc19lbXB0eSwgaXNfZnVuY3Rpb24sIGlzX3Byb21pc2UsIGlzX3ZvaWQsIGxpc3RlbiwgbGlzdGVuX2RldiwgbG9vcCwgbG9vcF9ndWFyZCwgbWVyZ2Vfc3NyX3N0eWxlcywgbWlzc2luZ19jb21wb25lbnQsIG1vdW50X2NvbXBvbmVudCwgbm9vcCwgbm90X2VxdWFsLCBub3csIG51bGxfdG9fZW1wdHksIG9iamVjdF93aXRob3V0X3Byb3BlcnRpZXMsIG9uRGVzdHJveSwgb25Nb3VudCwgb25jZSwgb3V0cm9fYW5kX2Rlc3Ryb3lfYmxvY2ssIHByZXZlbnRfZGVmYXVsdCwgcHJvcF9kZXYsIHF1ZXJ5X3NlbGVjdG9yX2FsbCwgcmFmLCBydW4sIHJ1bl9hbGwsIHNhZmVfbm90X2VxdWFsLCBzY2hlZHVsZV91cGRhdGUsIHNlbGVjdF9tdWx0aXBsZV92YWx1ZSwgc2VsZWN0X29wdGlvbiwgc2VsZWN0X29wdGlvbnMsIHNlbGVjdF92YWx1ZSwgc2VsZiwgc2V0Q29udGV4dCwgc2V0X2F0dHJpYnV0ZXMsIHNldF9jdXJyZW50X2NvbXBvbmVudCwgc2V0X2N1c3RvbV9lbGVtZW50X2RhdGEsIHNldF9kYXRhLCBzZXRfZGF0YV9kZXYsIHNldF9pbnB1dF90eXBlLCBzZXRfaW5wdXRfdmFsdWUsIHNldF9ub3csIHNldF9yYWYsIHNldF9zdG9yZV92YWx1ZSwgc2V0X3N0eWxlLCBzZXRfc3ZnX2F0dHJpYnV0ZXMsIHNwYWNlLCBzcHJlYWQsIHNyY191cmxfZXF1YWwsIHN0YXJ0X2h5ZHJhdGluZywgc3RvcF9wcm9wYWdhdGlvbiwgc3Vic2NyaWJlLCBzdmdfZWxlbWVudCwgdGV4dCwgdGljaywgdGltZV9yYW5nZXNfdG9fYXJyYXksIHRvX251bWJlciwgdG9nZ2xlX2NsYXNzLCB0cmFuc2l0aW9uX2luLCB0cmFuc2l0aW9uX291dCwgdHJ1c3RlZCwgdXBkYXRlX2F3YWl0X2Jsb2NrX2JyYW5jaCwgdXBkYXRlX2tleWVkX2VhY2gsIHVwZGF0ZV9zbG90LCB1cGRhdGVfc2xvdF9iYXNlLCB2YWxpZGF0ZV9jb21wb25lbnQsIHZhbGlkYXRlX2R5bmFtaWNfZWxlbWVudCwgdmFsaWRhdGVfZWFjaF9hcmd1bWVudCwgdmFsaWRhdGVfZWFjaF9rZXlzLCB2YWxpZGF0ZV9zbG90cywgdmFsaWRhdGVfc3RvcmUsIHZhbGlkYXRlX3ZvaWRfZHluYW1pY19lbGVtZW50LCB4bGlua19hdHRyIH07XG4iLCAiaW1wb3J0IHttb21lbnR9IGZyb20gJ29ic2lkaWFuJztcblxuY29uc3QgbW9udGhOYW1lcyA9IFtcbiAgICBcIkphbnVhcnlcIixcbiAgICBcIkZlYnJ1YXJ5XCIsXG4gICAgXCJNYXJjaFwiLFxuICAgIFwiQXByaWxcIixcbiAgICBcIk1heVwiLFxuICAgIFwiSnVuZVwiLFxuICAgIFwiSnVseVwiLFxuICAgIFwiQXVndXN0XCIsXG4gICAgXCJTZXB0ZW1iZXJcIixcbiAgICBcIk9jdG9iZXJcIixcbiAgICBcIk5vdmVtYmVyXCIsXG4gICAgXCJEZWNlbWJlclwiXG5dO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TW9udGhOYW1lKGluZGV4OiBudW1iZXIpOiBzdHJpbmcge1xuICAgIHJldHVybiBtb250aE5hbWVzW2luZGV4XTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldERhdGVSb3dzKG1vbnRoSW5kZXg6IG51bWJlciwgeWVhcjogbnVtYmVyKTogbnVtYmVyW10ge1xuICAgIGNvbnN0IGRheXM6IG51bWJlciA9IG1vbWVudChuZXcgRGF0ZSh5ZWFyLCBtb250aEluZGV4KSkuZGF5c0luTW9udGgoKTsgLy8gYW1vdW50IG9mIGRheXMgaW4gbW9udGhcbiAgICBjb25zdCByb3dzOiBudW1iZXJbXSA9IChuZXcgQXJyYXkoNDIpKS5maWxsKHVuZGVmaW5lZCk7IC8vIGVtcHR5IDQyIGxvbmcgYXJyYXlcbiAgICBjb25zdCBzdGFydEluZGV4OiBudW1iZXIgPSBnZXRXZWVrRGF5KG5ldyBEYXRlKHllYXIsIG1vbnRoSW5kZXgsIDEpKTsgLy8gaW5kZXggb2Zmc2V0IGJhc2VkIG9uIHdlZWtkYXkgb2YgZmlyc3QgZGF5IGluIG1vbnRoXG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRheXM7IGkrKykge1xuICAgICAgICByb3dzW2kgKyBzdGFydEluZGV4XSA9IGkgKyAxO1xuICAgIH1cblxuICAgIHJldHVybiByb3dzW3Jvd3MubGVuZ3RoIC0gN10gPyByb3dzIDogcm93cy5zbGljZSgwLCAtNyk7XG59XG5cbi8vIGZpcnN0IGRheSBvZiB0aGUgd2VlayBpcyBtb25kYXkgd2hlcmUgSSBsaXZlXG5leHBvcnQgZnVuY3Rpb24gZ2V0V2Vla0RheShkYXRlOiBEYXRlKTogbnVtYmVyIHtcbiAgICByZXR1cm4gZGF0ZS5nZXREYXkoKSA9PT0gMCA/IDYgOiBkYXRlLmdldERheSgpIC0gMTtcbn1cblxuLy8gZmlyc3QgZGF5IG9mIHRoZSB3ZWVrIGlzIG1vbmRheSB3aGVyZSBJIGxpdmVcbmV4cG9ydCBmdW5jdGlvbiBnZXRXZWVrRGF5cygpOiBzdHJpbmdbXSB7XG4gICAgcmV0dXJuIFsnTW8nLCAnVHUnLCAnV2UnLCAnVGgnLCAnRnInLCAnU2EnLCAnU3UnXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHV1aWQoKTogKCkgPT4gbnVtYmVyIHtcbiAgICBsZXQgaWQgPSAwO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIHJldHVybiArK2lkO1xuICAgIH07XG59XG4iLCAiPHNjcmlwdCBsYW5nPVwidHNcIj5cbiAgICBpbXBvcnQge2dldERhdGVSb3dzLCBnZXRXZWVrRGF5cywgdXVpZH0gZnJvbSAnLi9EYXRlUGlja2VySW5wdXRTdmVsdGVIZWxwZXJzLmpzJztcbiAgICBpbXBvcnQgeyBjcmVhdGVFdmVudERpc3BhdGNoZXIgfSBmcm9tIFwic3ZlbHRlXCI7XG4gICAgaW1wb3J0IHttb21lbnR9IGZyb20gJ29ic2lkaWFuJztcblxuICAgIGNvbnN0IGRpc3BhdGNoID0gY3JlYXRlRXZlbnREaXNwYXRjaGVyKCk7XG5cbiAgICAvLyBwcm9wc1xuICAgIGV4cG9ydCBsZXQgc2VsZWN0ZWREYXRlOiBtb21lbnQuTW9tZW50O1xuICAgIGV4cG9ydCBsZXQgbW9udGg6IG51bWJlcjtcbiAgICBleHBvcnQgbGV0IHllYXI6IG51bWJlcjtcblxuICAgIC8vIGxvY2FsIHZhcnMgdG8gaGVscCBpbiByZW5kZXJcbiAgICBsZXQgY2VsbHM7XG5cbiAgICAvLyBmdW5jdGlvbiBoZWxwZXJzXG4gICAgZnVuY3Rpb24gb25DaGFuZ2UoZGF0ZTogbnVtYmVyKSB7XG4gICAgICAgIGRpc3BhdGNoKFwiZGF0ZUNoYW5nZVwiLCBtb21lbnQobmV3IERhdGUoeWVhciwgbW9udGgsIGRhdGUpKSk7XG4gICAgfVxuXG4gICAgJDogY2VsbHMgPSBnZXREYXRlUm93cyhtb250aCwgeWVhcik7XG48L3NjcmlwdD5cblxuPHN0eWxlPlxuICAgIC5jYWxlbmRhciB7XG4gICAgICAgIG1hcmdpbi10b3A6IDEwcHg7XG4gICAgfVxuXG4gICAgLmNhbGVuZGFyLWhlYWRlciB7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGZsZXgtd3JhcDogd3JhcDtcblx0XHRnYXA6IDJweDtcblx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXByaW1hcnkpO1xuXHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLW1ldGEtYmluZC1wbHVnaW4tYm9yZGVyLXJhZGl1cyk7XG5cdFx0bWFyZ2luLWJvdHRvbTogMnB4O1xuICAgIH1cblxuXHQuY2FsZW5kYXItY29udGVudCB7XG5cdFx0ZGlzcGxheTogZ3JpZDtcblx0XHRmbGV4LXdyYXA6IHdyYXA7XG5cdFx0Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoNywgMWZyKTtcblx0XHRnYXA6IDJweDtcblx0fVxuXG4gICAgLmNlbGwge1xuICAgICAgICB3aWR0aDogNDBweDtcbiAgICAgICAgaGVpZ2h0OiAzMHB4O1xuICAgICAgICBwYWRkaW5nOiA1cHg7XG5cdFx0ZGlzcGxheTogZmxleDtcblx0XHRqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcblx0XHRhbGlnbi1pdGVtczogY2VudGVyO1xuXHRcdGJvcmRlci1yYWRpdXM6IHZhcigtLW1ldGEtYmluZC1wbHVnaW4tYm9yZGVyLXJhZGl1cyk7XG4gICAgfVxuXG5cdC5jb250ZW50LWNlbGwge1xuXHRcdGN1cnNvcjogcG9pbnRlcjtcblx0fVxuXG5cdC5jZWxsLXRleHQge1xuXHRcdG1hcmdpbjogYXV0bztcblx0XHR0ZXh0LWFsaWduOiBjZW50ZXI7XG5cdH1cblxuICAgIC5zZWxlY3RlZCB7XG4gICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWJhY2tncm91bmQtbW9kaWZpZXItc3VjY2Vzcyk7XG4gICAgfVxuXG4gICAgLmhpZ2hsaWdodDpob3ZlciB7XG4gICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWludGVyYWN0aXZlLWhvdmVyKTtcbiAgICB9XG5cbiAgICAuc2VsZWN0ZWQuaGlnaGxpZ2h0OmhvdmVyIHtcbiAgICAgICAgYmFja2dyb3VuZDogZ3JlZW47XG4gICAgfVxuPC9zdHlsZT5cblxuPGRpdiBjbGFzcz1cImNhbGVuZGFyXCI+XG4gICAgPGRpdiBjbGFzcz1cImNhbGVuZGFyLWhlYWRlclwiPlxuICAgICAgICB7I2VhY2ggZ2V0V2Vla0RheXMoKSBhcyBkYXl9XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY2VsbCBoZWFkZXItY2VsbFwiPlxuXHRcdFx0XHQ8c3BhbiBjbGFzcz1cImNlbGwtdGV4dFwiPntkYXl9PC9zcGFuPlxuXHRcdFx0PC9kaXY+XG4gICAgICAgIHsvZWFjaH1cbiAgICA8L2Rpdj5cblxuICAgIDxkaXYgY2xhc3M9XCJjYWxlbmRhci1jb250ZW50XCI+XG4gICAgICAgIHsjZWFjaCBjZWxscyBhcyB2YWx1ZSAodXVpZCgpKX1cbiAgICAgICAgICAgIDxkaXZcblx0XHRcdFx0XHRjbGFzcz1cImNlbGxcIlxuICAgICAgICAgICAgICAgICAgICBvbjpjbGljaz17dmFsdWUgPyAoKSA9PiBvbkNoYW5nZSh2YWx1ZSkgOiAoKSA9PiB7fX1cbiAgICAgICAgICAgICAgICAgICAgY2xhc3M6aGlnaGxpZ2h0PXt2YWx1ZX1cblx0XHRcdFx0XHRjbGFzczpjb250ZW50LWNlbGw9e3ZhbHVlfVxuICAgICAgICAgICAgICAgICAgICBjbGFzczpzZWxlY3RlZD17c2VsZWN0ZWREYXRlLnllYXIoKSA9PT0geWVhciAmJiBzZWxlY3RlZERhdGUubW9udGgoKSA9PT0gbW9udGggJiYgc2VsZWN0ZWREYXRlLmRhdGUoKSA9PT0gdmFsdWV9PlxuICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwiY2VsbC10ZXh0XCI+e3ZhbHVlIHx8ICcnfTwvc3Bhbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICB7L2VhY2h9XG4gICAgPC9kaXY+XG48L2Rpdj5cbiIsICI8c2NyaXB0IGxhbmc9XCJ0c1wiPlxuICAgIGltcG9ydCB7IGNyZWF0ZUV2ZW50RGlzcGF0Y2hlciB9IGZyb20gXCJzdmVsdGVcIjtcbiAgICBpbXBvcnQgQ2FsZW5kZXIgZnJvbSBcIi4vQ2FsZW5kZXIuc3ZlbHRlXCI7XG4gICAgaW1wb3J0IHsgZ2V0TW9udGhOYW1lIH0gZnJvbSBcIi4vRGF0ZVBpY2tlcklucHV0U3ZlbHRlSGVscGVycy5qc1wiO1xuXHRpbXBvcnQge21vbWVudH0gZnJvbSAnb2JzaWRpYW4nO1xuXG4gICAgY29uc3QgZGlzcGF0Y2ggPSBjcmVhdGVFdmVudERpc3BhdGNoZXIoKTtcblxuICAgIC8vIHByb3BzXG4gICAgZXhwb3J0IGxldCBzZWxlY3RlZERhdGU6IG1vbWVudC5Nb21lbnQgPSBtb21lbnQoKTtcblx0ZXhwb3J0IGxldCBkYXRlQ2hhbmdlQ2FsbGJhY2s6IChkYXRlOiBtb21lbnQuTW9tZW50KSA9PiB2b2lkO1xuXG4gICAgLy8gc3RhdGVcbiAgICBsZXQgZGF0ZTtcbiAgICBsZXQgbW9udGg7XG4gICAgbGV0IHllYXI7XG4gICAgbGV0IHNob3dEYXRlUGlja2VyO1xuXG4gICAgLy8gc28gdGhhdCB0aGVzZSBjaGFuZ2Ugd2l0aCBwcm9wc1xuICAgICQ6IHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ3VwZGF0ZSBkYXRlIHBpY2tlcicsIHNlbGVjdGVkRGF0ZSk7XG4gICAgICAgIGRhdGUgPSBzZWxlY3RlZERhdGUuZGF0ZSgpO1xuICAgICAgICBtb250aCA9IHNlbGVjdGVkRGF0ZS5tb250aCgpO1xuICAgICAgICB5ZWFyID0gc2VsZWN0ZWREYXRlLnllYXIoKTtcbiAgICB9XG5cbiAgICAvLyBoYW5kbGVyc1xuICAgIGZ1bmN0aW9uIG9uRm9jdXMoKSB7XG4gICAgICAgIHNob3dEYXRlUGlja2VyID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBuZXh0ICgpIHtcbiAgICAgICAgaWYgKG1vbnRoID09PSAxMSkge1xuICAgICAgICAgICAgbW9udGggPSAwO1xuICAgICAgICAgICAgeWVhciArPSAxO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIG1vbnRoID0gbW9udGggKyAxO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHByZXYoKSB7XG4gICAgICAgIGlmIChtb250aCA9PT0gMCkge1xuICAgICAgICAgICAgbW9udGggPSAxMTtcbiAgICAgICAgICAgIHllYXIgLT0gMTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBtb250aCAtPSAxO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uRGF0ZUNoYW5nZShkOiB7ZGV0YWlsOiBtb21lbnQuTW9tZW50fSkge1xuICAgICAgICBzaG93RGF0ZVBpY2tlciA9IGZhbHNlO1xuXHRcdHNlbGVjdGVkRGF0ZSA9IGQuZGV0YWlsO1xuICAgICAgICBkYXRlQ2hhbmdlQ2FsbGJhY2soZC5kZXRhaWwpO1xuICAgIH1cbjwvc2NyaXB0PlxuXG48c3R5bGU+XG4gICAgLmRhdGUtcGlja2VyLWlucHV0IHtcbiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuXHRcdGNvbG9yOiB2YXIoLS10ZXh0LW5vcm1hbCk7XG4gICAgfVxuXG4gICAgLmRhdGUtcGlja2VyIHtcbiAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICB0b3A6IDMwcHg7XG4gICAgICAgIGxlZnQ6IDA7XG4gICAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcblx0XHRiYWNrZ3JvdW5kOiB2YXIoLS1iYWNrZ3JvdW5kLXNlY29uZGFyeSk7XG5cdFx0Ym9yZGVyLXJhZGl1czogdmFyKC0tbWV0YS1iaW5kLXBsdWdpbi1ib3JkZXItcmFkaXVzKTtcblx0XHRib3JkZXI6IHZhcigtLW1ldGEtYmluZC1wbHVnaW4tYm9yZGVyLXdpZHRoKSBzb2xpZCB2YXIoLS1iYWNrZ3JvdW5kLW1vZGlmaWVyLWJvcmRlcik7XG5cdFx0cGFkZGluZzogMTBweDtcblx0XHR6LWluZGV4OiAxMDAwMDAwO1xuICAgIH1cblxuICAgIC5kYXRlLXBpY2tlci1oZWFkZXIge1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICB9XG5cblx0LmRhdGUtcGlja2VyLWhlYWRlci10ZXh0IHtcblx0XHRmbGV4OiAxO1xuXHRcdHRleHQtYWxpZ246IGNlbnRlcjtcblx0fVxuXG5cdC5tb250aC1zd2l0Y2gtYnV0dG9uIHtcblx0XHRtYXJnaW46IDA7XG5cdH1cbjwvc3R5bGU+XG5cbjxkaXYgY2xhc3M9XCJkYXRlLXBpY2tlci1pbnB1dFwiPlxuICAgIDxkaXYgb246Y2xpY2s9eygpID0+IHNob3dEYXRlUGlja2VyID0gdHJ1ZX0+e3NlbGVjdGVkRGF0ZS5mb3JtYXQoJ2RkZGQsIE1NTU0gRG8gWVlZWScpfTwvZGl2PlxuICAgIHsjaWYgc2hvd0RhdGVQaWNrZXJ9XG4gICAgICAgIDxkaXYgY2xhc3M9XCJkYXRlLXBpY2tlclwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImRhdGUtcGlja2VyLWhlYWRlclwiPlxuXHRcdFx0XHQ8YnV0dG9uIGNsYXNzPVwibW9udGgtc3dpdGNoLWJ1dHRvblwiIG9uOmNsaWNrPXtwcmV2fT5QcmV2PC9idXR0b24+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImRhdGUtcGlja2VyLWhlYWRlci10ZXh0XCI+XG5cdFx0XHRcdFx0e2dldE1vbnRoTmFtZShtb250aCl9IHt5ZWFyfVxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0PGJ1dHRvbiBjbGFzcz1cIm1vbnRoLXN3aXRjaC1idXR0b25cIiBvbjpjbGljaz17bmV4dH0+TmV4dDwvYnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8Q2FsZW5kZXJcbiAgICAgICAgICAgICAgICAgICAgb246ZGF0ZUNoYW5nZT17b25EYXRlQ2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICBtb250aD17bW9udGh9XG4gICAgICAgICAgICAgICAgICAgIHllYXI9e3llYXJ9XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkRGF0ZT17c2VsZWN0ZWREYXRlfT5cbiAgICAgICAgICAgIDwvQ2FsZW5kZXI+XG4gICAgICAgIDwvZGl2PlxuICAgIHsvaWZ9XG48L2Rpdj5cbiIsICJpbXBvcnQge0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkfSBmcm9tICcuLi8uLi9JbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCc7XG5pbXBvcnQge0Fic3RyYWN0SW5wdXRGaWVsZH0gZnJvbSAnLi4vQWJzdHJhY3RJbnB1dEZpZWxkJztcbmltcG9ydCB7TWV0YUJpbmRJbnRlcm5hbEVycm9yfSBmcm9tICcuLi8uLi91dGlscy9VdGlscyc7XG5pbXBvcnQgRGF0ZVBpY2tlciBmcm9tICcuL0RhdGVQaWNrZXIuc3ZlbHRlJztcbmltcG9ydCB7bW9tZW50fSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQge0RhdGVQYXJzZXJ9IGZyb20gJy4uLy4uL3BhcnNlcnMvRGF0ZVBhcnNlcic7XG5cbmV4cG9ydCBjbGFzcyBEYXRlUGlja2VySW5wdXRGaWVsZCBleHRlbmRzIEFic3RyYWN0SW5wdXRGaWVsZCB7XG5cdGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQgfCB1bmRlZmluZWQ7XG5cdGNvbXBvbmVudDogRGF0ZVBpY2tlciB8IHVuZGVmaW5lZDtcblx0ZGF0ZTogbW9tZW50Lk1vbWVudDtcblxuXHRjb25zdHJ1Y3RvcihpbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZDogSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQsIG9uVmFsdWVDaGFuZ2U6ICh2YWx1ZTogYW55KSA9PiAodm9pZCB8IFByb21pc2U8dm9pZD4pKSB7XG5cdFx0c3VwZXIoaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQsIG9uVmFsdWVDaGFuZ2UpO1xuXG5cdFx0dGhpcy5kYXRlID0gRGF0ZVBhcnNlci5nZXREZWZhdWx0RGF0ZSgpO1xuXHR9XG5cblx0Z2V0VmFsdWUoKTogYW55IHtcblx0XHRyZXR1cm4gRGF0ZVBhcnNlci5zdHJpbmdpZnkodGhpcy5kYXRlKTtcblx0fVxuXG5cdHNldFZhbHVlKHZhbHVlOiBhbnkpOiB2b2lkIHtcblx0XHR0aGlzLmRhdGUgPSBEYXRlUGFyc2VyLnBhcnNlKHZhbHVlKSA/PyBEYXRlUGFyc2VyLmdldERlZmF1bHREYXRlKCk7XG5cdFx0dGhpcy5jb21wb25lbnQ/LiRzZXQoeydzZWxlY3RlZERhdGUnOiB0aGlzLmRhdGV9KTtcblx0fVxuXG5cdGlzRXF1YWxWYWx1ZSh2YWx1ZTogYW55KTogYm9vbGVhbiB7XG5cdFx0cmV0dXJuIHRoaXMuZ2V0VmFsdWUoKSA9PSB2YWx1ZTtcblx0fVxuXG5cdGdldERlZmF1bHRWYWx1ZSgpOiBhbnkge1xuXHRcdHJldHVybiBEYXRlUGFyc2VyLnN0cmluZ2lmeShEYXRlUGFyc2VyLmdldERlZmF1bHREYXRlKCkpO1xuXHR9XG5cblx0Z2V0SHRtbEVsZW1lbnQoKTogSFRNTEVsZW1lbnQge1xuXHRcdGlmICghdGhpcy5jb250YWluZXIpIHtcblx0XHRcdHRocm93IG5ldyBNZXRhQmluZEludGVybmFsRXJyb3IoJycpO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzLmNvbnRhaW5lcjtcblx0fVxuXG5cdGRhdGVQaWNrZXJWYWx1ZUNoYW5nZWQoZGF0ZTogbW9tZW50Lk1vbWVudCk6IHZvaWQge1xuXHRcdHRoaXMuZGF0ZSA9IGRhdGU7XG5cdFx0Y29uc29sZS5sb2coJ2RhdGUgcGlja2VyIHZhbHVlIGNoYW5nZScsIHRoaXMuZGF0ZSk7XG5cblx0XHR0aGlzLm9uVmFsdWVDaGFuZ2UodGhpcy5nZXRWYWx1ZSgpKTtcblx0fVxuXG5cdHJlbmRlcihjb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG5cdFx0dGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XG5cblx0XHR0aGlzLmRhdGUgPSBEYXRlUGFyc2VyLnBhcnNlKHRoaXMuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQuZ2V0SW5pdGlhbFZhbHVlKCkpID8/IERhdGVQYXJzZXIuZ2V0RGVmYXVsdERhdGUoKTtcblxuXHRcdHRoaXMuY29tcG9uZW50ID0gbmV3IERhdGVQaWNrZXIoe1xuXHRcdFx0dGFyZ2V0OiBjb250YWluZXIsXG5cdFx0XHRwcm9wczoge1xuXHRcdFx0XHRzZWxlY3RlZERhdGU6IHRoaXMuZGF0ZSxcblx0XHRcdFx0ZGF0ZUNoYW5nZUNhbGxiYWNrOiAoZGF0ZTogbW9tZW50Lk1vbWVudCkgPT4gdGhpcy5kYXRlUGlja2VyVmFsdWVDaGFuZ2VkKGRhdGUpLFxuXHRcdFx0fSxcblx0XHR9KVxuXHR9XG5cbn1cbiIsICJpbXBvcnQge1RvZ2dsZUlucHV0RmllbGR9IGZyb20gJy4vVG9nZ2xlSW5wdXRGaWVsZCc7XG5pbXBvcnQge0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLCBJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZFR5cGV9IGZyb20gJy4uL0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkJztcbmltcG9ydCB7VGV4dElucHV0RmllbGR9IGZyb20gJy4vVGV4dElucHV0RmllbGQnO1xuaW1wb3J0IHtTbGlkZXJJbnB1dEZpZWxkfSBmcm9tICcuL1NsaWRlcklucHV0RmllbGQnO1xuaW1wb3J0IHtUZXh0QXJlYUlucHV0RmllbGR9IGZyb20gJy4vVGV4dEFyZWFJbnB1dEZpZWxkJztcbmltcG9ydCB7U2VsZWN0SW5wdXRGaWVsZH0gZnJvbSAnLi9TZWxlY3RJbnB1dEZpZWxkJztcbmltcG9ydCB7TXVsdGlTZWxlY3RJbnB1dEZpZWxkfSBmcm9tICcuL011bHRpU2VsZWN0SW5wdXRGaWVsZCc7XG5pbXBvcnQge0RhdGVJbnB1dEZpZWxkfSBmcm9tICcuL0RhdGVJbnB1dEZpZWxkJztcbmltcG9ydCB7VGltZUlucHV0RmllbGR9IGZyb20gJy4vVGltZUlucHV0RmllbGQnO1xuaW1wb3J0IHtNZXRhQmluZFBhcnNpbmdFcnJvcn0gZnJvbSAnLi4vdXRpbHMvVXRpbHMnO1xuaW1wb3J0IHtBYnN0cmFjdElucHV0RmllbGR9IGZyb20gJy4vQWJzdHJhY3RJbnB1dEZpZWxkJztcbmltcG9ydCB7SW5wdXRGaWVsZFR5cGV9IGZyb20gJy4uL3BhcnNlcnMvSW5wdXRGaWVsZERlY2xhcmF0aW9uUGFyc2VyJztcbmltcG9ydCB7RGF0ZVBpY2tlcklucHV0RmllbGR9IGZyb20gJy4vRGF0ZVBpY2tlci9EYXRlUGlja2VySW5wdXRGaWVsZCc7XG5cblxuZXhwb3J0IGNsYXNzIElucHV0RmllbGRGYWN0b3J5IHtcblx0c3RhdGljIGFsbG93Q29kZUJsb2NrTWFwOiBSZWNvcmQ8c3RyaW5nLCB7IGNvZGVCbG9jazogYm9vbGVhbiwgaW5saW5lQ29kZUJsb2NrOiBib29sZWFuIH0+ID0ge1xuXHRcdFtJbnB1dEZpZWxkVHlwZS5UT0dHTEVdOiB7IGNvZGVCbG9jazogVG9nZ2xlSW5wdXRGaWVsZC5hbGxvd0NvZGVCbG9jaywgaW5saW5lQ29kZUJsb2NrOiBUb2dnbGVJbnB1dEZpZWxkLmFsbG93SW5saW5lQ29kZUJsb2NrIH0sXG5cdFx0W0lucHV0RmllbGRUeXBlLlNMSURFUl06IHsgY29kZUJsb2NrOiBTbGlkZXJJbnB1dEZpZWxkLmFsbG93Q29kZUJsb2NrLCBpbmxpbmVDb2RlQmxvY2s6IFNsaWRlcklucHV0RmllbGQuYWxsb3dJbmxpbmVDb2RlQmxvY2sgfSxcblx0XHRbSW5wdXRGaWVsZFR5cGUuVEVYVF06IHsgY29kZUJsb2NrOiBUZXh0SW5wdXRGaWVsZC5hbGxvd0NvZGVCbG9jaywgaW5saW5lQ29kZUJsb2NrOiBUZXh0SW5wdXRGaWVsZC5hbGxvd0lubGluZUNvZGVCbG9jayB9LFxuXHRcdFtJbnB1dEZpZWxkVHlwZS5URVhUX0FSRUFdOiB7IGNvZGVCbG9jazogVGV4dEFyZWFJbnB1dEZpZWxkLmFsbG93Q29kZUJsb2NrLCBpbmxpbmVDb2RlQmxvY2s6IFRleHRBcmVhSW5wdXRGaWVsZC5hbGxvd0lubGluZUNvZGVCbG9jayB9LFxuXHRcdFtJbnB1dEZpZWxkVHlwZS5TRUxFQ1RdOiB7IGNvZGVCbG9jazogU2VsZWN0SW5wdXRGaWVsZC5hbGxvd0NvZGVCbG9jaywgaW5saW5lQ29kZUJsb2NrOiBTZWxlY3RJbnB1dEZpZWxkLmFsbG93SW5saW5lQ29kZUJsb2NrIH0sXG5cdFx0W0lucHV0RmllbGRUeXBlLk1VTFRJX1NFTEVDVF06IHsgY29kZUJsb2NrOiBNdWx0aVNlbGVjdElucHV0RmllbGQuYWxsb3dDb2RlQmxvY2ssIGlubGluZUNvZGVCbG9jazogTXVsdGlTZWxlY3RJbnB1dEZpZWxkLmFsbG93SW5saW5lQ29kZUJsb2NrIH0sXG5cdFx0W0lucHV0RmllbGRUeXBlLkRBVEVdOiB7IGNvZGVCbG9jazogRGF0ZUlucHV0RmllbGQuYWxsb3dDb2RlQmxvY2ssIGlubGluZUNvZGVCbG9jazogRGF0ZUlucHV0RmllbGQuYWxsb3dJbmxpbmVDb2RlQmxvY2sgfSxcblx0XHRbSW5wdXRGaWVsZFR5cGUuVElNRV06IHsgY29kZUJsb2NrOiBUaW1lSW5wdXRGaWVsZC5hbGxvd0NvZGVCbG9jaywgaW5saW5lQ29kZUJsb2NrOiBUaW1lSW5wdXRGaWVsZC5hbGxvd0lubGluZUNvZGVCbG9jayB9LFxuXHRcdFtJbnB1dEZpZWxkVHlwZS5EQVRFX1BJQ0tFUl06IHsgY29kZUJsb2NrOiBEYXRlUGlja2VySW5wdXRGaWVsZC5hbGxvd0NvZGVCbG9jaywgaW5saW5lQ29kZUJsb2NrOiBEYXRlUGlja2VySW5wdXRGaWVsZC5hbGxvd0lubGluZUNvZGVCbG9jayB9LFxuXHR9XG5cblx0c3RhdGljIGNyZWF0ZUlucHV0RmllbGQoaW5wdXRGaWVsZFR5cGU6IElucHV0RmllbGRUeXBlLCBhcmdzOiB7IHR5cGU6IElucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkVHlwZSwgaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQ6IElucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLCBvblZhbHVlQ2hhbmdlZDogKHZhbHVlOiBhbnkpID0+IHZvaWQgfCBQcm9taXNlPHZvaWQ+IH0pOiBBYnN0cmFjdElucHV0RmllbGQgfCB1bmRlZmluZWQge1xuXHRcdGlmIChpbnB1dEZpZWxkVHlwZSA9PT0gSW5wdXRGaWVsZFR5cGUuVE9HR0xFKSB7XG5cdFx0XHRJbnB1dEZpZWxkRmFjdG9yeS5jaGVja0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkVHlwZUFsbG93ZWQoaW5wdXRGaWVsZFR5cGUsIGFyZ3MudHlwZSk7XG5cdFx0XHRyZXR1cm4gbmV3IFRvZ2dsZUlucHV0RmllbGQoYXJncy5pbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCwgYXJncy5vblZhbHVlQ2hhbmdlZCk7XG5cdFx0fSBlbHNlIGlmIChpbnB1dEZpZWxkVHlwZSA9PT0gSW5wdXRGaWVsZFR5cGUuU0xJREVSKSB7XG5cdFx0XHRJbnB1dEZpZWxkRmFjdG9yeS5jaGVja0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkVHlwZUFsbG93ZWQoaW5wdXRGaWVsZFR5cGUsIGFyZ3MudHlwZSk7XG5cdFx0XHRyZXR1cm4gbmV3IFNsaWRlcklucHV0RmllbGQoYXJncy5pbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCwgYXJncy5vblZhbHVlQ2hhbmdlZCk7XG5cdFx0fSBlbHNlIGlmIChpbnB1dEZpZWxkVHlwZSA9PT0gSW5wdXRGaWVsZFR5cGUuVEVYVCkge1xuXHRcdFx0SW5wdXRGaWVsZEZhY3RvcnkuY2hlY2tJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZFR5cGVBbGxvd2VkKGlucHV0RmllbGRUeXBlLCBhcmdzLnR5cGUpO1xuXHRcdFx0cmV0dXJuIG5ldyBUZXh0SW5wdXRGaWVsZChhcmdzLmlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLCBhcmdzLm9uVmFsdWVDaGFuZ2VkKTtcblx0XHR9IGVsc2UgaWYgKGlucHV0RmllbGRUeXBlID09PSBJbnB1dEZpZWxkVHlwZS5URVhUX0FSRUEpIHtcblx0XHRcdElucHV0RmllbGRGYWN0b3J5LmNoZWNrSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGRUeXBlQWxsb3dlZChpbnB1dEZpZWxkVHlwZSwgYXJncy50eXBlKTtcblx0XHRcdHJldHVybiBuZXcgVGV4dEFyZWFJbnB1dEZpZWxkKGFyZ3MuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQsIGFyZ3Mub25WYWx1ZUNoYW5nZWQpO1xuXHRcdH0gZWxzZSBpZiAoaW5wdXRGaWVsZFR5cGUgPT09IElucHV0RmllbGRUeXBlLlNFTEVDVCkge1xuXHRcdFx0SW5wdXRGaWVsZEZhY3RvcnkuY2hlY2tJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZFR5cGVBbGxvd2VkKGlucHV0RmllbGRUeXBlLCBhcmdzLnR5cGUpO1xuXHRcdFx0cmV0dXJuIG5ldyBTZWxlY3RJbnB1dEZpZWxkKGFyZ3MuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQsIGFyZ3Mub25WYWx1ZUNoYW5nZWQpO1xuXHRcdH0gZWxzZSBpZiAoaW5wdXRGaWVsZFR5cGUgPT09IElucHV0RmllbGRUeXBlLk1VTFRJX1NFTEVDVCkge1xuXHRcdFx0SW5wdXRGaWVsZEZhY3RvcnkuY2hlY2tJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZFR5cGVBbGxvd2VkKGlucHV0RmllbGRUeXBlLCBhcmdzLnR5cGUpO1xuXHRcdFx0cmV0dXJuIG5ldyBNdWx0aVNlbGVjdElucHV0RmllbGQoYXJncy5pbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZCwgYXJncy5vblZhbHVlQ2hhbmdlZCk7XG5cdFx0fSBlbHNlIGlmIChpbnB1dEZpZWxkVHlwZSA9PT0gSW5wdXRGaWVsZFR5cGUuREFURSkge1xuXHRcdFx0SW5wdXRGaWVsZEZhY3RvcnkuY2hlY2tJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZFR5cGVBbGxvd2VkKGlucHV0RmllbGRUeXBlLCBhcmdzLnR5cGUpO1xuXHRcdFx0cmV0dXJuIG5ldyBEYXRlSW5wdXRGaWVsZChhcmdzLmlucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkLCBhcmdzLm9uVmFsdWVDaGFuZ2VkKTtcblx0XHR9IGVsc2UgaWYgKGlucHV0RmllbGRUeXBlID09PSBJbnB1dEZpZWxkVHlwZS5USU1FKSB7XG5cdFx0XHRJbnB1dEZpZWxkRmFjdG9yeS5jaGVja0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkVHlwZUFsbG93ZWQoaW5wdXRGaWVsZFR5cGUsIGFyZ3MudHlwZSk7XG5cdFx0XHRyZXR1cm4gbmV3IFRpbWVJbnB1dEZpZWxkKGFyZ3MuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQsIGFyZ3Mub25WYWx1ZUNoYW5nZWQpO1xuXHRcdH0gZWxzZSBpZiAoaW5wdXRGaWVsZFR5cGUgPT09IElucHV0RmllbGRUeXBlLkRBVEVfUElDS0VSKSB7XG5cdFx0XHRJbnB1dEZpZWxkRmFjdG9yeS5jaGVja0lucHV0RmllbGRNYXJrZG93blJlbmRlckNoaWxkVHlwZUFsbG93ZWQoaW5wdXRGaWVsZFR5cGUsIGFyZ3MudHlwZSk7XG5cdFx0XHRyZXR1cm4gbmV3IERhdGVQaWNrZXJJbnB1dEZpZWxkKGFyZ3MuaW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGQsIGFyZ3Mub25WYWx1ZUNoYW5nZWQpO1xuXHRcdH1cblxuXHRcdHJldHVybiB1bmRlZmluZWQ7XG5cdH1cblxuXHRzdGF0aWMgY2hlY2tJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZFR5cGVBbGxvd2VkKGlucHV0RmllbGRUeXBlOiBJbnB1dEZpZWxkVHlwZSwgdHlwZTogSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGRUeXBlKTogdm9pZCB7XG5cdFx0Y29uc3QgYWxsb3dDb2RlQmxvY2s6IHsgY29kZUJsb2NrOiBib29sZWFuOyBpbmxpbmVDb2RlQmxvY2s6IGJvb2xlYW4gfSA9IElucHV0RmllbGRGYWN0b3J5LmFsbG93Q29kZUJsb2NrTWFwW2lucHV0RmllbGRUeXBlXTtcblx0XHRpZiAodHlwZSA9PT0gSW5wdXRGaWVsZE1hcmtkb3duUmVuZGVyQ2hpbGRUeXBlLkNPREVfQkxPQ0sgJiYgIWFsbG93Q29kZUJsb2NrLmNvZGVCbG9jaykge1xuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kUGFyc2luZ0Vycm9yKGBcXCcke2lucHV0RmllbGRUeXBlfVxcJyBpcyBub3QgYWxsb3dlZCBhcyBjb2RlIGJsb2NrYCk7XG5cdFx0fVxuXHRcdGlmICh0eXBlID09PSBJbnB1dEZpZWxkTWFya2Rvd25SZW5kZXJDaGlsZFR5cGUuSU5MSU5FX0NPREVfQkxPQ0sgJiYgIWFsbG93Q29kZUJsb2NrLmlubGluZUNvZGVCbG9jaykge1xuXHRcdFx0dGhyb3cgbmV3IE1ldGFCaW5kUGFyc2luZ0Vycm9yKGBcXCcke2lucHV0RmllbGRUeXBlfVxcJyBpcyBub3QgYWxsb3dlZCBhcyBpbmxpbmUgY29kZSBibG9ja2ApO1xuXHRcdH1cblx0fVxuXG59XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFB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
